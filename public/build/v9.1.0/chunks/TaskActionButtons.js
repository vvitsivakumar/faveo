import{u as P,m as j,a as M,r as d,q as I,o as l,c as p,b as r,d as o,i as v,e as m,f as i,t as u,z as A,g as f,F as U,s as O,n as E,w as _,T as D,p as V,j as Y}from"./vendor.js";import{_ as C,j as K,D as N,q as R,R as z,r as H,S as J,e as S,p as L,s as q}from"./bootstrap.js";const W={data(){return{task_name:null,required:!0,task_description:null,associated_ticket:void 0,assignee:[],task_start_date:null,task_end_date:null,due_alert_text:"",alert_repeat:null,task_category_id:null,taskCategoryKey:Math.floor(Math.random()*1e6),is_private:0,taskId:null,task:"",mode:null,loading:!1,timeOptions:{start:"00:00",step:"00:30",end:"23:30"},numberStyle:{width:"20%"},elementsTaskAlert:[{name:"On day of event",value:"event_day"},{name:"5 minutes before",value:"5_minutes_before"},{name:"15 minutes before",value:"15_minutes_before"},{name:"30 minutes before",value:"30_minutes_before"},{name:"1 hour before",value:"1_hour_before"},{name:"2 hours before",value:"2_hours_before"},{name:"1 day before",value:"1_day_before"},{name:"No Reminder",value:"no_reminder"}],elementsAlertRepeat:[{name:"Never",value:"never"},{name:"Daily",value:"daily"},{name:"Weekly",value:"weekly"},{name:"Monthly",value:"monthly"}],elementTaskStatus:[{name:"Open",value:"Open"},{name:"Closed",value:"Closed"},{name:"In-progress",value:"In-progress"}],elementNotifyBefore:[{name:"10 minutes before",id:10},{name:"15 minutes before",id:15},{name:"30 minutes before",id:30},{name:"1 hour before",id:60}],status:{name:"Open",value:"Open"},project_id:"",department_id:"",task_category_api:"",radioOptions:[{name:"agent",value:"agents"},{name:"team",value:"teams"},{name:"assign_to_me",value:"assign_to_me"}],assign:null,assign_to:"",assignChange:!1,assigneesForEdit:null,departments:[],randomKey:Math.floor(Math.random()*1e6),hiddenLabelStyle:{display:"none"},assigned_agents:[],assigned_teams:[],attached_tickets:[],attached_changes:[],watching_agents:[],watching_teams:[],watching_departments:[]}}};const G={setup(){const e=P();return{formattedTime:j(()=>e.getters.formattedTime),formattedDate:j(()=>e.getters.formattedDate)}},props:{entityId:{type:[String,Number],default:""},entityType:{type:String,default:"ticket"},popup:{type:Boolean,default:!1},alertName:{type:String,default:"taskCreate"},onComplete:{type:Function},showChangeSelectionInput:{type:Boolean,default:!1}},mixins:[W],data(){return{category:""}},computed:{taskCategoryUrl(){const e=this.project_id;return e?`tasks/api/category/view?project_ids[0]=${e.id}`:(this.task_category_id=null,this.randomKey++,"")},requiredForPrivate(){return!parseInt(this.is_private)},disableRadioInput(){return!!this.popup},buttonText(){return this.mode==="edit"?"update":"submit"},buttonClass(){return this.mode==="edit"?"fas fa-sync":"fas fa-save"},getApiParameters(){return{"supplements[no_email]":1}},getDepartmentParams(){let e="";for(let t=0;t<this.departments.length;t++){let s=this.departments[t];e+=`department_id[${t}]=${s.id}&`}return e[e.length-1]==="&"&&(e=e.slice(0,-1)),e},getAgentsUrl(){let e="api/dependency/agents?";return this.departments.length?e+this.getDepartmentParams:e},getTeamsUrl(){let e="api/dependency/teams?";return this.departments.length?e+this.getDepartmentParams:e}},beforeMount(){this.isThisEditForm()&&this.getTaskDetails(),this.category=this.$store.getters.getChangeAssociateCategory},components:{"text-field":K,"dynamic-select":N,"date-time-field":R,RadioButton:z,FormFieldTemplate:H,StaticSelect:J},methods:{getTaskDetails(){this.loading=!0,M.get("/tasks/api/get-task-by-id/"+this.taskId+"?policy_check=1").then(e=>{let t=e.data.data;this.task_name=t.task_name,this.task_description=t.task_description,this.task_start_date=t.task_start_date,this.task_end_date=t.task_end_date,this.task_category_id=t.task_category,this.is_private=t.is_private,this.status={name:t.status,value:t.status},this.project_id=t.project,this.departments=t.department?t.department:[],this.assigned_agents=t.users?t.users:[],this.assigned_teams=t.teams?t.teams:[],this.attached_tickets=t.tickets?t.tickets:[],this.attached_changes=t.changes?t.changes:[],this.watching_agents=t.watching_agents?t.watching_agents:[],this.watching_teams=t.watching_teams?t.watching_teams:[],this.watching_departments=t.watching_departments?t.watching_departments:[],this.due_alert_text=t.due_alert_text?t.due_alert_text:null,this.loading=!1}).catch(e=>{this.loading=!1,S(e,this.alertName),setTimeout(()=>{this.redirect("/404")},1e3)})},filterValues(e,t){return e.filter(s=>{if(s.value===t)return s})[0]},isThisEditForm(){let e=window.location.pathname.split("/");return e[e.length-1]==="edit"?(this.taskId=e[e.length-2],this.mode="edit",!0):!1},onChange(e,t){this[t]=e,t==="project"&&this.randomKey++},subString(e){return L(e,25)},taskSubmit(){let e,t;parseInt(this.is_private)&&(this.assignee=[],this.associated_ticket=void 0);let s={task_start_date:this.task_start_date,task_end_date:this.task_end_date,due_alert_text:this.due_alert_text?this.due_alert_text:null,entity_id:this.entityId||null,assignee:this.assignee?this.assignee.map(n=>n.id):[],task_name:this.task_name,task_description:this.task_description,is_private:this.is_private,task_category_id:this.task_category_id?this.task_category_id.id:null,status:this.status?this.status.value:null,project_id:this.project_id?this.project_id.id:null,departments:this.departments&&this.departments.length?this.departments:[],entity_type:this.entityType||"ticket"},b={};this.is_private==0&&(b={attached_tickets:this.attached_tickets.length?this.attached_tickets.map(n=>n.id):[],attached_changes:this.attached_changes.length?this.attached_changes.map(n=>n.id):[],watching_agents:this.watching_agents?this.watching_agents.map(n=>n.id):[],watching_teams:this.watching_teams?this.watching_teams.map(n=>n.id):[],watching_departments:this.watching_departments?this.watching_departments.map(n=>n.id):[],assigned_agents:this.assigned_agents.length?this.assigned_agents.map(n=>n.id):[],assigned_teams:this.assigned_teams.length?this.assigned_teams.map(n=>n.id):[]}),s={...s,...b},this.loading=!0,this.mode==="edit"?(e="/tasks/task/"+this.taskId,t="PUT"):(e="/tasks/task",t="POST"),M.request({method:t,url:e,data:s}).then(n=>{this.loading=!1,this.$store.dispatch("unsetValidationError"),window.emitter.emit("refreshData"),q(n,this.alertName),this.popup?(this.onComplete(),window.emitter.emit("refreshData"),window.emitter.emit("updateChangeAssociates"),this.category==="activity"?window.emitter.emit("updateChangeActivity"):this.category==="tasks"&&window.emitter.emit("changeTaskrefreshData")):this.mode==="edit"?(this.$store.dispatch("unsetValidationError"),this.getTaskDetails(),window.emitter.emit("updateAgentSidebar")):setTimeout(()=>{let a=n.data.data.id;this.$router.push("/tasks/task/"+a)},3e3)}).catch(n=>{this.loading=!1,S(n,this.alertName)})}}},Q={class:"row"},X={class:"col-sm-6"},Z=i("br",null,null,-1),x={class:"radio-inline control-label"},$=["disabled"],ee={class:"font-weight-normal"},te={class:"radio-inline control-label"},ae={class:"font-weight-normal"},se={class:"row mt-5"},ne={class:"col-sm-2"};function ie(e,t,s,b,n,a){const g=d("custom-loader"),h=d("alert"),y=d("text-field"),k=d("date-time-field"),c=d("dynamic-select"),F=d("static-select"),B=I("focus-first-input");return l(),p("div",null,[e.loading?(l(),r(g,{key:0,"animation-duration":"4000",color:"#1d78ff",size:"60"})):o("",!0),s.popup?(l(),r(h,{key:1,componentName:"taskCreate"})):o("",!0),v((l(),p("div",Q,[m(y,{label:e.lang("task_name"),onChange:a.onChange,placehold:e.lang("enter_a_value"),value:e.task_name,type:"text",name:"task_name",classname:"col-sm-6",required:e.required,id:"task_name"},null,8,["label","onChange","placehold","value","required"]),i("div",X,[i("label",null,u(e.lang("task_type")),1),Z,i("label",x,[v(i("input",{class:"radioMargin",type:"radio",value:"1","onUpdate:modelValue":t[0]||(t[0]=w=>e.is_private=w),disabled:a.disableRadioInput},null,8,$),[[A,e.is_private]]),i("span",ee," "+u(e.lang("private")),1)]),f("   "),i("label",te,[v(i("input",{class:"radioMargin",type:"radio",value:"0","onUpdate:modelValue":t[1]||(t[1]=w=>e.is_private=w)},null,512),[[A,e.is_private]]),i("span",ae," "+u(e.lang("public")),1)])]),m(k,{label:e.lang("start_at"),value:e.task_start_date,type:"datetime",name:"task_start_date",onChange:a.onChange,required:e.required,format:"MMMM DD YYYY, h:mm a",classname:"col-sm-6",clearable:!0,disabled:!1,editable:!0,range:!1,currentYearDate:!1,"time-picker-options":e.timeOptions,isDateSelector:!1,numberStyle:e.numberStyle,confirm:!0},null,8,["label","value","onChange","required","time-picker-options","numberStyle"]),m(k,{label:e.lang("ends_at"),value:e.task_end_date,type:"datetime",name:"task_end_date",onChange:a.onChange,required:e.required,format:"MMMM DD YYYY, h:mm a",classname:"col-sm-6",clearable:!0,disabled:!1,editable:!0,range:!1,currentYearDate:!1,"time-picker-options":e.timeOptions,isDateSelector:!1,numberStyle:e.numberStyle,confirm:!0},null,8,["label","value","onChange","required","time-picker-options","numberStyle"]),m(c,{name:"status",classname:"col-sm-6",elements:e.elementTaskStatus,multiple:!1,label:e.lang("task-status-label"),clearble:!1,value:e.status,onChange:a.onChange,searchable:!1,required:e.required},null,8,["elements","label","value","onChange","required"]),m(c,{name:"project_id",classname:"col-sm-6",apiEndpoint:"tasks/api/project/view",multiple:!1,label:e.lang("project"),value:e.project_id,onChange:a.onChange,searchable:!0},null,8,["label","value","onChange"]),(l(),r(c,{name:"task_category_id",classname:"col-sm-6",key:e.randomKey,apiEndpoint:a.taskCategoryUrl,multiple:!1,label:e.lang("task_list"),hint:e.lang("task-plugin-category-tooltip"),value:e.task_category_id,onChange:a.onChange,searchable:!0},null,8,["apiEndpoint","label","hint","value","onChange"])),a.requiredForPrivate?(l(),r(c,{key:0,name:"assigned_agents",value:e.assigned_agents,multiple:!0,classname:"col-sm-6","api-endpoint":a.getAgentsUrl,"api-parameters":a.getApiParameters,onChange:a.onChange,strlength:"30",label:e.trans("agents")},null,8,["value","api-endpoint","api-parameters","onChange","label"])):o("",!0),a.requiredForPrivate?(l(),r(c,{key:1,name:"assigned_teams",value:e.assigned_teams,multiple:!0,classname:"col-sm-6","api-endpoint":a.getTeamsUrl,onChange:a.onChange,strlength:"30",label:e.trans("teams")},null,8,["value","api-endpoint","onChange","label"])):o("",!0),!s.entityId&&a.requiredForPrivate?(l(),p(U,{key:2},[a.requiredForPrivate?(l(),r(c,{key:0,name:"attached_tickets",classname:"col-sm-6",multiple:!0,apiEndpoint:"api/dependency/tickets",label:e.trans("link_ticket"),value:e.attached_tickets,onChange:a.onChange,searchable:!0,required:!1},null,8,["label","value","onChange"])):o("",!0),a.requiredForPrivate?v((l(),r(c,{key:1,name:"attached_changes",classname:"col-sm-6",multiple:!0,apiEndpoint:"service-desk/api/dependency/changes",label:e.trans("link_change"),value:e.attached_changes,onChange:a.onChange,searchable:!0,required:!1},null,8,["label","value","onChange"])),[[O,s.showChangeSelectionInput]]):o("",!0)],64)):o("",!0),a.requiredForPrivate?(l(),r(c,{key:3,name:"watching_agents",value:e.watching_agents,multiple:!0,classname:"col-sm-6","api-endpoint":"api/dependency/agents","api-parameters":a.getApiParameters,onChange:a.onChange,strlength:"30",label:e.trans("task_crud_notify_agents"),hint:e.trans("task_crud_notify_agents_hint")},null,8,["value","api-parameters","onChange","label","hint"])):o("",!0),a.requiredForPrivate?(l(),r(c,{key:4,name:"watching_departments",classname:"col-sm-6",apiEndpoint:"api/dependency/departments?meta=true",multiple:!0,label:e.lang("task_crud_notify_departments"),hint:e.lang("task_crud_notify_departments_hint"),value:e.watching_departments,onChange:a.onChange,searchable:!0},null,8,["label","hint","value","onChange"])):o("",!0),a.requiredForPrivate?(l(),r(c,{key:5,name:"watching_teams",value:e.watching_teams,multiple:!0,classname:"col-sm-6","api-endpoint":a.getTeamsUrl,onChange:a.onChange,strlength:"30",label:e.trans("task_crud_notify_teams"),hint:e.trans("task_crud_notify_teams_hint")},null,8,["value","api-endpoint","onChange","label","hint"])):o("",!0),m(F,{name:"due_alert_text",classname:"col-sm-6",elements:e.elementNotifyBefore,multiple:!1,label:e.lang("task_notify_before"),clearble:!1,value:e.due_alert_text,onChange:a.onChange,placeHolder:e.lang("select"),searchable:!1,required:!1},null,8,["elements","label","value","onChange","placeHolder"]),m(y,{rows:"5",cols:"1",label:e.lang("task_description"),onChange:a.onChange,placehold:e.lang("enter_a_value"),value:e.task_description,type:"textarea",name:"task_description",classname:"col-sm-12 resizeTextArea",required:!1,id:"task_description"},null,8,["label","onChange","placehold","value"])])),[[B]]),i("div",se,[i("div",ne,[s.popup!==!0?(l(),p("button",{key:0,class:"btn btn-primary",onClick:t[2]||(t[2]=(...w)=>a.taskSubmit&&a.taskSubmit(...w))},[i("i",{class:E(a.buttonClass)},null,2),f(" "+u(e.lang(a.buttonText)),1)])):o("",!0)])])])}const le=C(G,[["render",ie]]),oe={name:"task-add-modal",description:"Task add Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function},entityId:{type:[String,Number],default:""},entityType:{type:String,default:"ticket"},reloadDetails:{type:Function},alertName:{type:String,default:"timeline"}},data(){return{isDisabled:!1,containerStyle:{width:"950px"},loading:!1}},methods:{onSubmit(){this.$refs.taskCreate.taskSubmit()},onCompleted(){this.onClose(),this.reloadDetails()}},components:{task:le}},re={class:"modal-title"},de={id:"task-modal-container"},me={key:0,class:"row"},ue=["disabled"],ce=i("i",{class:"fas fa-save"},null,-1);function he(e,t,s,b,n,a){const g=d("task"),h=d("loader"),y=d("modal");return s.showModal?(l(),r(y,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle,modalBodyClass:"task_fields"},{title:_(()=>[i("h4",re,u(e.lang("task_create")),1)]),fields:_(()=>[i("div",de,[m(g,{popup:!0,ref:"taskCreate","entity-id":s.entityId,onComplete:a.onCompleted,alertName:s.alertName,"entity-type":s.entityType},null,8,["entity-id","onComplete","alertName","entity-type"])]),n.loading?(l(),p("div",me,[m(h,{"animation-duration":4e3,size:60})])):o("",!0)]),controls:_(()=>[i("button",{type:"button",onClick:t[0]||(t[0]=(...k)=>a.onSubmit&&a.onSubmit(...k)),class:"btn btn-primary",disabled:n.isDisabled},[ce,f(" "+u(e.lang("save")),1)],8,ue)]),_:1},8,["showModal","onClose","containerStyle"])):o("",!0)}const pe=C(oe,[["render",he]]),_e={name:"TaskTemplateChooser",components:{"dynamic-select":N},props:{entityId:{type:[String,Number],default:""},entityType:{type:String,default:"ticket"},onComplete:{type:Function},alertComponentName:{type:String,default:"timeline"}},data(){return{template:null,loading:!1,category:""}},beforeMount(){this.category=this.$store.getters.getChangeAssociateCategory},methods:{onChange(e,t){this[t]=e},apply(){this.loading=!0,M.post("tasks/api/template/apply",{template:this.template?this.template.id:null,entity_type:this.entityType,entity_id:this.entityId}).then(e=>{q(e,this.alertComponentName),this.onComplete(),window.emitter.emit("refreshData"),window.emitter.emit("updateChangeAssociates"),this.category==="activity"?window.emitter.emit("updateChangeActivity"):this.category==="tasks"&&window.emitter.emit("changeTaskrefreshData")}).catch(e=>{S(e,this.alertComponentName),e.response.status!==412&&this.onComplete()}).finally(()=>{this.loading=!1})}}},ge={class:"container-fluid"},ye={class:"row"};function ke(e,t,s,b,n,a){const g=d("custom-loader"),h=d("dynamic-select");return l(),p("div",ge,[n.loading?(l(),r(g,{key:0,"animation-duration":"4000",color:"#1d78ff",size:"60"})):o("",!0),i("div",ye,[m(h,{name:"template",classname:"col-sm-12",apiEndpoint:"tasks/api/template/dropdown",multiple:!1,label:e.lang("task-plugin-task-template"),clearble:!0,value:n.template,onChange:a.onChange,searchable:!0,required:!0},null,8,["label","value","onChange"])])])}const fe=C(_e,[["render",ke]]),be={name:"TicketTaskTemplateModal",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function},entityId:{type:[String,Number],default:""},entityType:{type:String,default:"ticket"},reloadDetails:{type:Function},alertComponentName:{type:String,default:"timeline"}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1}},methods:{onSubmit(){this.$refs.taskTemplateChooser.apply()},onCompleted(){this.onClose(),this.reloadDetails(),window.emitter.emit("updateChangeAssociates"),this.category==="activity"?window.emitter.emit("updateChangeActivity"):this.category==="tasks"&&window.emitter.emit("changeTaskrefreshData")}},components:{"task-template-chooser":fe}},Ce={class:"modal-title"},we={id:"task-modal-container"},ve={key:0,class:"row"},Te=["disabled"],Me=i("i",{class:"fas fa-check"},null,-1);function Se(e,t,s,b,n,a){const g=d("task-template-chooser"),h=d("reuse-loader"),y=d("modal");return s.showModal?(l(),r(y,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{title:_(()=>[i("h4",Ce,u(e.lang("task-plugin-template-modal-title")),1)]),fields:_(()=>[i("div",we,[m(g,{ref:"taskTemplateChooser","entity-type":s.entityType,onComplete:a.onCompleted,"entity-id":s.entityId,"alert-component-name":s.alertComponentName},null,8,["entity-type","onComplete","entity-id","alert-component-name"])]),n.loading?(l(),p("div",ve,[m(h,{"animation-duration":4e3,size:60})])):o("",!0)]),controls:_(()=>[i("button",{type:"button",onClick:t[0]||(t[0]=(...k)=>a.onSubmit&&a.onSubmit(...k)),class:"btn btn-primary",disabled:n.isDisabled},[Me,f(" "+u(e.lang("task-plugin-template-selection-apply")),1)],8,Te)]),_:1},8,["showModal","onClose","containerStyle"])):o("",!0)}const De=C(be,[["render",Se]]),Ne={name:"ExistingTaskChooserModal",components:{DynamicSelect:N},props:{entityId:{type:[String,Number],default:""},entityType:{type:String,default:"ticket"},onComplete:{type:Function},alertComponentName:{type:String,default:"timeline"},showModal:{type:Boolean,default:!1},onClose:{type:Function},reloadDetails:{type:Function}},data(){return{task:null,loading:!1,project_id:null,task_category_id:null,randomKey:Math.floor(Math.random()*1e6),task_category_api:"",task_api:"",containerStyle:{width:"500px"},disableTaskDropdown:!1,disableTaskCategoryDropdown:!1,showBasicFilters:!1,category:""}},beforeMount(){this.category=this.$store.getters.getChangeAssociateCategory},computed:{isDisabled(){return!1},taskCategoryUrl(){const e=this.project_id;let t="tasks/api/category/view?";return e&&(t+=`project_ids[0]=${e.id}`),t},taskUrl(){const e=this.task_category_id,t=this.project_id;let s="tasks/api/list?";return t&&(s+=`projects[0]=${t.id}&`),e&&(s+=`task_categories[0]=${e.id}&`),s[s.length-1]==="&"&&(s=s.slice(0,-1)),`${s}&only_public=1`}},methods:{onChange(e,t){this[t]=e,t==="project_id"&&(e?(this.task_category_api=`tasks/api/category/view?project_ids[0]=${e.id}`,this.disableTaskCategoryDropdown=!1):(this.task_category_api="",this.task_category_id="",this.disableTaskCategoryDropdown=!0,this.randomKey++)),t==="task_category_id"&&e&&(this.task_api="tasks/api/list")},prepareForRequest(){let e="tasks/api/add-tasks-to-",t={};switch(this.entityType){case"ticket":e+="ticket",t.ticket_id=this.entityId;break;case"change":e+="change",t.change_id=this.entityId;break}return{url:e,params:t}},async apply(){this.loading=!0;let{url:e,params:t}=this.prepareForRequest();t.task_ids=this.task.map(s=>s.id);try{let s=await M.post(e,t);q(s,this.alertComponentName),window.emitter.emit("refreshData"),window.emitter.emit("updateChangeAssociates"),this.category==="activity"?window.emitter.emit("updateChangeActivity"):this.category==="tasks"&&window.emitter.emit("changeTaskrefreshData"),this.reloadDetails()}catch(s){S(s,this.alertComponentName)}finally{this.loading=!1,this.onClose()}}}},qe={class:"modal-title"},je={id:"task-modal-container"},Ae={class:"container-fluid"},Ie={key:1,class:"row"},Ee={class:"row"},Fe=["disabled"],Be=i("i",{class:"fas fa-check"},null,-1);function Pe(e,t,s,b,n,a){const g=d("custom-loader"),h=d("dynamic-select"),y=d("modal");return s.showModal?(l(),r(y,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{title:_(()=>[i("h4",qe,u(e.trans("task_attach_existing_task")),1)]),fields:_(()=>[i("div",je,[i("div",Ae,[n.loading?(l(),r(g,{key:0,"animation-duration":4e3,color:"#1d78ff",size:"60"})):(l(),p("div",Ie,[m(h,{name:"project_id",classname:"col-sm-6",apiEndpoint:"tasks/api/project/view",multiple:!1,label:e.trans("project"),value:n.project_id,onChange:a.onChange,searchable:!0},null,8,["label","value","onChange"]),(l(),r(h,{name:"task_category_id",classname:"col-sm-6",key:n.randomKey,apiEndpoint:a.taskCategoryUrl,multiple:!1,label:e.trans("task_list"),hint:e.trans("task-plugin-category-tooltip"),value:n.task_category_id,onChange:a.onChange,searchable:!0},null,8,["apiEndpoint","label","hint","value","onChange"]))])),i("div",Ee,[(l(),r(h,{name:"task",classname:"col-sm-12",key:n.randomKey,apiEndpoint:a.taskUrl,multiple:!0,label:e.trans("task"),hint:e.trans("task-plugin-attach-task-modal-tooltip"),value:n.task,onChange:a.onChange,searchable:!0},null,8,["apiEndpoint","label","hint","value","onChange"]))])])])]),controls:_(()=>[i("button",{type:"button",onClick:t[0]||(t[0]=(...k)=>a.apply&&a.apply(...k)),class:"btn btn-primary",disabled:a.isDisabled},[Be,f(" "+u(e.trans("task_attach_existing_task_btn")),1)],8,Fe)]),_:1},8,["showModal","onClose","containerStyle"])):o("",!0)}const Ue=C(Ne,[["render",Pe]]);const Oe={name:"TaskActions",description:"Task actions dropdown button",components:{TaskModal:pe,TicketTaskTemplateModal:De,ExistingTaskChooserModal:Ue},props:{data:{type:[String,Object],required:!0},showButtonBorder:{type:Number,default:1},requiresJsonParse:{type:Number,default:1},showViewButton:{type:[Number,Boolean],default:1},showAttachExistingTaskButton:{type:Number,default:1},viewButtonAction:{type:Function,required:!0}},data(){return{showModal:!1,showTemplateChooserModal:!1,showAttachExistingTaskChooserModal:!1,renderData:""}},beforeMount(){this.renderData=this.requiresJsonParse?JSON.parse(this.data):this.data},computed:{entityId(){return this.renderData.entity_id},entityType(){return this.renderData.entity_type},taskCount(){return this.renderData.task_count},showTaskCount(){return this.renderData.showTaskCount},alertName(){return this.renderData.alertName}},methods:{onModalClose(){this.showModal=!1,this.showTemplateChooserModal=!1,this.showAttachExistingTaskChooserModal=!1,this.$store.dispatch("unsetValidationError")},reloadData(){window.emitter.emit("actionDone","external"),window.emitter.emit("updateTimelineActivity")},updateTaskUi(){window.emitter.emit("showHidedData"),window.emitter.emit("showCalendarData")}}},T=e=>(V("data-v-3e2f8468"),e=e(),Y(),e),Ve={class:"btn-group"},Ye=T(()=>i("i",{class:"far fa-calendar-plus"},null,-1)),Ke={key:0,class:"badge badge-danger"},Re={class:"dropdown-menu"},ze=T(()=>i("i",{class:"glyphicon glyphicon-plus"},null,-1)),He=T(()=>i("i",{class:"fas fa-tasks"},null,-1)),Je=T(()=>i("i",{class:"fa fa-bars"},null,-1)),Le=T(()=>i("i",{class:"fas fa-eye"},null,-1));function We(e,t,s,b,n,a){const g=d("TaskModal"),h=d("TicketTaskTemplateModal"),y=d("ExistingTaskChooserModal"),k=I("scroll-to");return l(),p("div",Ve,[i("button",{type:"button",class:E(["btn btn-xs btn-default dropdown-toggle",{button_no_border:!s.showButtonBorder}]),"data-toggle":"dropdown",id:"task-action"},[Ye,f(" "+u(e.trans("task"))+" ",1),a.showTaskCount?(l(),p("span",Ke,u(a.taskCount),1)):o("",!0)],2),i("div",Re,[i("a",{class:"dropdown-item",href:"javascript:;",onClick:t[0]||(t[0]=c=>n.showModal=!0)},[ze,f("  "+u(e.trans("create_task")),1)]),s.showAttachExistingTaskButton?(l(),p("a",{key:0,class:"dropdown-item",href:"javascript:;",onClick:t[1]||(t[1]=c=>n.showAttachExistingTaskChooserModal=!0)},[He,f("  "+u(e.trans("task_attach_existing_task")),1)])):o("",!0),i("a",{class:"dropdown-item",href:"javascript:;",onClick:t[2]||(t[2]=c=>n.showTemplateChooserModal=!0)},[Je,f("  "+u(e.trans("task-plugin-template-ticket-action-button")),1)]),s.showViewButton?v((l(),p("a",{key:1,class:"dropdown-item",href:"javascript:;",onClick:t[3]||(t[3]=(...c)=>s.viewButtonAction&&s.viewButtonAction(...c))},[Le,f("  "+u(e.trans("view")),1)])),[[k,"#timeline-display-box-tasks"]]):o("",!0)]),m(D,{name:"modal"},{default:_(()=>[n.showModal?(l(),r(g,{key:0,onClose:a.onModalClose,showModal:n.showModal,"entity-id":a.entityId,"alert-name":a.alertName,"entity-type":a.entityType,reloadDetails:a.reloadData},null,8,["onClose","showModal","entity-id","alert-name","entity-type","reloadDetails"])):o("",!0)]),_:1}),m(D,{name:"modal"},{default:_(()=>[n.showTemplateChooserModal?(l(),r(h,{key:0,onClose:a.onModalClose,showModal:n.showTemplateChooserModal,"entity-id":a.entityId,"entity-type":a.entityType,"alert-component-name":a.alertName,reloadDetails:a.reloadData},null,8,["onClose","showModal","entity-id","entity-type","alert-component-name","reloadDetails"])):o("",!0)]),_:1}),m(D,{name:"modal"},{default:_(()=>[n.showAttachExistingTaskChooserModal?(l(),r(y,{key:0,"on-close":a.onModalClose,"show-modal":n.showAttachExistingTaskChooserModal,"entity-id":a.entityId,"entity-type":a.entityType,"alert-component-name":a.alertName,reloadDetails:a.reloadData},null,8,["on-close","show-modal","entity-id","entity-type","alert-component-name","reloadDetails"])):o("",!0)]),_:1})])}const Xe=C(Oe,[["render",We],["__scopeId","data-v-3e2f8468"]]);export{Xe as T,pe as a,De as b,le as c};
