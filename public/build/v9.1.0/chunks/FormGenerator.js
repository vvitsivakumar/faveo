import{_ as S,p as G,e as P,f as M,s as N,T as fe,M as ve,r as le,F as ke,l as K,V as ee,c as te,i as ce,j as X,D as q,N as Fe,q as _e,g as ue,z as we,k as ne,R as ge,X as Ce,x as Se,S as De,v as Ae,a9 as he,H as Te,a as Ve,A as Oe,C as Ie,w as Pe,b as Me}from"./bootstrap.js";import{r as p,o as n,c as r,f as l,F as w,h as I,g as b,t as c,e as m,d as u,u as Q,m as H,a as O,q as j,G as W,n as D,i as C,w as v,b as k,p as E,j as B,$ as je,v as ae,A as Re,y as re,ay as Le,Y as pe,X as Ee,a4 as Be,V as A,s as se,aE as Ue,x as me,z as qe,ax as Ne,W as ie}from"./vendor.js";import{a as Ye,A as xe}from"./AdminNavigationBar.js";import{C as He,d as ze,a as Ke}from"./DataTableActions.js";const We={name:"language-dropdown",description:"Language  dropdown component",props:{language:{type:String,default:"en"}},data(){return{loading:!1,languages:""}},watch:{},computed:{langSorted(){return _.orderBy(this.languages,"name","asc")}},beforeMount(){this.getLanguages()},methods:{getLanguages(){this.loading=!0,axios.get("api/dependency/languages?meta=true").then(e=>{this.loading=!1,this.languages=e.data.data.languages,this.$store.dispatch("setAllLangs",this.languages)}).catch(e=>{this.loading=!1})},changeLang(e){axios.post("api/user-language?locale="+e).then(a=>{window.location.reload()})}}},Ge={class:"nav-item dropdown"},Xe={class:"nav-link","data-toggle":"dropdown",href:"javascript:;"},Qe=["src"],Je={class:"dropdown-menu dropdown-menu-sm dropdown-menu-right p-0",id:"lang_div"},Ze=["onClick"],$e=["src"],et={key:0,class:"row",id:"load"};function tt(e,a,t,o,s,i){const f=p("reuse-loader");return n(),r("li",Ge,[l("a",Xe,[l("img",{src:e.basePathVersion()+"/themes/default/common/images/flags/"+t.language+".png"},null,8,Qe)]),l("div",Je,[(n(!0),r(w,null,I(i.langSorted,h=>(n(),r("a",{href:"javascript:;",class:"dropdown-item",onClick:y=>i.changeLang(h.locale)},[l("img",{src:e.basePathVersion()+"/themes/default/common/images/flags/"+h.locale+".png",class:"mr-2"},null,8,$e),b("   "+c(h.name)+"  ‏("+c(h.translation)+")‏ ",1)],8,Ze))),256)),s.loading?(n(),r("div",et,[m(f,{"animation-duration":4e3,size:30})])):u("",!0)])])}const at=S(We,[["render",tt],["__scopeId","data-v-9d3ffd8e"]]);const st={setup(){const e=Q();return{formattedTime:H(()=>e.getters.formattedTime),formattedDate:H(()=>e.getters.formattedDate)}},props:{userId:{type:[String,Number],default:""},callingFrom:{type:String,default:""},headerBackground:{type:String,default:""}},data(){return{loading:!1,notifications:[],count:0,notification_count:0,handledData:[],page:1,showLoader:!1,initialLoading:!0,backgroundColors:{"navbar-light":"#f8f9fa","navbar-dark navbar-blue":"#3c8dbc","navbar-dark navbar-black":"#343a40","navbar-dark navbar-green":"#28a745","navbar-dark navbar-purple":"#6f42c1","navbar-dark navbar-red":"#dc3545","navbar-light navbar-yellow":"#ffc107","navbar-light navbar-orange":"#fd7e14"},indicatorBackground:"#FFF"}},beforeMount(){this.indicatorBackground=this.backgroundColors[this.headerBackground],this.getInitialLogs()},created(){window.emitter.on("update-sidebar",this.getCount)},methods:{subString(e,a=30){return G(e,a)},reloadNotifications(){if(this.initialLoading)return this.initialLoading=!1,!1;this.getInitialLogs()},getInitialLogs(){this.handledData=[],this.notifications=[],this.page=1,this.getLogs()},getLogs(e,a=!1){this.showLoader=!0,O.get("/api/in-app/auth/notifications",{params:{page:this.page}}).then(t=>{a?this.notifications=t.data.data:this.notifications.push(...t.data.data),e&&e.loaded(),t.data.data.length<10&&e&&e.complete(),this.page++,this.notification_count=t.data.unread_count,this.handleData(this.notifications),this.showLoader=!1}).catch(t=>{this.showLoader=!1,this.notifications=[]})},handleData(e){for(var a in e)if(e[a].notified_by==null||typeof e[a].notified_by.full_name>"u"){e[a].user="Elea";var t=this.basePathVersion()+"/themes/default/common/images/system.png";e[a].notified_by={profile_pic:t}}else e[a].user=e[a].notified_by.full_name;this.handledData=e},makeSeen(e){let a=e.action_link.includes("panel")?e.action_link.replace(this.basePath()+"/panel",""):e.action_link.replace(this.basePath(),"");e.seen?this.redirectTo(a):(this.loading=!0,O.patch("/api/in-app/auth/mark-read/"+e.id).then(t=>{this.loading=!1,this.notification_count=this.notification_count-1,this.redirectTo(a)}).catch(t=>{this.loading=!1}))},markALLSeen(){this.loading=!0,O.patch("/api/in-app/auth/mark-read/").then(e=>{this.loading=!1,this.getInitialLogs()}).catch(e=>{this.loading=!1})},deleteAll(){this.loading=!0,O.delete("/api/in-app/auth/delete").then(e=>{this.loading=!1,this.getInitialLogs()}).catch(e=>{this.loading=!1})},redirectTo(e){e.includes("/agent/export/download/")||e.includes("/admin/view/import-tracking-details")||e.includes("ticket-print")||e.includes("service-desk/change-print")||e.includes("user/list/download/")||e.includes("/billing-user-packages")?O.get(e).then(a=>{window.open(this.basePath()+e)}).catch(a=>{P(a,"layout")}):e.includes("/service-desk/import-tracking/")?window.open(e.replace(this.basePath(),this.basePath()+"/admin")):this.callingFrom=="admin"&&!e.includes("system-backup")?this.redirect("/panel"+e):e.includes("user/list")?this.redirect("/panel"+e):e.includes("/admin/system-backup")?this.redirect(e):this.$router.push({path:e})}}},Y=e=>(E("data-v-9cf2d9da"),e=e(),B(),e),it={class:"nav-item dropdown"},lt=Y(()=>l("i",{class:"far fa-bell"},null,-1)),nt={class:"dropdown-menu dropdown-menu-xl dropdown-menu-right inapp-notify-drop"},rt={class:"dropdown-header"},ot={key:0,class:"dropdown-header notify-actions row"},dt={class:"row"},ct={class:"col-sm-6 read"},ut=Y(()=>l("span",null,[l("i",{class:"fas fa-circle"})],-1)),ht={class:"col-sm-6 delete"},mt=Y(()=>l("span",null,[l("i",{class:"fas fa-trash-alt"})],-1)),ft={class:"scrollable-ul",id:"activity_scroll"},_t={key:0},gt=Y(()=>l("div",{class:"dropdown-divider"},null,-1)),pt=["onClick"],bt={class:"media"},yt={class:"media-body"},vt={class:"dropdown-item-title text-primary"},kt=["innerHTML"],Ft={class:"text-xs text-muted"},wt=Y(()=>l("i",{class:"far fa-clock mr-1"},null,-1)),Ct=Y(()=>l("span",null,null,-1)),St=Y(()=>l("span",null,null,-1)),Dt={key:1,class:"mb-3"};function At(e,a,t,o,s,i){const f=p("faveo-image-element"),h=p("infinite-loading"),y=p("reuse-loader"),g=p("custom-loader"),d=j("tooltip");return n(),r("li",it,[l("a",{class:"nav-link font-1","data-toggle":"dropdown",href:"javascript:;",onClick:a[0]||(a[0]=(...F)=>i.reloadNotifications&&i.reloadNotifications(...F))},[l("div",null,[lt,s.notification_count>0?(n(),r("div",{key:0,class:"indicator",style:W({"border-color":s.indicatorBackground})},null,4)):u("",!0)])]),l("div",nt,[l("span",rt,c(e.trans("you_have"))+" "+c(s.notification_count)+" "+c(e.trans("unread_notification")),1),s.handledData.length>0?(n(),r("div",ot,[l("div",dt,[l("div",ct,[s.notification_count>0?(n(),r("a",{key:0,href:"javascript:;",onClick:a[1]||(a[1]=(...F)=>i.markALLSeen&&i.markALLSeen(...F))},[ut,b(" "+c(e.trans("mark_all_as_read")),1)])):u("",!0)]),l("div",ht,[l("a",{href:"javascript:;",onClick:a[2]||(a[2]=(...F)=>i.deleteAll&&i.deleteAll(...F)),class:"right"},[mt,b(" "+c(e.trans("delete_all")),1)])])])])):u("",!0),l("div",ft,[s.handledData.length>0?(n(),r("div",_t,[(n(!0),r(w,null,I(s.handledData,(F,T)=>(n(),r(w,null,[gt,l("a",{href:"javascript:;",onClick:V=>i.makeSeen(F),class:D(["dropdown-item",{"bg-light":!F.is_read,"bg-whitte":F.seen,"pointer-normal":F.action_link===""}])},[l("div",bt,[m(f,{id:"size-30","source-url":F.notified_by.profile_pic,classes:["img-size-50 mr-3 img-circle elevation-2"],"alternative-text":"User Image"},null,8,["source-url"]),l("div",yt,[C((n(),r("h3",vt,[b(c(i.subString(F.user)),1)])),[[d,F.user]]),C(l("p",{class:"text-gray break-word",innerHTML:F.notify_message},null,8,kt),[[d,{content:F.notify_message,html:!0}]]),l("p",Ft,[wt,b(),l("i",null,c(o.formattedTime(F.created_at)),1)])])])],10,pt)],64))),256)),m(h,{onInfinite:i.getLogs},{spinner:v(()=>[Ct]),complete:v(()=>[St]),_:1},8,["onInfinite"])])):u("",!0)]),s.showLoader?(n(),r("div",Dt,[m(y,{"animation-duration":4e3,size:30})])):u("",!0)]),s.loading?(n(),k(g,{key:0,"animation-duration":4e3})):u("",!0)])}const Tt=S(st,[["render",At],["__scopeId","data-v-9cf2d9da"]]);const Vt={name:"system-updates",props:{callingFrom:{type:String,default:""},headerBackground:{type:String,default:""}},data(){return{updatesCount:"",backgroundColors:{"navbar-light":"#f8f9fa","navbar-dark navbar-blue":"#3c8dbc","navbar-dark navbar-black":"#343a40","navbar-dark navbar-green":"#28a745","navbar-dark navbar-purple":"#6f42c1","navbar-dark navbar-red":"#dc3545","navbar-light navbar-yellow":"#ffc107","navbar-light navbar-orange":"#fd7e14"},indicatorBackground:"#FFF"}},beforeMount(){this.indicatorBackground=this.backgroundColors[this.headerBackground],this.getUpdate()},methods:{getUpdate(){this.loading=!0,axios.get("/auto-update/notification").then(e=>{this.loading=!1,this.updatesCount=e.data.data.count}).catch(e=>{this.loading=!1,this.updatesCount=0})}}},oe=e=>(E("data-v-e42eeb71"),e=e(),B(),e),Ot={key:0,class:"nav-item dropdown"},It={class:"nav-link font-1","data-toggle":"dropdown",href:"javascript:;"},Pt=oe(()=>l("i",{class:"fas fa-sync-alt"},null,-1)),Mt={class:"dropdown-menu dropdown-menu-lg dropdown-menu-right"},jt={key:0,class:"dropdown-header"},Rt=oe(()=>l("span",{class:"dropdown-header"},"New version(s) available.",-1)),Lt=oe(()=>l("div",{class:"dropdown-divider"},null,-1)),Et={href:"javascript:;",class:"dropdown-item"},Bt=["href"];function Ut(e,a,t,o,s,i){const f=p("router-link"),h=j("tooltip");return s.updatesCount>0?(n(),r("li",Ot,[C((n(),r("a",It,[l("div",null,[Pt,s.updatesCount>0?(n(),r("div",{key:0,class:"indicator",style:W({"border-color":s.indicatorBackground})},null,4)):u("",!0)])])),[[h,e.trans("application_updates")]]),l("div",Mt,[s.updatesCount?u("",!0):(n(),r("span",jt,"You have "+c(s.updatesCount)+" update(s)",1)),s.updatesCount?(n(),r(w,{key:1},[Rt,Lt,l("a",Et,[t.callingFrom=="admin"?(n(),r(w,{key:0},[b(" Please "),m(f,{to:"/check-updates"},{default:v(()=>[b(" click here ")]),_:1}),b(" to update your system. ")],64)):(n(),r(w,{key:1},[b(" Please "),l("a",{href:e.basePath()+"/admin/check-updates"}," click here ",8,Bt),b(" to update your system. ")],64))])],64)):u("",!0)])])):u("",!0)}const qt=S(Vt,[["render",Ut],["__scopeId","data-v-e42eeb71"]]);const Nt={name:"status-switch",description:"Switch for turning ON/OFF status of a feature in a fancy way",props:{name:{type:[String,Number],required:!0},value:{type:[Boolean,Number],default:!1},classname:{type:String,default:""},onChange:{type:Function,Required:!0},bold:{type:[Boolean,Number],default:!1}},data(){return{enabled:M(this.value)}},watch:{enabled(e){this.onChange(e,this.name)},value(e){this.enabled=M(this.value)}}};function Yt(e,a,t,o,s,i){const f=p("toggle");return n(),r("div",{class:D(t.classname)},[m(f,{modelValue:s.enabled,"onUpdate:modelValue":a[0]||(a[0]=h=>s.enabled=h),class:"toggle-switch"},null,8,["modelValue"])],2)}const xt=S(Nt,[["render",Yt]]);const Ht={name:"GlobalSearch",components:{"status-switch":xt},props:{userId:{type:[String,Number],default:""},callingFrom:{type:String,default:""},headerBackground:{type:String,default:""}},data(){return{backgroundColors:{"navbar-light":"#f8f9fa","navbar-dark navbar-blue":"#3c8dbc","navbar-dark navbar-black":"#343a40","navbar-dark navbar-green":"#28a745","navbar-dark navbar-purple":"#6f42c1","navbar-dark navbar-red":"#dc3545","navbar-light navbar-yellow":"#ffc107","navbar-light navbar-orange":"#fd7e14"},indicatorBackground:"#FFF",mainFilter:[{id:"all",title:"all"},{id:"tickets",title:"tickets"},{id:"contacts",title:"contacts"},{id:"articles",title:"articles"}],searchBy:[],isDropdownOpen:!0,showSearchby:!1,searchedText:"",recentSearches:[],timeoutId:null,searchResult:"",showLoader:!1,apiUrl:"",search:"",selected:"all",category:"all",showRecentSearch:!0,showData:!1,noData:"all",filterParams:[],recentlyViewed:[],selectAllText:"",page:1,ticketNextPageUrl:"",loadUrl:"",nextPage:"",loadData:!1,next_pageUrl:"",reloadData:""}},beforeMount(){this.indicatorBackground=this.backgroundColors[this.headerBackground],this.getSearchedText(),setTimeout(()=>{this.$refs.searchInput.focus()},1)},watch:{searchedText(e){e.length===0&&(this.showRecentSearch=!0,this.showData=!1)}},computed:{...je(["formattedDate"]),noDataMessage(){if(this.noData==="all"&&(!this.searchResult||this.searchResult.tickets&&this.searchResult.tickets.count<=0&&this.searchResult.contacts&&this.searchResult.contacts.count<=0&&this.searchResult.articles&&this.searchResult.articles.count<=0))return this.lang("no_data_found");if(this.searchResult&&this.noData!=="all"){if(this.searchResult.tickets&&this.searchResult.tickets.count<=0&&this.noData==="tickets")return this.lang("no_tickets_found");if(this.searchResult.contacts&&this.searchResult.contacts.count<=0&&this.noData==="contacts")return this.lang("no_contacts_found");if(this.searchResult.articles&&this.searchResult.articles.count<=0&&this.noData==="articles")return this.lang("no_articles_found")}return null}},methods:{outsideClick(e){const a=this.$el,{clientX:t,clientY:o}=e,s=a.getBoundingClientRect(),i=s.left+window.pageXOffset,f=s.right+window.pageXOffset,h=s.top-window.pageYOffset,y=s.bottom+window.pageYOffset,d=t<i-400||t>f||o<h||o>y,F=!a.contains(e.target);d&&F&&this.isDropdownOpen&&this.closeSearchBar()},gotoViewAll(e){this.closeSearchBar();const a=Date.now().toString();this.$router.push({path:"/search-results",query:{type:e,endpoint:this.apiUrl,key:a}})},closeSearchBar(){this.$emit("close-search-bar",!1)},subString(e,a=30){return G(e,a)},searchText(e){this.searchedText=e,this.$refs.searchInput.focus()},getSearchedText(){return O.get("/agent/recent-searches/get").then(e=>{var a,t;this.recentSearches=((t=(a=e.data)==null?void 0:a.data)==null?void 0:t.recentSearches)||[]}).catch(e=>{})},callFilterData(){event.stopPropagation(),this.getFilterParams(),this.updateSelectAllText(),this.showSearchby=!0},onChange(e,a){this[a]=e;const t=this.searchBy.find(o=>o.id===a);if(t)if(e)this.filterParams.includes(t.id)||this.filterParams.push(t.id);else{const o=this.filterParams.indexOf(t.id);o>-1&&this.filterParams.splice(o,1)}this.updateSelectAllText()},toggleSelectAll(){this.selectAllText==="select_all"?(this.selectAllText="deselect_all",this.searchBy.forEach(e=>{e.is_selected=!0,this.filterParams.includes(e.id)||this.filterParams.push(e.id)})):(this.selectAllText="select_all",this.searchBy.forEach(e=>{e.is_selected=!1;const a=this.filterParams.indexOf(e.id);a>-1&&this.filterParams.splice(a,1)}))},updateSelectAllText(){this.filterParams.length===0?this.selectAllText="select_all":this.filterParams.length===this.searchBy.length?this.selectAllText="deselect_all":this.selectAllText="deselect_all"},selectedFilter(e){this.selected!==e&&(this.selected=e,this.category=e,this.searchedText.length>0&&this.category&&this.searchContent(),this.noData=e)},isSelected(e){return this.selected===e},clearSearchHistory(){O.get("/agent/recent-searches/clear").then(e=>{this.recentSearches=[]}).catch(e=>{})},getFilterParams(){this.showLoader=!0,O.get("/agent/search-preferences").then(e=>{this.searchBy=e.data.data,this.showLoader=!1,this.filterParams=[];for(const a of this.searchBy)a.is_selected&&this.filterParams.push(a.id);this.updateSelectAllText()}).catch(e=>{this.showLoader=!1,P(e)})},searchContent(){if(!(!this.searchedText||this.searchedText.trim()==="")){if(this.showSearchby&&(this.showSearchby=!1),this.category&&this.category!=="all"&&this.searchedText&&this.searchedText.length>0){let e=encodeURIComponent(this.searchedText);this.apiUrl="/search-all?search-query="+e+"&category[]="+this.category}else if(this.searchedText&&this.searchedText.length>0){let e=encodeURIComponent(this.searchedText);this.apiUrl="/search-all?search-query="+e}this.searchedText&&this.searchedText.length>0&&(this.showRecentSearch=!1,this.showData=!0,this.showLoader=!0,O.get(this.apiUrl).then(e=>{this.getSearchedText(),this.showLoader=!1,this.searchResult=e.data.data,this.nextPage=this.category,e.data.data[this.nextPage].data.next_page_url&&this.category!=="all"&&(this.loadUrl=e.data.data[this.nextPage].data.next_page_url)}).catch(e=>{this.showLoader=!1}))}},saveFilters(){event.stopPropagation();const e={"filter-ids":[...this.filterParams]};O.post("/agent/search-preferences",e).then(a=>{this.searchContent(),N(a)}).catch(a=>{P(a)}),this.showSearchby=!1},cancelFilters(){event.stopPropagation(),this.showSearchby=!1}},beforeDestroy(){document.removeEventListener("click",this.outsideClick)},mounted(){document.addEventListener("click",this.outsideClick),this.updateSelectAllText()}},zt={class:"nav-item dropdown"},Kt={class:"nav-link font-1"},Wt={class:"navbar-search-block navbar-search-open global-search-box"},Gt={class:"form-inline"},Xt={class:"input-group input-group-sm global-search-input-group position-relative"},Qt=["placeholder"],Jt={class:"input-group-append"},Zt=l("i",{class:"fas fa-search"},null,-1),$t=[Zt],ea=l("i",{class:"fas fa-times"},null,-1),ta=[ea],aa={key:0,class:"loader-overlay"},sa={class:"loader-content"},ia={key:0,class:"filter_by"},la={class:"card-header"},na={class:"row"},ra=["onClick"],oa={class:"ml-auto"},da={class:"scrollable-ul",id:"activity_scroll"},ca={class:"dropdown-item dropdown-header text-left bg-light"},ua=l("div",{class:"dropdown-divider"},null,-1),ha=["onClick"],ma=l("i",{class:"fas fa-search mr-2"},null,-1),fa=l("div",{class:"dropdown-divider"},null,-1),_a={key:0,class:"pt-3 pb-2 text-center"},ga={class:"dropdown-item dropdown-header text-left bg-light"},pa=l("div",{class:"dropdown-divider"},null,-1),ba=l("i",{class:"fas fa-ticket mr-2"},null,-1),ya={class:"text-gray"},va={class:"text-primary"},ka={class:"text-primary"},Fa={class:"float-right text-muted text-xs"},wa=l("i",{class:"far fa-clock mr-1"},null,-1),Ca=l("div",{class:"dropdown-divider"},null,-1),Sa={class:"dropdown-item dropdown-header text-left bg-light"},Da=l("div",{class:"dropdown-divider"},null,-1),Aa={href:"javascript:;",class:"dropdown-item bg-light"},Ta=l("i",{class:"fas fa-user-alt mr-2"},null,-1),Va={class:"text-gray"},Oa={class:"text-primary"},Ia={class:"float-right text-muted text-xs"},Pa=l("i",{class:"far fa-clock mr-1"},null,-1),Ma=l("div",{class:"dropdown-divider"},null,-1),ja={class:"dropdown-item dropdown-header text-left"},Ra=l("div",{class:"dropdown-divider"},null,-1),La=l("i",{class:"fas fa-newspaper mr-2"},null,-1),Ea=["href"],Ba={class:"text-primary"},Ua={class:"float-right text-muted text-xs"},qa=l("i",{class:"far fa-clock mr-1"},null,-1),Na=l("div",{class:"dropdown-divider"},null,-1),Ya={key:1,class:"search_by"},xa={key:0,class:"card heading-card"},Ha={class:"card-header"},za={class:"card-body filter-data"},Ka={class:"scrollable-ul",id:"activity_scroll"},Wa=l("hr",null,null,-1),Ga={class:"card-footer"},Xa=l("i",{class:"fas fa-save"},null,-1),Qa=l("i",{class:"fas fa-times"},null,-1);function Ja(e,a,t,o,s,i){const f=p("reuse-loader"),h=p("router-link"),y=p("status-switch"),g=j("tooltip");return n(),r("li",zt,[l("a",Kt,[l("div",Wt,[l("div",Gt,[l("div",Xt,[C(l("input",{"onUpdate:modelValue":a[0]||(a[0]=d=>s.searchedText=d),ref:"searchInput",class:"form-control",type:"search",autofocus:"",placeholder:e.trans("search"),onKeyup:a[1]||(a[1]=Re(d=>i.searchContent(),["enter"]))},null,40,Qt),[[ae,s.searchedText,void 0,{trim:!0}]]),l("div",Jt,[l("a",{class:"btn btn-default search_button",type:"button",onClick:a[2]||(a[2]=d=>i.searchContent())},$t),l("a",{class:"btn btn-default search_button",type:"button",onClick:a[3]||(a[3]=(...d)=>i.closeSearchBar&&i.closeSearchBar(...d))},ta)]),s.showLoader?(n(),r("div",aa,[l("div",sa,[m(f,{"animation-duration":6e3,size:20})])])):u("",!0)])])])]),l("div",{class:D(["dropdown-menu dropdown-menu-xl dropdown-menu-right search-data",{show:s.isDropdownOpen}])},[s.showSearchby?u("",!0):(n(),r("div",ia,[l("div",la,[l("div",na,[(n(!0),r(w,null,I(s.mainFilter,d=>(n(),r("div",{key:d,class:"space_button"},[l("div",{class:D([i.isSelected(d.id)?"btn btn-block btn-primary select-filter":"btn btn-block btn-outline-primary select-filter"]),onClick:F=>i.selectedFilter(d.id)},c(e.lang(d.title)),11,ra)]))),128)),l("div",oa,[C(l("i",{class:"fas fa-cog search_icon",onClick:a[4]||(a[4]=d=>i.callFilterData())},null,512),[[g,e.trans("search_filter")]])])])]),l("div",da,[s.showRecentSearch?(n(),r(w,{key:0},[s.recentSearches.length>0?(n(),r(w,{key:0},[l("span",ca,[l("span",null,c(e.trans("recently_searched")),1),l("a",{href:"javascript:;",class:"text-primary float-right bg-light",onClick:a[5]||(a[5]=d=>i.clearSearchHistory())},c(e.trans("clear_all")),1)]),ua,(n(!0),r(w,null,I(s.recentSearches.slice(-5).reverse(),d=>(n(),r("a",{href:"javascript:;",class:"dropdown-item",onClick:F=>i.searchText(d)},[ma,b(" "+c(d),1)],8,ha))),256)),fa],64)):u("",!0)],64)):u("",!0),s.searchedText&&s.showData&&!s.showLoader?(n(),r(w,{key:1},[i.noDataMessage?(n(),r("div",_a,c(i.noDataMessage),1)):u("",!0),(s.category,n(),r(w,{key:1},[s.searchResult&&s.searchResult.tickets&&s.searchResult.tickets.count>0?(n(),r(w,{key:0},[l("span",ga,[l("span",null,c(e.lang("tickets")),1),l("a",{href:"javascript:;",class:"float-right text-primary",onClick:a[6]||(a[6]=d=>i.gotoViewAll("tickets"))},c(e.trans("view_all"))+" ("+c(s.searchResult.tickets.total)+") ",1)]),pa,(n(!0),r(w,null,I(s.searchResult.tickets.data.data.slice(0,s.category==="all"?3:10),d=>(n(),r("div",{key:d,href:"javascript:;",class:"dropdown-item bg-light"},[ba,C((n(),k(h,{to:d.view_url,id:"first_thread_title",onClick:a[7]||(a[7]=F=>i.closeSearchBar())},{default:v(()=>[l("span",ya,"[#"+c(d.ticket_number)+"]",1),b("  "),l("span",va,c(d.first_thread.title.length>10?d.first_thread.title.substring(0,10)+"...":d.first_thread.title),1),l("span",ka," ("+c(d.thread_count)+") ",1)]),_:2},1032,["to"])),[[g,d.first_thread.title]]),l("span",Fa,[wa,b(c(e.formattedDate(d.created_at)),1)])]))),128)),Ca],64)):u("",!0)],64)),(s.category,n(),r(w,{key:2},[s.searchResult&&s.searchResult.contacts&&s.searchResult.contacts.count>0?(n(),r(w,{key:0},[l("span",Sa,[l("span",null,c(e.lang("contacts")),1),l("a",{href:"javascript:;",class:"float-right text-primary",onClick:a[8]||(a[8]=d=>i.gotoViewAll("contacts"))},c(e.trans("view_all"))+" ("+c(s.searchResult.contacts.total)+") ",1)]),Da,(n(!0),r(w,null,I(s.searchResult.contacts.data.data.slice(0,s.category==="all"?3:10),d=>(n(),r("div",Aa,[Ta,m(h,{to:d.view_url,id:"first_thread_title",onClick:a[9]||(a[9]=F=>i.closeSearchBar())},{default:v(()=>[C((n(),r("span",Va,[b("["+c(d.email?d.email.length>15?d.email.slice(0,12)+"...":d.email:d.user_name?d.user_name.slice(0,12)+"...":d.user_name)+"]",1)])),[[g,d.email?d.email:d.user_name]]),b("   "),C((n(),r("span",Oa,[b(c(d.full_name.length>10?d.full_name.substring(0,10)+"...":d.full_name),1)])),[[g,d.full_name]])]),_:2},1032,["to"]),l("span",Ia,[Pa,b(c(e.formattedDate(d.created_at)),1)])]))),256)),Ma],64)):u("",!0)],64)),(s.category,n(),r(w,{key:3},[s.searchResult&&s.searchResult.articles&&s.searchResult.articles.count>0?(n(),r(w,{key:0},[l("span",ja,[l("span",null,c(e.lang("articles")),1),l("a",{href:"javascript:;",class:"float-right text-primary bg-light",onClick:a[10]||(a[10]=d=>i.gotoViewAll("articles"))},c(e.trans("view_all"))+" ("+c(s.searchResult.articles.total)+") ",1)]),Ra,(n(!0),r(w,null,I(s.searchResult.articles.data.data.slice(0,s.category==="all"?3:10),d=>(n(),r("div",{key:d,href:"javascript:;",class:"dropdown-item bg-light"},[La,l("a",{href:e.basePath()+d.view_url,target:"_blank",onClick:a[11]||(a[11]=F=>i.closeSearchBar())},[C((n(),r("span",Ba,[b(c(d.name.length>30?d.name.substring(0,30)+"...":d.name),1)])),[[g,d.name]])],8,Ea),l("span",Ua,[qa,b(c(e.formattedDate(d.publish_time)),1)])]))),128)),Na],64)):u("",!0)],64))],64)):u("",!0)])])),s.showSearchby?(n(),r("div",Ya,[s.showLoader?u("",!0):(n(),r("div",xa,[l("div",Ha,[l("h6",null,[l("b",null,c(e.trans("search_by")),1),b(),l("a",{class:"select-btn float-right",onClick:a[12]||(a[12]=(...d)=>i.toggleSelectAll&&i.toggleSelectAll(...d))},c(e.lang(s.selectAllText)),1)])]),l("div",za,[l("div",Ka,[(n(!0),r(w,null,I(s.searchBy,d=>(n(),r("div",{key:d},[b(c(e.lang(d.key))+" ",1),m(y,{name:d.id,onChange:i.onChange,classname:"toggle_button float-right",value:d.is_selected},null,8,["name","onChange","value"]),Wa]))),128))])]),l("div",Ga,[l("div",{class:"btn btn-primary float-right",onClick:a[13]||(a[13]=d=>i.saveFilters())},[Xa,b(" "+c(e.trans("save")),1)]),l("div",{class:"btn btn-default float-left",onClick:a[14]||(a[14]=d=>i.cancelFilters())},[Qa,b(" "+c(e.trans("cancel")),1)])])]))])):u("",!0)],2)])}const Za=S(Ht,[["render",Ja]]);const $a={name:"admin-agent-top-navbar",setup(){const e=Q();return{getPushMenu:H(()=>e.getters.getPushMenu)}},props:{auth:{type:Object,default:()=>{}},portal:{type:Object,default:()=>{}},callingFrom:{type:String,default:""}},data(){return{loading:!1,showSearchBar:!1}},created(){this.togglePush()},computed:{userLang(){return this.auth.user_data.user_language?this.auth.user_data.user_language:"en"}},methods:{navbarMounted(){window.emitter.emit("navbar-mounted")},subString(e,a=30){return G(e,a)},signOut(){this.loading=!0,axios.post("/auth/logout").then(e=>{this.loading=!1,window.location.href=e.data.data?e.data.data:this.basePath()}).catch(e=>{this.loading=!1})},pushMenu(){this.$store.dispatch("setPushMenu",!this.getPushMenu),this.togglePush()},togglePush(){let e=document.getElementById("layout_body");setTimeout(()=>{this.getPushMenu?e.classList.add("sidebar-collapse"):e.classList.remove("sidebar-collapse")},1e3)},handleCloseSearchBar(e){this.showSearchBar=e}},components:{"language-dropdown":at,"inapp-notification":Tt,"application-updates":qt,"global-search":Za}},z=e=>(E("data-v-b4a3fd8e"),e=e(),B(),e),es={class:"navbar-nav"},ts={class:"nav-item"},as=z(()=>l("i",{class:"fas fa-bars"},null,-1)),ss=[as],is={class:"navbar-nav ml-auto"},ls={class:"nav-item"},ns=["href"],rs=z(()=>l("i",{class:"fa-solid fa-user-tie m-auto"},null,-1)),os=[rs],ds={key:0,class:"nav-item"},cs=["href"],us=z(()=>l("i",{class:"fa-solid fa-user-gear m-auto"},null,-1)),hs=[us],ms={key:1,class:"nav-link",href:"javascript:;"},fs={key:4,id:"nav-id",class:"nav-item"},_s={class:"nav-item dropdown user-menu"},gs={href:"javascript:;",class:"nav-link dropdown-toggle","data-toggle":"dropdown","aria-expanded":"false"},ps={class:"d-none d-md-inline mr-1",dir:"auto"},bs=["src"],ys={class:"dropdown-menu dropdown-menu-sm dropdown-menu-right rounded model-box rounded text-light dropdown-menu-arrow mt-2 rounded"},vs=["href"],ks=z(()=>l("i",{class:"fa fa-user pr-2"},null,-1)),Fs=z(()=>l("i",{class:"fa fa-user pr-2"},null,-1)),ws=z(()=>l("i",{class:"fas fa-sign-out-alt pr-2"},null,-1));function Cs(e,a,t,o,s,i){const f=p("global-search"),h=p("application-updates"),y=p("inapp-notification"),g=p("language-dropdown"),d=p("faveo-image-element"),F=p("router-link"),T=p("custom-loader"),V=j("tooltip");return n(),r("nav",{class:D(["main-header navbar navbar-expand",t.callingFrom=="admin"?t.portal.admin_header_color:t.portal.agent_header_color])},[l("ul",es,[l("li",ts,[l("a",{class:"nav-link",href:"javascript:;",role:"button",onClick:a[0]||(a[0]=(...L)=>i.pushMenu&&i.pushMenu(...L)),"data-widget":"pushmenu"},ss)])]),l("ul",is,[l("li",ls,[t.callingFrom=="admin"?C((n(),r("a",{key:0,class:"nav-link",href:e.basePath()+"/panel/dashboard"},os,8,ns)),[[V,e.trans("switch_to_agent_panel")]]):u("",!0)]),!t.callingFrom&&t.auth.user_data.role=="admin"?(n(),r("li",ds,[C((n(),r("a",{class:"nav-link",href:e.basePath()+"/admin/home"},hs,8,cs)),[[V,e.trans("switch_to_admin_panel")]])])):u("",!0),!s.showSearchBar&&t.callingFrom!="admin"?(n(),r("a",ms,[l("div",null,[l("i",{class:"fas fa-search",onClick:a[1]||(a[1]=L=>s.showSearchBar=!0)})])])):u("",!0),s.showSearchBar?(n(),k(f,{key:2,onCloseSearchBar:i.handleCloseSearchBar,userId:t.auth.user_data.id,callingFrom:t.callingFrom,headerBackground:t.callingFrom=="admin"?t.portal.admin_header_color:t.portal.agent_header_color},null,8,["onCloseSearchBar","userId","callingFrom","headerBackground"])):u("",!0),t.auth.user_data.role=="admin"?(n(),k(h,{key:3,callingFrom:t.callingFrom,headerBackground:t.callingFrom=="admin"?t.portal.admin_header_color:t.portal.agent_header_color},null,8,["callingFrom","headerBackground"])):u("",!0),m(y,{userId:t.auth.user_data.id,callingFrom:t.callingFrom,headerBackground:t.callingFrom=="admin"?t.portal.admin_header_color:t.portal.agent_header_color},null,8,["userId","callingFrom","headerBackground"]),t.callingFrom?u("",!0):(n(),r("li",fs,c(i.navbarMounted()),1)),m(g,{language:i.userLang},null,8,["language"]),l("li",_s,[l("a",gs,[C((n(),r("span",ps,[b(c(i.subString(t.auth.user_data.full_name))+" ",1),l("img",{src:t.auth.user_data.profile_pic,class:"user-image img-circle elevation-2 d-none d-md-inline",alt:"User Image"},null,8,bs)])),[[V,t.auth.user_data.full_name]]),m(d,{id:"nav-image",src:t.auth.user_data.profile_pic,class:"user-image img-circle elevation-2 d-md-none",alt:"User Image"},null,8,["src"])]),l("ul",ys,[l("li",null,[t.callingFrom==="admin"?(n(),r("a",{key:0,class:"dropdown-item dp-data",href:e.basePath()+"/panel/profile"},[ks,b(c(e.trans("profile")),1)],8,vs)):(n(),k(F,{key:1,class:"dropdown-item dp-data",to:"/profile"},{default:v(()=>[Fs,b(c(e.trans("profile")),1)]),_:1}))]),l("li",null,[l("a",{href:"javascript:;",class:"dropdown-item dp-data mb-4 mt-1",onClick:a[2]||(a[2]=(...L)=>i.signOut&&i.signOut(...L))},[ws,b(c(e.trans("sign_out")),1)])])])])]),s.loading?(n(),k(T,{key:0,"animation-duration":4e3})):u("",!0)],2)}const dd=S($a,[["render",Cs],["__scopeId","data-v-b4a3fd8e"]]);const Ss={name:"admin-agent-sidebar",props:{company:{type:Object,default:()=>{}},portal:{type:Object,default:()=>{}},auth:{type:Object,default:()=>{}},callingFrom:{type:String,default:""},alertData:{type:Object,default:()=>{}},alertWrapper:{type:[Boolean,Number],default:""}},components:{AgentNavigationBar:Ye,AdminNavigationBar:xe}},Ds=["href"],As=["src"],Ts=["href"],Vs=["src"];function Os(e,a,t,o,s,i){const f=p("admin-navigation-bar"),h=p("agent-navigation-bar");return n(),r("aside",{class:D(["main-sidebar elevation-4",t.callingFrom=="admin"?t.portal.admin_sidebar_color:t.portal.agent_sidebar_color])},[t.callingFrom=="admin"?(n(),r("a",{key:0,href:t.company.website,class:D(["brand-link text-center",t.portal.admin_header_color!="navbar-light"?t.portal.admin_header_color:""]),style:W({top:t.alertData?t.alertWrapper+"px !important":""})},[l("img",{src:t.portal.logo,alt:"AdminLTE Logo",class:"brand-image ml-0 float-none"},null,8,As)],14,Ds)):(n(),r("a",{key:1,href:t.company.website,class:D(["brand-link text-center",t.portal.agent_header_color!="navbar-light"?t.portal.agent_header_color:""]),style:W({top:t.alertData?t.alertWrapper+"px !important":""})},[l("img",{src:t.portal.logo,alt:"AdminLTE Logo",class:"brand-image ml-0 float-none"},null,8,Vs)],14,Ts)),t.callingFrom=="admin"?(n(),k(f,{key:2,auth:t.auth,from:"admin"},null,8,["auth"])):(n(),k(h,{key:3,auth:t.auth,from:"agent"},null,8,["auth"]))],2)}const cd=S(Ss,[["render",Os]]);const Is={name:"admin-agent-footer",props:{company:{type:[Object,String],default:""},whiteLabel:{type:Boolean,default:!1},tag:{type:String,default:""},version:{type:String,default:""},lang:{type:String,default:""}}},Ps={class:"main-footer"},Ms=["href"],js={key:1,class:"text-primary"},Rs=l("a",{href:"https://www.faveohelpdesk.com/",target:"_blank"},"Faveo",-1);function Ls(e,a,t,o,s,i){return n(),r("footer",Ps,[l("div",{class:D([{"float-right":t.lang!="ar","float-left":t.lang=="ar"},"d-none d-sm-inline"])},[l("strong",null,c(e.trans("version"))+" ",1),b(" "+c(t.whiteLabel?t.tag:t.version),1)],2),l("span",null,[b(c(e.trans("copyright"))+" © "+c(new Date().getFullYear())+" ",1),t.company.website?(n(),r("a",{key:0,href:t.company.website,target:"_blank"},c(t.company.company_name)+".",9,Ms)):(n(),r("a",js,c(t.company.company_name)+".",1))]),b("  "),t.whiteLabel?(n(),r(w,{key:0},[b(c(e.trans("all_rights_reserved")),1)],64)):(n(),r(w,{key:1},[b(c(e.trans("all_rights_reserved"))+". "+c(e.trans("powered_by"))+" ",1),Rs],64))])}const ud=S(Is,[["render",Ls]]),Es={name:"bread-crumbs",data(){return{showEditBtn:!1,inDashboard:!0,isAdminEnabled:!1,isRtl:!1}},beforeMount(){this.isRtl=M(sessionStorage.getItem("is_rtl"))},created(){window.emitter.on("edit-dashboard",e=>{this.inDashboard=e}),window.emitter.on("isAdminEnabled",e=>{this.isAdminEnabled=e})},methods:{getTitle(){return this.$route.meta.title?this.$route.meta.title=="from_report"?this.$route.params.type:this.$route.meta.title:this.$route.query["show[]"]},getActive(e){return e=="from_report"?this.$route.params.type:e},redirectToEditPage(){this.inDashboard=!1,window.emitter.emit("editDash",!0)}},watch:{"$route.href":{immediate:!0,handler(e,a){e.includes("/panel/dashboard")?this.showEditBtn=!0:this.showEditBtn=!1}}}},Bs={class:"content-header"},Us={class:"container-fluid"},qs={class:"row mb-2"},Ns={class:"col-sm-6 d-flex"},Ys={class:"m-0"},xs=l("button",{type:"button",class:"btn btn-sm border","data-toggle":"dropdown","aria-expanded":"false"},[l("i",{class:"fas fa-ellipsis-v"})],-1),Hs={class:"dropdown-menu",role:"menu"},zs=["disabled"],Ks=l("i",{class:"fas fa-edit"},null,-1),Ws={key:0,class:"col-sm-6"},Gs={class:"breadcrumb float-sm-right"},Xs=l("li",null,[l("i",{class:"fas fa-home text-gray"}),b("  ")],-1),Qs={key:0,class:"breadcrumb-item"},Js={key:1,class:"breadcrumb-item"},Zs={key:2,class:"breadcrumb-item"},$s={key:3,class:"breadcrumb-item active"},ei={key:4,class:"breadcrumb-item active"};function ti(e,a,t,o,s,i){const f=p("router-link"),h=j("tooltip");return n(),r("div",Bs,[l("div",Us,[l("div",qs,[l("div",Ns,[l("h1",Ys,c(e.trans(i.getTitle())),1),s.showEditBtn&&s.inDashboard?(n(),r("div",{key:0,id:"editPage-btn",class:D(["ml-2 btn-group",s.isRtl?"dropstart":""])},[xs,l("div",Hs,[C((n(),r("a",{type:"button",class:"dropdown-item",onClick:a[0]||(a[0]=(...y)=>i.redirectToEditPage&&i.redirectToEditPage(...y)),disabled:s.isAdminEnabled},[Ks,b("   "+c(e.trans("edit")),1)],8,zs)),[[h,e.trans("dashboard_edit")]])])],2)):u("",!0)]),e.$route.meta.crumb?(n(),r("div",Ws,[l("ol",Gs,[Xs,e.$route.meta.crumb.link?(n(),r("li",Qs,[m(f,{to:e.$route.meta.crumb.link.to},{default:v(()=>[b(c(e.trans(e.$route.meta.crumb.link.name)),1)]),_:1},8,["to"])])):u("",!0),e.$route.meta.crumb.root_link?(n(),r("li",Js,[m(f,{to:e.$route.meta.crumb.root_link.to},{default:v(()=>[b(c(e.trans(e.$route.meta.crumb.root_link.name)),1)]),_:1},8,["to"])])):u("",!0),e.$route.meta.crumb.parent_link?(n(),r("li",Zs,[m(f,{to:e.$route.meta.crumb.parent_link.to},{default:v(()=>[b(c(e.trans(e.$route.meta.crumb.parent_link.name)),1)]),_:1},8,["to"])])):u("",!0),e.$route.meta.crumb.root?(n(),r("li",$s,c(e.trans(e.$route.meta.crumb.root)),1)):u("",!0),e.$route.meta.crumb.active?(n(),r("li",ei,c(e.trans(i.getActive(e.$route.meta.crumb.active))),1)):u("",!0)])])):u("",!0)])])])}const hd=S(Es,[["render",ti]]);const ai={},si={class:"lockscreen-wrapper lockscreen-wraper"},ii={class:"error-page"},li=l("h2",{class:"headline text-warning lock_mt_25"}," 404",-1),ni={class:"error-content"},ri=l("h3",null,[l("i",{class:"fas fa-exclamation-triangle text-warning"}),b(" Oops! Page not found.")],-1);function oi(e,a){const t=p("router-link");return n(),r("div",si,[l("div",ii,[li,l("div",ni,[ri,l("p",null,[b(" We could not find the page you were looking for. Meanwhile, you may "),m(t,{to:"/"},{default:v(()=>[b("return to dashboard.")]),_:1})])])])])}const md=S(ai,[["render",oi]]);const di={name:"checkbox",description:"Checkbox with default css class and other required props to be used throughout the project",props:{value:{type:[Boolean,Number],default:!1},name:{type:[String,Number],required:!0},label:{type:String,required:!0},hint:{type:String,default:""},title:{type:String,default:""},classname:{type:String,default:""},onChange:{type:Function,Required:!0},disabled:{type:Boolean,default:!1},id:{type:[String,Number],default:"checkbox"},defaultClass:{type:String,default:"form-group"},labelClass:{type:String,default:""}},data(){return{checked:!(this.value==""||this.value==null||this.value=="0")}},watch:{value(e,a){return this.checked=!(e==""||e==null||e=="0"),e},checked(e,a){this.onChange(e,this.name)}},components:{"tool-tip":fe}},ci=["title"],ui=["id","name","disabled"];function hi(e,a,t,o,s,i){const f=p("tool-tip");return n(),r("div",{class:D(t.defaultClass)},[l("div",{class:D(t.classname)},[l("label",{title:e.trans(t.title),class:D(t.labelClass)},[C(l("input",{id:t.id,name:t.name,"onUpdate:modelValue":a[0]||(a[0]=h=>s.checked=h),type:"checkbox",disabled:t.disabled,class:"check_align mr-1"},null,8,ui),[[re,s.checked]]),b(" "+c(e.lang(t.label))+" ",1),t.hint!=""?(n(),k(f,{key:0,message:t.hint,size:"small"},null,8,["message"])):u("",!0)],10,ci)],2)],2)}const be=S(di,[["render",hi],["__scopeId","data-v-5b744b2f"]]);const mi={name:"file-upload",description:"file upload component along with error block",props:{label:{type:String,required:!0},hint:{type:String,default:""},name:{type:String,required:!0},onChange:{type:Function,Required:!0},classname:{type:String,default:""},required:{type:Boolean,default:!1},labelStyle:{type:Object},id:{type:[String,Number],default:"text-field"},value:{type:[Object,String],default:""},is_default:{type:[Boolean,Number],default:!1},btnName:{type:String,default:""},buttonName:{type:String,default:""},labelCss:{type:Object,default:()=>{}}},data(){return{selectedFile:this.value,imageSrc:"",tooltip:"",styleObj:{background:"none"},showModal:!1,containerStyle:{width:"800px"},crop:{width:"400px",height:"300px"},cropImg:"",resultImage:"",aspectRatio:0}},beforeMount(){this.selectedFile=this.value,this.tooltipValue(this.selectedFile)},watch:{value(e){this.selectedFile=e}},methods:{onFileSelected(e){if(!e.target.files[0].type.includes("image/")){this.showCustomAlert(this.lang("select_image"));return}if(e.target.files[0].size<2097152){this.showModal=!0;var a=this.$refs.fileInput;this.selectedFile=e.target.files[0];var t=e.target;if(t.files&&t.files[0]){var o=new FileReader;o.onload=s=>{this.imageSrc=s.target.result,this.$refs.cropper.replace(s.target.result)},o.readAsDataURL(t.files[0])}a.value=""}else this.showCustomAlert(this.lang("max_size_new_added"))},cropImage(){this.$refs.cropper&&(this.cropImg=this.$refs.cropper.getCroppedCanvas().toDataURL())},rotateImage(){this.$refs.cropper.rotate(90)},onClose(){this.showModal=!1},onSubmit(){var e=this.cropImg,a=e.split(";"),t=a[0].split(":")[1],o=a[1].split(",")[1];this.resultImage=this.b64toBlob(o,t);const s={};s.name=this.selectedFile.name,s.image=this.cropImg,s.file=this.resultImage,this.onChange(s,this.name),this.onClose()},b64toBlob(e,a,t="",o=512){for(var s=atob(e),i=[],f=0;f<s.length;f+=o){for(var h=s.slice(f,f+o),y=new Array(h.length),g=0;g<h.length;g++)y[g]=h.charCodeAt(g);var d=new Uint8Array(y);i.push(d)}var F=new Blob(i,{type:t});return F},tooltipValue(e){this.tooltip=e!==null&&e.name===void 0?e.split("/")[e.split("/").length-1]:e?e.name:"no_file",this.styleObj.background=this.tooltip==="logo.png"?"black":"none"},showCustomAlert(e){this.$store.dispatch("setAlert",{type:"danger",message:e,component_name:"layout"})},changeRatio(e){this.$refs.cropper.setAspectRatio(e),this.aspectRatio=e}},components:{VueCropper:Le,modal:ve,"form-field-template":le,"faveo-image-element":ke}},ye=e=>(E("data-v-1d0a4025"),e=e(),B(),e),fi=["disabled"],_i={class:"text-center"},gi=["disabled"],pi={key:0,class:"fas fa-exchange-alt"},bi={class:""},yi={class:"rotate-button"},vi=ye(()=>l("i",{class:"fas fa-sync-alt"},null,-1)),ki=ye(()=>l("i",{class:"fa fa-check"},null,-1));function Fi(e,a,t,o,s,i){const f=p("faveo-image-element"),h=p("vue-cropper"),y=p("modal"),g=p("form-field-template");return n(),k(g,{label:t.label,labelStyle:t.labelStyle,name:t.name,classname:t.classname,hint:t.hint,required:t.required},{default:v(()=>[l("input",{ref:"fileInput",type:"file",onChange:a[0]||(a[0]=(...d)=>i.onFileSelected&&i.onFileSelected(...d)),style:{display:"none"},multiple:"",disabled:t.is_default},null,40,fi),l("div",null,[m(f,{id:"profile-pic",classes:["profile-user-img","img-responsive","img-circle","img-click"],"source-url":t.value,title:e.lang(s.tooltip),"style-object":s.styleObj},null,8,["source-url","title","style-object"]),l("h6",{class:"text-center font-weight-normal mt-2",style:W(t.labelCss)},c(t.label),5)]),l("div",_i,[l("button",{class:"btn btn-primary btn-xs text-center",disabled:t.is_default,"data-toggle":"modal",onClick:a[1]||(a[1]=d=>e.$refs.fileInput.click())},[t.buttonName?u("",!0):(n(),r("i",pi)),b(" "+c(t.buttonName?e.lang(t.buttonName):t.btnName?e.lang("change_icon"):e.lang("change_logo")),1)],8,gi)]),s.showModal?(n(),k(y,{key:0,showModal:s.showModal,onClose:i.onClose,containerStyle:s.containerStyle},{title:v(()=>[l("div",null,[l("h4",null,c(t.name==="profile_pic"?e.trans("crop_profile"):t.btnName?e.trans("crop_Icon"):e.trans("crop_logo")),1)])]),fields:v(()=>[l("div",bi,[m(h,{ref:"cropper",guides:!0,"view-mode":2,"drag-mode":"crop","auto-crop":!0,"auto-crop-area":100,"min-container-width":570,"min-container-height":300,background:!0,rotatable:!0,src:s.imageSrc,"img-style":s.crop,crop:i.cropImage,"aspect-ratio":""},null,8,["src","img-style","crop"])]),l("div",yi,[s.imageSrc?(n(),r("button",{key:0,onClick:a[2]||(a[2]=(...d)=>i.rotateImage&&i.rotateImage(...d)),id:"rotate"},[vi,b(" "+c(e.trans("rotate")),1)])):u("",!0),s.imageSrc?(n(),r("button",{key:1,onClick:a[3]||(a[3]=d=>i.changeRatio(0)),id:"ratio",class:D([{active:s.aspectRatio===0},"m-1"])},"  "+c(e.trans("no_ratio")),3)):u("",!0),s.imageSrc?(n(),r("button",{key:2,onClick:a[4]||(a[4]=d=>i.changeRatio(1)),id:"ratio",class:D([{active:s.aspectRatio===1},"m-1"])},"  "+c("1:1 "+e.trans("ratio")),3)):u("",!0),s.imageSrc?(n(),r("button",{key:3,onClick:a[5]||(a[5]=d=>i.changeRatio(2)),id:"ratio",class:D([{active:s.aspectRatio===2},"m-1"])},"  "+c("16:9 "+e.trans("ratio")),3)):u("",!0)])]),controls:v(()=>[l("button",{type:"button",onClick:a[6]||(a[6]=(...d)=>i.onSubmit&&i.onSubmit(...d)),class:"btn btn-primary float-right",id:"crop_action"},[ki,b(" "+c(e.lang("proceed")),1)])]),_:1},8,["showModal","onClose","containerStyle"])):u("",!0)]),_:1},8,["label","labelStyle","name","classname","hint","required"])}const fd=S(mi,[["render",Fi],["__scopeId","data-v-1d0a4025"]]);const wi={props:{label:{type:String,required:!0},api:{type:String,required:!0},keyname:{type:String},base:{type:String},meta:{type:Boolean},value:{type:Array},updateFilter:{type:Function},reset:{type:Boolean}},data(){return{filter_options:[],filter_selected:[],filter_obj:{},isLoading:!1,page:0,observer:null,next_page_url:"",searchQuery:"",showField:!1}},components:{"v-select":pe},mounted(){this.filter_selected=this.value,setTimeout(()=>{this.showField=!0},1),this.observer=new IntersectionObserver(this.infiniteScroll)},watch:{value(e,a){this.filter_selected=e,this.tagsChanged(this.keyname,e)},reset(e){e&&(this.filter_selected=[],this.filter_obj={})}},computed:{hasNextPage(){return this.next_page_url!==null}},methods:{onValueChange(e){this.tagsChanged(this.keyname,e)},subString(e){return G(e,35)},onSearch(e){this.page=1,this.searchQuery=e,this.search(this)},search:Ee.debounce(e=>{e.getDataFromServer(!0)},350),getDataFromServer(e,a){this.isLoading=!0,axios.get("api/"+this.base+"/"+this.api,{params:this.getApiParams()}).then(t=>{this.postApiResponseOperations(t.data.data,e,a)}).catch(t=>{console.log(t)}).finally(()=>{this.isLoading=!1})},async postApiResponseOperations(e,a,t){if(this.next_page_url=e.next_page_url,a)this.filter_options=e.data;else{const o=t.offsetParent,s=t.offsetParent.scrollTop;this.filter_options.push(...e.data),await this.$nextTick(),o.scrollTop=s}},getApiParams(){return{"search-query":this.searchQuery||void 0,page:this.page||void 0,meta:this.meta||void 0,paginate:1}},clearSearchQuery(){this.$refs.faveoDynamicSelect.onEscape()},tagsChanged(e,a){if(a&&a.length!=0){var t=[];for(var o in a)t.push(a[o].id);this.filter_obj[e]=t}else this.filter_obj[e]=[];this.$emit("selected",this.filter_obj);let s={};s[this.keyname]=this.filter_selected,this.updateFilter(s)},async infiniteScroll([{isIntersecting:e,target:a}]){e&&(this.page+=1,this.getDataFromServer(!1,a))},async onOpen(e){this.hasNextPage&&(await this.$nextTick(),this.observer.observe(this.$refs.load))},onClose(){this.observer.disconnect(),this.isLoading=!1}}},Ci=e=>(E("data-v-8aab961c"),e=e(),B(),e),Si={key:0,class:"col-sm-4 margin-bottom-15"},Di=Ci(()=>l("span",null,null,-1)),Ai={key:0},Ti=["title"],Vi=["title"],Oi={ref:"load"};function Ii(e,a,t,o,s,i){const f=p("loader"),h=p("faveo-image-element"),y=p("v-select");return s.showField?(n(),r("div",Si,[l("label",null,c(t.label),1),m(y,{multiple:"",class:"faveo-dynamic-select",ref:"faveoDynamicSelect",id:t.api+t.keyname,modelValue:s.filter_selected,"onUpdate:modelValue":[a[0]||(a[0]=g=>s.filter_selected=g),i.onValueChange],label:"name",options:s.filter_options,placeholder:e.lang("search_or_select"),filterable:!1,onSearch:i.onSearch,onOpen:i.onOpen,onClose:i.onClose,"onSearch:blur":i.clearSearchQuery},Be({spinner:v(({loader:g})=>[s.isLoading?(n(),k(f,{key:0,class:"loader-area",duration:4e3,size:20})):u("",!0)]),"no-options":v(({search:g,searching:d})=>[Di,d?(n(),r(w,{key:0},[b(c(e.lang("no_results_found_for"))+" ",1),l("em",null,c(g),1),b(". ")],64)):(n(),r(w,{key:1},[!s.isLoading&&!i.hasNextPage?(n(),r("span",Ai,c(e.lang("no_options_found")),1)):u("",!0)],64))]),option:v(g=>[l("div",{class:"d-center",title:g.name},[g.profile_pic?(n(),k(h,{key:0,id:"faveo-dynamic-select-img","source-url":g.profile_pic,"img-height":"20","img-width":"20","alternative-text":"User"},null,8,["source-url"])):u("",!0),b(" "+c(i.subString(g.name)),1)],8,Ti)]),"selected-option":v(g=>[l("div",{class:"selected d-center",title:g.name},[g.profile_pic?(n(),k(h,{key:0,id:"faveo-dynamic-select-img","source-url":g.profile_pic,"img-height":"20","img-width":"20"},null,8,["source-url"])):u("",!0),b(" "+c(i.subString(g.name)),1)],8,Vi)]),_:2},[i.hasNextPage?{name:"list-footer",fn:v(()=>[l("li",Oi,null,512)]),key:"0"}:void 0]),1032,["id","modelValue","options","placeholder","onUpdate:modelValue","onSearch","onOpen","onClose","onSearch:blur"])])):u("",!0)}const Pi=S(wi,[["render",Ii],["__scopeId","data-v-8aab961c"]]);const Mi={props:["filterArray","label","keyname","dateRange","value","updateFilter","reset"],data(){return{filter_options:this.filterArray,filter_selected:null,filter_obj:{},customRange:!1,timeRange:"",showField:!1}},mounted(){const e=this;$(document).ready(function(){e.keyname=="last-modified-start"?$("#custom-update-range").daterangepicker({timePicker:!0,timePickerIncrement:15,startDate:A().startOf("hour"),endDate:A().startOf("hour").add(32,"hour"),locale:{format:"YYYY-MM-DD HH:mm:SS"},maxDate:A()}).on("apply.daterangepicker",(a,t)=>{e.filter_obj["last-modified-start"]=A(t.startDate._d).format("YYYY-MM-DD HH:mm:ss"),e.filter_obj["last-modified-end"]=A(t.endDate._d).format("YYYY-MM-DD HH:mm:ss"),e.$emit("selected",this.filter_obj)}):$("#custom-created-range").daterangepicker({timePicker:!0,timePickerIncrement:15,startDate:A().startOf("hour"),endDate:A().startOf("hour").add(32,"hour"),locale:{format:"YYYY-MM-DD HH:mm:SS"},maxDate:A()}).on("apply.daterangepicker",(a,t)=>{e.filter_obj["created-start"]=A(t.startDate._d).format("YYYY-MM-DD HH:mm:ss"),e.filter_obj["created-end"]=A(t.endDate._d).format("YYYY-MM-DD HH:mm:ss"),e.$emit("selected",this.filter_obj)})}),this.filter_selected=this.value,setTimeout(()=>{this.showField=!0},1)},watch:{value(e,a){this.filter_selected=e,this.tagsChanged(this.keyname,e)},reset(e){e&&(this.filter_selected=null,this.filter_obj={})}},methods:{onValueChange(e){this.tagsChanged(this.keyname,e)},tagsChanged(e,a){if(this.filter_selected=a,a!=null){if(e!="due-on"&&e!="created-start"&&e!="last-modified-start"){for(var t in a)t=="id"&&(this.filter_obj[e]=a[t]);this.$emit("selected",this.filter_obj)}else if(e=="due-on")for(var t in a)t=="id"&&(a[t]!="today"?this.getTime(e,a[t]):this.getEoD(e,new Date));else if(e=="created-start"||e=="last-modified-start"){for(var t in a)if(t=="id")if(a[t]=="custom"){this.customRange=!0;var o=this.$store.getters.timezone;this.keyname=="created-start"?(this.filter_obj["created-start"]=A.tz(o).startOf("day").format("YYYY-MM-DD HH:mm:ss"),this.filter_obj["created-end"]=A().format("YYYY-MM-DD HH:mm:ss"),this.$emit("selected",this.filter_obj)):(this.filter_obj["last-modified-start"]=A.tz(o).startOf("day").format("YYYY-MM-DD HH:mm:ss"),this.filter_obj["last-modified-end"]=A().format("YYYY-MM-DD HH:mm:ss"),this.$emit("selected",this.filter_obj))}else a[t]=="today"?(this.customRange=!1,this.getEoD(e,new Date)):a[t]=="5"||a[t]=="10"||a[t]=="15"||a[t]=="30"?(this.customRange=!1,this.getMint(e,a[t])):(this.customRange=!1,this.getTime(e,a[t]))}}else this.customRange=!1,this.keyname=="created-start"?(this.filter_obj["created-start"]="",this.filter_obj["created-end"]=""):this.keyname=="last-modified-start"?(this.filter_obj["last-modified-start"]="",this.filter_obj["last-modified-end"]=""):this.filter_obj[e]="",this.$emit("selected",this.filter_obj);let s={};s[this.keyname]=this.filter_selected,this.updateFilter(s)},getMint(e,a){var t=new Date,o=this.$store.getters.timezone,s=A(t.setMinutes(t.getMinutes()-a)).tz(o).format("YYYY-MM-DD HH:mm:ss");this.keyname=="created-start"?(this.filter_obj["created-start"]=String(s),this.filter_obj["created-end"]=A().tz(o).format("YYYY-MM-DD HH:mm:ss")):this.keyname=="last-modified-start"?(this.filter_obj["last-modified-start"]=String(s),this.filter_obj["last-modified-end"]=A().tz(o).format("YYYY-MM-DD HH:mm:ss")):this.filter_obj[e]=String(s),this.$emit("selected",this.filter_obj)},getTime(e,a){var t=new Date,o=this.$store.getters.timezone,s=A(t.setHours(t.getHours()-a)).tz(o).format("YYYY-MM-DD HH:mm:ss");this.keyname=="created-start"?(this.filter_obj["created-start"]=String(s),this.filter_obj["created-end"]=A().tz(o).format("YYYY-MM-DD HH:mm:ss")):this.keyname=="last-modified-start"?(this.filter_obj["last-modified-start"]=String(s),this.filter_obj["last-modified-end"]=A().tz(o).format("YYYY-MM-DD HH:mm:ss")):this.filter_obj[e]=String(s),this.$emit("selected",this.filter_obj)},getEoD(e,a){var t=this.$store.getters.timezone,o=A.tz(a,t).startOf("day").format("YYYY-MM-DD HH:mm:ss"),s=A.tz(a,t).endOf("day").format("YYYY-MM-DD HH:mm:ss");this.keyname=="created-start"?(this.filter_obj["created-start"]=String(o),this.filter_obj["created-end"]=A().tz(t).format("YYYY-MM-DD HH:mm:ss")):this.keyname=="last-modified-start"?(this.filter_obj["last-modified-start"]=String(o),this.filter_obj["last-modified-end"]=A().tz(t).format("YYYY-MM-DD HH:mm:ss")):this.filter_obj[e]=String(s),this.$emit("selected",this.filter_obj)},showPlaceholder(){return"Search or select "+this.label.toLowerCase()}},components:{"v-select":pe}},ji={key:0,class:"col-sm-4 margin-bottom-15"},Ri={class:"col-sm-3"},Li=["id"];function Ei(e,a,t,o,s,i){const f=p("v-select");return s.showField?(n(),r("div",ji,[l("div",null,[l("label",null,c(t.label),1),m(f,{ref:"faveoDynamicSelect",class:"faveo-dynamic-select",label:"text",options:s.filter_options,placeholder:e.lang("search_or_select"),"onUpdate:modelValue":[i.onValueChange,a[0]||(a[0]=h=>s.filter_selected=h)],modelValue:s.filter_selected},null,8,["options","placeholder","onUpdate:modelValue","modelValue"])]),C(l("div",Ri,[l("label",null,"Time period for "+c(t.label),1),C(l("input",{type:"text",id:t.dateRange,class:"form-control","onUpdate:modelValue":a[1]||(a[1]=h=>s.timeRange=h)},null,8,Li),[[ae,s.timeRange]])],512),[[se,s.customRange]])])):u("",!0)}const Bi=S(Mi,[["render",Ei],["__scopeId","data-v-5ba0df6b"]]);const Ui={data(){return{allCustomFields:[],selectedCustomFields:this.selectedFilters,searchedCustomFields:[],search:"",loading:!0,updatedFilterValues:this.customFilters,valuesInEdit:[],filterOpen:!1,hasMoreData:!0,page:1}},props:{selectedFilters:{type:Array,required:!0},customFilters:{type:Object,default:()=>{}},updatedFieldValues:{type:Function},showLoader:{type:Function,default:()=>{}},filterId:{type:[String,Number],default:""}},beforeMount(){setTimeout(()=>{this.getCustomFields()},1e3)},methods:{handleFilterScroll(){const e=document.getElementById("filter-container"),a=e.scrollHeight,t=e.scrollTop,o=e.clientHeight;t+o>=a-100&&!this.loading&&this.hasMoreData&&this.getCustomFields()},async getCustomFields(){try{this.toggleOptions(),this.loading=!0;let t=location.search.substring(1),o,s;t&&(o=JSON.parse('{"'+decodeURI(t).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"').replace(/%2F/g,"/")+'"}')),o&&(s=Object.keys(o).find(f=>f.includes("custom_")));const i=await O.get(`/custom-field-flattened?category=ticket&page=${this.page}&time=${Date.now()}&module=filter&filter_id=${this.filterId}&filter_key=${s||""}`);if(i.data.data.data.length>0){for(var e in i.data.data.data){i.data.data.data[e].selected===void 0&&(i.data.data.data[e].selected=0);for(var a in this.selectedCustomFields)this.selectedCustomFields[a].id===i.data.data.data[e].id&&(i.data.data.data[e].selected=1,i.data.data.data[e].value=this.selectedCustomFields[a].value)}this.allCustomFields=[...this.allCustomFields,...i.data.data.data],this.setUpdatedField(this.allCustomFields),this.page++,this.filterOpen=!0,this.showLoader(!1),this.hasMoreData=!0}else this.hasMoreData=!1}catch(t){P(t)}finally{this.loading=!1,this.showLoader(!1)}},setSelectedField(e){if(e.length>0){for(var a in e){e[a].selected==null&&(e[a].selected=0);for(var t in this.selectedCustomFields)this.selectedCustomFields[t].id==e[a].id&&(e[a].selected=1,e[a].value=this.selectedCustomFields[t].value)}this.allCustomFields=e,this.setUpdatedField(this.allCustomFields)}},setUpdatedField(e){if(e.length>0){for(var a in e){if(this.valuesInEdit.length)for(var t in this.valuesInEdit)this.valuesInEdit[t].key==e[a].key&&(e[a].selected=1,e[a].value||(e[a].data_type=="checkbox"?e[a].value=this.valuesInEdit[t].value.split(","):e[a].value=this.valuesInEdit[t].value,this.selectedCustomFields.push(e[a]),this.selectedCustomFields.length===this.valuesInEdit.length&&this.$emit("custom",this.selectedCustomFields)));e[a].selected==null&&(e[a].selected=0);for(var o in this.selectedCustomFields)this.selectedCustomFields[o].id==e[a].id&&(e[a].selected=1,e[a].value=this.selectedCustomFields[o].value)}this.allCustomFields=e}},unbindClickInContainer(e){$(e.target).attr("@click",null).unbind("click")},toggleOptions(){$(".custom-menu").dropdown("toggle")},toggleFormFieldVisibility(e){let a=this.allCustomFields.findIndex(t=>t.key==e.key);e.selected?(e.selected=0,delete this.updatedFilterValues[e.key],this.updatedFieldValues(this.updatedFilterValues),this.allCustomFields.splice(a,1,e),this.selectedCustomFields=this.selectedCustomFields.filter(function(t){return t.id!=e.id})):(e.selected=1,e.value="",this.selectedCustomFields.push(e),this.allCustomFields.splice(a,1,e)),this.$emit("custom",this.selectedCustomFields)},searchFilter(e){return this.allCustomFields.filter(a=>(e=e.toLowerCase(),a.label.toLowerCase().indexOf(e)!==-1))}},watch:{search(e){this.searchedCustomFields=this.searchFilter(e)}},computed:{visibileCustomFields(){return this.search==""?this.allCustomFields:this.searchedCustomFields}}},de=e=>(E("data-v-f3e02392"),e=e(),B(),e),qi={class:"card-tools"},Ni={href:"javascript:;",class:"btn-tool dropdown-toggle","data-toggle":"dropdown"},Yi=de(()=>l("i",{class:"glyphicon glyphicon-plus"},null,-1)),xi=[Yi],Hi={class:"dropdown-header"},zi={class:"px-2"},Ki=["placeholder"],Wi=["id","onClick"],Gi={key:0},Xi=de(()=>l("span",{"aria-hidden":"true",class:"fas fa-check"},null,-1)),Qi=[Xi],Ji={key:1,class:"ml-2"},Zi=de(()=>l("span",{"aria-hidden":"true",class:"fas fa-arrow-right"},null,-1)),$i=[Zi],el=["title"],tl={key:1,class:"dropdown-item"},al={key:2,style:{padding:"35px"}};function sl(e,a,t,o,s,i){const f=p("loader"),h=j("tooltip");return n(),r("div",qi,[C((n(),r("a",Ni,xi)),[[h,e.trans("add_custom_field")]]),l("div",{class:"dropdown-menu dropdown-menu-right dropdown-menu-lg custom_filter_menu",role:"menu",onClick:a[1]||(a[1]=y=>y.stopPropagation()),id:"filter-container",onScroll:a[2]||(a[2]=y=>i.handleFilterScroll())},[l("span",Hi,c(e.trans("filter_custom_field")),1),l("div",zi,[C(l("input",{type:"text",class:"form-control",placeholder:e.lang("filter_here"),"onUpdate:modelValue":a[0]||(a[0]=y=>s.search=y)},null,8,Ki),[[ae,s.search]])]),i.visibileCustomFields.length?(n(!0),r(w,{key:0},I(i.visibileCustomFields,(y,g)=>(n(),r("a",{id:"form-field-"+g,role:"menuitem",tabindex:"-1",href:"javascript:;",class:D(["dropdown-item",{"selected-field":y.selected}]),onClick:d=>i.toggleFormFieldVisibility(y)},[y.selected==1?(n(),r("span",Gi,Qi)):u("",!0),b("  "),y.isChild?(n(),r("span",Ji,$i)):u("",!0),b("  "),l("span",{style:{position:"absolute","margin-top":"-1px"},title:y.hover?y.hover:y.label},c(e.getSubString(y.label,30)),9,el)],10,Wi))),256)):u("",!0),!i.visibileCustomFields.length&&!s.loading?(n(),r("a",tl,c(e.trans("no_results_found")),1)):u("",!0),s.loading?(n(),r("div",al,[m(f,{size:30,duration:4e3,color:"#1d78ff"})])):u("",!0)],32)])}const il=S(Ui,[["render",sl],["__scopeId","data-v-f3e02392"]]);function ll(e){const{display_order:a}=e;let t={display_order:[a,"isRequired",{"minValue(1)":K("display_order_tickets")}]};const o=new ee(K),{errors:s,isValid:i}=o.validate(t);return te.dispatch("setValidationError",s),{errors:s,isValid:i}}const nl={name:"save-filter",description:"Save filter pop-up in ticket filters",setup(){const e=Q();return{formattedTime:H(()=>e.getters.formattedTime)}},props:{filterName:{type:String,default:""},filterObjects:{type:Object,required:!0},filterValues:{type:Object,required:!0},filterId:{type:Number,default:0},toggleFilterPopUp:{type:Function,required:!0},mode:{type:String,default:""},initialAgents:{type:Array,default:()=>[]},intitialDepartments:{type:Array,default:()=>[]},postFilterSaveAction:{type:Function,required:!0},from:{type:String,default:""},totalFilters:{type:Number,default:0},dashboardConfig:{type:Object,default:function(){return{displayOnDashboard:!1,isDisplayUnderDefault:!1,iconColor:"#00C0EF",iconClass:{icon_class:"fas fa-ticket"},created_at:"",created_by:[],canViewCreatorProfile:!0,display_order:""}}},source:{type:String,default:""}},data(){return{name:"",agents:[],departments:[],shallFilterBeVisible:!0,loading:!1,isDisplayOnDashboard:!1,iconColor:"",iconClass:"",iconList:[],isDisplayUnderDefault:!1,created_by:[],created_at:"",canViewCreatorProfile:!0,display_order:""}},beforeMount(){const e=this.source==="open_tickets"&&this.mode==="save";this.isDisplayOnDashboard=e?!1:this.dashboardConfig.displayOnDashboard,this.isDisplayUnderDefault=e?!1:this.dashboardConfig.isDisplayUnderDefault,this.iconColor=e?"#00C0EF":this.dashboardConfig.iconColor,this.iconClass=e?{icon_class:"fas fa-ticket"}:this.dashboardConfig.iconClass,this.created_at=e?"":this.dashboardConfig.created_at,this.created_by=e?[]:this.dashboardConfig.created_by,this.canViewCreatorProfile=e?!0:this.dashboardConfig.canViewCreatorProfile,this.departments=e?[]:this.intitialDepartments,this.agents=e?[]:this.initialAgents,this.name=e?"":this.trans(this.filterName),this.display_order=e?"":this.dashboardConfig.display_order,this.mode!=="delete"&&this.getIconList()},methods:{checkFromWhere(){return this.from!=="clientFilter"},isValid(){const{errors:e,isValid:a}=ll(this.$data);return a},saveFilter(e){this.isValid()&&(this.$store.dispatch("unsetValidationError"),this.loading=!0,O.post("/api/agent/ticket-filter",this.getApiParams(e)).then(a=>{this.loading=!1,N(a,this.$options.name),this.postFilterSaveAction(),setTimeout(()=>{this.toggleFilterPopUp(!1,!1),window.emitter.emit("ticketFilterSaved"),window.emitter.emit("updateFilterApi")},2e3),window.emitter.emit("updateNavActive"),window.emitter.emit("updateSideNav"),window.emitter.emit("updateAgentSidebar")}).catch(a=>{this.loading=!1,P(a,this.$options.name)}))},getApiParams(e){let t={id:e=="create"?0:this.filterId,name:this.name,fields:this.getFormattedFilterData(),agents:this.isDisplayUnderDefault?[]:ce(this.agents),departments:this.isDisplayUnderDefault?[]:ce(this.departments),display_on_dashboard:this.isDisplayOnDashboard,display_on_navigation_bar:this.isDisplayUnderDefault,icon_class:this.iconClass.icon_class,icon_color:this.iconColor,display_order:this.display_order};return t.is_Edited=!(this.source==="open_tickets"&&e!=="create"),t.type=this.from==="clientFilter"?"admin":"agent",t},getIconList(){O.get("/json/icon-list.json").then(e=>{this.iconList=e.data.data}).catch(e=>{console.error("SaveFilter | getIconList | Error= ",e)})},getFormattedFilterData(){return Object.keys(this.filterObjects).filter(e=>M(this.filterObjects[e])).map(e=>{let a=this.filterValues[e]!==void 0?this.filterValues[e]:this.filterObjects[e];return{key:e,value:a}})},deleteFilter(){this.$store.dispatch("unsetValidationError"),this.loading=!0,O.delete("/api/agent/ticket-filter/"+this.filterId).then(e=>{this.loading=!1,N(e,this.$options.name),setTimeout(()=>{this.toggleFilterPopUp(!1,!1),this.$router.push("/tickets/filter/"+e.data.data.filter_id)},2e3)}).catch(e=>{this.loading=!1,P(e,this.$options.name)})},onChange(e,a){this[a]=e},onClose(){this.$store.dispatch("unsetValidationError"),this.$store.dispatch("unsetAlert"),this.toggleFilterPopUp(!1,!0)},showSaveAsNew(){return this.mode!=="delete"},showSaveNew(){return this.mode!=="delete"&&this.totalFilters!=5},showSave(){return this.mode!=="delete"&&this.filterId!=0},showDelete(){return this.mode==="delete"},subString(e,a=25){return G(e,a)}},computed:{isDisabled(){return this.source==="open_tickets"&&this.mode!=="save"},isShared(){return this.departments.length>0||this.agents.length>0}},watch:{isDisplayOnDashboard:function(){this.isDisplayOnDashboard&&this.iconList.length===0&&this.getIconList()}},components:{"text-field":X,"dynamic-select":q,"tool-tip":fe,checkbox:be,"color-picker":He,"number-field":Fe}},J=e=>(E("data-v-247a8aae"),e=e(),B(),e),rl={key:0,class:"modal-title"},ol={key:1,class:"modal-title"},dl={key:0,class:"save-filter-modal-body"},cl={class:"row"},ul={key:0,class:"col-sm-6 pl-0 filter-info"},hl={class:"col-sm-12"},ml=["href"],fl={key:1,class:"permission-update"},_l={class:"col-sm-12"},gl={key:0,class:"row"},pl={class:"col-sm-6 pl-0"},bl={key:0,class:"col-sm-6 pl-0"},yl={class:"row"},vl={class:"col-sm-6"},kl={for:"dashboard-widget-bg-color"},Fl={key:0,class:"is-danger"},wl={key:1},Cl={class:"row"},Sl={class:"col-sm-4",style:{"line-height":"2"}},Dl={class:"row"},Al={class:"row"},Tl={key:1},Vl=J(()=>l("i",{class:"fas fa-sync","aria-hidden":"true"},null,-1)),Ol=J(()=>l("i",{class:"fas fa-save","aria-hidden":"true"},null,-1)),Il=J(()=>l("i",{class:"fas fa-save","aria-hidden":"true"},null,-1)),Pl=J(()=>l("i",{class:"fas fa-save","aria-hidden":"true"},null,-1)),Ml=J(()=>l("i",{class:"fas fa-trash","aria-hidden":"true"},null,-1));function jl(e,a,t,o,s,i){const f=p("alert"),h=p("custom-loader"),y=p("text-field"),g=p("checkbox"),d=p("tool-tip"),F=p("color-picker"),T=p("dynamic-select"),V=p("number-field"),L=p("modal"),x=j("tooltip"),R=j("focus-first-input");return n(),k(L,{showModal:!0,onClose:i.onClose},{title:v(()=>[t.mode!=="delete"?(n(),r("h4",rl,c(e.lang(t.source==="open_tickets"&&t.mode!=="save"?"update_filter":"save_filter")),1)):(n(),r("h4",ol,c(e.lang("are_you_sure_you_want_to_delete")),1))]),alert:v(()=>[m(f,{componentName:this.$options.name},null,8,["componentName"])]),fields:v(()=>[t.mode!=="delete"?(n(),r("div",dl,[s.loading?(n(),k(h,{key:0})):u("",!0),C((n(),r("div",cl,[m(y,{name:"name",label:e.lang("name"),value:s.name,onChange:i.onChange,required:!0,classname:"col-md-6"},null,8,["label","value","onChange"]),t.filterId!==0&&this.mode!=="save"?(n(),r("div",ul,[l("div",hl,[l("b",null,c(e.lang("created_by"))+":",1),b("  "),l("span",null,[s.canViewCreatorProfile?C((n(),r("a",{key:0,target:"_blank",class:"creater-info",href:e.basePath()+"/panel/user/"+s.created_by.id},[b(c(i.subString(s.created_by.full_name)),1)],8,ml)),[[x,e.trans(s.created_by.full_name)]]):C((n(),r("span",fl,[b(c(i.subString(s.created_by.full_name)),1)])),[[x,e.trans("access_denied_now")]])])]),l("div",_l,[l("b",null,c(e.trans("created_at"))+":",1),b(" "),C((n(),r("span",null,[b(c(o.formattedTime(s.created_at)),1)])),[[x,o.formattedTime(s.created_at)]])])])):u("",!0)])),[[R]]),l("section",null,[i.checkFromWhere()?(n(),r("div",gl,[l("div",pl,[m(g,{id:"isDisplayOnDashboard",name:"isDisplayOnDashboard",value:s.isDisplayOnDashboard,disabled:i.isDisabled,class:D(i.isDisabled?"cursor-none":""),label:e.trans("display_this_filter_on_dashboard"),onChange:i.onChange,classname:"col-sm-12"},null,8,["value","disabled","class","label","onChange"])]),i.isShared?u("",!0):(n(),r("div",bl,[m(g,{id:"isDisplayUnderDefault",name:"isDisplayUnderDefault",value:s.isDisplayUnderDefault,disabled:i.isDisabled,class:D(i.isDisabled?"cursor-none":""),label:e.trans("display_filter_in_sidebar"),onChange:i.onChange,classname:"col-sm-12"},null,8,["value","disabled","class","label","onChange"])]))])):u("",!0),l("div",yl,[l("div",vl,[l("label",kl,c(e.lang("icon_color")),1),s.isDisplayOnDashboard?(n(),r("label",Fl,"*")):u("",!0),m(d,{message:e.lang("dashboard_icon_background_color_hint"),size:"small"},null,8,["message"]),m(F,{id:"dashboard-widget-bg-color",name:"iconColor",color:s.iconColor,disabled:!s.isDisplayOnDashboard&&t.from!=="clientFilter",onColor:i.onChange},null,8,["color","disabled","onColor"])]),m(T,{name:"iconClass",label:e.lang("icon_class"),value:s.iconClass,onChange:i.onChange,classname:"col-md-6",elements:s.iconList,disabled:!s.isDisplayOnDashboard&&t.from!=="clientFilter",multiple:!1,"option-label":"icon_class",required:s.isDisplayOnDashboard,clearable:!1,hint:e.lang("dashboard_icon_class_hint")},null,8,["label","value","onChange","elements","disabled","required","hint"])])]),i.checkFromWhere()&&!s.isDisplayUnderDefault?(n(),r("section",wl,[l("div",Cl,[l("div",Sl,[l("span",null,[l("strong",null,c(e.lang("share_with")+":"),1)]),m(d,{message:e.lang("share_filter_tooltip_message"),size:"small"},null,8,["message"])])]),l("div",Dl,[m(T,{name:"agents",label:e.lang("agents"),value:s.agents,onChange:i.onChange,classname:"col-md-6",apiEndpoint:"/api/dependency/agents",multiple:!0},null,8,["label","value","onChange"]),m(T,{name:"departments",label:e.lang("departments"),value:s.departments,onChange:i.onChange,classname:"col-md-6",apiEndpoint:"/api/dependency/departments",multiple:!0},null,8,["label","value","onChange"])])])):u("",!0),l("section",null,[l("div",Al,[m(V,{label:e.lang("display_order"),value:s.display_order,name:"display_order",classname:"col-sm-6",onChange:i.onChange,placeholder:"n",type:"number",required:!0},null,8,["label","value","onChange"])])])])):(n(),r("div",Tl,[l("span",null,[b("You are about to delete a filter with name "),l("strong",null,c(t.filterName),1),b(" created by you. Please confirm")])]))]),controls:v(()=>[l("div",null,[i.showSave()&&t.mode!=="save"?(n(),r("button",{key:0,type:"button",onClick:a[0]||(a[0]=Z=>i.saveFilter("update")),class:"btn btn-primary"},[Vl,b(" "+c(e.lang("update")),1)])):u("",!0),t.from==="clientFilter"?(n(),r(w,{key:1},[i.showSaveNew()?(n(),r("button",{key:0,type:"button",onClick:a[1]||(a[1]=Z=>i.saveFilter("create")),class:"btn btn-primary"},[Ol,b(" "+c(e.lang("save_as_new")),1)])):u("",!0)],64)):(n(),r(w,{key:2},[t.source==="open_tickets"&&t.mode==="save"?(n(),r("button",{key:0,type:"button",onClick:a[2]||(a[2]=Z=>i.saveFilter("create")),class:"btn btn-primary"},[Il,b(" "+c(e.lang("save")),1)])):u("",!0),i.showSaveAsNew()&&t.source!=="open_tickets"&&t.mode!=="save"?(n(),r("button",{key:1,type:"button",onClick:a[3]||(a[3]=Z=>i.saveFilter("create")),class:"btn btn-primary"},[Pl,b(" "+c(e.lang("save_as_new")),1)])):u("",!0)],64)),i.showDelete()?(n(),r("button",{key:3,type:"button",onClick:a[4]||(a[4]=Z=>i.deleteFilter()),class:"btn btn-danger"},[Ml,b(" "+c(e.lang("delete")),1)])):u("",!0)])]),_:1},8,["onClose"])}const Rl=S(nl,[["render",jl],["__scopeId","data-v-247a8aae"]]);const Ll={name:"time-range-filter",components:{DatePicker:Ue,"date-time-field":_e,"dynamic-select":q},props:{labels:{type:[Array,String],required:!0},identifier:{type:String,required:!0},options:{type:Array,required:!0},value:{required:!0},reset:{type:Boolean,required:!0},isLastNextSelector:{type:Boolean,default:()=>!1}},beforeMount(){this.value&&this.setInitialValue()},mounted(){["created-at","updated-at"].includes(this.identifier)?this.notAfter=this.presentTime:this.identifier==="due-on"&&(this.notBefore=this.presentTime)},data(){return{measure:null,isDatePicker:!1,timeUnit:null,timeRange:null,nextOrLast:"last",unitListArr:this.options,notBefore:this.presentTime,notAfter:this.presentTime,dateTimeFormat:"YYYY-MM-DD HH:mm:ss",presentTime:A().format(this.dateTimeFormat)}},methods:{onValueChange(){Number(this.measure)>0&&this.timeUnit?this.saveUserInput():this.emitEmptyValue()},onDatePickerConfirm(){if(!this.timeRange)return;let e={};const a="date::"+this.timeRange.map(t=>A(t).format(this.dateTimeFormat)).join("~");e[this.identifier]=a,this.eventEmitter("selected",{data:e,isTimeRangeFilter:!0})},eventEmitter(e,a){this.$emit(e,a)},saveUserInput(){let e={};e[this.identifier]=this.getPrefixText()+this.measure+"~"+this.timeUnit,this.eventEmitter("selected",{data:e,isTimeRangeFilter:!0})},getPrefixText(){let e=this.identifier==="due-on"?"next::":"last::";return this.isLastNextSelector&&(e=this.nextOrLast+"::"),e},setInitialValue(){let e={};e[this.identifier]=this.value,this.eventEmitter("selected",{data:e,isTimeRangeFilter:!0});const a=this.value.split("::");if(a[0]==="date")this.isDatePicker=!0,this.timeRange=a[1].split("~").map(t=>new Date(t));else{this.isDatePicker=!1;const t=a[1].split("~");this.measure=t[0],this.timeUnit=t[1]}},onClearField(){this.isDatePicker?this.timeRange=null:(this.measure=null,this.timeUnit=null),this.emitEmptyValue()},emitEmptyValue(){let e={};e[this.identifier]=void 0,this.eventEmitter("selected",{data:e,isTimeRangeFilter:!0})},allowPositiveNumberOnly(e){const a=e.which||e.keyCode;if(a>31&&(a<48||a>57))e.preventDefault();else return!0}},computed:{fieldCanBeCleared:function(){return this.isDatePicker&&this.timeRange}},watch:{reset(e){e&&(this.measure=null,this.isDatePicker=!1,this.timeUnit=null,this.timeRange=null)}}},El={class:"col-sm-4 main-container"},Bl={key:0},Ul={class:"input-group"},ql={value:"last",selected:""},Nl={value:"next"},Yl=["value"],xl={key:0,class:"fas fa-pencil-alt",title:"Enter by hand","aria-hidden":"true"},Hl={key:1,class:"far fa-calendar",title:"Use datepicker","aria-hidden":"true"};function zl(e,a,t,o,s,i){const f=p("date-picker");return n(),r("div",El,[t.labels?(n(),r("label",Bl,[b(c(s.isDatePicker?e.lang(t.labels[1]):e.lang(t.labels[0]))+" ",1),i.fieldCanBeCleared?(n(),r("i",{key:0,onClick:a[0]||(a[0]=(...h)=>i.onClearField&&i.onClearField(...h)),class:"fa fa-times clear-btn",title:"Clear","aria-hidden":"true"})):u("",!0)])):u("",!0),l("div",Ul,[!s.isDatePicker&&t.isLastNextSelector?C((n(),r("select",{key:0,class:"form-control last-next-width","onUpdate:modelValue":a[1]||(a[1]=h=>s.nextOrLast=h),onChange:a[2]||(a[2]=h=>i.onValueChange())},[l("option",ql,c(e.lang("last")),1),l("option",Nl,c(e.lang("next")),1)],544)),[[me,s.nextOrLast]]):u("",!0),s.isDatePicker?u("",!0):C((n(),r("input",{key:1,onInput:a[3]||(a[3]=h=>i.onValueChange()),placeholder:"n",type:"number",onKeypress:a[4]||(a[4]=(...h)=>i.allowPositiveNumberOnly&&i.allowPositiveNumberOnly(...h)),class:"form-control measure-input hide-number-spinner","onUpdate:modelValue":a[5]||(a[5]=h=>s.measure=h),"aria-label":"..."},null,544)),[[ae,s.measure]]),s.isDatePicker?u("",!0):C((n(),r("select",{key:2,class:"form-control","onUpdate:modelValue":a[6]||(a[6]=h=>s.timeUnit=h),onChange:a[7]||(a[7]=h=>i.onValueChange())},[(n(!0),r(w,null,I(s.unitListArr,h=>(n(),r("option",{key:h.id,value:h.id},c(e.lang(h.value)),9,Yl))),128))],544)),[[me,s.timeUnit]]),C(m(f,{value:s.timeRange,"onUpdate:value":a[8]||(a[8]=h=>s.timeRange=h),"time-picker-options":{start:"00:00",step:"00:30",end:"23:30"},"not-before":s.notBefore,"not-after":s.notAfter,onConfirm:a[9]||(a[9]=h=>i.onDatePickerConfirm()),"input-class":"form-control cust-datepicker",format:s.dateTimeFormat,lang:"en",type:"datetime",placeholder:e.lang("enter_time_range"),clearable:!1,confirm:"",range:"","range-separator":"~"},null,8,["value","not-before","not-after","format","placeholder"]),[[se,s.isDatePicker]]),l("button",{class:"btn btn-default range_btn",type:"button",onClick:a[10]||(a[10]=h=>s.isDatePicker=!s.isDatePicker)},[s.isDatePicker?(n(),r("i",xl)):(n(),r("i",Hl))])])])}const Kl=S(Ll,[["render",zl],["__scopeId","data-v-6ca859a1"]]);const Wl={name:"radio-field",props:{name:{type:String,required:!0},label:{type:String,required:!0},hint:{type:String,default:""},options:{type:Array,required:!0},required:{type:Boolean,default:!1},onChange:{type:Function,Required:!0},value:{type:[String,Object],default:""},labelStyle:{type:Object,default:()=>{}},isInlineForm:{type:Boolean,default:!1},rules:{type:String,default:""},from:{type:String,default:""},tipRule:{type:[Number,Boolean],default:!1}},data:()=>({selectedValue:""}),mounted(){this.selectedValue=M(this.value)?this.value:""},watch:{value(e){this.selectedValue=M(e)?e:""}},methods:{getUniqueName(e=""){return e+"__"+Math.floor(Math.random()*1e5)},onInput(e){this.from?this.onChange(e,this.name):this.onChange(e,this.label)}},components:{"form-field-template":le}},Gl={class:"row"},Xl={class:"control-label"},Ql=["value","name"];function Jl(e,a,t,o,s,i){const f=p("ValidationProvider"),h=p("form-field-template");return n(),k(h,{name:t.name,label:t.label,hint:t.hint,required:t.required,labelStyle:t.labelStyle,isInlineForm:t.isInlineForm,tipRule:t.tipRule},{default:v(()=>[l("div",Gl,[m(f,{name:t.name,rules:t.rules,class:"row",tag:"div",modelValue:e.selectedValue,"onUpdate:modelValue":a[2]||(a[2]=y=>e.selectedValue=y)},{default:v(({field:y,errorMessage:g,meta:d,classes:F})=>[(n(!0),r(w,null,I(t.options,T=>(n(),r("div",{class:"col-md-4 form-radio",key:T.id},[l("label",Xl,[C(l("input",{type:"radio",class:D(["form-check-input",g?"field-danger":""]),"onUpdate:modelValue":a[0]||(a[0]=V=>e.selectedValue=V),value:T,name:i.getUniqueName(T.form_identifier),onChange:a[1]||(a[1]=V=>i.onInput(e.selectedValue))},null,42,Ql),[[qe,e.selectedValue]]),b(" "+c(T.label),1)])]))),128)),C(l("div",{class:"error-block is-danger col-md-12"},c(g),513),[[se,g]])]),_:1},8,["name","rules","modelValue"])])]),_:1},8,["name","label","hint","required","labelStyle","isInlineForm","tipRule"])}const Zl=S(Wl,[["render",Jl],["__scopeId","data-v-b38be859"]]);const $l={name:"checkbox-field",props:{name:{type:String,required:!0},label:{type:String,required:!0},hint:{type:String,default:""},options:{type:Array,required:!0},required:{type:Boolean,default:!1},onChange:{type:Function,Required:!0},value:{type:[Array,String],default:""},labelStyle:{type:Object,default:()=>{}},isInlineForm:{type:Boolean,default:!1},rules:{type:String,default:""},from:{type:String,default:""},tipRule:{type:[Number,Boolean],default:!1}},data:()=>({selectedValue:[]}),mounted(){this.selectedValue=M(this.value)?this.value:[]},watch:{value(e){this.selectedValue=M(e)?e:[]}},methods:{getUniqueName(e=""){return e+"__"+Math.floor(Math.random()*1e5)},onInput(e){this.from?this.onChange(e,this.name):this.onChange(e,this.label)}},components:{"form-field-template":le}},en={class:"row"},tn={class:"control-label"},an=["id","value","name"];function sn(e,a,t,o,s,i){const f=p("ValidationProvider"),h=p("form-field-template");return n(),k(h,{name:t.name,label:t.label,hint:t.hint,required:t.required,labelStyle:t.labelStyle,isInlineForm:t.isInlineForm,tipRule:t.tipRule},{default:v(()=>[l("div",en,[m(f,{name:t.name,rules:t.rules,class:"row",tag:"div",modelValue:e.selectedValue,"onUpdate:modelValue":a[2]||(a[2]=y=>e.selectedValue=y)},{default:v(({field:y,errorMessage:g,meta:d,classes:F})=>[(n(!0),r(w,null,I(t.options,T=>(n(),r("div",{class:"col-md-4 form-checkbox",key:T.id},[l("label",tn,[C(l("input",{type:"checkbox",class:D(["form-check-input",g?"field-danger":""]),id:T.form_identifier,"onUpdate:modelValue":a[0]||(a[0]=V=>e.selectedValue=V),value:T,name:i.getUniqueName(T.form_identifier),onChange:a[1]||(a[1]=V=>i.onInput(e.selectedValue))},null,42,an),[[re,e.selectedValue]]),b(" "+c(T.label),1)])]))),128)),C(l("div",{class:"error-block is-danger col-md-12"},c(g),513),[[se,g]])]),_:1},8,["name","rules","modelValue"])])]),_:1},8,["name","label","hint","required","labelStyle","isInlineForm","tipRule"])}const ln=S($l,[["render",sn],["__scopeId","data-v-be3c9ef5"]]),nn={name:"custom-form-fields",props:{formField:{type:Object,required:!0},allFields:{type:Array,default:()=>[]}},data(){return{selectedVal:this.formField.value,uniqueId:this.formField.key,updatedFields:this.allFields,dropdownOptions:[],dropdownLabel:"label",country_code:null,showMobileField:!1}},watch:{allFields(e,a){this.updatedFields=e},formField(e,a){this.uniqueId=e.key,this.selectedVal=e.value,e.data_type==="checkbox"&&(this.selectedVal=this.selectedVal.split(",")),e.data_type==="mobile"&&this.selectedVal&&this.selectedVal.includes(" ")&&(this.selectedVal=this.selectedVal.split(" ")[1])}},beforeMount(){(this.formField.data_type==="select"||this.formField.data_type==="select"&&this.formField.title==="Api")&&this.getSelectFieldOptions(),this.formField.data_type==="mobile"&&this.formField.value&&this.formField.value.includes(" ")?(this.country_code=this.formField.value.split(" ")[0],this.showMobileField=!0):this.showMobileField=!0},computed:{apiInfoUrl(){let e=ue.convertStringOfPropertiesToObject(this.formField.api_info).url;return!e&&this.formField.api_info&&(e=this.formField.api_info),e},dropdownKey(){return ue.convertStringOfPropertiesToObject(this.formField.api_info).key||"label"},selectedValue(){let e=this.updatedFields.findIndex(a=>a.key==this.uniqueId);if(e!=-1){if(this.formField.data_type==="mobile"&&this.selectedVal&&this.selectedVal.includes(" "))return this.selectedVal.split(" ")[1];if(Array.isArray(this.selectedVal)&&this.selectedVal!=null){let a=[];return this.selectedVal.forEach(t=>{typeof t=="object"?a.push(t.label):a.push(t)}),this.updatedFields[e].value=a.map(t=>t).toString(),this.updatedFields[e].options.filter(t=>a.includes(t.label))}else if(M(this.updatedFields[e].options)){let a="";return typeof this.selectedVal=="object"?a=this.selectedVal.label:a=this.selectedVal,this.updatedFields[e].options.find(t=>t.label===a)}else return this.selectedVal?this.selectedVal:""}else return this.selectedVal}},methods:{keypressEvent(e,a,t){if(t==="number"||t==="mobile"){e=e||window.event;var o=e.which?e.which:e.keyCode;if(o>31&&(o<48||o>57))e.preventDefault();else return!0}else if(t==="float"||t==="decimal"){e=e||window.event;var o=e.which?e.which:e.keyCode,s=e.target.value;if(o==46&&s.indexOf(".")!==-1||o==46&&s.length===0)e.preventDefault();else{if(o>=48&&o<=57||o==46)return!0;e.preventDefault()}}},pasteEvent(e,a,t){if(t==="number"||t==="mobile")e=e||window.event,e.clipboardData.getData("Text").match(/[^\d]/)&&e.preventDefault();else if(t==="float"||t==="decimal"){e=e||window.event;var o=e.clipboardData||window.clipboardData,s=o.getData("Text");/^[-]?\d*\.?\d*$/.test(s)||e.preventDefault()}},onCountryCodeUpdate(e,a){this[a]=e},getSelectFieldOptions(){M(this.apiInfoUrl)?this.formField.title==="Api"?(this.dropdownLabel=this.dropdownKey,O.get(this.apiInfoUrl).then(e=>{this.dropdownOptions=e.data}).catch(e=>{console.error(e)})):this.fetchOptionListForApiField():(this.dropdownOptions=this.formField.options,this.dropdownLabel="label")},fetchOptionListForApiField(){O.get(this.apiInfoUrl).then(e=>{this.dropdownLabel=this.dropdownKey;let a=e.data;for(let t in a)a[t][this.dropdownLabel]=a[t][this.dropdownLabel].toString();this.dropdownOptions=a}).catch(e=>{this.dropdownOptions=[]})},onChange(e,a){let t=this.updatedFields.findIndex(o=>o.key===a);Array.isArray(e)&&e!=null?(this.updatedFields[t].value=e.map(o=>o.label).toString(),this.selectedVal=e):typeof e=="object"&&e!=null?(this.updatedFields[t].value=e[this.dropdownLabel],this.selectedVal=e):this.formField.data_type==="mobile"?(this.updatedFields[t].value=e?this.country_code+" "+e:"",this.selectedVal=e?this.country_code+" "+e:""):(this.updatedFields[t].value=e||"",this.selectedVal=e||""),this.$emit("updated",this.updatedFields)}},components:{"dynamic-select":q,"text-field":X,"radio-field":Zl,"checkbox-field":ln,"date-time-field":_e,MobileField:we}};function rn(e,a,t,o,s,i){const f=p("date-time-field"),h=p("dynamic-select"),y=p("text-field"),g=p("radio-field"),d=p("checkbox-field"),F=p("MobileField");return n(),r("div",null,[t.formField.data_type==="date"?(n(),k(f,{key:0,type:"datetime",label:t.formField.label,value:i.selectedValue,id:t.formField.key,required:!1,name:t.formField.key,onChange:i.onChange,format:"MMMM DD YYYY HH:mm",clearable:!0,outputFormat:"YYYY-MM-DD HH:mm:ss"},null,8,["label","value","id","name","onChange"])):u("",!0),t.formField.data_type==="select"&&t.formField.title!=="Api"?(n(),k(h,{key:1,id:t.formField.key,label:t.formField.label,multiple:!1,name:t.formField.key,apiEndpoint:i.apiInfoUrl,value:i.selectedValue,onChange:i.onChange,optionLabel:s.dropdownLabel},null,8,["id","label","name","apiEndpoint","value","onChange","optionLabel"])):u("",!0),t.formField.data_type==="select"&&t.formField.title==="Api"?(n(),k(h,{key:2,id:t.formField.key,label:t.formField.label,multiple:!1,name:t.formField.key,elements:s.dropdownOptions,value:i.selectedValue,onChange:i.onChange,optionLabel:s.dropdownLabel,strlength:75,fieldUniqueName:t.formField.key,labelLength:25},null,8,["id","label","name","elements","value","onChange","optionLabel","fieldUniqueName"])):u("",!0),t.formField.data_type==="text"||t.formField.data_type==="textarea"||t.formField.data_type==="number"||t.formField.data_type==="decimal"||t.formField.data_type==="email"?(n(),k(y,{key:3,id:t.formField.key,label:t.formField.label,type:t.formField.data_type,name:t.formField.key,value:i.selectedValue,onChange:i.onChange,from:"filter",keypressEvt:i.keypressEvent,pasteEvt:i.pasteEvent},null,8,["id","label","type","name","value","onChange","keypressEvt","pasteEvt"])):u("",!0),t.formField.data_type==="radio"?(n(),k(g,{key:4,name:t.formField.key,label:t.formField.label,options:t.formField.options,value:i.selectedValue,onChange:i.onChange,from:"filter"},null,8,["name","label","options","value","onChange"])):u("",!0),t.formField.data_type==="checkbox"?(n(),k(d,{key:5,name:t.formField.key,label:t.formField.label,options:t.formField.options,value:i.selectedValue,onChange:i.onChange,from:"filter"},null,8,["name","label","options","value","onChange"])):u("",!0),s.showMobileField&&t.formField.data_type==="mobile"?(n(),k(F,{key:6,id:t.formField.key,label:t.formField.label,type:t.formField.data_type,name:t.formField.key,value:i.selectedValue,onChange:i.onChange,isInlineForm:!1,countryCode:s.country_code,onCountryCode:a[0]||(a[0]=T=>i.onCountryCodeUpdate(T,"country_code")),keypressEvt:i.keypressEvent,pasteEvt:i.pasteEvent,extensionEnabled:0,ext:[]},null,8,["id","label","type","name","value","onChange","countryCode","keypressEvt","pasteEvt"])):u("",!0)])}const on=S(nn,[["render",rn]]);const dn={props:{isApplyOnlyMode:{type:Boolean,default:!1},prefilledFilterObject:{type:Object,default:()=>{}},filterDependenciesApiEndpoint:{type:String,default:""},iconClass:{type:String,default:"fas fa-filter"},showFilter:{type:Boolean,default:!0},closeFilterView:{type:Function,default:()=>{}},from:{type:String,default:""},isEditMode:{type:Boolean,default:!1},selectedId:{type:[String,Number],default:0},divId:{type:String,default:""},totalFilters:{type:Number,default:0},filterNumber:{type:[String,Number],default:""}},data(){return{booleanFilters:[{id:1,text:"Yes"},{id:0,text:"No"}],ratingImpactFilters:[{id:"positive",text:"Positive"},{id:"negative",text:"Negative"},{id:"neutral",text:"Neutral"}],slaMetFilters:[{id:"met",text:"Met"},{id:"notmet",text:"Not met"},{id:"pending",text:"Pending"}],categoryFilterValue:[{id:"all",text:this.trans("all")},{id:"inbox",text:this.trans("inbox")},{id:"mytickets",text:this.trans("mytickets")},{id:"unassigned",text:this.trans("unassigned")},{id:"overdue",text:this.trans("overdue")},{id:"unapproved",text:this.trans("unapproved")},{id:"waiting-for-approval",text:this.trans("waiting-for-approval")},{id:"closed",text:this.trans("closed")},{id:"deleted",text:this.trans("deleted")},{id:"spam",text:this.trans("spam")}],categoryClientFilterValue:[{id:"all",text:this.trans("all")},{id:"inbox",text:this.trans("open")},{id:"closed",text:this.trans("closed")},{id:"deleted",text:this.trans("deleted")},{id:"waiting-for-approval",text:this.trans("waiting-for-approval")}],filter:{},customFieldFilters:[],isRtl:!0,loading:!1,filterObjects:{},selectedFilter:this.selectedId,showFilterPopUp:!1,filterName:"",filterMode:"",departments:[],agents:[],reset:!1,filterId:"",timeFilterOptions:[{id:"minute",value:"unit_minute"},{id:"hour",value:"unit_hour"},{id:"day",value:"unit_day"},{id:"month",value:"unit_month"}],dashboardConfig:{displayOnDashboard:!1,isDisplayUnderDefault:!1,iconColor:"#00C0EF",iconClass:{icon_class:"fas fa-ticket"},created_by:[],created_at:"",canViewCreatorProfile:!0,display_order:""},appendLoad:!1,isDefaultFilter:!1,isDeleteable:!1,source:"",refreshFilter:!1,selectedFilterId:""}},computed:{showRatingFilter(){let a=window.location.pathname.split("/");return a[a.length-3]!="reports"}},beforeMount(){this.openFilter()},mounted(){this.handleTooltip()},created(){window.emitter.on("performApplyAction",this.applyFilter),window.emitter.on("updateFilterApi",this.closeFilter)},methods:{updatedCustomFields(e){this.customFieldFilters=e},closeFilter(){this.closeFilterView()},handleTooltip(){setTimeout(()=>{$(".ticket-filter").tooltip(),this.$store.state.auth.user.user_language=="ar"&&(this.isRtl=!1)},2e3)},toggleFilterPopUp(e,a){this.filterMode=="delete"&&!a&&(this.filterObjects={},this.filter={},this.filterName="",this.selectedFilter=0,this.resetDashboardConfig(),this.resetFilter()),this.showFilterPopUp=e},getTicketFilterById(e){this.loading=!0,this.resetFilter();let a=M(e)?"/api/agent/ticket-filter/"+e:"/api/agent/filter-dependencies";this.filterDependenciesApiEndpoint&&(a=this.filterDependenciesApiEndpoint);let t={};!M(e)&&(t=this.getParamsFromUrl(),!t)||(typeof this.prefilledFilterObject<"u"&&(t=this.prefilledFilterObject),O.get(a,{params:t}).then(o=>{let s={};typeof this.prefilledFilterObject<"u"&&(this.customFieldFilters=[]);let i=[];o.data.data.fields.map(f=>{f.key.indexOf("custom_")!==-1?i.push(f):(this.from==="clientFilter"&&f.key==="category"&&f.value==="inbox"&&(f.value_meta={id:"inbox",text:"Open"}),s[f.key]=f.value_meta)}),i.length?this.appendCustomFieldFilter(i):this.loading=!1,this.filterObjects=s,M(e)&&!this.filterDependenciesApiEndpoint&&(this.selectedFilter=o.data.data.id,this.filterName=this.trans(o.data.data.name),this.departments=o.data.data.departments,this.agents=o.data.data.agents,this.dashboardConfig.displayOnDashboard=o.data.data.display_on_dashboard,this.dashboardConfig.isDisplayUnderDefault=o.data.data.display_on_navigation_bar,this.dashboardConfig.created_by=o.data.data.created_by[0],this.dashboardConfig.created_at=o.data.data.created_at,this.dashboardConfig.canViewCreatorProfile=o.data.data.canViewCreatorProfile,this.dashboardConfig.display_order=o.data.data.display_order,o.data.data.icon_class?(this.dashboardConfig.iconClass.icon_class=o.data.data.icon_class,this.dashboardConfig.iconColor=o.data.data.icon_color):this.resetDashboardConfig(),this.isDefaultFilter=!!o.data.data.is_default,this.isDeleteable=!!o.data.data.is_deletable,this.source=o.data.data.source)}).catch(o=>{this.loading=!1,P(o)}))},getParamsFromUrl(){try{let e=location.search.substring(1);return JSON.parse('{"'+decodeURI(e).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"').replace(/%2F/g,"/")+'"}')}catch{return{}}},appendCustomFieldFilter(e){this.$refs.custom_filter.valuesInEdit=e,setTimeout(()=>{this.loading=!1},1e3)},saveFilter(e){this.filterMode=e,this.customFieldFilters.map(a=>{a.value&&(this.filterObjects["custom_"+a.id]=a.value)}),this.showFilterPopUp=!0},updateFilter(e){this.filterObjects[Object.keys(e)[0]]=e[Object.keys(e)[0]]},onChange(e,a){this[a]=e},openFilter(){let e=ne(this.currentPath());this.selectedFilterId=this.filterNumber?this.filterNumber:e,this.isEditMode&&(e=this.selectedFilter),this.getTicketFilterById(e)},resetDashboardConfig(){this.dashboardConfig.displayOnDashboard=!1,this.dashboardConfig.isDisplayUnderDefault=!1,this.dashboardConfig.iconClass={icon_class:"fas fa-ticket"},this.dashboardConfig.iconColor="#00C0EF",this.dashboardConfig.created_by=[],this.dashboardConfig.created_at="",this.dashboardConfig.display_order=""},visibleLoader(e){this.appendLoad=e},resetFilter(){this.reset=!0,this.filter={},this.filterObjects={},this.agents=[],this.departments=[],this.customFieldFilters.map(e=>{e.value=""}),setTimeout(()=>{this.reset=!1},2e3)},filtervalue(e){if(e.isTimeRangeFilter){const t=e.data;for(const o in t)t.hasOwnProperty(o)&&(this.filter[o]=t[o],this.filterObjects[o]=t[o])}else for(var a in e)this.filter[a]=e[a]},applyFilter(e=!1){this.customFieldFilters.length>0?(this.customFieldFilters.map(a=>{let t=typeof a.value=="string"?a.value.trim():a.value;this.filter["custom_"+a.id]=t}),this.$emit("filter",this.filter,e)):(this.filter.category==""&&this.filter.category==[],this.$emit("filter",this.filter,e,!0))},getUpdatedFilter(e){this.filter=e},getCustomFields(e){this.customFieldFilters=e}},watch:{refreshFilter(e,a){e===!0&&this.openFilter(),this.refreshFilter=!1}},components:{"common-api-filter":Pi,"common-filter":Bi,"custom-field-filter":il,"save-filter":Rl,"time-range-filter":Kl,"custom-form-fields":on}},U=e=>(E("data-v-66d5d02f"),e=e(),B(),e),cn={class:"inbox-tic-filter"},un={class:"card card-light"},hn={class:"card-header"},mn={class:"card-title"},fn=["id"],_n={key:0,class:"row"},gn={class:"row"},pn={class:"row"},bn={class:"row"},yn={class:"row"},vn={class:"row"},kn={class:"row"},Fn={class:"row"},wn={class:"row"},Cn={class:"row"},Sn=U(()=>l("hr",null,null,-1)),Dn={class:"row"},An={class:"row"},Tn={key:1,class:"hr"},Vn={key:2,class:"row"},On={class:"col-sm-4"},In={key:3,class:"row"},Pn={class:"card-footer"},Mn={key:0},jn=U(()=>l("i",{class:"fas fa-save","aria-hidden":"true"},null,-1)),Rn={key:1},Ln=U(()=>l("i",{class:"fas fa-sync","aria-hidden":"true"},null,-1)),En=U(()=>l("i",{class:"fas fa-check","aria-hidden":"true"},null,-1)),Bn=U(()=>l("i",{class:"fas fa-save","aria-hidden":"true"},null,-1)),Un={key:0},qn=U(()=>l("i",{class:"fas fa-save","aria-hidden":"true"},null,-1)),Nn={key:1},Yn=U(()=>l("span",{class:"fas fa-sync"},null,-1)),xn=U(()=>l("i",{class:"fas fa-trash","aria-hidden":"true"},null,-1)),Hn=U(()=>l("i",{class:"fas fa-undo","aria-hidden":"true"},null,-1)),zn=U(()=>l("i",{class:"fas fa-times","aria-hidden":"true"},null,-1));function Kn(e,a,t,o,s,i){const f=p("custom-loader"),h=p("custom-field-filter"),y=p("save-filter"),g=p("common-api-filter"),d=p("common-filter"),F=p("time-range-filter"),T=p("custom-form-fields");return n(),r("div",cn,[s.loading?(n(),k(f,{key:0})):u("",!0),l("div",un,[l("div",hn,[l("h3",mn,c(e.lang("apply_filter")),1),m(h,{selectedFilters:s.customFieldFilters,onCustom:i.getCustomFields,customFilters:s.filter,updatedFieldValues:i.getUpdatedFilter,ref:"custom_filter",showLoader:i.visibleLoader,filterId:s.selectedFilterId},null,8,["selectedFilters","onCustom","customFilters","updatedFieldValues","showLoader","filterId"]),s.showFilterPopUp?(n(),k(y,{key:0,filterName:s.filterName,filterValues:s.filter,filterObjects:s.filterObjects,filterId:s.selectedFilter,toggleFilterPopUp:i.toggleFilterPopUp,mode:s.filterMode,intitialDepartments:s.departments,initialAgents:s.agents,postFilterSaveAction:i.applyFilter,"dashboard-config":s.dashboardConfig,from:t.from,totalFilters:t.totalFilters,source:s.source},null,8,["filterName","filterValues","filterObjects","filterId","toggleFilterPopUp","mode","intitialDepartments","initialAgents","postFilterSaveAction","dashboard-config","from","totalFilters","source"])):u("",!0)]),l("div",{class:"card-body",id:t.divId},[t.showFilter?(n(),r(w,{key:0},[t.from==="clientFilter"?(n(),r("div",_n,[m(g,{label:e.lang("ticket_id-subject"),api:"tickets",base:"dependency",reset:s.reset,keyname:"ticket-ids",onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects["ticket-ids"]},null,8,["label","reset","onSelected","updateFilter","value"]),m(g,{label:e.lang("requester"),api:"users",meta:!0,keyname:"owner-ids",reset:s.reset,base:"dependency",onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects["owner-ids"]},null,8,["label","reset","onSelected","updateFilter","value"]),m(d,{label:e.lang("category"),filterArray:s.categoryClientFilterValue,keyname:"category",reset:s.reset,onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects.category},null,8,["label","filterArray","reset","onSelected","updateFilter","value"]),m(g,{label:e.lang("status"),api:"statuses?client_visibility=1&client_filter=1",keyname:"status-ids",base:"dependency",reset:s.reset,meta:!0,onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects["status-ids"]},null,8,["label","reset","onSelected","updateFilter","value"]),s.loading?u("",!0):(n(),k(F,{key:0,labels:["created_within_last","created_in"],options:s.timeFilterOptions,onSelected:i.filtervalue,identifier:"created-at",value:s.filterObjects["created-at"],reset:s.reset},null,8,["options","onSelected","value","reset"]))])):(n(),r(w,{key:1},[l("div",gn,[m(g,{label:e.lang("ticket_id-subject"),api:"tickets",base:"dependency",reset:s.reset,keyname:"ticket-ids",onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects["ticket-ids"]},null,8,["label","reset","onSelected","updateFilter","value"]),m(g,{label:e.lang("requester"),api:"users",meta:!0,keyname:"owner-ids",reset:s.reset,base:"dependency",onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects["owner-ids"]},null,8,["label","reset","onSelected","updateFilter","value"]),m(d,{label:e.lang("category"),filterArray:s.categoryFilterValue,keyname:"category",reset:s.reset,onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects.category},null,8,["label","filterArray","reset","onSelected","updateFilter","value"])]),l("div",pn,[m(g,{label:e.lang("organization"),api:"organizations",base:"dependency",reset:s.reset,keyname:"organization-ids",onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects["organization-ids"]},null,8,["label","reset","onSelected","updateFilter","value"]),m(g,{label:e.lang("department"),api:"departments",base:"dependency",reset:s.reset,keyname:"dept-ids",onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects["dept-ids"]},null,8,["label","reset","onSelected","updateFilter","value"]),m(g,{label:e.lang("help_topic"),api:"help-topics",base:"dependency",reset:s.reset,keyname:"helptopic-ids",onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects["helptopic-ids"]},null,8,["label","reset","onSelected","updateFilter","value"])]),l("div",bn,[m(g,{label:e.lang("type"),api:"types",base:"dependency",keyname:"type-ids",reset:s.reset,onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects["type-ids"]},null,8,["label","reset","onSelected","updateFilter","value"]),m(g,{label:e.lang("source"),api:"sources",base:"dependency",keyname:"source-ids",reset:s.reset,onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects["source-ids"]},null,8,["label","reset","onSelected","updateFilter","value"]),m(g,{label:e.lang("priority"),api:"priorities",base:"dependency",reset:s.reset,keyname:"priority-ids",onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects["priority-ids"]},null,8,["label","reset","onSelected","updateFilter","value"])]),l("div",yn,[m(g,{label:e.lang("status"),api:"statuses",keyname:"status-ids",base:"dependency",reset:s.reset,meta:!0,onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects["status-ids"]},null,8,["label","reset","onSelected","updateFilter","value"]),m(g,{label:e.lang("labels"),api:"labels?limit-by-status=false",keyname:"label-ids",base:"dependency",reset:s.reset,onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects["label-ids"]},null,8,["label","reset","onSelected","updateFilter","value"]),m(g,{label:e.lang("tags"),api:"tags",base:"dependency",keyname:"tag-ids",reset:s.reset,onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects["tag-ids"]},null,8,["label","reset","onSelected","updateFilter","value"])]),l("div",vn,[m(d,{label:e.lang("is_resolved"),filterArray:s.booleanFilters,keyname:"is-resolved",reset:s.reset,onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects["is-resolved"]},null,8,["label","filterArray","reset","onSelected","updateFilter","value"]),m(d,{label:e.lang("has-resolution-sla-met"),filterArray:s.slaMetFilters,keyname:"has-resolution-sla-met",reset:s.reset,onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects["has-resolution-sla-met"],ref:"has_resolution_sla_met_filter"},null,8,["label","filterArray","reset","onSelected","updateFilter","value"]),m(d,{label:e.lang("has-response-sla-met"),filterArray:s.slaMetFilters,keyname:"has-response-sla-met",reset:s.reset,onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects["has-response-sla-met"],ref:"has_response_sla_met_filter"},null,8,["label","filterArray","reset","onSelected","updateFilter","value"])]),l("div",kn,[m(d,{label:e.lang("is_assigned_agent"),filterArray:s.booleanFilters,keyname:"assigned_agent",reset:s.reset,onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects.assigned_agent},null,8,["label","filterArray","reset","onSelected","updateFilter","value"]),m(d,{label:e.lang("is_assigned_team"),filterArray:s.booleanFilters,keyname:"assigned_team",reset:s.reset,onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects.assigned_team},null,8,["label","filterArray","reset","onSelected","updateFilter","value"]),m(d,{label:e.lang("is_answered"),filterArray:s.booleanFilters,keyname:"answered",reset:s.reset,onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects.answered},null,8,["label","filterArray","reset","onSelected","updateFilter","value"])]),l("div",Fn,[m(d,{label:e.lang("is_reopened"),filterArray:s.booleanFilters,keyname:"reopened",reset:s.reset,onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects.reopened},null,8,["label","filterArray","reset","onSelected","updateFilter","value"]),m(g,{label:e.lang("creator"),api:"users",meta:!0,base:"dependency",reset:s.reset,keyname:"creator-ids",onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects["creator-ids"]},null,8,["label","reset","onSelected","updateFilter","value"]),m(g,{label:e.lang("assigned_to_agent"),meta:!0,api:"agents",base:"dependency",reset:s.reset,keyname:"assignee-ids",onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects["assignee-ids"]},null,8,["label","reset","onSelected","updateFilter","value"])]),l("div",wn,[m(g,{label:e.lang("assigned_to_team"),api:"teams",base:"dependency",reset:s.reset,keyname:"team-ids",onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects["team-ids"]},null,8,["label","reset","onSelected","updateFilter","value"]),m(g,{label:e.lang("location"),api:"locations",base:"dependency",reset:s.reset,keyname:"location-ids",onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects["location-ids"]},null,8,["label","reset","onSelected","updateFilter","value"]),m(g,{label:e.lang("sla_plan"),api:"sla-plans",base:"dependency",reset:s.reset,keyname:"sla-plan-ids",onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects["sla-plan-ids"]},null,8,["label","reset","onSelected","updateFilter","value"])]),l("div",Cn,[m(g,{label:e.lang("collaborator"),api:"users",meta:!0,base:"dependency",reset:s.reset,keyname:"collaborator-ids",onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects["collaborator-ids"]},null,8,["label","reset","onSelected","updateFilter","value"]),Sn,s.loading?u("",!0):(n(),k(F,{key:0,labels:["created_within_last","created_in"],options:s.timeFilterOptions,onSelected:i.filtervalue,identifier:"created-at",value:s.filterObjects["created-at"],reset:s.reset},null,8,["options","onSelected","value","reset"])),s.loading?u("",!0):(n(),k(F,{key:1,labels:["modified_within_last","modified_in"],options:s.timeFilterOptions,onSelected:i.filtervalue,identifier:"updated-at",value:s.filterObjects["updated-at"],reset:s.reset},null,8,["options","onSelected","value","reset"]))]),l("div",Dn,[s.loading?u("",!0):(n(),k(F,{key:0,labels:["due_within_next","due_in"],options:s.timeFilterOptions,onSelected:i.filtervalue,identifier:"due-on",value:s.filterObjects["due-on"],reset:s.reset},null,8,["options","onSelected","value","reset"])),i.showRatingFilter?(n(),r(w,{key:1},[m(g,{label:e.trans("ticket_filter_rating"),api:"rating-types",base:"dependency",keyname:"rating_ids",onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects.rating_ids,reset:s.reset},null,8,["label","onSelected","updateFilter","value","reset"]),m(d,{label:e.trans("ticket_filter_rating_impact"),filterArray:s.ratingImpactFilters,keyname:"rating_impact",reset:s.reset,onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects.rating_impact},null,8,["label","filterArray","reset","onSelected","updateFilter","value"])],64)):u("",!0)]),l("div",An,[m(g,{label:e.lang("forms"),api:"forms",base:"ticket",reset:s.reset,keyname:"form_category_ids",onSelected:i.filtervalue,updateFilter:i.updateFilter,value:s.filterObjects.form_category_ids},null,8,["label","reset","onSelected","updateFilter","value"])])],64))],64)):u("",!0),s.customFieldFilters.length>0?(n(),r("hr",Tn)):u("",!0),s.reset?u("",!0):(n(),r("div",Vn,[(n(!0),r(w,null,I(s.customFieldFilters,(V,L)=>(n(),r("div",On,[m(T,{formField:V,allFields:s.customFieldFilters,onUpdated:i.updatedCustomFields,key:"index"},null,8,["formField","allFields","onUpdated"])]))),256))])),s.reset?(n(),r("div",In,[m(f)])):u("",!0)],8,fn),l("div",Pn,[t.from==="clientFilter"?(n(),r("button",{key:0,id:"edit-filter",type:"button",onClick:a[0]||(a[0]=V=>i.saveFilter()),class:"btn btn-primary"},[t.isEditMode?(n(),r("span",Rn,[Ln,b(" "+c(e.lang("update")),1)])):(n(),r("span",Mn,[jn,b(" "+c(e.lang("save")),1)]))])):(n(),r(w,{key:1},[l("button",{id:"apply-filter",type:"button",onClick:a[1]||(a[1]=V=>i.applyFilter(!0)),class:"btn btn-primary"},[En,b(" "+c(e.lang("apply")),1)]),!t.isApplyOnlyMode&&s.source==="open_tickets"?(n(),r("button",{key:0,id:"edit-filter",type:"button",onClick:a[2]||(a[2]=V=>i.saveFilter("save")),class:"btn btn-primary"},[l("span",null,[Bn,b(" "+c(e.lang("save")),1)])])):u("",!0),t.isApplyOnlyMode?u("",!0):(n(),r("button",{key:1,id:"edit-filter",type:"button",onClick:a[3]||(a[3]=V=>i.saveFilter()),class:"btn btn-primary"},[s.selectedFilter===0&&!t.isApplyOnlyMode?(n(),r("span",Un,[qn,b(" "+c(e.lang("save")),1)])):(n(),r("span",Nn,[Yn,b("  "+c(e.lang("update")),1)]))])),Ne(e.$slots,"filter-operation-btn-group",{},void 0,!0),s.selectedFilter!==0&&!s.isDefaultFilter&&s.source!=="open_tickets"||s.isDefaultFilter&&s.isDeleteable?(n(),r("button",{key:2,id:"delete-filter",type:"button",onClick:a[4]||(a[4]=V=>i.saveFilter("delete")),class:"btn btn-danger"},[xn,b(" "+c(e.lang("delete")),1)])):u("",!0)],64)),l("button",{id:"reset-filter",type:"button",onClick:a[5]||(a[5]=V=>i.resetFilter()),class:"btn btn-primary"},[Hn,b(" "+c(e.lang("reset")),1)]),l("button",{id:"close-filter",type:"button",onClick:a[6]||(a[6]=V=>i.closeFilter()),class:"btn btn-danger"},[zn,b(" "+c(e.lang("cancel")),1)])])]),s.appendLoad?(n(),k(f,{key:1})):u("",!0)])}const _d=S(dn,[["render",Kn],["__scopeId","data-v-66d5d02f"]]),Wn={props:["data","keyName","colName"],data(){return{href:"href",text:"innerText",tag:"tag",keyVal:this.keyName,keySplits:[]}},beforeMount(){this.keySplits=this.keyName.split(".")},methods:{getAssets(e){return typeof e=="string"?this.$route.name==="User Directory"&&this.keyVal==="labels"?[e]:e.split(","):[]},getRoute(e,a,t){let o=location.pathname.split("/")[location.pathname.split("/").length-2],i=new DOMParser().parseFromString(e,"text/html"),f=i.getElementsByTagName("a"),h=f[f.length-1];return h==null||t=="name"&&(o=="department-performance"||o=="team-performance")||a=="href"&&h[a].includes("department")||a=="href"&&h[a].includes("team")?a=="href"?"":a=="tag"?"span":i.getElementsByTagName("body")[0].innerHTML:a=="href"?h[a].replace(this.basePath(),""):a=="tag"?"a":h[a]}}},Gn={class:"dynamic-hyper-link"},Xn={key:0},Qn={key:0},Jn={key:0},Zn=["innerHTML"],$n={key:0},er=["innerHTML"],tr={key:0},ar={key:0},sr=["innerHTML"],ir={key:0},lr=["innerHTML"],nr={key:1};function rr(e,a,t,o,s,i){const f=p("router-link");return n(),r("span",Gn,[t.data[t.colName]?(n(),r("span",Xn,[s.keySplits[1]?(n(),r(w,{key:0},[t.data[s.keySplits[0]][s.keySplits[1]]?(n(),r("span",Qn,[i.getRoute(t.data[s.keySplits[0]][s.keySplits[1]],s.href,s.keyVal)?(n(),r("span",Jn,[(n(!0),r(w,null,I(i.getAssets(t.data[s.keySplits[0]][s.keySplits[1]]),(h,y)=>(n(),k(f,{key:y,tag:i.getRoute(h,s.tag,s.keyVal),to:i.getRoute(h,s.href,s.keyVal)},{default:v(()=>[l("span",{innerHTML:i.getRoute(h,s.text,s.keyVal)},null,8,Zn),y<i.getAssets(t.data[s.keySplits[0]][s.keySplits[1]]).length-1?(n(),r("span",$n,", ")):u("",!0)]),_:2},1032,["tag","to"]))),128))])):(n(),r("span",{key:1,innerHTML:t.data[s.keySplits[0]][s.keySplits[1]]},null,8,er))])):u("",!0)],64)):(n(),r(w,{key:1},[t.data[s.keySplits[0]]?(n(),r("span",tr,[i.getRoute(t.data[t.keyName],s.href,s.keyVal)?(n(),r("span",ar,[(n(!0),r(w,null,I(i.getAssets(t.data[t.keyName]),(h,y)=>(n(),k(f,{key:y,tag:i.getRoute(h,s.tag,s.keyVal),to:i.getRoute(h,s.href,s.keyVal)},{default:v(()=>[l("span",{innerHTML:i.getRoute(h,s.text,s.keyVal)},null,8,sr),y<i.getAssets(t.data[t.keyName]).length-1?(n(),r("span",ir,", ")):u("",!0)]),_:2},1032,["tag","to"]))),128))])):(n(),r("span",{key:1,innerHTML:t.data[t.keyName]},null,8,lr))])):u("",!0)],64))])):(n(),r("span",nr,"--"))])}const gd=S(Wn,[["render",rr]]),or={name:"data-table-status",description:"Contains active and inactive status",props:{data:{type:Object,required:!0}},methods:{}},dr={class:"btn-group"},cr={id:"status"};function ur(e,a,t,o,s,i){return n(),r("div",dr,[l("a",cr,[l("span",{title:"Status",class:D({"btn btn-success btn-xs pointer_normal":t.data.status,"btn btn-danger btn-xs pointer_normal":!t.data.status}),id:"edit_btn"},c(t.data.status?e.lang("active"):e.lang("inactive")),3)])])}const pd=S(or,[["render",ur]]),hr={name:"user-table-actions",description:"User table edit componnet",props:{data:{type:Object,required:!0}}},mr={class:"user-table-actions"},fr=l("i",{class:"fas fa-edit"},null,-1),_r={key:1,class:"btn-group"},gr={type:"button",class:"btn btn-default table_btn dropdown-toggle","data-toggle":"dropdown"},pr=l("i",{class:"fas fa-eye"},null,-1),br=[pr],yr={class:"dropdown-menu dropdown-menu-right"},vr=["href"],kr=["href"],Fr=["href"],wr=l("i",{class:"fas fa-eye"},null,-1),Cr=[wr],Sr=l("i",{class:"fas fa-edit"},null,-1),Dr={key:1,class:"btn-group"},Ar={type:"button",class:"btn btn-default table_btn dropdown-toggle","data-toggle":"dropdown"},Tr=l("i",{class:"fas fa-eye"},null,-1),Vr=[Tr],Or={class:"dropdown-menu dropdown-menu-right"},Ir=l("i",{class:"fas fa-eye"},null,-1);function Pr(e,a,t,o,s,i){const f=p("router-link"),h=j("tooltip");return n(),r("div",mr,[t.data.from=="admin"?(n(),r(w,{key:0},[t.data.edit_url?C((n(),k(f,{key:0,class:"btn btn-default table_btn",to:t.data.edit_url},{default:v(()=>[fr]),_:1},8,["to"])),[[h,e.lang("edit")]]):u("",!0),t.data.role!="user"?(n(),r("div",_r,[C((n(),r("button",gr,br)),[[h,e.lang("view")]]),l("div",yr,[l("a",{class:"dropdown-item",href:t.data.view_url},c(e.trans("view_user")),9,vr),l("a",{class:"dropdown-item",href:t.data.agent_view_url},c(e.trans("view_agent")),9,kr)])])):u("",!0),t.data.role==="user"?C((n(),r("a",{key:2,class:"btn btn-default table_btn",href:t.data.view_url},Cr,8,Fr)),[[h,e.lang("view")]]):u("",!0)],64)):(n(),r(w,{key:1},[t.data.edit_url?C((n(),k(f,{key:0,class:"btn btn-default table_btn",to:t.data.edit_url},{default:v(()=>[Sr]),_:1},8,["to"])),[[h,e.lang("edit")]]):u("",!0),t.data.role!="user"?(n(),r("div",Dr,[C((n(),r("button",Ar,Vr)),[[h,e.lang("view")]]),l("div",Or,[m(f,{class:"dropdown-item",to:t.data.view_url},{default:v(()=>[b(c(e.trans("view_user")),1)]),_:1},8,["to"]),m(f,{class:"dropdown-item",to:t.data.agent_view_url},{default:v(()=>[b(c(e.trans("view_agent")),1)]),_:1},8,["to"])])])):u("",!0),t.data.role==="user"?C((n(),k(f,{key:2,class:"btn btn-default table_btn",to:t.data.view_url},{default:v(()=>[Ir]),_:1},8,["to"])),[[h,e.lang("view")]]):u("",!0)],64))])}const bd=S(hr,[["render",Pr]]);const Mr={name:"data-table-statuses",description:"Contains active,ban,email,mobile verify and inactive status",props:{data:{type:Object,required:!0}},methods:{}},jr={class:"btn-group"},Rr=["id"];function Lr(e,a,t,o,s,i){const f=j("tooltip");return n(),r("div",jr,[C(l("i",{class:D([["agent","admin"].includes(t.data.role)?"agent":"user",["agent","user"].includes(t.data.role)?"fa-solid fa-user-tie":"fa-solid fa-user-gear"]),id:"email"},null,2),[[f,e.lang(t.data.role)]]),b("   "),C(l("i",{class:D(["fas fa-envelope",{success:t.data.email_verified==1,danger:t.data.email_verified!=1}]),id:"email"},null,2),[[f,t.data.email_verified==1?e.lang("user_email_is_verified"):e.lang("user_email_not_verified")]]),b("   "),C(l("i",{class:D([{success:t.data.mobile_verified==1,danger:t.data.mobile_verified!=1},"fas fa-mobile-alt"]),id:"mobile"},null,2),[[f,t.data.mobile_verified==1?e.lang("user_mobile_is_verified"):e.lang("user_mobile_not_verified")]]),b("   "),C(l("i",{class:D([{success:t.data.is_2fa_enabled==1,danger:t.data.is_2fa_enabled!=1},"fas fa-shield-alt"]),id:"2fa_status_user__"+t.data.id},null,10,Rr),[[f,t.data.is_2fa_enabled==1?e.lang("user_enabled_2fa"):e.lang("user_not_enabled_2fa")]]),b("   ")])}const yd=S(Mr,[["render",Lr]]),Er={name:"advance-filter",description:"",components:{DateTimeField:ze,"dynamic-select":q},props:{metaData:{type:Array,required:!0}},methods:{onChange(e,a){this.selectedFilters[a]=e},onCancel(){this.$emit("selectedFilters","closeEvent")},onApply(){this.$emit("selectedFilters",this.selectedFilters)},onReset(){this.selectedFilters={},this.$emit("selectedFilters","resetEvent")}},data(){return{selectedFilters:{},close_on_select:!this.multiple,isShowFilter:!1,componentMetaData:this.metaData}}},Br={class:"main-div"},Ur={class:"row"},qr={class:"col-md-4"},Nr={class:"card-footer"},Yr=l("span",{class:"fas fa-check"},null,-1),xr=l("span",{class:"fas fa-undo"},null,-1),Hr=l("span",{class:"fas fa-times"},null,-1);function zr(e,a,t,o,s,i){const f=p("date-time-field"),h=p("dynamic-select"),y=p("faveo-box");return n(),r("div",Br,[m(y,{"box-class":"card card-light",title:e.lang("filter")},{actions:v(()=>[l("div",Nr,[l("button",{id:"apply-btn",class:"btn btn-primary",type:"button",onClick:a[0]||(a[0]=(...g)=>i.onApply&&i.onApply(...g))},[Yr,b("  "+c(e.lang("apply")),1)]),l("button",{id:"apply-btn",class:"btn btn-primary single-btn",type:"button",onClick:a[1]||(a[1]=(...g)=>i.onReset&&i.onReset(...g))},[xr,b("  "+c(e.lang("reset")),1)]),l("button",{id:"apply-btn",class:"btn btn-danger single-btn",type:"button",onClick:a[2]||(a[2]=(...g)=>i.onCancel&&i.onCancel(...g))},[Hr,b("  "+c(e.lang("cancel")),1)])])]),default:v(()=>[(n(!0),r(w,null,I(s.componentMetaData,g=>(n(),r("div",Ur,[(n(!0),r(w,null,I(g.section,d=>(n(),r("div",qr,[d.hasOwnProperty("type")&&d.type==="date"?(n(),k(f,{label:d.label,value:d.value,type:"datetime",key:d.name,id:d.name,name:d.name,onChange:i.onChange,range:d.range,required:!1,format:"MMMM DD YYYY, h:mm a",clearable:!1,disabled:!1,editable:!0,currentYearDate:!1,"time-picker-options":d.timeOptions,isDateSelector:!1,confirm:!0},null,8,["label","value","id","name","onChange","range","time-picker-options"])):(n(),k(h,{key:d.name,id:d.name,name:d.name,apiEndpoint:d.url,elements:d.elements,multiple:d.isMultiple,label:e.lang(d.label),value:d.value,onChange:i.onChange,strlength:d.strlength,clearable:!!d.value},null,8,["id","name","apiEndpoint","elements","multiple","label","value","onChange","strlength","clearable"]))]))),256))]))),256))]),_:1},8,["title"])])}const vd=S(Er,[["render",zr]]);function Kr(e){const{first_name:a,email:t,user_name:o,departments:s,agent_tzone:i,last_name:f,ext:h}=e;let y={email:[t,"isRequired","isEmail"],first_name:[a,"isRequired",{"max(250)":"The name must be less than 250 characters long."}],user_name:[o,"isRequired"],departments:[s,"isRequired"],agent_tzone:[i,"isRequired"],last_name:[f,{"max(250)":"The name must be less than 250 characters long."}]};const g=new ee(K),{errors:d,isValid:F}=g.validate(y);return d.hasOwnProperty("user_name")&&d.user_name!=="This field is required"&&(d.user_name="Please type a valid user name"),te.dispatch("setValidationError",d),{errors:d,isValid:F}}const Wr={name:"create-update-agent",description:"Agent create and update page",props:{isCalledFromUserDirectoryPage:{type:Boolean,default:!1}},components:{"text-field":X,"radio-button":ge,"dynamic-select":q,phoneWithCountryCode:Ce,checkbox:be},data:()=>({loading:!0,hasDataPopulated:!1,title:"create_an_agent",iconClass:"fas fa-save",submitButton:"save",agentId:0,first_name:"",last_name:"",user_name:"",email:"",ext:"",phone_number:"",country_code:null,mobile:"",phone_country_code:null,phone_iso:"",role:"admin",roleRadioOptions:[{name:"admin",value:"admin"},{name:"agent",value:"agent"}],teams:[],permissions:"",agent_sign:"",departments:[],type:[],location:"",agent_tzone:"",permissionsList:[],selectedPermissionList:[],selectedPermissionIdsSD:"",iso:"",sdAgentPermissions:[]}),beforeMount(){this.getInitialValue()},created(){window.emitter.on("selected-permission-list",e=>{this.selectedPermissionIdsSD=e})},computed:{getApiParameters(){return{department_ids:this.departments.map(e=>e.id)}},getDeptParameters(){return{team_ids:this.teams.map(e=>e.id)}}},methods:{onChange(e,a){this[a]=e,a==="role"&&e==="agent"&&(this.updatePermissions(),this.showSdPermissionListBox(this.sdAgentPermissions))},getCountCode(e){this.country_code=e},getCountIso(e){this.iso=e},getPCountCode(e){this.phone_country_code=e},getPCountIso(e){this.phone_iso=e},getInitialValue(){O.get("api/dependency/permissions?limit=all",{}).then(e=>{this.permissionsList=Se(e.data.data),this.updatePermissions(),this.isEditAgent(window.location.pathname)?this.agentEditMode():(this.showSdPermissionListBox(),this.hasDataPopulated=!0,this.loading=!1)}).catch(e=>{P(e)})},updatePermissions(){this.permissionsList.forEach(function(e){e.checked=!1,e.disabled=!1,e.title="",e.key==="global_access"?e.title="Restricted access will be disabled if global access is checked.":e.key==="restricted_access"?e.title="Global access will be disabled if restricted access is checked.":e.key==="edit_articles_created_by_others"&&(e.disabled=!0)})},agentEditMode(){this.title="edit_an_agent",this.iconClass="fas fa-sync",this.submitButton="update",this.getAgentInfo(this.agentId)},getAgentInfo(e){this.loading=!0,O.get("/api/admin/agent/"+e).then(a=>{this.fillAgentInfo(a.data.data.agent)}).catch(a=>{P(a),this.loading=!1,this.hasDataPopulated=!0})},fillAgentInfo(e){try{this.email=e.email?e.email:"",this.first_name=e.first_name?e.first_name:"",this.last_name=e.last_name?e.last_name:"",this.user_name=e.user_name?e.user_name:"",this.agent_sign=e.agent_sign?e.agent_sign:"",this.location=M(e.location)?e.location:"",this.role=e.role?e.role:"",this.ext=e.ext?e.ext:"",this.country_code=e.country_code?e.country_code.id:null,this.phone_country_code=e.phone_country_code?e.phone_country_code.id:null,this.iso=e.iso?e.iso:null,this.phone_iso=e.phone_iso?e.phone_iso:null,this.mobile=e.mobile&&e.mobile!=="Not available"?e.mobile:"",this.phone_number=e.phone_number&&e.phone_number!=="Not available"?e.phone_number:"",this.agent_sign=e.agent_sign?e.agent_sign:"",this.agent_tzone=e.agent_tzone?e.agent_tzone:"",this.type=e.type?e.type:"",this.departments=e.departments?e.departments:"",this.teams=e.teams?e.teams:"";var a=this,t=0,o=void 0;e.permissions.forEach(function(s,i,f){t++,(s.key==="global_access"||s.key==="restricted_access")&&(o=s.key),a.checkBoxOperations(!0,s.key,!0),t===f.length&&o&&a.handleGlobalResMode(!0,o)}),this.sdAgentPermissions=e.sd_permissions,this.showSdPermissionListBox(e.sd_permissions),this.loading=!1,this.hasDataPopulated=!0}catch(s){console.error("error in fillAgentInfo method ",s)}},checkBoxOperations(e,a,t){let o=this;this.permissionsList.forEach(function(s){if(s.key==a){s.checked=e;return}o.handleGlobalResMode(e,a)})},handleGlobalResMode(e,a){this.role==="agent"&&setTimeout(()=>{if(a=="global_access"||a=="restricted_access"){let t=a=="global_access"?"restricted_access":"global_access";this.permissionsList.find(o=>o.key==a).checked&&this.permissionsList.find(o=>o.key==t).checked&&(this.permissionsList.find(o=>o.key==t).checked=!1,this.permissionsList.find(o=>o.key==t).disabled=!0),document.getElementById(t).checked=!1,document.getElementById(t).disabled=e,document.getElementById("view_all_tickets").checked=!1,document.getElementById("view_all_tickets").disabled=e}else a=="access_kb"&&(this.permissionsList.find(t=>t.key=="access_kb").checked?document.getElementById("edit_articles_created_by_others").disabled=!1:(document.getElementById("edit_articles_created_by_others").disabled=!0,document.getElementById("edit_articles_created_by_others").checked=!1))},500)},isEditAgent(e){return e.indexOf("edit")>=0?(this.agentId=ne(e),!0):!1},onSubmit(){if(this.agent_sign=this.getAgentSign(),this.isValidInputs()){this.loading=!0;let e=this.getSubmitParams();O.post("api/admin/agent/",e).then(a=>{this.loading=!1,N(a,"createUpdateAgent"),this.isCalledFromUserDirectoryPage||this.redirectToAgentListPage()}).catch(a=>{this.loading=!1,P(a,"createUpdateAgent")})}},getSubmitParams(){let e={email:this.email,user_name:this.user_name,first_name:this.first_name,agent_tzone_id:this.agent_tzone?this.agent_tzone.id:"",role:this.role,department_ids:this.departments.map(a=>a.id),id:this.agentId,last_name:this.last_name,type_ids:this.type?this.type.map(a=>a.id):"",location_id:this.location?this.location.name:"",permission_ids:this.role==="agent"?this.permissionsList.filter(a=>a.checked).map(a=>a.id):[],team_ids:this.teams?this.teams.map(a=>a.id):"",agent_sign:this.agent_sign,ext:this.ext};return this.phone_country_code!==null&&(e.phone_number=this.phone_number,e.phone_country_code=this.phone_country_code,e.phone_iso=this.phone_iso),this.country_code!==null&&(e.mobile=this.mobile,e.country_code=this.country_code,e.iso=this.iso),this.selectedPermissionIdsSD&&(e.sd_permission_ids=this.role==="agent"?this.selectedPermissionIdsSD:[]),e},redirectToAgentListPage(){window.location.href.indexOf("user")>-1?window.location.href=window.axios.defaults.baseURL+"/panel/user":setTimeout(()=>this.$router.push({name:"Agents Index"}),3e3)},getAgentSign(){return this.agent_sign},isValidInputs(){const{errors:e,isValid:a}=Kr(this.$data);return a},showSdPermissionListBox(e){window.emitter.emit("permission-list-box-mounted",e)},validateExtension(){this.ext=this.ext.replace(/[^0-9]/g,"")}}},Gr={class:"col-sm-12"},Xr={key:0,class:"row"},Qr={class:"row"},Jr={class:"row"},Zr={class:"row"},$r={class:"row"},eo={class:"row"},to={class:"row"},ao=l("div",{id:"permission-list-box"},null,-1),so={class:"card-footer"};function io(e,a,t,o,s,i){const f=p("custom-loader"),h=p("alert"),y=p("text-field"),g=p("dynamic-select"),d=p("phoneWithCountryCode"),F=p("faveo-box"),T=p("radio-button"),V=p("checkbox"),L=p("tiny-editor"),x=j("focus-first-input");return n(),r("div",Gr,[e.loading?(n(),r("div",Xr,[m(f,{duration:4e3})])):u("",!0),m(h,{componentName:"createUpdateAgent"}),e.hasDataPopulated?(n(),k(F,{key:1,title:e.lang(e.title),id:"form-main-box",boxClass:"card-light"},{actions:v(()=>[l("div",so,[l("button",{id:"agent-submit",class:"btn btn-primary",type:"button",onClick:a[0]||(a[0]=(...R)=>i.onSubmit&&i.onSubmit(...R))},[l("span",{class:D(e.iconClass),id:"submit-btn"},null,2),b("  "+c(e.lang(e.submitButton)),1)])])]),default:v(()=>[m(F,{title:e.lang("agent_info"),boxClass:"card-light"},{default:v(()=>[C((n(),r("div",Qr,[m(y,{id:"email",label:e.lang("email"),type:"text",name:"email",classname:"col-sm-6",value:e.email,onChange:i.onChange,placehold:e.lang("enter_a_value"),required:!0},null,8,["label","value","onChange","placehold"]),m(y,{id:"user_name",label:e.lang("user_name"),type:"text",name:"user_name",classname:"col-sm-6",value:e.user_name,onChange:i.onChange,placehold:e.lang("enter_a_value"),required:!0},null,8,["label","value","onChange","placehold"])])),[[x]]),l("div",Jr,[m(y,{id:"first_name",label:e.lang("firstname"),type:"text",name:"first_name",classname:"col-sm-4",value:e.first_name,onChange:i.onChange,placehold:e.lang("enter_a_value"),required:!0},null,8,["label","value","onChange","placehold"]),m(y,{id:"last_name",label:e.lang("lastname"),type:"text",name:"last_name",classname:"col-sm-4",onChange:i.onChange,placehold:e.lang("enter_a_value"),value:e.last_name,required:!1},null,8,["label","onChange","placehold","value"]),m(g,{id:"location",name:"location",classname:"col-sm-4",apiEndpoint:"/api/dependency/locations",multiple:!1,label:e.lang("location"),value:e.location,required:!1,onChange:i.onChange},null,8,["label","value","onChange"])]),l("div",Zr,[m(d,{id:"phone_number",classname:"col-sm-4",name:"phone_number",onChange:i.onChange,value:e.phone_number,countryCode:e.phone_country_code,countryIso:e.phone_iso,onCountCode:i.getPCountCode,onCountIso:i.getPCountIso,labelName:"phone_number",apiUrl:"/api/dependency/country-codes?time="+Date.now()},null,8,["onChange","value","countryCode","countryIso","onCountCode","onCountIso","apiUrl"]),m(y,{id:"ext",label:e.lang("ext"),type:"number",name:"ext",class:"col-sm-1",value:e.ext,onChange:i.onChange,placehold:e.lang("enter_a_value"),onInput:i.validateExtension},null,8,["label","value","onChange","placehold","onInput"]),m(d,{id:"mobile",classname:"col-sm-4",name:"mobile",onChange:i.onChange,value:e.mobile,countryCode:e.country_code,countryIso:e.iso,onCountCode:i.getCountCode,onCountIso:i.getCountIso},null,8,["onChange","value","countryCode","countryIso","onCountCode","onCountIso"]),m(g,{id:"time-zone",name:"agent_tzone",classname:"col-sm-4",apiEndpoint:"/api/dependency/time-zones",label:e.lang("agent_time_zone"),value:e.agent_tzone,required:!0,multiple:!1,onChange:i.onChange},null,8,["label","value","onChange"])])]),_:1},8,["title"]),m(F,{title:e.lang("account_status_setting"),boxClass:"card-light"},{default:v(()=>[l("div",$r,[m(g,{id:"departments",name:"departments",classname:"col-sm-6",removeVal:!1,apiEndpoint:"/api/dependency/departments",label:e.lang("department"),hint:e.lang("primary_department"),value:e.departments,required:!0,multiple:!0,onChange:i.onChange,"api-parameters":i.getDeptParameters},null,8,["label","hint","value","onChange","api-parameters"]),m(T,{id:"role",name:"role",classname:"form-group col-sm-6",options:e.lang(e.roleRadioOptions),label:e.lang("role"),value:e.role,onChange:i.onChange},null,8,["options","label","value","onChange"])]),l("div",eo,[m(g,{id:"teams",name:"teams",classname:"col-sm-6",apiEndpoint:"/api/dependency/teams",label:e.lang("team"),hint:e.lang("assigned_team"),value:e.teams,required:!1,multiple:!0,onChange:i.onChange,"api-parameters":i.getApiParameters,removeVal:!1},null,8,["label","hint","value","onChange","api-parameters"]),m(g,{id:"type",name:"type",classname:"col-sm-6",apiEndpoint:"/api/dependency/types",label:e.lang("type"),hint:e.lang("ticket_type"),value:e.type,onChange:i.onChange,required:!1,multiple:!0},null,8,["label","hint","value","onChange"])])]),_:1},8,["title"]),e.role==="agent"?(n(),r(w,{key:0},[m(F,{title:e.lang("access-permissions"),boxClass:"card-light"},{default:v(()=>[l("div",to,[(n(!0),r(w,null,I(e.permissionsList,R=>(n(),r("div",{class:"col-sm-4",id:"assign_groups",key:R.id},[m(V,{name:R.key,value:R.checked,disabled:R.disabled,label:R.key,title:R.name,onChange:i.checkBoxOperations,id:R.key},null,8,["name","value","disabled","label","title","onChange","id"])]))),128))])]),_:1},8,["title"]),ao],64)):u("",!0),m(F,{title:e.lang("agent_sign"),boxClass:"card-light"},{default:v(()=>[l("div",null,[m(L,{value:e.agent_sign,type:"text",onChange:i.onChange,name:"agent_sign",label:"",lang:"en",width:"100%"},null,8,["value","onChange"])])]),_:1},8,["title"])]),_:1},8,["title"])):u("",!0)])}const kd=S(Wr,[["render",io]]);const lo={name:"agent-tickets-table",description:"Agent panel tickets page",setup(){const e=Q();return{formattedTime:H(()=>e.getters.formattedTime)}},props:{id:{type:[Number,String],default:""},category:{type:String,default:"inbox"},tickets:{type:Function,default:()=>[]},allTickets:{type:Function,default:()=>[]},apiUrl:{type:String,default:""},componentTitle:{type:String,default:""},scroll_to:{type:String,default:""},isCalledFromAdmin:{type:Boolean,default:!1},disableLoader:{type:Boolean,default:!1}},data(){return{selectedTickets:this.tickets,options:{},tableData:[]}},beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},headings:{id:this.trans("id"),title:this.trans("subject"),ticket_number:this.trans("ticket_id"),user:this.trans("requester"),assign_to:this.trans("assign_to"),updated_at:this.trans("last_activity")},columnsClasses:{id:"ticket-id",title:"ticket-title",ticket_number:"ticket-number",user:"ticket-user",assign_to:"ticket-assign",updated_at:"ticket-updated"},texts:{filter:"",limit:""},templates:{title:function(a,t){return e.isCalledFromAdmin?e.h("a",{target:"_blank",href:e.basePath()+"/panel/thread/"+t.id},(t.title?t.title:" ")+"("+t.thread_count+")"):e.h(ie,{to:"/thread/"+t.id},(t.title?t.title:" ")+"("+t.thread_count+")")},updated_at(a,t){return e.formattedTime(t.updated_at)},user:function(a,t){return e.isCalledFromAdmin?e.h("a",{target:"_blank",href:e.basePath()+"/panel/user/"+t.from.id},t.from.full_name?t.from.full_name:t.from.user_name):e.h(ie,{to:"/user/"+t.from.id},t.from.full_name?t.from.full_name:t.from.user_name)},assign_to:function(a,t){return e.h("p",t.assigned?t.assigned.full_name:Array.isArray(t.assigned_team)?"---":t.assigned_team.name)},ticket_number:function(a,t){return e.isCalledFromAdmin?e.h("a",{target:"_blank",href:e.basePath()+"/panel/thread/"+t.id},"#"+t.ticket_number):e.h(ie,{to:"/thread/"+t.id},"#"+t.ticket_number)}},sortable:["ticket_number","updated_at"],filterable:["ticket_number","updated_at"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(a){return{"sort-field":a.orderBy?a.orderBy:"updated_at","sort-order":a.ascending?"desc":"asc","search-query":a.query.trim(),page:a.page,limit:a.limit}},responseAdapter({data:a}){return e.tableData=a.data,e.allTickets(a.data.tickets),{data:a.data.tickets.map(t=>t),count:a.data.total}}}},computed:{columns(){return this.tableData.length===0?["ticket_number","title","user","assign_to","updated_at"]:["id","ticket_number","title","user","assign_to","updated_at"]}},methods:{handelLoader(e){this.$emit("loaderValue",e)}}};function no(e,a,t,o,s,i){const f=p("data-table");return n(),k(f,{url:t.apiUrl,dataColumns:i.columns,onLoaderState:i.handelLoader,option:s.options,tickets:t.tickets,scroll_to:t.scroll_to,disableLoader:t.disableLoader,componentTitle:t.componentTitle},null,8,["url","dataColumns","onLoaderState","option","tickets","scroll_to","disableLoader","componentTitle"])}const Fd=S(lo,[["render",no]]);function ro(e){const{commnetValue:a}=e;let t={commnetValue:[a,"isRequired"]};const o=new ee(K),{errors:s,isValid:i}=o.validate(t);return te.dispatch("setValidationError",s),{errors:s,isValid:i}}const oo={name:"change-status-modal",description:"Change status Modal component",props:{showModal:{type:Boolean,default:!1},ticketIds:{type:Array,default:()=>[]},status:{type:Object,default:()=>{}},onClose:{type:Function,default:()=>{}},componentTitle:{type:String,default:"UserTickets"},reloadTickets:{type:Function,default:()=>{}},label:{type:String,default:""}},data:()=>({isDisabled:!1,containerStyle:{width:"800px"},loading:!1,commnetValue:"",checked:!1}),methods:{isValid(){const{errors:e,isValid:a}=ro(this.$data);return!!a},validate(){this.status.comment?this.isValid()&&this.onSubmit():this.onSubmit()},onSubmit(){this.loading=!0,this.isDisabled=!0,O.post("/ticket/change-status/"+this.ticketIds+"/"+this.status.id,{comment:this.commnetValue,"as-reply":this.checked}).then(e=>{this.loading=!1,this.isDisabled=!0,this.reloadTickets("status"),N(e,this.componentTitle),window.emitter.emit(this.componentTitle+"refreshData"),window.emitter.emit(this.componentTitle+"uncheckCheckbox"),window.emitter.emit("refreshUserReport"),window.emitter.emit("refreshOrgReport"),this.onClose()}).catch(e=>{this.loading=!1,this.isDisabled=!1,P(e,this.componentTitle),this.onClose()})},onChange(e,a){this[a]=e}},components:{"text-field":X}},co=e=>(E("data-v-6fd1b9db"),e=e(),B(),e),uo={class:"modal-title"},ho={class:"row"},mo={key:0,class:"ml-1 p-1"},fo={key:0,class:"is-danger"},_o={class:"col-sm-12"},go=["disabled"],po=co(()=>l("i",{class:"fa fa-check","aria-hidden":"true"},null,-1));function bo(e,a,t,o,s,i){const f=p("tiny-editor-with-validation"),h=p("custom-loader"),y=p("modal"),g=j("focus-first-input");return t.showModal?(n(),k(y,{key:0,showModal:t.showModal,onClose:t.onClose,containerStyle:e.containerStyle},{title:v(()=>[l("h4",uo,c(e.lang("change_status_confirmation")+" "+t.status.name+"?"),1)]),fields:v(()=>[C((n(),r("div",ho,[t.label?(n(),r("strong",mo,[b(c(e.lang(t.status.comment?"leave_comment_status_change_required":"leave_comment_status_change_optional")),1),t.status.comment?(n(),r("span",fo,"*")):u("",!0)])):u("",!0),m(f,{id:"commnetValue",name:"commnetValue",value:e.commnetValue,label:e.lang(t.status.comment?"leave_comment_status_change_required":"leave_comment_status_change_optional"),onChange:i.onChange,required:!!t.status.comment,mediaOption:!1,classname:"col-sm-12"},null,8,["value","label","onChange","required"])])),[[g]]),l("div",_o,[C(l("input",{class:"checkbox_align",type:"checkbox","onUpdate:modelValue":a[0]||(a[0]=d=>e.checked=d)},null,512),[[re,e.checked]]),b(" "+c(e.lang("post_comment_as_reply")),1)]),e.loading?(n(),k(h,{key:0,duration:4e3})):u("",!0)]),controls:v(()=>[l("button",{id:"submit_btn",type:"button",onClick:a[1]||(a[1]=d=>i.validate()),class:"btn btn-primary",disabled:e.isDisabled},[po,b(" "+c(e.lang("proceed")),1)],8,go)]),_:1},8,["showModal","onClose","containerStyle"])):u("",!0)}const wd=S(oo,[["render",bo],["__scopeId","data-v-6fd1b9db"]]);function yo(e){const{title:a,parentTicket:t}=e;let o={parentTicket:[t,"isRequired"],title:[a,"isRequired"]};const s=new ee(K),{errors:i,isValid:f}=s.validate(o);return te.dispatch("setValidationError",i),{errors:i,isValid:f}}const vo={name:"merge-ticket-modal",description:"Merge Ticket Modal component",props:{showModal:{type:Boolean,default:!1},parent_tickets:{type:Array,default:()=>[]},ticketIds:{type:Array,default:()=>[]},onClose:{type:Function,default:()=>{}},componentTitle:{type:String,default:"UserTickets"},reloadTickets:{type:Function,default:()=>{}}},data:()=>({isDisabled:!1,containerStyle:{width:"600px"},loading:!1,size:60,lang_locale:"",merge_reason:"",title:"",parentTicket:""}),created(){this.lang_locale=localStorage.getItem("LANGUAGE")},computed:{getApiParameters(){return{"ticket-ids":this.ticketIds}}},methods:{isValid(){const{errors:e,isValid:a}=yo(this.$data);return!!a},onChange(e,a){a==="parentTicket"?(this.title=e.name,this.parentTicket=e):this[a]=e},onSubmit(){if(this.isValid()){this.loading=!0,this.isDisabled=!0;const e=this.parentTicket?this.parentTicket.ticket_id:null;O.post("/merge-tickets/"+this.ticketIds,{p_id:e,title:this.title,reason:this.merge_reason,_method:"PATCH"}).then(a=>{this.loading=!1,this.isDisabled=!0,this.reloadTickets(),N(a,this.componentTitle),window.emitter.emit(this.componentTitle+"refreshData"),window.emitter.emit(this.componentTitle+"uncheckCheckbox"),window.emitter.emit("refreshUserReport"),window.emitter.emit("refreshOrgReport"),window.emitter.emit("closeTimelineView"),this.onClose()}).catch(a=>{this.loading=!1,this.isDisabled=!1,P(a,this.componentTitle),this.onClose()})}}},components:{DynamicSelect:q,"text-field":X,"static-select":De}},ko=e=>(E("data-v-c90c1581"),e=e(),B(),e),Fo={class:"modal-title"},wo={key:0},Co={class:"row"},So={class:"row"},Do={key:1,class:"row"},Ao=["disabled"],To=ko(()=>l("i",{class:"fa fa-check"},null,-1));function Vo(e,a,t,o,s,i){const f=p("dynamic-select"),h=p("text-field"),y=p("reuse-loader"),g=p("modal");return t.showModal?(n(),k(g,{key:0,showModal:t.showModal,onClose:t.onClose,containerStyle:e.containerStyle},{title:v(()=>[l("h4",Fo,c(e.lang("merge-ticket")),1)]),fields:v(()=>[e.loading?u("",!0):(n(),r("div",wo,[l("div",Co,[m(f,{"api-parameters":i.getApiParameters,optionLabel:"title",label:e.lang("select-pparent-ticket"),required:!0,name:"parentTicket",classname:"col-sm-6","api-endpoint":"/api/agent/tickets/get-merge-tickets",value:e.parentTicket,onChange:i.onChange,strlength:"30"},null,8,["api-parameters","label","value","onChange"]),m(h,{label:e.lang("title"),value:e.title,type:"text",name:"title",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold"])]),l("div",So,[m(h,{label:e.lang("merge-reason"),value:e.merge_reason,type:"textarea",name:"merge_reason",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-12"},null,8,["label","value","onChange","placehold"])])])),e.loading?(n(),r("div",Do,[m(y,{"animation-duration":4e3,color:"#1d78ff",size:e.size,class:D({spin:e.lang_locale=="ar"})},null,8,["size","class"])])):u("",!0)]),controls:v(()=>[l("button",{type:"button",id:"submit_btn",onClick:a[0]||(a[0]=(...d)=>i.onSubmit&&i.onSubmit(...d)),class:"btn btn-primary",disabled:e.isDisabled},[To,b(" "+c(e.lang("proceed")),1)],8,Ao)]),_:1},8,["showModal","onClose","containerStyle"])):u("",!0)}const Cd=S(vo,[["render",Vo],["__scopeId","data-v-c90c1581"]]);const Oo={name:"assign-ticket-modal",description:"Assign ticket Modal component",props:{showModal:{type:Boolean,default:!1},ticketIds:{type:Array,default:()=>[]},tickets:{type:Array,default:()=>[]},onClose:{type:Function,default:()=>{}},componentTitle:{type:String,default:"UserTickets"},reloadTickets:{type:Function,default:()=>{}},deptId:{type:[String,Number],default:""},teamId:{type:[String,Number],default:""}},data:()=>({isDisabled:!0,containerStyle:{width:"800px"},loading:!1,size:60,assign_to:"",assign:"agents",radioOptions:[{name:"agent",value:"agents"},{name:"team",value:"teams"},{name:"assign_to_me",value:"assign_to_me"}],assignChange:!1}),computed:{getApiParameters(){let e={};if(e["supplements[ticket_id]"]=this.ticketIds,e["supplements[no_email]"]=1,this.deptId&&(e["department_ids[]"]=this.deptId),this.teamId&&(e.team_id=this.teamId),this.tickets.length){let a=this.tickets.filter(t=>this.ticketIds.includes(t.id)).map(t=>t.department.id);e.department_ids=a.filter((t,o)=>a.indexOf(t)===o)}return e}},methods:{onChange(e,a){this[a]=e,a==="assign"&&(this.assignChange=!0,setTimeout(()=>{this.assignChange=!1},1),this.assign_to=e!="assign_to_me"?"":{id:sessionStorage.getItem("user_id")},this.isDisabled=e!="assign_to_me"),a==="assign_to"&&(this.isDisabled=!e)},onSubmit(){this.loading=!0,this.isDisabled=!0;var e={assign_to:this.assign==="teams"?"team_"+this.assign_to.id:"user_"+this.assign_to.id,_method:"PATCH"};O.post("/ticket/assign?ticket_id="+this.ticketIds,e).then(a=>{this.loading=!1,this.isDisabled=!0,this.reloadTickets("assign"),N(a,this.componentTitle),window.emitter.emit(this.componentTitle+"refreshData"),window.emitter.emit(this.componentTitle+"uncheckCheckbox"),window.emitter.emit("refreshUserReport"),window.emitter.emit("refreshOrgReport"),this.onClose()}).catch(a=>{this.loading=!1,this.isDisabled=!1,P(a,this.componentTitle),this.onClose()})}},components:{"dynamic-select":q,"radio-button":ge}},Io={class:"modal-title"},Po={key:0,class:"row"},Mo={key:0,id:"assign_change"},jo={key:1,class:"row"},Ro=["disabled"],Lo=l("i",{class:"far fa-hand-point-right"},null,-1);function Eo(e,a,t,o,s,i){const f=p("radio-button"),h=p("loader"),y=p("dynamic-select"),g=p("reuse-loader"),d=p("modal");return t.showModal?(n(),k(d,{key:0,showModal:t.showModal,onClose:t.onClose,containerStyle:e.containerStyle},{title:v(()=>[l("h4",Io,c(e.lang("assign_tickets")),1)]),fields:v(()=>[e.loading?u("",!0):(n(),r("div",Po,[m(f,{options:e.radioOptions,label:e.lang("assign_to"),name:"assign",value:e.assign,onChange:i.onChange,classname:"form-group col-sm-4"},null,8,["options","label","value","onChange"]),e.assignChange?(n(),r("div",Mo,[m(h,{size:30,duration:4e3,color:"#1d78ff"})])):u("",!0),!e.assignChange&&e.assign!="assign_to_me"?(n(),k(y,{key:1,label:e.lang("whome_do_you_want_to_assign_ticket"),multiple:!1,name:"assign_to",classname:"col-sm-8","api-endpoint":"api/dependency/"+e.assign+(e.assign=="teams"?"?meta=true":""),"api-parameters":i.getApiParameters,value:e.assign_to,onChange:i.onChange,strlength:"65"},null,8,["label","api-endpoint","api-parameters","value","onChange"])):u("",!0)])),e.loading?(n(),r("div",jo,[m(g,{"animation-duration":4e3,color:"#1d78ff",size:e.size},null,8,["size"])])):u("",!0)]),controls:v(()=>[l("button",{type:"button",onClick:a[0]||(a[0]=F=>i.onSubmit()),class:"btn btn-primary",id:"submit_btn",disabled:e.isDisabled},[Lo,b(" "+c(e.lang("assign")),1)],8,Ro)]),_:1},8,["showModal","onClose","containerStyle"])):u("",!0)}const Sd=S(Oo,[["render",Eo]]);const Bo={name:"recurring-tickets",description:"Recurring tickets list",setup(){const e=Q();return{formattedDate:H(()=>e.getters.formattedDate)}},props:{from:{type:String,default:""}},data(){return{columns:["name","interval","start_date","end_date","action"],options:{},apiUrl:null,panel:null}},beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},headings:{name:e.lang("name"),interval:e.lang("interval"),start_date:e.lang("start_date"),end_date:e.lang("end_date"),action:e.lang("action")},columnsClasses:{name:"recur-name",interval:"recur-interval",start_date:"recur-start",end_date:"recur-end",action:"recur-action"},texts:{filter:"",limit:""},templates:{start_date:function(a,t){return t.start_date&&t.start_date!="0000-00-00 00:00:00"?e.formattedDate(t.start_date):"--"},end_date:function(a,t){return t.end_date&&t.end_date!="0000-00-00 00:00:00"?e.formattedDate(t.end_date):"--"},action:(a,t)=>e.h(Ke,{data:t})},sortable:["name","interval","start_date","end_date"],filterable:["name","interval","start_date","end_date"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(a){return{"sort-field":a.orderBy?a.orderBy:"updated_at","sort-order":a.ascending?"desc":"asc","search-query":a.query.trim(),page:a.page,limit:a.limit}},responseAdapter({data:a}){return{data:a.data.data.map(t=>(t.from=e.panel?"agent":"",t.edit_url=e.panel?e.panel+"/recur/"+t.id+"/edit":"/recur/"+t.id+"/edit",t.delete_url=e.basePath()+"/api/recur-delete/"+t.id,t)),count:a.data.total}}}},created(){this.panel=window.location.pathname.split("/").includes("agent")?"/agent":"",this.apiUrl="api"+this.panel+"/recur-list"}},Uo={id:"list_of_recur",class:"col-sm-12"},qo={class:"card card-light"},No={class:"card-header"},Yo={class:"card-title"},xo={class:"card-tools"},Ho=l("i",{class:"glyphicon glyphicon-plus"},null,-1),zo=l("i",{class:"glyphicon glyphicon-plus"},null,-1),Ko={class:"card-body",id:"my_recurs"};function Wo(e,a,t,o,s,i){const f=p("alert"),h=p("router-link"),y=p("data-table"),g=j("tooltip");return n(),r("div",Uo,[m(f,{componentName:"dataTableModal"}),l("div",qo,[l("div",No,[l("h3",Yo,c(e.lang("list_of_recur")),1),l("div",xo,[t.from=="admin"?C((n(),k(h,{key:0,to:"/recur/create",class:"btn-tool"},{default:v(()=>[Ho]),_:1})),[[g,e.lang("create_recur")]]):C((n(),k(h,{key:1,to:s.panel+"/ticket/recur",class:"btn-tool"},{default:v(()=>[zo]),_:1},8,["to"])),[[g,e.lang("create_recur")]])])]),l("div",Ko,[m(y,{url:s.apiUrl,dataColumns:s.columns,option:s.options,scroll_to:"list_of_recur"},null,8,["url","dataColumns","option"])])])])}const Dd=S(Bo,[["render",Wo]]);const Go={name:"faveo-form",props:{recur_mode:{type:String,default:""},template_mode:{type:String,default:""},category:{type:String,required:!0},panel:{type:String,default:"agent"},scenario:{type:String,default:""},showViewButton:{type:Boolean,default:!1}},data(){return{baseEndpoint:"render/form",fetchFormFieldApi:"",formUniqueKey:null,submitFormInProgress:!1,editId:"",selectedForm:"",formSelected:!1}},mixins:[Ae],beforeMount(){if(this.fetchFormFieldApi=this.baseEndpoint,this.editId=ne(this.currentPath()),this.mode==="edit"){let e=this.scenario||this.category;this.fetchFormFieldApi=he(e,this.editId),this.baseEndpoint=he(e,this.editId),this.formSelected=!0}else this.getDefaultFormValue()},created(){window.emitter.on("updateTicketCategory",this.updateTicketCategory),window.emitter.on("updateSelectedForm",e=>{this.selectedForm=e})},computed:{mode(){return this.currentPath().indexOf("edit")!==-1?"edit":"create"},viewId(){return{organisation:"organizations",requester:"user"}[this.category]||this.category},page(){return this.scenario?this.category+"_"+this.scenario+"_"+this.panel:this.category+"_"+this.mode+"_"+this.panel},fetchFormApi(){return this.fetchFormFieldApi}},methods:{updateTicketCategory(){window.emitter.emit("storeCategoryId",this.selectedForm.id)},onChange(e,a){this[a]=e,this.formSelected=!1,this.updateFetchApi()},getDefaultFormValue(){this.showLoader=!0,axios.get("/from/forms/"+this.category).then(e=>{this.selectedForm=e.data.data.data[0],this.showLoader=!1,this.updateFetchApi()}).catch(e=>{this.showLoader=!1,P(e,"faveo-form")})},updateFetchApi(){this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey),this.$store.dispatch("unsetValidationError");let e=this.baseEndpoint.includes("render/form")?"id":"form_category_id";this.fetchFormFieldApi=this.baseEndpoint+"?"+e+"="+this.selectedForm.id+"&mode=render",setTimeout(()=>{this.$store.dispatch("createNewFormInstance",{formUniqueKey:this.formUniqueKey,scenario:this.scenario||this.mode}),this.formSelected=!0},1)},afterSubmit(e){if((this.scenario==="recur"||this.scenario==="template")&&this.mode==="create")setTimeout(()=>this.scenario==="recur"?this.$router.push({name:"Recurring Tickets"}):this.$router.push({name:"Ticket Templates Index"}),3e3);else{window.emitter.emit("updateAgentSidebar"),this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey);let a=Te(this.category);this.$store.dispatch("createNewFormInstance",{formUniqueKey:a,scenario:this.scenario||this.mode}),this.formUniqueKey=a,window.emitter.emit("reset-captcha");let t=e.data.data.id;if(this.mode==="create"){const o={requester:"/user/",organisation:"/organizations/",ticket:"/thread/"};setTimeout(()=>{const s=o[this.category];s&&this.$router.push(s+t)},3e3)}}},formSubmit(e,a){this.$store.dispatch("setRecaptchaKey",a),this.onSubmit()}},components:{FaveoBox:Ve,Alert:Oe,Loader:Ie,FormWithCaptcha:Pe,DynamicSelect:q,FormRenderer:Me}},Xo={class:"col-sm-12"},Qo={id:"faveo-form"},Jo={class:"card card-light"},Zo={key:0,class:"card-header"},$o={class:"card-title"},ed={class:"card-tools"},td=l("i",{class:"fas fa-eye"},null,-1),ad={class:"card-body"},sd={class:"row"};function id(e,a,t,o,s,i){const f=p("router-link"),h=p("Alert"),y=p("Loader"),g=p("DynamicSelect"),d=p("FormRenderer"),F=p("ValidationObserver"),T=p("FormWithCaptcha"),V=j("tooltip");return n(),r("div",Xo,[l("div",Qo,[l("div",Jo,[t.showViewButton?(n(),r("div",Zo,[l("h3",$o,c(e.trans("edit")),1),l("div",ed,[C((n(),k(f,{to:"/"+i.viewId+"/"+s.editId,id:"form_view_btn",class:"btn btn-tool text-dark"},{default:v(()=>[td]),_:1},8,["to"])),[[V,e.trans("view")]])])])):u("",!0),l("div",ad,[m(h,{componentName:"faveo-form"}),e.showLoader||s.submitFormInProgress?(n(),k(y,{key:0,duration:4e3})):u("",!0),l("div",sd,[t.category==="ticket"?(n(),k(g,{key:0,label:e.trans("select_form"),multiple:!1,name:"selectedForm",classname:"col-sm-12",apiEndpoint:"/from/forms/"+t.category,value:s.selectedForm,onChange:i.onChange,clearable:!1,"label-style":{display:"none"}},null,8,["label","apiEndpoint","value","onChange"])):u("",!0)]),s.formUniqueKey&&s.formSelected?(n(),k(T,{key:1,loading:!e.showLoader,btnClass:"btn btn-primary pull-right",btnName:"submit",componentName:"faveo-form",btn_id:"form-submit",formSubmit:i.formSubmit,page:i.page,recaptchaContainerClass:"mt-2",disableSubmit:s.submitFormInProgress},{fields:v(()=>[m(F,{ref:"faveoFormObserver"},{default:v(({values:L,errors:x,validate:R})=>[(n(),k(d,{key:s.formUniqueKey,fetchFormFieldApi:i.fetchFormApi,formUniqueKey:s.formUniqueKey,scenario:t.scenario||i.mode,category:t.category,panel:t.panel,recur_mode:t.recur_mode,template_mode:t.template_mode,selectDependencyId:s.editId},null,8,["fetchFormFieldApi","formUniqueKey","scenario","category","panel","recur_mode","template_mode","selectDependencyId"]))]),_:1},512)]),_:1},8,["loading","formSubmit","page","disableSubmit"])):u("",!0)])])])])}const Ad=S(Go,[["render",id]]);export{dd as A,be as C,pd as D,Ad as F,gd as H,fd as I,Cd as M,md as N,Dd as R,xt as S,_d as T,bd as U,Zl as a,ln as b,cd as c,hd as d,ud as e,yd as f,vd as g,Fd as h,wd as i,Sd as j,kd as k};
