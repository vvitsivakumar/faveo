import{V as A,l as w,c as u,_ as V,s as k,e as O,R as S,N as D,D as L}from"../chunks/bootstrap.js";import{a as m,r,o as p,c,e as n,f as o,t as g,d,F as N,b as P,g as B}from"../chunks/vendor.js";import{r as E,A as R}from"../chunks/adminRouter.js";import"../chunks/FormGenerator.js";import"../chunks/AdminNavigationBar.js";import"../chunks/DataTableActions.js";import"../chunks/HelpSection.js";function q(e){let a={};e.assign_department_option==="specific"&&(a.department_list=[e.department_list,"isRequired"]);const _=new A(w),{errors:i,isValid:t}=_.validate(a);return u.dispatch("setValidationError",i),{errors:i,isValid:t}}const F={name:"auto-assign",data(){return{status:0,only_login:0,assign_not_accept:0,assign_with_type:0,is_location:0,assign_department_option:"all",threshold:"",department_list:[],radioOptions:[{name:"yes",value:1},{name:"no",value:0}],deptOptions:[{name:"all",value:"all"},{name:"specific",value:"specific"}],loading:!0,hasDataPopulated:!1,pageLoad:!1,is_dept_mgr_auto_approve:1,is_team_lead_auto_approve:1}},beforeMount(){this.getValues()},methods:{getValues(){m.get("/api/get-auto-assign").then(e=>{this.loading=!1,this.hasDataPopulated=!0,this.updateStatesWithData(e.data.data.autoAssign)}).catch(e=>{this.loading=!1,this.hasDataPopulated=!0})},updateStatesWithData(e){const a=this,_=this.$data;Object.keys(e).map(i=>{_.hasOwnProperty(i)&&(a[i]=i!="assign_department_option"&&i!="department_list"?parseInt(e[i]):e[i])}),this.threshold=this.threshold?this.threshold:""},onChange(e,a){this[a]=e,this.assign_department_option=="all"&&(this.department_list=[])},isValid(){const{errors:e,isValid:a}=q(this.$data);return a},onSubmit(){if(this.isValid()){this.pageLoad=!0;const e={};e.status=this.status,e.only_login=this.only_login,e.assign_not_accept=this.assign_not_accept,e.assign_with_type=this.assign_with_type,e.is_location=this.is_location,e.threshold=this.threshold,e.assign_department_option=this.assign_department_option,e.is_team_lead_auto_approve=this.is_team_lead_auto_approve,e.is_dept_mgr_auto_approve=this.is_dept_mgr_auto_approve,this.assign_department_option==="specific"&&(e.department_list=this.department_list.map(a=>a.id)),m.post("/api/auto-assign",e).then(a=>{this.pageLoad=!1,k(a,"AutoAssign"),this.getValues()}).catch(a=>{O(a,"AutoAssign"),this.pageLoad=!1})}},triggerEvent(e){var a=e.which||e.keyCode;a===13&&this.onSubmit()}},components:{"radio-button":S,"number-field":D,"dynamic-select":L}},H={class:"col-sm-12"},M={class:"card card-light"},U={class:"card-header"},W={class:"card-title"},j={class:"card-body"},z={key:0,class:"row"},I={class:"row"},T={class:"row"},G={class:"row"},J={class:"row"},K={class:"row"},Q={class:"card-footer"},X=o("i",{class:"fas fa-sync"},null,-1),Y={key:0,class:"row"};function Z(e,a,_,i,t,s){const h=r("alert"),v=r("reuse-loader"),l=r("radio-button"),b=r("number-field"),f=r("dynamic-select"),C=r("custom-loader");return p(),c("div",H,[n(h,{componentName:"AutoAssign"}),o("div",M,[o("div",U,[o("h3",W,g(e.trans("settings")),1)]),o("div",j,[t.loading||!t.hasDataPopulated?(p(),c("div",z,[n(v,{"animation-duration":4e3,size:60})])):d("",!0),t.hasDataPopulated?(p(),c(N,{key:1},[o("div",I,[n(l,{options:t.radioOptions,label:e.trans("enable"),name:"status",value:t.status,onChange:s.onChange,classname:"form-group col-sm-6"},null,8,["options","label","value","onChange"]),n(l,{options:t.radioOptions,label:e.trans("only-login-agents"),name:"only_login",value:t.only_login,onChange:s.onChange,classname:"form-group col-sm-6"},null,8,["options","label","value","onChange"])]),o("div",T,[n(l,{options:t.radioOptions,label:e.trans("assign-ticket-even-agent-in-non-acceptable-mode"),name:"assign_not_accept",value:t.assign_not_accept,onChange:s.onChange,classname:"form-group col-sm-6"},null,8,["options","label","value","onChange"]),n(l,{options:t.radioOptions,label:e.trans("assign-ticket-with-agent-having-type"),name:"assign_with_type",value:t.assign_with_type,onChange:s.onChange,classname:"form-group col-sm-6"},null,8,["options","label","value","onChange"])]),o("div",G,[n(l,{options:t.radioOptions,label:e.trans("auto_approve_dept_mgr"),name:"is_dept_mgr_auto_approve",value:t.is_dept_mgr_auto_approve,onChange:s.onChange,classname:"form-group col-sm-6"},null,8,["options","label","value","onChange"]),n(l,{options:t.radioOptions,label:e.trans("auto_approve_team_lead_mgr"),name:"is_team_lead_auto_approve",value:t.is_team_lead_auto_approve,onChange:s.onChange,classname:"form-group col-sm-6"},null,8,["options","label","value","onChange"])]),o("div",J,[n(l,{options:t.radioOptions,label:e.trans("assign-ticket-with-agent-having-location"),name:"is_location",value:t.is_location,onChange:s.onChange,classname:"form-group col-sm-6"},null,8,["options","label","value","onChange"]),n(l,{options:t.deptOptions,label:e.trans("auto-assign-enabled-departments"),name:"assign_department_option",value:t.assign_department_option,onChange:s.onChange,classname:"form-group col-sm-6"},null,8,["options","label","value","onChange"])]),o("div",K,[n(b,{label:e.trans("maximum-number-of-ticket-can-assign-to-agent"),value:t.threshold,name:"threshold",onChange:s.onChange,classname:"col-sm-6",type:"number",required:!1,keyupListener:s.triggerEvent,placeholder:"n"},null,8,["label","value","onChange","keyupListener"]),t.assign_department_option==="specific"?(p(),P(f,{key:0,label:e.trans("select-deparment"),multiple:!0,name:"department_list",classname:"col-sm-6",apiEndpoint:"/api/dependency/departments",value:t.department_list,onChange:s.onChange,strlength:30,required:!0},null,8,["label","value","onChange"])):d("",!0)])],64)):d("",!0)]),o("div",Q,[o("button",{class:"btn btn-primary",onClick:a[0]||(a[0]=(...y)=>s.onSubmit&&s.onSubmit(...y))},[X,B(" "+g(e.trans("update")),1)])])]),t.pageLoad?(p(),c("div",Y,[n(C,{duration:4e3})])):d("",!0)])}const x=V(F,[["render",Z]]);let $={path:"/auto-assign",component:R,name:"Auto Assign Setting",redirect:"/auto-assign/settings",children:[{path:"settings",component:x,name:"AutoAssign Settings",meta:{title:"auto_assign",crumb:{link:{name:"admin_panel",to:"/"},active:"auto_assign"}}}]};E.addRoute($);u.dispatch("deleteUser");u.dispatch("updateUser");
