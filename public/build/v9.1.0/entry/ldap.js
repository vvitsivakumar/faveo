import{_ as V,e as I,s as P,V as j,l as Q,c as U,i as O,S as J,j as W,D as X,T as Y,k as Z,m as x}from"../chunks/bootstrap.js";import{a as S,r as p,q as G,o as l,c as d,e as r,w as v,f as t,i as A,b as C,y as ee,d as g,F as B,h as $,t as b,p as q,j as E,n as H,g as D,u as K,m as T,G as R}from"../chunks/vendor.js";import{U as ae,r as te,A as se}from"../chunks/adminRouter.js";import{a as ne,b as le}from"../chunks/DataTableActions.js";import{D as ie}from"../chunks/DataTableIsDefault.js";import{C as oe}from"../chunks/FormGenerator.js";import"../chunks/HelpSection.js";import"../chunks/AdminNavigationBar.js";const de={name:"ldap-list-page",data:function(){return{dataToDisplay:["domain","port","encryption","username"],adList:[],hideDefaultLogin:!1,isLoading:!1}},beforeMount(){this.getLdapList()},methods:{getLdapList(){this.isLoading=!0,S.get("api/ldap/settings").then(e=>{this.adList=e.data.data.ldap_list,this.hideDefaultLogin=e.data.data.hide_default_login}).catch(e=>{I(e,"ldap-list-page")}).finally(()=>{this.isLoading=!1})},deleteItem(e){confirm("Are you sure you want to delete?")&&(this.isLoading=!0,S.delete("api/ldap/settings/"+e).then(n=>{P(n,"ldap-list-page"),this.getLdapList()}).catch(n=>{I(n,"ldap-list-page")}).finally(()=>{this.isLoading=!1}))},updateHideDefaultLogin(){this.isLoading=!0;const e={hide_default_login:this.hideDefaultLogin};S.post("api/ldap/hide-default-login",e).then(a=>{P(a,"ldap-list-page")}).catch(a=>{I(a,"ldap-list-page")}).finally(()=>{this.isLoading=!1})}}},re=e=>(q("data-v-157ae39f"),e=e(),E(),e),pe={class:"col-sm-12"},ce={class:"card-tools d-flex mt-1"},ue=re(()=>t("i",{class:"glyphicon glyphicon-plus","aria-hidden":"true"},null,-1)),he={class:"btn-tool"},me={class:"list-group"},ge={class:"row"},_e={class:"col-md-2"},fe={class:"ldap-schema-img"},be=["src","alt"],ye={class:"description-header"},ve={class:"description-text"},we={class:"col-md-2 description-block action-block float-right"},Ce={class:"fas fa-edit","aria-hidden":"true"},ke=["onClick"],Le={class:"fas fa-trash","aria-hidden":"true"};function Se(e,a,n,i,o,s){const c=p("alert"),w=p("custom-loader"),u=p("router-link"),k=p("faveo-box"),y=G("tooltip");return l(),d("div",pe,[r(k,{title:e.trans("ldap_list")},{headerMenu:v(()=>[t("div",ce,[A((l(),C(u,{class:"btn btn-tool",to:"/ldap/settings/create"},{default:v(()=>[ue]),_:1})),[[y,e.trans("configure_new_ldap")]]),A((l(),d("span",he,[A(t("input",{class:"hide-checkbox",type:"checkbox","onUpdate:modelValue":a[0]||(a[0]=f=>e.hideDefaultLogin=f),onChange:a[1]||(a[1]=f=>s.updateHideDefaultLogin())},null,544),[[ee,e.hideDefaultLogin]])])),[[y,e.trans("hide_default_login")]])])]),default:v(()=>[r(c,{componentName:"ldap-list-page"}),e.isLoading?(l(),C(w,{key:0,duration:4e3})):g("",!0),t("div",me,[(l(!0),d(B,null,$(e.adList,f=>(l(),d("div",{class:"list-group-item",key:f.id},[t("div",ge,[A((l(),d("div",_e,[t("div",fe,[t("img",{src:f.image_url,alt:f.schema,class:"w-100"},null,8,be)])])),[[y,e.trans(f.schema)]]),(l(!0),d(B,null,$(e.dataToDisplay,L=>(l(),d("div",{class:"col-md-2 description-block data-block",key:L},[t("h5",ye,b(e.trans(L)),1),t("span",ve,b(f[L]?f[L]:"---"),1)]))),128)),t("div",we,[r(u,{class:"btn btn-primary btn-sm",to:"/ldap/settings/"+f.id+"/edit"},{default:v(()=>[A(t("i",Ce,null,512),[[y,e.trans("edit")]])]),_:2},1032,["to"]),t("button",{class:"btn btn-danger btn-sm",onClick:L=>s.deleteItem(f.id)},[A(t("i",Le,null,512),[[y,e.trans("delete")]])],8,ke)])])]))),128))])]),_:1},8,["title"])])}const De=V(de,[["render",Se],["__scopeId","data-v-157ae39f"]]);function Ie(e){const{domain:a,username:n,password:i,ldap_label:o,forgot_password_link:s}=e;var c={domain:[a,"isRequired"],username:[n,"isRequired"],password:[i,"isRequired"],ldap_label:[o,"max(24)"]};const w=new j(Q),{errors:u,isValid:k}=w.validate(c);return U.dispatch("setValidationError",u),{errors:u,isValid:k}}function Ae(e){var a={};for(let s=0;s<e.length;s++){let c=[];c[0]=e[s].search_base,c[1]="isRequired",a["searchbase"+[s]]=c}const n=new j(Q),{errors:i,isValid:o}=n.validate(a);return U.dispatch("setValidationError",i),{errors:i,isValid:o}}const Pe={props:{ldapId:{type:String,default:""},addUser:{type:Function,default:function(){return null}},searchBaseArray:{type:Array,default:[]},getLdap:{type:Function,default:function(){return null}},showOrganization:{type:Boolean,default:!0},showDepartment:{type:Boolean,default:!0},showRole:{type:Boolean,default:!0},loadingValue:{type:Boolean,default:!0}},data:function(){return{name:"searchbase",iconClass:"fa fa-trash",is_valid:"",search_base:"",loading:this.loadingValue,loadingSpeed:4e3,usersArray:[{id:"user",name:"user"},{id:"admin",name:"admin"},{id:"agent",name:"agent"}],deletePopup:!1,containerStyle:{width:"500px"},searchValueId:"",indexValue:"",organization_ids:[]}},watch:{searchBaseArray(e){return e}},methods:{addQuery(){this.addUser({id:"",search_base:"",filter:"",user_type:"user",departments:[],organizations:[]})},onSearchBase(e,a){let n=a.replace("searchbase","");this.searchBaseArray[n].search_base=e},onFilter(e,a){let n=a.replace("filter-","");this.searchBaseArray[n].filter=e},onOrganizationChange(e,a){this.searchBaseArray[a].organizations=e},onDepartmentChange(e,a){this.searchBaseArray[a].departments=e},onHandle(e,a){this.searchBaseArray[a].user_type=e},confirmLdapPing(e,a){this.loading=!0,S.get("api/ldap/search-base/ping/"+this.ldapId,{params:{search_base:e,filter:a}}).then(n=>{this.loading=!1,P(n,"searchbase")}).catch(n=>{this.loading=!1,I(n,"searchbase")})},deleteUser(e,a){this.deletePopup=!0,e?(this.deletePopup=!0,this.searchValueId=e):this.indexValue=a},onSubmitDelete(){this.searchValueId?S.delete("api/ldap/search-base/"+this.searchValueId).then(e=>{this.deletePopup=!1,P(e,"searchbase"),this.getLdap(),this.searchValueId=""}).catch(e=>{I(e,"searchbase")}):(this.deletePopup=!1,U.dispatch("setAlert",{type:"success",message:"Successfully Deleted",component_name:"searchbase"}),this.searchBaseArray.splice(this.indexValue,1))},onClose(){this.deletePopup=!1,this.searchValueId=""},isValidSearchBase(){const{errors:e,isValid:a}=Ae(this.searchBaseArray);return!!a},saveandImport(e,a){this.loading=!0;let n=_.each(e,function(i){i.user_type==="user"&&(i.department_ids=[]),i.user_type!=="user"&&(i.organization_ids=[]),i.departments&&(i.department_ids=O(i.departments)),i.organizations&&(i.organization_ids=O(i.organizations))});if(this.isValidSearchBase()){const i="/api/ldap/search-bases/"+this.ldapId;S.post(i,{search_bases:n,import:a}).then(o=>{this.loading=!1,P(o,"searchbase"),this.getLdap()}).catch(o=>{this.loading=!1,I(o,"searchbase")})}else this.loading=!1}},components:{"static-select":J,"text-field":W,"dynamic-select":X}},z=e=>(q("data-v-feebcc85"),e=e(),E(),e),Be={key:0,class:"row"},Ve={class:"modal-title"},ze={class:"row"},$e={class:"form-group col-sm-2"},Me={for:"actions"},Te=["id","onClick","title"],Ue=z(()=>t("i",{class:"fa fa-paper-plane"},null,-1)),qe=[Ue],Ee=["id","title","onClick"],He=z(()=>t("i",{class:"fa fa-trash"},null,-1)),Oe=[He],Re={class:"row"},Fe={class:"card-footer"},Ne=["disabled"],je=z(()=>t("span",{class:"fas fa-save"},null,-1)),Qe=["disabled"],Je=z(()=>t("span",{class:"fas fa-save"},null,-1)),We=["disabled"],Ge=z(()=>t("span",{class:"glyphicon glyphicon-plus"},null,-1));function Ke(e,a,n,i,o,s){const c=p("alert"),w=p("custom-loader"),u=p("modal"),k=p("text-field"),y=p("static-select"),f=p("dynamic-select"),L=p("faveo-box");return l(),d("div",null,[r(c,{componentName:"searchbase"}),e.loading===!0?(l(),d("div",Be,[r(w,{duration:e.loadingSpeed},null,8,["duration"])])):g("",!0),e.deletePopup?(l(),C(u,{key:1,classname:"modal-sm",containerStyle:e.containerStyle,showModal:e.deletePopup,onClose:s.onClose},{title:v(()=>[t("h4",Ve,b(e.lang("delete_search_base")),1)]),fields:v(()=>[t("span",null,b(e.lang("delete_confirmation_message")),1)]),controls:v(()=>[t("button",{type:"button",onClick:a[0]||(a[0]=h=>s.onSubmitDelete()),class:"btn btn-danger"},[t("i",{class:H(e.iconClass),"aria-hidden":"true"},null,2),D(" "+b(e.lang("delete")),1)])]),_:1},8,["containerStyle","showModal","onClose"])):g("",!0),r(L,{title:e.lang("import_settings")},{actions:v(()=>[t("div",Fe,[t("button",{class:"btn btn-primary update-btn",id:"query",onClick:a[1]||(a[1]=h=>s.saveandImport(n.searchBaseArray,!1)),disabled:e.loading},[je,D(" "+b(e.lang("save")),1)],8,Ne),t("button",{class:"btn btn-primary update-btn",id:"importquery",onClick:a[2]||(a[2]=h=>s.saveandImport(n.searchBaseArray,!0)),disabled:e.loading},[Je,D(" "+b(e.lang("save_and_import")),1)],8,Qe),t("button",{class:"btn btn-primary update-btn",id:"importquery",onClick:a[3]||(a[3]=(...h)=>s.addQuery&&s.addQuery(...h)),disabled:e.loading},[Ge,D(" "+b(e.lang("add_more")),1)],8,We)])]),default:v(()=>[(l(!0),d(B,null,$(n.searchBaseArray,(h,m)=>(l(),d("div",{key:m,class:"clearfix ldap-import-query"},[t("div",ze,[r(k,{id:"searchbase-"+m,label:e.lang("search_base"),value:h.search_base,type:"text",name:"searchbase"+m,onChange:s.onSearchBase,classname:"col-sm-4",required:!0},null,8,["id","label","value","name","onChange"]),r(k,{id:"filter-"+m,label:e.lang("filter"),value:h.filter,type:"text",name:"filter-"+m,onChange:s.onFilter,classname:"col-sm-6",hint:e.lang("ldap_filter_hint")},null,8,["id","label","value","name","onChange","hint"]),t("div",$e,[t("label",Me,b(e.lang("actions")),1),t("div",null,[h.search_base?(l(),d("span",{key:0,id:"ping-"+m,class:"btn btn-primary",onClick:M=>s.confirmLdapPing(h.search_base,h.filter),title:e.lang("ping_user")},qe,8,Te)):g("",!0),t("span",{id:"delete-"+m,class:"btn btn-danger",title:e.lang("delete_user"),onClick:M=>s.deleteUser(h.id,m)},Oe,8,Ee)])])]),t("div",Re,[n.showRole?(l(),C(y,{key:0,id:"user-type-"+m,label:e.lang("user_type"),elements:e.usersArray,name:m,hideEmptySelect:!0,value:h.user_type,classname:"col-sm-4",onChange:s.onHandle,required:!0},null,8,["id","label","elements","name","value","onChange"])):g("",!0),h.user_type!=="user"&&n.showDepartment?(l(),C(f,{key:"search-base-"+m+"-department",id:"search-base-"+m+"-department",apiEndpoint:"/api/dependency/departments",label:e.lang("department"),multiple:!0,name:m,prePopulate:!1,classname:"col-sm-6",value:h.departments,onChange:s.onDepartmentChange},null,8,["id","label","name","value","onChange"])):g("",!0),h.user_type==="user"&&n.showOrganization?(l(),C(f,{key:"search-base-"+m+"-organization",id:"search-base-"+m+"-organization",apiEndpoint:"/api/dependency/organizations",label:e.lang("organizations"),multiple:!0,name:m,prePopulate:!1,classname:"col-sm-6",value:h.organizations,onChange:s.onOrganizationChange},null,8,["id","label","name","value","onChange"])):g("",!0)])]))),128))]),_:1},8,["title"])])}const Xe=V(Pe,[["render",Ke],["__scopeId","data-v-feebcc85"]]);const Ye={name:"ldap-table",description:"Ldap table component",setup(){const e=K();return{formattedTime:T(()=>e.getters.formattedTime)}},props:{ldapId:{type:String,default:""}},data(){return{showModal:!1,data:{id:0,name:""},hasDataPopulated:!1,minimized:!0,base:window.axios.defaults.baseURL,columns:["name","created_at","updated_at","is_default","action"],options:{},apiUrl:"/api/dependency/ldap-directory-attributes/"+this.ldapId}},beforeMount(){const e=this;this.options={headings:{name:this.lang("name"),created_at:this.lang("created_at"),updated_at:this.lang("updated_at"),is_default:this.lang("is_default"),action:this.lang("action")},texts:{filter:"",limit:""},templates:{action:(a,n)=>e.h(ne,{data:n}),is_default:(a,n)=>e.h(ie,{data:n}),created_at:(a,n)=>this.formattedTime(n.created_at),updated_at:(a,n)=>this.formattedTime(n.updated_at)},sortable:["name","created_at","updated_at","is_default"],filterable:["name","created_at","updated_at"],pagination:{chunk:5,nav:"scroll"},requestAdapter(a){return{sort_field:a.orderBy?a.orderBy:"is_default",sort_order:a.ascending?"desc":"asc",search_query:a.query.trim(),page:a.page,limit:a.limit}},responseAdapter({data:a}){return{data:a.data.data.map(n=>(n.edit_modal="api/ldap/ldap-directory-attribute/"+e.ldapId,n.delete_url=window.axios.defaults.baseURL+"/api/ldap/ldap-directory-attribute/"+n.id,n.active=n.active=="1"?"active":"inactive",n)),count:a.data.total}}}},methods:{toggleList(){this.minimized=!this.minimized,this.minimized?this.hasDataPopulated=!1:this.hasDataPopulated=!0},onClose(){this.showModal=!1,this.$store.dispatch("unsetValidationError")}},components:{"data-table-modal":le,"tool-tip":Y}},Ze=e=>(q("data-v-adfe8adf"),e=e(),E(),e),xe={class:"card card-light"},ea={class:"card-header"},aa={class:"card-title"},ta=["title"],sa=["title"],na={class:"card-body"},la={class:"box-header"},ia={class:"row"},oa={key:0,class:"col-md-12"},da=Ze(()=>t("span",{class:"glyphicon glyphicon-plus"},null,-1)),ra={class:"card-footer"};function pa(e,a,n,i,o,s){const c=p("alert"),w=p("tool-tip"),u=p("data-table"),k=p("data-table-modal");return l(),d("div",null,[r(c,{componentName:"dataTableModal"}),t("div",xe,[t("div",ea,[t("h3",aa,b(e.lang("directory_attributes")),1),r(w,{message:e.lang("directory_attributes_description"),size:"large"},null,8,["message"]),t("a",{id:"toggle-list-button",onClick:a[0]||(a[0]=(...y)=>s.toggleList&&s.toggleList(...y))},[o.minimized?(l(),d("span",{key:0,class:"pull-right glyphicon glyphicon-menu-down",title:e.lang("expand")},null,8,ta)):(l(),d("span",{key:1,class:"pull-right glyphicon glyphicon-menu-up",title:e.lang("collapse")},null,8,sa))])]),t("div",na,[t("div",{class:H(["toggle1",{"toggle-expand":o.hasDataPopulated}])},[t("div",la,[t("div",ia,[o.minimized?g("",!0):(l(),d("div",oa,[t("a",{class:"btn btn-primary right",onClick:a[1]||(a[1]=y=>o.showModal=!0),href:"javascript:;"},[da,D(" "+b(e.lang("add_more")),1)])]))])]),o.hasDataPopulated?(l(),C(u,{key:0,url:o.apiUrl,dataColumns:o.columns,option:o.options},null,8,["url","dataColumns","option"])):g("",!0)],2)]),t("div",ra,[o.showModal?(l(),C(k,{key:0,title:"create",onClose:s.onClose,showModal:o.showModal,apiUrl:"api/ldap/ldap-directory-attribute/"+this.ldapId,data:o.data},null,8,["onClose","showModal","apiUrl","data"])):g("",!0)])])])}const ca=V(Ye,[["render",pa],["__scopeId","data-v-adfe8adf"]]),F="api/ldap/settings/",ua={name:"ldap-settings",description:"ldap setting page",beforeMount(){const e=Z(window.location.pathname);this.ldapId=e||"",this.ldapId!==""?this.getldapSetting():(this.hasDataPopulated=!0,this.loading=!1)},data:function(){return{domain:"",is_valid:0,password:"",port:null,encryption:null,schema:"active_directory",ldap_label:"",forgot_password_link:"",prefix:"",suffix:"",username:"",user_type:"",search_bases:[],show_organization:!0,show_department:!0,show_role:!0,loading:!0,loadingSpeed:4e3,hasDataPopulated:!1,message:"",ldapId:"",tableHeadings:{faveo:{header:"faveo_attribute",description:"faveo_attribute_description"},thirdParty:{header:"active_directory_attribute",description:"active_directory_attribute_description"},overwrite:{header:"overwrite",description:"ldap_overwrite_description"}}}},watch:{},methods:{getldapSetting(){this.loading=!0,S.get(F+this.ldapId).then(e=>{this.loading=!1,this.hasDataPopulated=!0,this.updateStatesWithData(e.data.data),this.message=e.data.message,e.data.data.search_bases.length>0||setTimeout(()=>{this.search_bases.push({id:"",search_base:"",filter:"",user_type:"user",departments:[],organizations:[]})},5)}).catch(e=>{this.loading=!1})},updateStatesWithData(e){const a=this,n=this.$data;Object.keys(e).map(i=>{n.hasOwnProperty(i)&&(a[i]=e[i])})},addUser(e){this.search_bases.push(e)},onChange(e,a){this[a]=e},confirmLdapPing(e){this.loading=!0,S.get("api/ldap/search-base/ping",{params:{search_base:e}}).then(a=>{this.loading=!1,P(a,"searchbase")}).catch(a=>{this.loading=!1,I(a,"searchbase")})},deleteUser(e){this.search_bases.splice(e,1)},saveConfiguration(){this.isValid()&&(this.loading=!0,S.post(F,this.getSaveApiParams()).then(e=>{this.loading=!1,this.showSearchQueryBlock=!0,P(e,"ldap"),this.ldapId=e.data.data.ldap_id,this.getldapSetting()}).catch(e=>{this.loading=!1,I(e,"ldap")}))},getSaveApiParams(){return{id:this.ldapId!==""?this.ldapId:void 0,domain:this.domain,username:this.username,password:this.password,port:this.port,encryption:this.encryption,schema:this.schema,ldap_label:this.ldap_label,forgot_password_link:this.forgot_password_link,prefix:this.prefix,suffix:this.suffix}},isValid(){const{errors:e,isValid:a}=Ie(this.$data);return!!a}},computed:{schemas(){return[{id:"active_directory",name:"ActiveDirectory"},{id:"open_ldap",name:"OpenLDAP"},{id:"free_ipa",name:"FreeIPA"}]},encryptions(){return[{id:null,name:"None"},{id:"ssl",name:"SSL"},{id:"tls",name:"TLS"}]}},components:{"static-select":J,"text-field":W,"search-basis":Xe,"user-import-mapper":ae,"ldap-table":ca,checkbox:oe}},ha={class:"col-sm-12"},ma={key:1},ga={key:0,id:"ldap-configure-warning",class:"alert alert-warning text-uppercase"},_a=t("span",null,[t("i",{class:"fa fa-exclamation-triangle"})],-1),fa={style:{"margin-top":"2rem"}},ba={class:"row"},ya={style:{"margin-top":"2rem"}},va={class:"row"},wa={class:"card-footer"},Ca=["disabled"],ka=t("span",{class:"fas fa-save"},null,-1);function La(e,a,n,i,o,s){const c=p("custom-loader"),w=p("alert"),u=p("text-field"),k=p("static-select"),y=p("faveo-box"),f=p("search-basis"),L=p("user-import-mapper"),h=p("ldap-table"),m=G("focus-first-input");return l(),d("div",ha,[!e.hasDataPopulated||e.loading?(l(),C(c,{key:0,duration:e.loadingSpeed},null,8,["duration"])):g("",!0),r(w,{componentName:"ldap"}),e.hasDataPopulated?(l(),d("div",ma,[r(y,{title:e.lang("ldap_configuration_settings")},{actions:v(()=>[t("div",wa,[t("button",{id:"ldap-settings-submit",class:"btn btn-primary",onClick:a[0]||(a[0]=(...M)=>s.saveConfiguration&&s.saveConfiguration(...M)),disabled:e.loading},[ka,D("  "+b(e.lang("save_configuration")),1)],8,Ca)])]),default:v(()=>[e.message?(l(),d("h6",ga,[_a,D(),t("span",null,b(e.message),1)])):g("",!0),t("div",fa,[r(y,{title:e.lang("connection_settings")},{default:v(()=>[A((l(),d("div",ba,[r(u,{label:e.lang("ldap_domain"),value:e.domain,type:"text",name:"domain",onChange:s.onChange,placehold:e.lang("enter_a_value"),classname:"col-md-4",required:!0,id:"domain"},null,8,["label","value","onChange","placehold"]),r(u,{label:e.lang("username"),value:e.username,type:"text",name:"username",onChange:s.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-4",required:!0,id:"username"},null,8,["label","value","onChange","placehold"]),r(u,{label:e.lang("password"),value:e.password,type:"password",name:"password",onChange:s.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-4",required:!0,id:"password"},null,8,["label","value","onChange","placehold"]),r(k,{label:e.lang("ldap_schema"),elements:s.schemas,name:"schema",value:e.schema,classname:"col-sm-4",onChange:s.onChange,placeHolder:e.lang("select"),hint:e.lang("ldap_schema_description"),id:"schema"},null,8,["label","elements","value","onChange","placeHolder","hint"]),r(u,{label:e.lang("port"),value:e.port,type:"number",name:"port",onChange:s.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-4",hint:e.lang("ldap_port_hint"),id:"port"},null,8,["label","value","onChange","placehold","hint"]),r(k,{label:e.lang("encryption"),elements:s.encryptions,name:"encryption",value:e.encryption,classname:"col-sm-4",onChange:s.onChange,placeHolder:e.lang("select"),hint:e.lang("ldap_encryption_hint"),id:"encryption"},null,8,["label","elements","value","onChange","placeHolder","hint"])])),[[m]])]),_:1},8,["title"])]),t("div",ya,[r(y,{title:e.lang("login_settings")},{default:v(()=>[t("div",va,[r(u,{label:e.lang("ldap_label"),value:e.ldap_label,type:"text",name:"ldap_label",onChange:s.onChange,classname:"col-sm-4",hint:e.lang("ldap_label_hint"),id:"label"},null,8,["label","value","onChange","hint"]),r(u,{label:e.lang("forgot_password_link"),value:e.forgot_password_link,type:"text",name:"forgot_password_link",onChange:s.onChange,classname:"col-sm-4",hint:e.lang("forgot_password_link_description"),id:"forgot-password-link"},null,8,["label","value","onChange","hint"]),r(u,{label:e.lang("username_prefix"),value:e.prefix,type:"text",name:"prefix",onChange:s.onChange,classname:"col-sm-4",hint:e.lang("username_prefix_description"),id:"prefix"},null,8,["label","value","onChange","hint"]),r(u,{label:e.lang("username_suffix"),value:e.suffix,type:"text",name:"suffix",onChange:s.onChange,classname:"col-sm-4",hint:e.lang("username_suffix_description"),id:"suffix"},null,8,["label","value","onChange","hint"])])]),_:1},8,["title"])])]),_:1},8,["title"]),e.is_valid!=0?(l(),C(f,{key:0,"ldap-id":e.ldapId,addUser:s.addUser,searchBaseArray:e.search_bases,getLdap:s.getldapSetting,showOrganization:e.show_organization,showDepartment:e.show_department,showRole:e.show_role,loadingValue:e.loading},null,8,["ldap-id","addUser","searchBaseArray","getLdap","showOrganization","showDepartment","showRole","loadingValue"])):g("",!0),e.is_valid!=0?(l(),C(L,{key:1,"api-endpoint":"/api/ldap/advanced-settings/"+e.ldapId,updateParent:s.getldapSetting,"table-headings":e.tableHeadings},null,8,["api-endpoint","updateParent","table-headings"])):g("",!0),e.is_valid!=0?(l(),C(h,{key:2,"ldap-id":e.ldapId},null,8,["ldap-id"])):g("",!0)])):g("",!0)])}const N=V(ua,[["render",La]]);const Sa={props:["data"],setup(){const e=K();return{buttonStyle:T(()=>e.getters.getButtonStyle),linkStyle:T(()=>e.getters.getLinkStyle)}},data(){return{disabled:!1,ldapSettings:null,login_via_ldap:!1,oauthLogin:""}},beforeMount(){this.ldapSettings=JSON.parse(this.data).providerData.ldap_meta_settings,this.ldapSettings.hide_default_login&&this.hideDefaultLogin(),this.oauthLogin=JSON.parse(this.data).login_type},mounted(){window.emitter.on("login-success",()=>{this.disabled=!0}),window.emitter.on("login-failure",()=>{this.disabled=!1,this.login_via_ldap=!1}),window.emitter.on("logging-in-with-enter-key",()=>{document.getElementById("default-login-button").style.display=="none"&&document.getElementById("ldap-login-button-0").click()})},methods:{hideDefaultLogin(){document.getElementById("default-login-button").style.display="none",document.getElementById("default-forgot-password").style.display="none"},ldapLoginSubmit(e){this.login_via_ldap=!0,window.emitter.on("login-data-submitting",a=>{a.ldap=this.login_via_ldap,a.ldap_id=e}),document.getElementById("default-login-button").click()}}},Da={id:"ldap-login"},Ia={class:"ldap-login-block"},Aa=["id","disabled","onClick"],Pa={key:0},Ba=["id","href"];function Va(e,a,n,i,o,s){return l(),d("div",Da,[(l(!0),d(B,null,$(o.ldapSettings.directory_settings,(c,w)=>(l(),d("span",Ia,[t("button",{id:"ldap-login-button-"+w,class:H(["ldap-login-button btn-block btn-flat",o.oauthLogin!=="oAuth"?"btn btn-custom mt-1 mb-1":"btn-light link-dark border-0 p-2 mt-2 mb-2"]),disabled:o.disabled,style:R(o.oauthLogin!=="oAuth"?i.buttonStyle:"border-radius: 4px !important; border-width: 1px !important; border-color: #BDC1CAFF !important; border-style: solid !important;"),onClick:()=>s.ldapLoginSubmit(c.id)},[o.oauthLogin==="oAuth"?(l(),d("strong",Pa,b(c.ldap_label!==""?c.ldap_label:e.lang("login_via_ldap")),1)):(l(),d(B,{key:1},[D(b(c.ldap_label!==""?c.ldap_label:e.lang("login_via_ldap")),1)],64))],14,Aa),c.forgot_password_link!==""?(l(),d("a",{key:0,id:"ldap-forgot-password-"+w,href:c.forgot_password_link,target:"_blank",style:R(i.linkStyle)},b(e.lang("forgot_ldap_password")),13,Ba)):g("",!0)]))),256))])}const za=V(Sa,[["render",Va]]);let $a={path:"/ldap",component:se,name:"LDAP",redirect:"/ldap/settings",children:[{path:"settings",component:De,name:"LDAP Settings",meta:{title:"ldap",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},active:"ldap_settings"}}},{path:"settings/create",component:N,name:"LDAP Create",meta:{title:"ldap",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},parent_link:{name:"ldap_settings",to:"/ldap"},active:"create"}}},{path:"settings/:id/edit",component:N,name:"LDAP Edit",meta:{title:"ldap",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},parent_link:{name:"ldap_settings",to:"/ldap"},active:"edit"}}}]};te.addRoute($a);x("ldap-login",za,"login-box-mounted","login-box");
