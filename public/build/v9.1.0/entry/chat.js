import{_ as y,s as U,e as T,p as B,k as X,j as N,D as F,V as R,l as x,c as W,M as Y,N as $}from"../chunks/bootstrap.js";import{r as c,o as l,c as r,b as V,Z as O,f as a,t as d,B as tt,n as w,d as m,u as j,m as z,e as o,a as v,q as D,i as I,g as b,F as E,w as k,h as A,z as et,G as S}from"../chunks/vendor.js";import{r as at,A as st}from"../chunks/adminRouter.js";import{S as H}from"../chunks/FormGenerator.js";import{a as J,C as it}from"../chunks/DataTableActions.js";import"../chunks/HelpSection.js";import"../chunks/AdminNavigationBar.js";const nt={components:{"status-switch":H},props:["data"],methods:{onChange(t,e){this.statusChange(e)},statusChange(t){axios.get("chat/api/status/"+t).then(e=>{U(e,"dataTableModal"),window.emitter.emit("refreshData")}).catch(e=>{T(e,"dataTableModal")})}}},ot={class:"btn-group"};function lt(t,e,i,u,s,n){const h=c("status-switch");return l(),r("div",ot,[(l(),V(h,{name:i.data.id,value:i.data.status,key:Math.random(),onChange:n.onChange},null,8,["name","value","onChange"]))])}const rt=y(nt,[["render",lt]]);const dt={name:"click-to-copy",description:"Reusable component which handles copying of text content to clipboard on click.",props:{data:{type:Object,required:!0}},data(){return{copied:!1}},methods:{copyToClipboard(){O(this.data.textToCopy),this.copied=!0,this.showCopyIconAfterCopying()},subString(t,e=15){return B(t,e)},showCopyIconAfterCopying(){setTimeout(()=>{this.copied=!1},5e3)}}},ct={class:"wrapping-div"},ht={class:"text-left url-paragraph"};function ut(t,e,i,u,s,n){return l(),r("div",null,[a("div",ct,[a("p",ht,d(i.data.textToCopy?n.subString(i.data.textToCopy,100):"--"),1),i.data.textToCopy?(l(),r("button",{key:0,title:"Click to copy",class:"pull-right unstyled-button",onClick:e[0]||(e[0]=tt((...h)=>n.copyToClipboard&&n.copyToClipboard(...h),["prevent"]))},[a("i",{class:w(s.copied?"glyphicon glyphicon-ok green":"fa fa-clipboard")},null,2)])):m("",!0)])])}const pt=y(dt,[["render",ut],["__scopeId","data-v-fa0b43b2"]]);const _t={setup(){const t=j();return{formattedTime:z(()=>t.getters.formattedTime)}},data(){return{apiUrl:"chat/api/chats",loading:!1,columns:["name","url","department","helptopic","status","action"],options:{},duration:4e3}},methods:{subString(t,e=30){return B(t,e)}},beforeMount(){const t=this;this.options={headings:{name:this.trans("name"),url:this.trans("url"),status:this.trans("status"),action:this.trans("action"),helptopic:this.trans("helptopic"),department:this.trans("department")},columnsClasses:{name:"chat-name",url:"chat-url",status:"chat-status",action:"chat-action",department:"chat-department",helptopic:"chat-helptopic"},sortIcon:{base:"glyphicon",up:"glyphicon-chevron-up",down:"glyphicon-chevron-down"},texts:{filter:"",limit:""},templates:{url:(e,i)=>t.h(pt,{data:i}),department:function(e,i,u){return i.department?i.department.name:"--"},helptopic:function(e,i,u){return i.helptopic?i.helptopic.name:"--"},status:(e,i)=>i.edit_url=="/chat/widget"?"--":t.h(rt,{data:i}),action:(e,i)=>t.h(J,{data:i})},requestAdapter(e){return{sort_field:e.orderBy?e.orderBy:"id",sort_order:e.ascending?"desc":"asc",search_term:e.query.trim(),page:e.page,limit:e.limit}},responseAdapter({data:e}){return{data:e.data.chats.map(i=>(i.edit_url=i.short==="widget"?"/chat/widget":"/chat/"+i.id+"/edit",i.textToCopy=i.url,i)),count:e.data.total}},sortable:["name","department","helptopic"],filterable:["name","department","helptopic"],pagination:{chunk:5,nav:"fixed",edge:!0}}}},gt={class:"col-sm-12"},mt={class:"card card-light"},wt={class:"card-header"},ft={class:"card-title"},bt={class:"card-body",id:"chat-view"};function vt(t,e,i,u,s,n){const h=c("alert"),_=c("data-table");return l(),r("div",gt,[o(h,{componentName:"dataTableModal"}),a("div",mt,[a("div",wt,[a("h3",ft,d(t.lang("chat_settings")),1)]),a("div",bt,[o(_,{url:s.apiUrl,dataColumns:s.columns,option:s.options,scroll_to:"chat-view"},null,8,["url","dataColumns","option"])])])])}const yt=y(_t,[["render",vt]]);const Ct={data(){return{departmentUrl:"api/dependency/departments?meta=true",helptopicUrl:"api/dependency/help-topics?meta=true",secret_key:"",secret_key_required:!1,department:"",helptopic:"",required:!0,url:"",depUrlBit:"",helpUrlBit:"",name:"",script:"",additional_secret_keys:"",id:""}},watch:{department(t){t&&(this.depUrlBit=t.id,this.generateUrl())},helptopic(t){t?(this.helpUrlBit=t.id,this.generateUrl()):(this.helpUrlBit="",this.generateUrl())}},methods:{onChange(t,e){this[e]=t},generateUrl(){this.url=this.basePath()+"/chat/"+this.name+"/"+this.depUrlBit+(this.helpUrlBit!==""&&this.helpUrlBit!==null?"/"+this.helpUrlBit:"")},submit(){v.put("chat/api/update/"+this.id,{department:this.department,helptopic:this.helptopic,secret_key:this.secret_key,url:this.url,script:this.script,additional_secret_keys:this.additional_secret_keys}).then(t=>{this.$store.dispatch("unsetValidationError"),U(t,"chatEdit"),setTimeout(()=>this.$router.push({name:"Chat Settings"}),3e3)}).catch(t=>{T(t,"chatEdit")})},getChatId(t){v.get("/chat/api/validate/"+t).then(e=>{this.id=e.data.data,this.getChatDetails()})},getChatDetails(){v.get("/chat/api/chats?ids[]="+this.id).then(t=>{let e=t.data.data.chats[0];this.department=e.department,this.helptopic=e.helptopic,this.url=e.url,this.secret_key=e.secret_key,this.secret_key_required=!!e.secret_key_required,this.name=e.short,this.script=e.script,this.additional_secret_keys=e.additional_secret_keys})}},beforeMount(){this.getChatId(X(window.location.pathname))},components:{"text-field":N,"dynamic-select":F}},kt={class:"col-sm-12"},qt={class:"card card-light"},Et={class:"card-header"},Tt={class:"card-title"},It={class:"card-body"},St={class:"row"},Ut={class:"row"},Vt={class:"row"},Dt={class:"row"},Mt={class:"card-footer"},At=a("i",{class:"fas fa-save"},null,-1);function Pt(t,e,i,u,s,n){const h=c("alert"),_=c("dynamic-select"),g=c("text-field"),f=D("focus-first-input");return l(),r("div",kt,[o(h,{componentName:"chatEdit"}),a("div",qt,[a("div",Et,[a("h3",Tt,d(t.lang("edit")),1)]),a("div",It,[I((l(),r("div",St,[o(_,{name:"department",classname:"col-sm-6",apiEndpoint:s.departmentUrl,multiple:!1,prePopulate:!1,label:t.lang("department"),value:s.department,onChange:n.onChange,required:s.required,clearable:!1},null,8,["apiEndpoint","label","value","onChange","required"]),o(_,{name:"helptopic",classname:"col-sm-6",apiEndpoint:s.helptopicUrl,multiple:!1,prePopulate:!1,label:t.lang("helptopic"),value:s.helptopic,onChange:n.onChange,clearable:!0},null,8,["apiEndpoint","label","value","onChange"])])),[[f]]),a("div",Ut,[o(g,{label:t.lang("url_webhook"),onChange:n.onChange,placehold:t.lang("enter_a_value"),value:s.url,type:"text",name:"url",disabled:!0,classname:"col-sm-6",hint:t.lang("url_hint"),id:"url"},null,8,["label","onChange","placehold","value","hint"]),o(g,{label:t.lang("secret_key"),onChange:n.onChange,placehold:t.lang("enter_a_value"),value:s.secret_key,type:"text",name:"secret_key",classname:"col-sm-6",disabled:!s.secret_key_required,hint:t.lang("secret_key_hint"),id:"secret_key",required:s.required},null,8,["label","onChange","placehold","value","disabled","hint","required"])]),a("div",Vt,[o(g,{label:t.lang("additional_secret_keys"),onChange:n.onChange,placehold:t.lang("enter_a_value"),value:s.additional_secret_keys,name:"additional_secret_keys",classname:"col-sm-12",rows:"2",type:"textarea",hint:t.lang("additional_secret_keys_hint"),id:"additional_secret_keys"},null,8,["label","onChange","placehold","value","hint"])]),a("div",Dt,[o(g,{label:t.lang("chat_widget_script"),onChange:n.onChange,placehold:t.lang("enter_a_value"),value:s.script,name:"script",classname:"col-sm-12",rows:"6",type:"textarea",hint:t.lang("chat_widget_script_hint"),id:"script"},null,8,["label","onChange","placehold","value","hint"])])]),a("div",Mt,[a("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=(...q)=>n.submit&&n.submit(...q))},[At,b(" "+d(t.lang("save")),1)])])])])}const Bt=y(Ct,[["render",Pt]]);function Nt(t){const{widget_name:e,widget_color:i,websites:u,selectedForm:s}=t;let n={widget_name:[e,"isRequired"],widget_color:[i,"isRequired"],websites:[u,"isRequired"],selectedForm:[s,"isRequired"]};const h=new R(x),{errors:_,isValid:g}=h.validate(n);return W.dispatch("setValidationError",_),{errors:_,isValid:g}}function Ft(t){const{height:e,width:i}=t;let u={height:[e,"isRequired",{"minValue(490)":"Please enter a value greater than or equal to 490."},{"maxValue(850)":"Please enter a value lesser than or equal to 850."}],width:[i,"isRequired",{"minValue(400)":"Please enter a value greater than or equal to 400."},{"maxValue(1000)":"Please enter a value lesser than or equal to 1000."}]};const s=new R(x),{errors:n,isValid:h}=s.validate(u);return W.dispatch("setValidationError",n),{errors:n,isValid:h}}const Rt={name:"widget-settings-component",data(){return{widgetId:"",loading:!0,widgetData:"",widget_name:"",showErr:!1,colorErr:"",widget_color:"#3c8dbc",widget_code:"",widget_status:1,showCopyButton:!1,copied:!1,websites:[],direct_chat_url:"",widget_position:"bottom-right",posOptions:["bottom-right","bottom-left","top-right","top-left","center-right","center-left"],positionToDivMap:{"top-left":1,"top-right":3,"center-left":4,"center-right":6,"bottom-left":7,"bottom-right":9},showAppearanceModal:!1,height:600,width:420,attention_grab:!1,attachment:"",attachPath:"",page_title:"create_widget",iconClass:"fas fa-save",btnName:"save",hasDataPopulated:!1,fileChoosen:!1,selectedForm:""}},beforeMount(){const t=window.location.pathname;this.getValues(t)},watch:{widget_color(t,e){return t=="#"&&(this.widget_color=""),this.widget_color}},methods:{onClose(){this.$store.dispatch("unsetValidationError"),this.showAppearanceModal=!1,this.height=this.height?this.height:600,this.width=this.width?this.width:420},getValues(t){let e=t.split("/");this.$route.path!=="/chat/widget/create"?(this.widgetId=e[e.length-1],this.page_title="edit_widget",this.iconClass="fas fa-sync-alt",this.btnName="update",this.hasDataPopulated=!1,this.getData()):(this.loading=!1,this.hasDataPopulated=!0)},async getAttachmentInfo(t){let e=JSON.stringify(t.files);this.loading=!0;try{let i=await v.get("file-manager/files-info",{params:{names:e,disk:t.disk}});this.attachment=i.data.data[0],this.attachPath=this.basePath()+"/file-manager/thumbnails?disk="+this.attachment.disk+"&path="+this.attachment.filename,this.fileChoosen=!0}catch{this.fileChoosen=!1,await this.$store.dispatch("setAlert",{type:"danger",message:this.lang("file-manager-modal-error-message"),component_name:"widget-appearance"})}finally{this.loading=!1}},isModalValid(){const{errors:t,isValid:e}=Ft(this.$data);return e},onSave(){this.isModalValid()&&(this.showAppearanceModal=!1)},getDivStyle(t,e){return e===this.positionToDivMap[t]?{backgroundColor:this.widget_color}:{}},copyText(t){O(t),this.copied=!0,setTimeout(()=>{this.copied=!1},1e3)},onChange(t,e){this[e]=t||""},getData(){this.loading=!0,v.get("/chat/api/widgets?id="+this.widgetId).then(t=>{this.hasDataPopulated=!0,this.loading=!1,this.widget_name=t.data.data.name,this.widget_color=t.data.data.color_code;let e=`&lt;script type="text/javascript"&gt;(function(){
                        var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
                        s1.src="${t.data.data.url}/widget.js?uuid=${t.data.data.id}";
                        s1.async=true;s1.charset='UTF-8';
                        s1.setAttribute('data-url', "${t.data.data.url}");
                        s1.setAttribute('data-id', "${t.data.data.id}");
                        s0.parentNode.insertBefore(s1,s0);})();
                        &lt;/script&gt;`;this.widget_code=e.replaceAll("&lt;","<").replaceAll("&gt;",">"),this.widget_status=t.data.data.status,this.websites=t.data.data.websites,this.widget_position=t.data.data.position,this.height=t.data.data.height,this.width=t.data.data.width,this.attachment=t.data.data.attach,this.attention_grab=t.data.data.is_grabber,this.attention_grab&&(this.attachPath=this.attachment?this.attachment.view_url:""),this.direct_chat_url=t.data.data.url+"/chat-widget?chat_url="+encodeURIComponent(t.data.data.url)+"&chat_id="+encodeURIComponent(t.data.data.id)+"&chat_data="+encodeURIComponent(JSON.stringify(t.data.data)),this.selectedForm=t.data.data.form_category}).catch(t=>{this.loading=!1,T(t,"widget-settings"),setTimeout(()=>{this.$router.push({name:"Chat Widget Index"})},3e3)})},isValid(){const{errors:t,isValid:e}=Nt(this.$data);return e},onUpdate(){if(this.widget_color=this.widget_color=="#"?"":this.widget_color,this.showErr=!this.widget_color,this.isValid()){this.loading=!0;let t={};t.name=this.widget_name,t.color_code=this.widget_color,this.widgetId&&(t.id=this.widgetId),t.status=this.widget_status?1:0,t.websites=this.websites.map(e=>typeof e=="object"?e.name:e),t.form_category_id=this.selectedForm.id,t.position=this.widget_position,t.is_grabber=!!this.attention_grab,this.fileChoosen&&!this.attachment.id&&(t.grabber_image=this.attention_grab?this.attachment:""),this.attachment&&this.attachment.id&&(t.grabber_image_id=this.attachment.id),t.height=this.height?this.height:600,t.width=this.width?this.width:420,v.post("/chat/api/widget",t).then(e=>{this.fileChoosen=!1,this.colorErr="",this.loading=!1,U(e,"widget-settings"),this.widgetId?this.getData():setTimeout(()=>this.$router.push({name:"Chat Widget Index"}),3e3)}).catch(e=>{this.loading=!1,e.response.data.message&&e.response.data.message.color_code&&(this.colorErr=e.response.data.message.color_code),T(e,"widget-settings")})}}},components:{"status-switch":H,"color-picker":it,"text-field":N,"dynamic-select":F,modal:Y,"number-field":$}},xt={class:"col-sm-12"},Wt={key:0,class:"row"},Ot={key:1,class:"card card-light"},jt={class:"card-header"},zt={class:"card-title mt-1"},Ht={class:"card-body"},Jt={class:"row"},Lt={class:"row"},Gt={class:"form-group col-sm-12"},Zt={for:"status"},Kt=a("label",{class:"is-danger"}," *",-1),Qt=a("br",null,null,-1),Xt={class:"form-group col-sm-6"},Yt={for:"status"},$t=a("label",{class:"is-danger"}," *",-1),te=a("br",null,null,-1),ee={key:0,class:"col-sm-6"},ae={class:"row"},se={class:"form-group col-sm-12 widget-code"},ie={for:"status"},ne=a("label",{class:"is-danger"}," *",-1),oe=a("br",null,null,-1),le=["value"],re={class:"overlay"},de={class:"row"},ce={key:0,class:"form-group col-sm-12"},he={class:"input-group"},ue=["value"],pe={class:"input-group-append"},_e={class:"row"},ge=a("span",{class:"text-red"},"*",-1),me={key:0,class:"error-block is-danger"},we={key:1,class:"is-danger"},fe={class:"col-sm-1"},be={class:"modal-title"},ve={class:"row"},ye={class:"col-sm-6 card p-3"},Ce={class:"row"},ke={class:"col-sm-12"},qe={class:"form-group"},Ee={class:"desktop-wdget-pos-scltr wdgt-pos-slctr"},Te=["onClick"],Ie=["id","value","checked"],Se=["for"],Ue={class:"row"},Ve={class:"row"},De={class:"form-group col-sm-6 d-flex mt-2"},Me={for:"status"},Ae={key:0,class:"col-sm-6"},Pe={class:"col-sm-6"},Be={class:"card"},Ne={class:"card-body h-300v"},Fe=["src"],Re=a("i",{class:"fas fa-comment-alt sv-icon"},null,-1),xe=[Re],We=a("i",{class:"fas fa-check"},null,-1),Oe={class:"card-footer"};function je(t,e,i,u,s,n){const h=c("custom-loader"),_=c("alert"),g=c("text-field"),f=c("status-switch"),q=c("dynamic-select"),L=c("color-picker"),M=c("number-field"),G=c("file-manager-container"),Z=c("modal"),K=D("tooltip");return l(),r("div",xt,[s.hasDataPopulated===!1||s.loading===!0?(l(),r("div",Wt,[o(h)])):m("",!0),o(_,{componentName:"widget-settings"}),s.hasDataPopulated?(l(),r("div",Ot,[a("div",jt,[a("h3",zt,d(t.trans("widget-settings")),1)]),a("div",Ht,[a("div",Jt,[a("div",{class:w(s.widgetId?"col-sm-6":"col-sm-12")},[a("div",Lt,[s.widgetId?(l(),r(E,{key:0},[o(g,{label:t.trans("widget-name"),value:s.widget_name,name:"widget_name",onChange:n.onChange,placehold:t.lang("enter_a_value"),required:!0,classname:"col-sm-12"},null,8,["label","value","onChange","placehold"]),a("div",Gt,[a("label",Zt,d(t.trans("widget-status")),1),Kt,Qt,o(f,{name:"widget_status",value:s.widget_status,onChange:n.onChange,bold:!0},null,8,["value","onChange"])]),o(g,{label:t.trans("widget-id"),value:s.widgetId,name:"widget_id",onChange:n.onChange,required:!1,disabled:!0,classname:"col-sm-12"},null,8,["label","value","onChange"])],64)):(l(),r(E,{key:1},[o(g,{label:t.trans("widget-name"),value:s.widget_name,name:"widget_name",onChange:n.onChange,placehold:t.lang("enter_a_value"),required:!0,classname:"col-sm-6"},null,8,["label","value","onChange","placehold"]),a("div",Xt,[a("label",Yt,d(t.trans("widget-status")),1),$t,te,o(f,{name:"widget_status",value:s.widget_status,onChange:n.onChange,bold:!0},null,8,["value","onChange"])])],64))])],2),s.widgetId?(l(),r("div",ee,[a("div",ae,[a("div",se,[a("label",ie,d(t.trans("widget-code")),1),ne,oe,a("textarea",{id:"widget-code",class:"form-control",value:s.widget_code,name:"widget_code",disabled:!0,rows:8,ref:"widget_code"},`

                                `,8,le),a("div",re,[a("button",{type:"button",class:"btn btn-default",onClick:e[0]||(e[0]=p=>n.copyText(s.widget_code))},[a("i",{class:w(s.copied?"fas fa-check":"fas fa-copy")},null,2),b(" "+d(s.copied?t.trans("copied"):t.trans("copy-to-clipboard")),1)])])])])])):m("",!0)]),a("div",de,[s.widgetId?(l(),r("div",ce,[a("label",null,d(t.trans("direct-chat-link")),1),a("div",he,[a("input",{type:"text",name:"direct_chat_url",class:"form-control text-truncate",value:s.direct_chat_url,disabled:""},null,8,ue),a("span",pe,[a("button",{type:"button",class:"btn btn-default",onClick:e[1]||(e[1]=p=>n.copyText(s.direct_chat_url))},[a("i",{class:w(s.copied?"fas fa-check":"fas fa-copy")},null,2),b(" "+d(s.copied?t.trans("copied"):t.trans("copy")),1)])])])])):m("",!0),o(q,{label:t.trans("enter_website_urls"),multiple:!0,name:"websites",elements:[],value:s.websites,onChange:n.onChange,clearable:!!s.websites,classname:"col-sm-6",taggable:!0,required:!0},null,8,["label","value","onChange","clearable"]),o(q,{label:t.trans("select_form"),multiple:!1,name:"selectedForm",classname:"col-sm-6",apiEndpoint:"/from/forms/ticket",value:s.selectedForm,onChange:n.onChange,required:!0,showIcon:!1},null,8,["label","value","onChange"])]),a("div",_e,[a("div",{class:w(["col-sm-5 form-group",{"has-error":s.showErr||s.colorErr}])},[a("label",null,[b(d(t.trans("widget-color"))+" ",1),ge]),o(L,{color:s.widget_color,name:"widget_color",onColor:n.onChange,showError:s.showErr,colorError:s.colorErr},null,8,["color","onColor","showError","colorError"]),s.showErr?(l(),r("div",me,d(t.trans("this_field_is_required")),1)):m("",!0),!s.showErr&&s.colorErr?(l(),r("span",we,d(s.colorErr),1)):m("",!0)],2),a("div",fe,[a("button",{type:"button",class:"btn btn-default mt-30",onClick:e[2]||(e[2]=p=>s.showAppearanceModal=!0)},d(t.lang("advanced")),1)]),s.showAppearanceModal?(l(),V(Z,{key:0,showModal:!0,onClose:n.onClose},{title:k(()=>[a("h4",be,d(t.trans("widget-appearance")),1)]),alert:k(()=>[o(_,{componentName:"widget-appearance"})]),fields:k(()=>[a("div",ve,[a("div",ye,[a("div",Ce,[a("div",ke,[a("div",qe,[a("label",null,d(t.trans("widget-position")),1),a("div",Ee,[(l(!0),r(E,null,A(s.posOptions,(p,Q)=>I((l(),r("div",{key:Q,class:"widget-pos-selector",onClick:C=>s.widget_position==p},[I(a("input",{name:"desktop-widget-position",id:p,type:"radio",value:p,"onUpdate:modelValue":e[3]||(e[3]=C=>s.widget_position=C),checked:s.widget_position===p},null,8,Ie),[[et,s.widget_position]]),a("label",{class:"tr",for:p,style:S({borderColor:s.widget_position===p?s.widget_color:""})},[(l(),r(E,null,A(9,C=>a("div",{key:C,style:S(n.getDivStyle(p,C))},null,4)),64))],12,Se)],8,Te)),[[K,t.trans(p)]])),128))])])])]),a("div",Ue,[o(M,{label:t.trans("width"),value:s.width,name:"width",classname:"col-sm-6",onChange:n.onChange,type:"number",required:!0},null,8,["label","value","onChange"]),o(M,{label:t.trans("height"),value:s.height,name:"height",classname:"col-sm-6",onChange:n.onChange,type:"number",required:!0},null,8,["label","value","onChange"])]),a("div",Ve,[a("div",De,[a("label",Me,d(t.trans("attention-grabber")),1),b("   "),o(f,{name:"attention_grab",value:s.attention_grab,onChange:n.onChange,bold:!0},null,8,["value","onChange"])]),s.attention_grab?(l(),r("div",Ae,[o(G,{page:"widget",onFilesChosen:n.getAttachmentInfo},null,8,["onFilesChosen"])])):m("",!0)])]),a("div",Pe,[a("div",Be,[a("div",Ne,[s.attention_grab&&s.attachment?(l(),r("div",{key:0,id:"sv-attention-grab",class:w(s.widget_position+"-img")},[s.attachPath?(l(),r("img",{key:0,class:"sv-img-grab",src:s.attachPath,alt:"Chat attention grabber"},null,8,Fe)):m("",!0)],2)):m("",!0),a("div",{id:"sv-widget",class:w(s.widget_position+"-icon"),style:S({background:s.widget_color})},xe,6)])])])])]),controls:k(()=>[a("button",{type:"button",onClick:e[4]||(e[4]=p=>n.onSave()),class:"btn btn-primary"},[We,b(d(t.trans("apply")),1)])]),_:1},8,["onClose"])):m("",!0)])]),a("div",Oe,[a("button",{type:"button",class:"btn btn-primary float-right",onClick:e[5]||(e[5]=p=>n.onUpdate())},[a("i",{class:w(s.iconClass)},null,2),b(" "+d(t.trans(s.btnName)),1)])])])):m("",!0)])}const P=y(Rt,[["render",je]]);const ze={name:"chat-widgets-list",setup(){const t=j();return{formattedTime:z(()=>t.getters.formattedTime)}},data(){return{columns:["name","status","created_at","updated_at","action"],options:{},apiUrl:"/chat/api/widgets"}},beforeMount(){const t=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-up",down:"glyphicon-chevron-down"},texts:{filter:"",limit:""},headings:{name:this.trans("name"),status:this.trans("status"),created_at:this.trans("created_at"),updated_at:this.trans("updated_at"),action:this.trans("action")},columnsClasses:{name:"chat-widget-name",status:"chat-widget-status",created_at:"chat-widget-created",updated_at:"chat-widget-updated"},templates:{created_at(e,i){return t.formattedTime(i.created_at)},updated_at(e,i){return t.formattedTime(i.updated_at)},status:function(e,i){let u=t.h("span",{class:i.status?"btn btn-success btn-xs":"btn btn-danger btn-xs",style:"cursor:auto"},i.status?"Active":"Inactive");return t.h("a",{},[u])},action:(e,i)=>t.h(J,{data:i})},sortable:["name","status","created_at","updated_at"],filterable:["name","status","created_at","updated_at"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(e){return{"sort-field":e.orderBy?e.orderBy:"id","sort-order":e.ascending?"desc":"asc","search-query":e.query.trim(),page:e.page,limit:e.limit}},responseAdapter({data:e}){return{data:e.data.data.map(i=>(i.edit_url="/chat/widget/"+i.id,i.delete_url=t.basePath()+"/chat/api/widget/"+i.id,i)),count:e.data.total}}}}},He={class:"col-sm-12"},Je={class:"card card-light chat-widgets-table"},Le={class:"card-header"},Ge={class:"card-title"},Ze={class:"card-tools"},Ke=a("i",{class:"glyphicon glyphicon-plus"},null,-1),Qe={class:"card-body",id:"chat-widgets-table"};function Xe(t,e,i,u,s,n){const h=c("alert"),_=c("router-link"),g=c("data-table"),f=D("tooltip");return l(),r("div",He,[o(h,{componentName:"dataTableModal"}),a("div",Je,[a("div",Le,[a("h3",Ge,d(t.trans("list_of_chat_widgets")),1),a("div",Ze,[I((l(),V(_,{class:"btn-tool",to:"/chat/widget/create"},{default:k(()=>[Ke]),_:1})),[[f,t.trans("create_new_widget")]])])]),a("div",Qe,[o(g,{url:s.apiUrl,dataColumns:s.columns,option:s.options,scroll_to:"chat-widgets-table"},null,8,["url","dataColumns","option"])])])])}const Ye=y(ze,[["render",Xe]]);let $e={path:"/chat",component:st,name:"Chat",redirect:"/chat/settings",children:[{path:"settings",component:yt,name:"Chat Settings",meta:{title:"chat-integrations",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},active:"chat_settings"}}},{path:":id/edit",component:Bt,name:"Chat Edit",meta:{title:"chat-integrations",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},parent_link:{name:"chat_settings",to:"/chat"},active:"edit_chat"}}},{path:"widget",component:Ye,name:"Chat Widget Index",meta:{title:"chat-widgets",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},active:"chat-widgets"}}},{path:"widget/create",component:P,name:"Widget Settings",meta:{title:"widget-settings",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},parent_link:{name:"chat-widgets",to:"/chat/widget"},active:"create"}}},{path:"widget/:id",component:P,name:"Widget Settings",meta:{title:"widget-settings",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},parent_link:{name:"chat-widgets",to:"/chat/widget"},active:"edit"}}}]};at.addRoute($e);
