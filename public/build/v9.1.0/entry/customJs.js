import{_ as v,j as D,R as L,S as J,s as F,e as A}from"../chunks/bootstrap.js";import{r as S,A as x}from"../chunks/adminRouter.js";import{a as T}from"../chunks/DataTableActions.js";import{r,q as y,o as c,c as g,e as o,w as m,f as l,i as j,b as E,a as f,d as q,g as O,t as P}from"../chunks/vendor.js";import"../chunks/FormGenerator.js";import"../chunks/AdminNavigationBar.js";import"../chunks/HelpSection.js";const B={name:"CustomCssIndex",data(){return{apiUrl:"get-custom-js",loading:!1,columns:["name","fired_at","fire","action"],options:{}}},beforeMount(){const e=this;this.options={headings:{name:e.lang("name"),fired_at:e.lang("fired_at"),fire:e.lang("status"),action:e.lang("actions")},sortIcon:{base:"glyphicon",up:"glyphicon-chevron-up",down:"glyphicon-chevron-down"},texts:{filter:"",limit:""},templates:{fired_at:function(t,s){return s.formatted_fired_at?s.formatted_fired_at:s.fired_at},fire:function(t,s){let n=e.h("span",{class:s.fire?"btn btn-success btn-xs":"btn btn-danger btn-xs"},s.fire?"Active":"Inactive");return e.h("a",{},[n])},action:(t,s)=>e.h(T,{data:s})},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.message.data.map(s=>(s.delete_url=e.basePath()+"/custom-js/delete/"+s.id,s.edit_url="/custom-js/edit/"+s.id,s)),count:t.message.total}},sortable:["name","fired_at","fire"],filterable:["name"],pagination:{chunk:5,nav:"fixed",edge:!0}}}},N={class:"main col-sm-12"},M={class:"card-tools"},V=l("i",{class:"glyphicon glyphicon-plus"},null,-1),I={class:"row",id:"custom-js-view"};function H(e,t,s,n,a,i){const p=r("alert"),h=r("router-link"),u=r("data-table"),d=r("faveo-box"),_=y("tooltip");return c(),g("div",N,[o(p,{componentName:"dataTableModal"}),o(d,{title:e.lang("custom-js")},{headerMenu:m(()=>[l("div",M,[j((c(),E(h,{class:"btn btn-tool",to:"/custom-js/create"},{default:m(()=>[V]),_:1})),[[_,e.lang("create_custom_js")]])])]),default:m(()=>[l("div",I,[o(u,{url:a.apiUrl,dataColumns:a.columns,option:a.options,scroll_to:"custom-js-view",class:"col-sm-12"},null,8,["url","dataColumns","option"])])]),_:1},8,["title"])])}const R=v(B,[["render",H]]),U={name:"CustomJsCreateEdit",components:{"text-field":D,"radio-button":L,"static-select":J},data(){return{name:"",fired_at:"",firedAtElements:[{id:"adminlayout",name:"Admin Layout"},{id:"agentlayout",name:"Agent Layout"},{id:"clientlayout",name:"Client Layout"}],radioOptions:[{name:"active",value:1},{name:"inactive",value:0}],isDisabled:!1,script:"",fire:1,loading:!1,idForEdit:0,parameter:"",parameterElementsList:[]}},mounted(){this.idForEdit&&this.getDetailsForEdit()},beforeMount(){this.setparameterElementsList(),this.setDefaultProps()},computed:{componentTitle(){return this.idForEdit?this.lang("custom_js_edit"):this.lang("custom_js_create")},parameterElements(){return this.fired_at=="adminlayout"&&Object.keys(this.parameterElementsList).length?this.parameterElementsList.admin:this.fired_at=="agentlayout"&&Object.keys(this.parameterElementsList).length?this.parameterElementsList.agent:this.fired_at=="clientlayout"&&Object.keys(this.parameterElementsList).length?this.parameterElementsList.client:[]}},methods:{onChange(e,t){this[t]=e,t=="fired_at"&&(this.parameter="")},async submit(){this.loading=!0;let e,t,s={fired_at:this.fired_at,script:this.script,name:this.name,fire:this.fire,parameter:this.parameter};this.idForEdit?(e=`custom-js/edit/${this.idForEdit}`,t="PATCH"):(e="custom-js/create",t="POST");try{let n=await f.request({method:t,url:e,data:s});this.$store.dispatch("unsetValidationError"),F(n,"customJs"),this.idForEdit?this.fired_at=="adminlayout"&&this.redirect(window.location.href.replace(this.basePath(),"")):this.fired_at=="adminlayout"?(this.redirect("/admin/custom-js/settings"),setTimeout(()=>{this.$router.push({name:"CustomJs Settings"})},3e3)):setTimeout(()=>{this.$router.push({name:"CustomJs Settings"})},3e3)}catch(n){A(n,"customJs")}finally{this.loading=!1,await this.getDetailsForEdit()}},async getDetailsForEdit(){try{let{data:e}=await f.get(`custom-js/details/${this.idForEdit}`);this.updateStatesWithData(e.data)}catch{}},updateStatesWithData(e){const t=this,s=this.$data;Object.keys(e).map(n=>{s.hasOwnProperty(n)&&(t[n]=e[n])})},setDefaultProps(){let e=location.href;if(e.includes("edit")){let t=e.split("/").length;this.idForEdit=e.split("/")[t-1]}},async setparameterElementsList(){try{let{data:e}=await f.get("custom-js/get-routes");this.parameterElementsList=e.data}catch{}}}},W={id:"main",class:"col-sm-12"},z={class:"row"},G={class:"row"},K={class:"row"},Q={class:"card-footer"},X=["disabled"],Y=l("i",{class:"fas fa-save","aria-hidden":"true"},null,-1);function Z(e,t,s,n,a,i){const p=r("alert"),h=r("custom-loader"),u=r("text-field"),d=r("static-select"),_=r("radio-button"),C=r("faveo-box"),k=y("focus-first-input");return c(),g("div",W,[o(p,{componentName:"customJs"}),a.loading?(c(),E(h,{key:0})):q("",!0),o(C,{title:i.componentTitle},{actions:m(()=>[l("div",Q,[l("button",{type:"button",id:"submitter",onClick:t[0]||(t[0]=(...w)=>i.submit&&i.submit(...w)),class:"btn btn-primary",disabled:a.isDisabled},[Y,O(" "+P(e.lang("submit")),1)],8,X)])]),default:m(()=>[j((c(),g("div",z,[o(u,{name:"name",value:a.name,"on-change":i.onChange,placehold:e.lang("enter_a_value"),label:e.lang("name"),type:"text",required:!0,classname:"col-sm-4"},null,8,["value","on-change","placehold","label"]),o(d,{name:"fired_at",value:a.fired_at,"on-change":i.onChange,label:e.lang("fired_at"),elements:a.firedAtElements,required:!0,classname:"col-sm-4"},null,8,["value","on-change","label","elements"]),o(d,{name:"parameter",value:a.parameter,"on-change":i.onChange,label:e.lang("parameter"),elements:i.parameterElements,required:!0,classname:"col-sm-4",hint:e.lang("select_url_description")},null,8,["value","on-change","label","elements","hint"])])),[[k]]),l("div",G,[o(_,{options:a.radioOptions,label:e.lang("fire-javascript"),name:"fire",value:a.fire,onChange:i.onChange,classname:"col-sm-4"},null,8,["options","label","value","onChange"])]),l("div",K,[o(u,{value:a.script,name:"script",type:"textarea","on-change":i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-12",label:e.lang("script"),required:!0,rows:"6",hint:e.lang("customjs_script_hint")},null,8,["value","on-change","placehold","label","hint"])])]),_:1},8,["title"])])}const b=v(U,[["render",Z]]);let $={path:"/custom-js",component:x,name:"CustomJS",redirect:"/custom-js/settings",children:[{path:"settings",component:R,name:"CustomJs Settings",meta:{title:"custom-js",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},active:"custom-js"}}},{path:"create",component:b,name:"CustomJs Create",meta:{title:"custom-js",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},parent_link:{name:"custom-js",to:"/custom-js"},active:"create"}}},{path:"edit/:id",component:b,name:"CustomJs Edit",meta:{title:"custom-js",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},parent_link:{name:"custom-js",to:"/custom-js"},active:"edit"}}}]};S.addRoute($);
