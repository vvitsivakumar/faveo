import{_ as L,V as I,l as P,c as f,k as U,e as b,s as q,j as T,N as w,D as A,X as B}from"../chunks/bootstrap.js";import{r as s,q as x,o as c,c as y,e as i,w as u,f as r,i as V,b as D,a as v,d as C,n as F,g as S,t as M}from"../chunks/vendor.js";import{r as W,A as H}from"../chunks/adminRouter.js";import{a as R}from"../chunks/DataTableActions.js";import"../chunks/FormGenerator.js";import"../chunks/AdminNavigationBar.js";import"../chunks/HelpSection.js";const j={name:"locations-index",data(){return{columns:["title","phone","address","action"],apiUrl:"/api/location-list",options:{}}},beforeMount(){const e=this;this.options={headings:{title:this.trans("title"),phone:this.trans("phone"),address:this.trans("address"),action:this.trans("actions")},texts:{filter:"",limit:""},templates:{phone(t,n){return n.phone&&n.phone_country_code?"+"+n.phone_country_code+" "+n.phone:n.phone?n.phone:"--"},address(t,n){return n.address?n.address:"--"},action:(t,n)=>e.h(R,{data:n})},sortable:["title","phone","address"],filterable:["title","phone","address"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"asc":"desc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.locations.map(n=>(n.edit_url="/location/"+n.id+"/edit",n.delete_url=e.basePath()+"/api/location/delete/"+n.id,n)),count:t.data.total}}}}},z={id:"locations-list",class:"col-sm-12"},O={class:"card-tools"},X=r("i",{class:"glyphicon glyphicon-plus"},null,-1);function G(e,t,n,g,o,a){const d=s("alert"),h=s("router-link"),l=s("data-table"),p=s("faveo-box"),_=x("tooltip");return c(),y("div",z,[i(d,{componentName:"dataTableModal"}),i(p,{title:e.trans("list_of_locations")},{customActions:u(()=>[r("div",O,[V((c(),D(h,{class:"btn btn-tool",to:"/location/create"},{default:u(()=>[X]),_:1})),[[_,e.trans("create_location")]])])]),default:u(()=>[i(l,{url:o.apiUrl,dataColumns:o.columns,option:o.options,scroll_to:"locations-list"},null,8,["url","dataColumns","option"])]),_:1},8,["title"])])}const J=L(j,[["render",G]]);function K(e){const{title:t,phone:n,address:g,pincode:o,city:a}=e;let d={title:[t,"isRequired",{"max(50)":"The title should be less than 50 characters."}],phone:[n,{"max(15)":"The phone should be less than 15 characters."}],pincode:[o,{"max(15)":"The pincode should be less than 15 characters."}],address:[g,{"max(50)":"The address should be less than 50 characters."}],city:[a,{"max(50)":"The city should be less than 50 characters."}]};const h=new I(P),{errors:l,isValid:p}=h.validate(d);return f.dispatch("setValidationError",l),{errors:l,isValid:p}}const Q={name:"location-create-edit",description:"Location create edit page",data(){return{page_title:"create_location",iconClass:"fas fa-save",btnName:"save",hasDataPopulated:!1,loading:!1,location_id:"",title:"",phone:"",address:"",state_id:"",country_id:"",city:"",pincode:"",phone_country_code:null,phone_iso:""}},computed:{stateEndpoint(){return this.country_id?"/api/dependency/states?supplements="+this.country_id.id:"/api/dependency/states?supplements="}},beforeMount(){const e=window.location.pathname;this.getValues(e)},methods:{getValues(e){const t=U(e);e.indexOf("edit")>=0?(this.page_title="edit_location",this.iconClass="fas fa-sync",this.btnName="update",this.hasDataPopulated=!1,this.getInitialValues(t)):(this.loading=!1,this.hasDataPopulated=!0)},getInitialValues(e){this.loading=!0,v.get("/api/location/"+e).then(t=>{this.loading=!1,this.hasDataPopulated=!0;let n=t.data.data.location;this.location_id=n.id,this.title=n.title,this.phone=n.phone,this.address=n.address,this.city=n.city,this.country_id=n.country,this.state_id=n.state,this.pincode=n.pin_code,this.phone_country_code=n.phone_country_code?n.phone_country_code:null,this.phone_iso=n.phone_iso?n.phone_iso:null}).catch(t=>{this.loading=!1,b(t,"location-create-edit")})},isValid(){const{errors:e,isValid:t}=K(this.$data);return t},onChange(e,t){this[t]=e,t=="country_id"&&(this.state_id="")},onSubmit(){if(this.isValid()){this.loading=!0;let e={};e.title=this.title,this.phone&&(e.phone=this.phone),this.address&&(e.address=this.address),this.country_id&&(e.country_id=this.country_id.id),this.state_id&&this.country_id&&(e.state_id=this.state_id.id),this.city&&(e.city=this.city),this.pincode&&(e.pincode=this.pincode),this.phone_country_code!==null&&(e.phone=this.phone,e.phone_country_code=this.phone_country_code,e.phone_iso=this.phone_iso);let t="/api/location";this.page_title=="edit_location"&&(t="/api/location-update/"+this.location_id),v.post(t,e).then(n=>{this.loading=!1,q(n,"location-create-edit"),this.location_id?this.getInitialValues(this.location_id):setTimeout(()=>{this.$router.push({name:"Location Index"})},3e3)}).catch(n=>{this.loading=!1,b(n,"location-create-edit")})}},triggerEvent(e){var t=e.which||e.keyCode;t===13&&this.onSubmit()},onPhoneFieldUpdate(e,t){this[t]=e}},components:{"text-field":T,"number-field":w,"dynamic-select":A,phoneWithCountryCode:B}},Y={class:"col-sm-12"},Z={key:0,class:"row"},$={class:"row"},ee={class:"row"},te={class:"row"},ne={class:"row"},oe={class:"card-footer"};function ae(e,t,n,g,o,a){const d=s("custom-loader"),h=s("alert"),l=s("text-field"),p=s("phoneWithCountryCode"),_=s("dynamic-select"),E=s("faveo-box"),N=x("focus-first-input");return c(),y("div",Y,[!o.hasDataPopulated||o.loading?(c(),y("div",Z,[i(d,{duration:4e3})])):C("",!0),i(h,{componentName:"location-create-edit"}),o.hasDataPopulated?(c(),D(E,{key:1,title:e.trans(o.page_title)},{actions:u(()=>[r("div",oe,[r("button",{id:"submit_btn",class:"btn btn-primary",onClick:t[2]||(t[2]=m=>a.onSubmit())},[r("i",{class:F(o.iconClass)},null,2),S(" "+M(e.trans(o.btnName)),1)])])]),default:u(()=>[V((c(),y("div",$,[i(l,{label:e.trans("title"),value:o.title,type:"text",name:"title",onChange:a.onChange,placehold:e.lang("enter_a_value"),keyupListener:a.triggerEvent,classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold","keyupListener"]),i(p,{id:"phone",classname:"col-sm-4",name:"phone",onChange:a.onChange,value:o.phone,countryCode:o.phone_country_code,countryIso:o.phone_iso,onCountCode:t[0]||(t[0]=m=>a.onPhoneFieldUpdate(m,"phone_country_code")),onCountIso:t[1]||(t[1]=m=>a.onPhoneFieldUpdate(m,"phone_iso")),keyupListener:a.triggerEvent,labelName:"phone",apiUrl:"/api/dependency/country-codes?time="+Date.now()},null,8,["onChange","value","countryCode","countryIso","keyupListener","apiUrl"])])),[[N]]),r("div",ee,[i(_,{label:e.trans("country"),multiple:!1,name:"country_id",classname:"col-sm-6",clearable:!!o.country_id,apiEndpoint:"/api/dependency/country-codes?limit=all",value:o.country_id,onChange:a.onChange,required:!1,strlength:"40"},null,8,["label","clearable","value","onChange"]),i(_,{label:e.trans("state"),multiple:!1,name:"state_id",classname:"col-sm-6",required:!1,strlength:"40",apiEndpoint:a.stateEndpoint,value:o.state_id,onChange:a.onChange,clearable:!!o.state_id,disabled:!o.country_id},null,8,["label","apiEndpoint","value","onChange","clearable","disabled"])]),r("div",te,[i(l,{label:e.trans("city"),value:o.city,type:"text",name:"city",onChange:a.onChange,placehold:e.lang("enter_a_value"),keyupListener:a.triggerEvent,classname:"col-sm-6",required:!1},null,8,["label","value","onChange","placehold","keyupListener"]),i(l,{label:e.trans("pincode"),value:o.pincode,type:"text",name:"pincode",onChange:a.onChange,placehold:e.lang("enter_a_value"),keyupListener:a.triggerEvent,classname:"col-sm-6",required:!1},null,8,["label","value","onChange","placehold","keyupListener"])]),r("div",ne,[i(l,{label:e.trans("address"),value:o.address,type:"textarea",name:"address",onChange:a.onChange,placehold:e.lang("enter_a_value"),keyupListener:a.triggerEvent,classname:"col-sm-12"},null,8,["label","value","onChange","placehold","keyupListener"])])]),_:1},8,["title"])):C("",!0)])}const k=L(Q,[["render",ae]]);let ie={path:"/location",component:H,name:"Locations",redirect:"/location/list",children:[{path:"list",name:"Location Index",component:J,meta:{title:"location",crumb:{link:{name:"admin_panel",to:"/"},active:"location"}}},{path:"create",name:"Location Create",component:k,meta:{title:"location",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"location",to:"/location"},active:"create"}}},{path:":id/edit",name:"Location Edit",component:k,meta:{title:"location",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"location",to:"/location"},active:"edit"}}}]};W.addRoute(ie);f.dispatch("deleteUser");f.dispatch("updateUser");
