import{_ as Y,e as j,q as D}from"../chunks/bootstrap.js";import{V as p,r as h,q as M,o as l,c as a,e as w,f as e,t as o,F as _,h as y,n as u,g as f,i as v,b as k,d as i}from"../chunks/vendor.js";import{c as q,r as A,A as V}from"../chunks/adminRouter.js";import"../chunks/FormGenerator.js";import"../chunks/AdminNavigationBar.js";import"../chunks/DataTableActions.js";import"../chunks/HelpSection.js";const S={name:"healthcheck-entry",data(){return{log_types:[{name:"cron",icon:"fas fa-hourglass"},{name:"exception",icon:"fas fa-exclamation-triangle"},{name:"mail",icon:"fas fa-envelope"}],selectedLogType:"",logTypeApi:"",loading:!1,logCategories:[],date:new Date,selectedCategory:"",fetching:!1,status:"",showTable:!1,logTooltip:""}},beforeMount(){this.showContent("cron")},created(){window.emitter.on("retryLogActionPerformed",this.updateMailLog)},methods:{showLogs(t,r=""){this.status=r;let m=document.getElementById("healthcheck-table-logs");setTimeout(()=>{m&&m.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})},2),this.fetching=!0,this.selectedCategory="",setTimeout(()=>{this.showTable=!0,this.selectedCategory=t,this.fetching=!1},1e3)},onChange(t,r){p(this.date).format("YYYY-MM-DD")!=p(t).format("YYYY-MM-DD")&&(this.showTable=!1,this[r]=t,this.loading=!0,setTimeout(()=>{this.getLogCategories()},1e3))},updateMailLog(t="mail"){this.selectedCategory="",this.selectedLogType=t,this.logTypeApi="/api/automation/"+t,this.loading=!0,setTimeout(()=>{this.getLogCategories()},1e3)},showContent(t){this.showTable=!1,this.selectedCategory="",this.selectedLogType=t,this.logTypeApi="/api/automation/"+t,this.loading=!0,setTimeout(()=>{this.getLogCategories()},1e3)},getLogCategories(){this.loading=!0,axios.get(this.logTypeApi+"?created_at="+p(this.date).format("YYYY-MM-DD")).then(t=>{this.logCategories=t.data.message,this.logTooltip=t.data.data.tool_tip_lang,this.loading=!1}).catch(t=>{j(t,"healthcheck-entry"),this.loading=!1,this.logCategories=[]})}},components:{"date-picker":D,"table-view":q}},B={class:"col-sm-12"},N={class:"card card-light"},E={class:"card-header"},I={class:"card-title"},P={class:"card-body"},F={class:"row"},z={class:"settingiconblue"},H=["onClick"],R={class:"fa-stack fa-2x"},G={class:"row mt-3"},J={class:"col-sm-12"},K={class:"card card-light"},O={class:"card-header"},Q={class:"card-title"},U={class:"logs-tooltip"},W={class:"fas fa-question-circle text-primary"},X={class:"card-body"},Z={key:1,class:"row"},$={class:"col-sm-9"},ee={class:"row"},se={key:0,class:"col-sm-12 text-center"},te={class:"log-h3"},oe=["onClick"],le={class:"info-box bg-gradient-light"},ne={class:"info-box-content"},ae={class:"info-box-text"},ie={class:"info-box-number"},ce={class:"text-blue text-xl"},de={key:1,class:"info-box bg-gradient-light"},re={class:"info-box-content"},he={class:"info-box-text"},_e={class:"info-box-number"},me=["onClick"],ge={class:"text-blue text-xl"},pe=["onClick"],ue={class:"text-blue text-xl"},fe={class:"info-box-icon custom-box-icon"},ve=["onClick"],ke={class:"text-lg"},be=["onClick"],Ce={class:"text-lg"},we=["onClick"],ye={class:"text-lg"},xe=["onClick"],Le={class:"text-lg"},Te=["onClick"],Ye={class:"text-lg"},je=["onClick"],De={class:"text-lg"},Me=["onClick"],qe={class:"text-lg"},Ae={class:"col-sm-3"},Ve={class:"card card-light"},Se={class:"card-body"},Be={class:"row mt-3",id:"healthcheck-table-logs"};function Ne(t,r,m,Pe,n,c){const x=h("alert"),b=h("reuse-loader"),L=h("date-picker"),T=h("table-view"),g=M("tooltip");return l(),a("div",B,[w(x,{componentName:"healthcheck-entry"}),e("div",N,[e("div",E,[e("h3",I,o(t.lang("logs")),1)]),e("div",P,[e("div",F,[(l(!0),a(_,null,y(n.log_types,s=>(l(),a("div",{key:s.name,class:"col-md-2 col-sm-6"},[e("div",z,[e("div",{class:u(["settingdivblue",s.name==n.selectedLogType?"selected_type":""])},[e("a",{href:"javascript:;",onClick:C=>c.showContent(s.name)},[e("span",R,[e("i",{class:u([s.icon,"fa-stack-1x"])},null,2)])],8,H)],2),e("div",{class:u(["text-center text-sm",s.name==n.selectedLogType?"fw_600":""])},o(t.trans(s.name)),3)])]))),128))]),e("div",G,[e("div",J,[e("div",K,[e("div",O,[e("h3",Q,[f(o(t.trans(n.selectedLogType))+" "+o(t.trans("logs"))+" ",1),e("span",U,[v(e("i",W,null,512),[[g,n.loading?"":n.logTooltip]])])])]),e("div",X,[n.loading?(l(),k(b,{key:0})):(l(),a("div",Z,[e("div",$,[e("div",ee,[!n.loading&&!n.logCategories.length?(l(),a("div",se,[e("h3",te,o(t.trans("no_logs_found")),1)])):i("",!0),(l(!0),a(_,null,y(n.logCategories,(s,C)=>(l(),a("div",{key:C,class:"col-md-4 col-sm-6 col-12"},[n.selectedLogType=="exception"?(l(),a("a",{key:0,href:"javascript:;",onClick:d=>c.showLogs(s)},[e("div",le,[e("div",ne,[v((l(),a("span",ae,[f(o(t.getSubString(s.name,25)),1)])),[[g,s.name]]),e("span",ie,[e("span",ce,o(s.count),1)])])])],8,oe)):(l(),a("div",de,[e("div",re,[v((l(),a("span",he,[f(o(t.getSubString(s.name,25)),1)])),[[g,s.name]]),e("span",_e,[n.selectedLogType=="cron"?(l(),a("a",{key:0,href:"javascript:;",onClick:d=>c.showLogs(s,"completed")},[e("span",ge,o(s.completed),1),e("small",null," "+o(t.trans("completed")),1)],8,me)):i("",!0),n.selectedLogType=="mail"?(l(),a("a",{key:1,href:"javascript:;",onClick:d=>c.showLogs(s,"sent")},[e("span",ue,o(s.sent),1),e("small",null," "+o(t.trans("sent")),1)],8,pe)):i("",!0)])]),e("span",fe,[n.selectedLogType=="cron"?(l(),a(_,{key:0},[s.running?(l(),a("a",{key:0,class:"text-uppercase fw_600",href:"javascript:;",onClick:d=>c.showLogs(s,"running")},[e("span",ke,o(s.running),1),e("small",null," "+o(t.trans("running")),1)],8,ve)):i("",!0)],64)):i("",!0),n.selectedLogType=="mail"?(l(),a(_,{key:1},[s.accepted?(l(),a("a",{key:0,class:"text-uppercase fw_600",href:"javascript:;",onClick:d=>c.showLogs(s,"accepted")},[e("span",Ce,o(s.accepted),1),e("small",null," "+o(t.trans("accepted")),1)],8,be)):i("",!0),s.queued?(l(),a("a",{key:1,class:"text-uppercase fw_600",href:"javascript:;",onClick:d=>c.showLogs(s,"queued")},[e("span",ye,o(s.queued),1),e("small",null," "+o(t.trans("queued")),1)],8,we)):i("",!0),s.blocked?(l(),a("a",{key:2,class:"text-uppercase fw_600",href:"javascript:;",onClick:d=>c.showLogs(s,"blocked")},[e("span",Le,o(s.blocked),1),e("small",null," "+o(t.trans("blocked")),1)],8,xe)):i("",!0),s.rejected?(l(),a("a",{key:3,class:"text-uppercase fw_600",href:"javascript:;",onClick:d=>c.showLogs(s,"rejected")},[e("span",Ye,o(s.rejected),1),e("small",null," "+o(t.trans("rejected")),1)],8,Te)):i("",!0),s["attachment-removed"]?(l(),a("a",{key:4,class:"text-uppercase fw_600",href:"javascript:;",onClick:d=>c.showLogs(s,"attachment-removed")},[e("span",De,o(s["attachment-removed"]),1),e("small",null," "+o(t.trans("attachment-removed")),1)],8,je)):i("",!0)],64)):i("",!0),e("a",{class:"text-uppercase text-red fw_600",href:"javascript:;",onClick:d=>c.showLogs(s,"failed")},[e("span",qe,o(s.failed),1),e("small",null," "+o(t.trans("failed")),1)],8,Me)])]))]))),128))])]),e("div",Ae,[e("div",Ve,[e("div",Se,[w(L,{label:t.trans("date"),value:n.date,type:"date",name:"date",onChange:c.onChange,required:!1,format:"MM-DD-YYYY",classname:"col-sm-12",clearable:!1,disabled:!1,inline:!0,"label-style":{display:"none"},checkManual:!0},null,8,["label","value","onChange"])])])])]))])])])]),e("div",Be,[n.fetching?(l(),k(b,{key:0})):i("",!0),n.showTable&&!n.fetching?(l(),k(T,{key:1,logType:n.selectedLogType,category:n.selectedCategory,status:n.status,created_at:n.date},null,8,["logType","category","status","created_at"])):i("",!0)])])])])}const Ee=Y(S,[["render",Ne],["__scopeId","data-v-f94412f6"]]);let Ie={path:"/system-logs",component:V,name:"System Logs",redirect:"/system-logs/list",children:[{path:"list",component:Ee,name:"LogsIndex",meta:{title:"system-logs",crumb:{link:{name:"admin_panel",to:"/"},active:"system-logs"}}}]};A.addRoute(Ie);
