import{_ as M,j as q,D as P,s as w,e as g}from"../chunks/bootstrap.js";import{a as f,r,q as A,o as i,c as d,b as k,d as u,e as n,f as a,t as c,i as V,n as y,g as v,w as m,T as I}from"../chunks/vendor.js";import{r as L,A as N}from"../chunks/adminRouter.js";import"../chunks/FormGenerator.js";import"../chunks/AdminNavigationBar.js";import"../chunks/DataTableActions.js";import"../chunks/HelpSection.js";const O={data(){return{loadingSpeed:4e3,app_exists:!1,isLoading:!1,loading:!1,consumer_api_key:"",consumer_api_secret:"",access_token:"",access_token_secret:"",required:!0,mode:"create",twitterModelId:null,hashtag_text:[],elements_hashtag:[],isDisabled:!1,appID:"",elements_new_ticket:[{name:"One Day",value:1},{name:"Five Days",value:5},{name:"Ten Days",value:10},{name:"Fifteen Days",value:15},{name:"Thirty Days",value:30}],elements_cron:[{name:"Yes",value:1},{name:"No",value:0}],new_ticket_interval:{name:"Ten Days",value:"10"},cron_confirm:{name:"Yes",value:1},showModal:!1,deleteUrl:"twitter/api/delete"}}};const z={mixins:[O],components:{"text-field":q,"dynamic-select":P},beforeMount(){this.hitApi()},computed:{submitIcon(){return this.app_exists?"fas fa-sync":"fas fa-save"}},methods:{hitApi(){this.getAppDetails()},onChange(e,t){this[t]=e},deleteTwitter(){this.isLoading=!0,this.isDisabled=!0,f.delete(this.deleteUrl+"/"+this.appID).then(e=>{w(e,"TwitterSettingsPageAlert"),this.isLoading=!1,this.showModal=!1,this.loading=!0,this.hitApi()}).catch(e=>{g(e,"TwitterSettingsPageAlert"),this.showModal=!1,this.isLoading=!1})},onSubmit(){let e={consumer_api_key:this.consumer_api_key,consumer_api_secret:this.consumer_api_secret,access_token:this.access_token,access_token_secret:this.access_token_secret,hashtag_text:this.hashtag_text.length?this.hashtag_text.map(o=>o.name):[],cron_confirm:this.cron_confirm.value,reply_interval:this.new_ticket_interval.value};this.loading=!0;let t,l;this.app_exists?(t="twitter/api/update/"+this.appID,l="PUT"):(t="twitter/api/create",l="POST"),f.request({method:l,url:t,data:e}).then(o=>{w(o,"TwitterSettingsPageAlert"),this.$store.dispatch("unsetValidationError"),this.hitApi()}).catch(o=>{this.loading=!1,g(o,"TwitterSettingsPageAlert")})},getAppDetails(){this.loading=!0,f.get("twitter/api/app").then(e=>{let t=e.data.data.data[0];t?(this.app_exists=!0,this.appID=t.id,this.consumer_api_key=t.consumer_api_key,this.consumer_api_secret=t.consumer_api_secret,this.new_ticket_interval=this.filterValues(this.elements_new_ticket,t.reply_interval),this.access_token=t.access_token,this.access_token_secret=t.access_token_secret,this.hashtag_text=t.hashtags,this.cron_confirm=this.filterValues(this.elements_cron,t.cron),this.loading=!1):(this.app_exists=!1,Object.assign(this.$data,this.$options.data.apply(this)),this.loading=!1)}).catch(e=>{this.loading=!1,g(e,"TwitterSettingsPage")})},filterValues(e,t){return e.filter(l=>{if(l.value==t)return l})[0]},toggleModal(){this.showModal=!this.showModal},onClose(){this.showModal=!1}}},B={class:"col-sm-12"},j={class:"card card-light"},F={class:"card-header"},U={class:"card-title"},E={class:"card-body"},H={class:"row"},Y={class:"row"},R={class:"row"},G={class:"row"},J={key:0,class:"card-footer"},K=["disabled"],Q=a("i",{class:"glyphicon glyphicon-repeat"},null,-1),W={class:"modal-title"},X={key:0},Z={key:1,class:"row"},$=a("i",{class:"glyphicon glyphicon-repeat","aria-hidden":"true"},null,-1);function x(e,t,l,o,ae,s){const b=r("custom-loader"),C=r("alert"),_=r("text-field"),p=r("dynamic-select"),T=r("reuse-loader"),D=r("modal"),S=A("focus-first-input");return i(),d("div",B,[e.loading?(i(),k(b,{key:0,duration:e.loadingSpeed},null,8,["duration"])):u("",!0),n(C,{componentName:"TwitterSettingsPageAlert"}),a("div",j,[a("div",F,[a("h3",U,c(e.lang("twitter_settings")),1)]),a("div",E,[V((i(),d("div",H,[n(_,{label:e.lang("consumer_api_key"),onChange:s.onChange,placehold:e.lang("enter_a_value"),value:e.consumer_api_key,type:"text",name:"consumer_api_key",required:e.required,classname:"col-sm-6",hint:e.lang("consumer_api_key"),id:"consumer_api_key"},null,8,["label","onChange","placehold","value","required","hint"]),n(_,{label:e.lang("consumer_api_secret"),onChange:s.onChange,placehold:e.lang("enter_a_value"),value:e.consumer_api_secret,type:"text",name:"consumer_api_secret",required:e.required,classname:"col-sm-6",hint:e.lang("consumer_api_secret"),id:"consumer_api_secret"},null,8,["label","onChange","placehold","value","required","hint"])])),[[S]]),a("div",Y,[n(_,{label:e.lang("access_token"),onChange:s.onChange,placehold:e.lang("enter_a_value"),value:e.access_token,type:"text",name:"access_token",required:e.required,classname:"col-sm-6",hint:e.lang("access_token"),id:"access_token"},null,8,["label","onChange","placehold","value","required","hint"]),n(_,{label:e.lang("access_token_secret"),onChange:s.onChange,placehold:e.lang("enter_a_value"),value:e.access_token_secret,type:"text",name:"access_token_secret",required:e.required,classname:"col-sm-6",hint:e.lang("access_token_secret"),id:"access_token_secret"},null,8,["label","onChange","placehold","value","required","hint"])]),a("div",R,[n(p,{name:"hashtag_text",classname:"col-sm-6",elements:e.elements_hashtag,multiple:!0,prePopulate:!1,label:e.lang("hashtags"),value:e.hashtag_text,onChange:s.onChange,taggable:!0,searchable:!0,disableNoOptionsMessage:!0,hint:e.lang("hashtag_hint")},null,8,["elements","label","value","onChange","hint"]),n(p,{name:"new_ticket_interval",classname:"col-sm-6",elements:e.elements_new_ticket,multiple:!1,prePopulate:!1,label:e.lang("time_check_twitter"),value:e.new_ticket_interval,onChange:s.onChange,searchable:!1,clearable:!1},null,8,["elements","label","value","onChange"])]),a("div",G,[n(p,{name:"cron_confirm",classname:"col-sm-6",elements:e.elements_cron,multiple:!1,prePopulate:!1,label:e.lang("cron_label_twitter"),value:e.cron_confirm,onChange:s.onChange,searchable:!1,clearable:!1},null,8,["elements","label","value","onChange"])])]),e.loading?u("",!0):(i(),d("div",J,[a("button",{type:"button",onClick:t[0]||(t[0]=(...h)=>s.onSubmit&&s.onSubmit(...h)),class:"btn btn-primary"},[a("i",{class:y(s.submitIcon)},null,2),v(" "+c(e.app_exists?e.lang("upd8"):e.lang("save")),1)]),a("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=(...h)=>s.toggleModal&&s.toggleModal(...h)),disabled:!e.app_exists},[Q,v("  "+c(e.lang("reset")),1)],8,K)]))]),n(I,{name:"modal"},{default:m(()=>[e.showModal?(i(),k(D,{key:0,showModal:!0,onClose:()=>e.showModal=!1,containerStyle:"width: 500px"},{title:m(()=>[a("h4",W,c(e.lang("reset")),1)]),fields:m(()=>[e.isLoading?u("",!0):(i(),d("div",X,[a("span",null,c(e.lang("reset_confirm")),1)])),e.isLoading?(i(),d("div",Z,[n(T,{"animation-duration":4e3,color:"#1d78ff",size:e.size,class:y({spin:e.lang_locale=="ar"})},null,8,["size","class"])])):u("",!0)]),controls:m(()=>[a("button",{type:"button",onClick:t[2]||(t[2]=(...h)=>s.deleteTwitter&&s.deleteTwitter(...h)),class:"btn btn-primary"},[$,v("  "+c(e.lang("reset")),1)])]),_:1},8,["onClose"])):u("",!0)]),_:1})])}const ee=M(z,[["render",x]]);let te={path:"/twitter",component:N,name:"Twitter",redirect:"/twitter/settings",children:[{path:"settings",component:ee,name:"Twitter Settings",meta:{title:"twitter_integration_settings",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},active:"twitter"}}}]};L.addRoute(te);
