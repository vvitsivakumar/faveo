import{c as A,V as x,l as V,_ as C,s as I,e as P,j as Q,S as G,N as R,k as B,t as me,D as X,q as pe,f as te,r as _e,R as ge,u as be,m as Z}from"../chunks/bootstrap.js";import{a as D,r as u,q as T,b as w,w as y,d as m,o as l,f as a,t as o,c as h,i as S,e as c,g as _,p as Y,j,n as O,$,F as L,h as N,T as q,W as z,V as H,G as E,s as ye,u as K,m as U,y as ne,K as fe,a0 as W}from"../chunks/vendor.js";import{r as ve,A as ae}from"../chunks/agentRouter.js";import{a as ie,c as oe}from"../chunks/DataTableActions.js";import{r as ke,A as le}from"../chunks/adminRouter.js";import{S as ee,D as de}from"../chunks/FormGenerator.js";import{g as we,b as Ce,c as De}from"../chunks/CurrencySelect.js";import{D as Se}from"../chunks/DataTableIsDefault.js";import"../chunks/HelpSection.js";import"../chunks/LoginLogs.js";import"../chunks/BarcodeModal.js";import"../chunks/TicketsIndex.js";import"../chunks/Loader.js";import"../chunks/approvalTicketRules.js";import"../chunks/PermaLink.js";import"../chunks/AdminNavigationBar.js";function Me(e){let t={};e.packages&&(t.price=[e.packages.price,"isRequired"]);const n=new x(V),{errors:d,isValid:s}=n.validate(t);return A.dispatch("setValidationError",d),{errors:d,isValid:s}}function Ve(e){const{gateway:t,transaction_id:n,amount:d}=e;let s={gateway:[t,"isRequired"],transaction_id:[n,"isRequired"],amount:[d,"isRequired"]};const i=new x(V),{errors:p,isValid:r}=i.validate(s);return A.dispatch("setValidationError",p),{errors:p,isValid:r}}const Pe={name:"settings-modal",description:"Settings Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function},title:{type:String,default:""},id:{type:[String,Number],default:""}},data:()=>({isDisabled:!1,containerStyle:{width:"600px"},loading:!1,size:60,status:0,transaction_id:"",amount:"",add_to_credit:!1,payment_gateway:[],gateway:"",comment:""}),methods:{isValid(){const{errors:e,isValid:t}=Ve(this.$data);return!!t},onChange(e,t){this[t]=e},onSubmit(){if(this.isValid()){this.loading=!0,this.isDisabled=!0;let e={};e.method=this.gateway,e.transactionId=this.transaction_id,e.invoice=this.id,e.amount=parseInt(this.amount),e.comment=this.comment,D.post("/bill/package/add-payment",e).then(t=>{this.loading=!1,this.isDisabled=!1,I(t,"invoice"),window.emitter.emit("reloadInvoiceData"),this.onClose()}).catch(t=>{this.loading=!1,this.isDisabled=!1,P(t,"invoice"),this.onClose()})}}},components:{"text-field":Q,"static-select":G,"number-field":R},beforeMount(){D.get("bill/get-gateways-list",{params:{active:1}}).then(e=>{e.data.data.data.forEach(t=>{this.payment_gateway.push({id:t.name,name:t.name})})}).catch(e=>{P(e,"invoice")})}},Ie=e=>(Y("data-v-2e6043a6"),e=e(),j(),e),qe={class:"modal-title"},Ue={key:0},Te={class:"row"},Fe={key:1,class:"row"},Oe=["disabled"],Le=Ie(()=>a("i",{class:"fas fa-sync","aria-hidden":"true"},null,-1));function Ae(e,t,n,d,s,i){const p=u("static-select"),r=u("text-field"),g=u("number-field"),f=u("reuse-loader"),v=u("modal"),b=T("focus-first-input");return n.showModal?(l(),w(v,{key:0,showModal:n.showModal,onClose:n.onClose,containerStyle:e.containerStyle},{title:y(()=>[a("h4",qe,o(e.lang(n.title)),1)]),fields:y(()=>[e.loading?m("",!0):(l(),h("div",Ue,[S((l(),h("div",Te,[c(p,{label:e.lang("payment_gateway"),elements:e.payment_gateway,name:"gateway",value:e.gateway,classname:"col-sm-12",onChange:i.onChange,required:!0},null,8,["label","elements","value","onChange"]),c(r,{label:e.lang("transaction_id"),value:e.transaction_id,type:"text",name:"transaction_id",onChange:i.onChange,required:!0,classname:"col-sm-12"},null,8,["label","value","onChange"]),c(g,{label:e.lang("amount"),value:e.amount,name:"amount",classname:"col-sm-12",onChange:i.onChange,type:"number",required:!0},null,8,["label","value","onChange"]),c(r,{label:e.lang("comment"),value:e.comment,type:"textarea",name:"comment",onChange:i.onChange,required:!0,classname:"col-sm-12"},null,8,["label","value","onChange"])])),[[b]])])),e.loading?(l(),h("div",Fe,[c(f,{"animation-duration":4e3,color:"#1d78ff",size:e.size},null,8,["size"])])):m("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=k=>i.onSubmit()),class:"btn btn-primary",disabled:e.isDisabled},[Le,_(" "+o(e.lang("ok")),1)],8,Oe)]),_:1},8,["showModal","onClose","containerStyle"])):m("",!0)}const Ee=C(Pe,[["render",Ae],["__scopeId","data-v-2e6043a6"]]);const Be={name:"unpaid-modal",description:"Unpaid Modal component",props:{showModal:{type:Boolean,default:!1},title:{type:String,default:""},id:{type:[Number,String],default:""},onClose:{type:Function},refreshPage:{type:Function}},data:()=>({isDisabled:!1,containerStyle:{width:"500px"},loading:!1,size:60,lang_locale:""}),created(){this.lang_locale=localStorage.getItem("LANGUAGE")},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0;const e={};e.invoice_id=this.id,e.amount_paid=0,axios.put("/invoice/update",e).then(t=>{this.loading=!1,this.isDisabled=!0,this.refreshPage(),this.onClose(),I(t,"invoice")}).catch(t=>{this.loading=!1,this.isDisabled=!0,P(t,"invoice")})}}},Ne={key:0},ze={key:1,class:"row",slot:"fields"},Re=["disabled"],Ye=a("i",{class:"fa fa-save"},null,-1);function je(e,t,n,d,s,i){const p=u("reuse-loader"),r=u("modal");return l(),h("div",null,[n.showModal?(l(),w(r,{key:0,showModal:n.showModal,onClose:n.onClose,containerStyle:e.containerStyle},{title:y(()=>[a("h4",null,o(e.lang(n.title)),1)]),fields:y(()=>[e.loading?m("",!0):(l(),h("div",Ne,[a("h5",{id:"H5",class:O({margin:e.lang_locale=="ar"})},o(e.lang("are_you_sure")),3)])),e.loading?(l(),h("div",ze,[c(p,{"animation-duration":4e3,color:"#1d78ff",size:e.size,class:O({spin:e.lang_locale=="ar"})},null,8,["size","class"])])):m("",!0)]),controls:y(()=>[a("button",{type:"button",onClick:t[0]||(t[0]=(...g)=>i.onSubmit&&i.onSubmit(...g)),class:"btn btn-primary",disabled:e.isDisabled},[Ye,_(" "+o(e.lang("proceed")),1)],8,Re)]),_:1},8,["showModal","onClose","containerStyle"])):m("",!0)])}const He=C(Be,[["render",je]]);const We={name:"package-invoice",description:"Package invoice page",data(){return{hasDataPopulated:!1,loading:!1,loadingSpeed:4e3,company_name:"",from:{},to:{},invoice_id:0,order_id:0,paid_date:"",packages:{},transactions:[],total_amount:0,paid_amount:0,labelStyle:{display:"none"},showModal:!1,payable_amount:"",showUnpaidModal:!1,currency:null}},computed:{...$(["formattedTime","formattedDate","getUserData"])},beforeMount(){const e=window.location.pathname;this.invoiceId=B(e),this.getData()},created(){window.emitter.on("reloadInvoiceData",this.getData)},methods:{getData(){this.loading=!0,D.get("/bill/package/user-invoice-info/"+this.invoiceId).then(e=>{let t=e.data.data;this.company_name=t.company_name,this.from=t.from,this.to=t.order.user,this.invoice_id=t.invoice_id,this.order_id=t.order_id,this.paid_date=t.paid_date,this.payable_amount=t.payable_amount,this.packages=t.order.package,this.transactions=t.transactions,this.total_amount=t.payable_amount,this.paid_amount=t.amount_paid,this.hasDataPopulated=!0,this.currency=t.currency,this.loading=!1}).catch(e=>{P(e),this.hasDataPopulated=!0,this.loading=!1})},isValid(){const{errors:e,isValid:t}=Me(this.$data);return!!t},onClose(){this.showModal=!1,this.showUnpaidModal=!1,this.$store.dispatch("unsetValidationError")},refreshPage(){this.getData()},onChange(e,t){this.payable_amount=e},printInvoice(e){var t=document.getElementById(e).innerHTML,n=window.open("","","width=auto,height=auto");n.document.write("<html><head><title></title></head><body>"+t+"</body>"),n.document.close(),n.focus(),n.print(),setTimeout(function(){n.close()},5)},sendMail(){this.loading=!0,D.get("/invoice/send/"+this.invoice_id).then(e=>{this.loading=!1,I(e,"invoice")}).catch(e=>{P(e,"invoice"),this.loading=!1})},onSubmit(){this.isValid()&&(this.showModal=!0)},onUpdate(){if(this.isValid()){this.loading=!0;const e={};e.invoice_id=this.invoice_id,e.payable_amount=this.payable_amount,D.put("/invoice/update",e).then(t=>{this.loading=!1,this.refreshPage(),I(t,"invoice")}).catch(t=>{this.loading=!1,P(t,"invoice")})}},getFormattedCurrency(e,t){return me(e,t,localStorage.getItem("LANGUAGE"))},generatePDF(){D.get("/invoice/pdf/"+this.invoice_id).then(e=>{e&&this.redirect("/invoice/pdf/"+this.invoice_id)}).catch(e=>{P(e,"invoice")})}},components:{"number-field":R,"invoice-modal":Ee,"unpaid-modal":He}},M=e=>(Y("data-v-4fd69331"),e=e(),j(),e),xe={class:"col-sm-12"},Ge={key:0,class:"row"},Ke={key:1,class:"invoice"},Je={class:"invoice p-3 mb-3"},Qe={class:"row"},Xe={class:"col-12"},Ze=M(()=>a("i",{class:"fas fa-globe"},null,-1)),$e={class:"dropdown float-right"},et=M(()=>a("button",{class:"btn btn-default dropdown-toggle",type:"button","data-toggle":"dropdown"},[a("i",{class:"fas fa-bars"})],-1)),tt={class:"dropdown-menu dropdown-menu-right"},at=M(()=>a("i",{class:"fas fa-credit-card"},null,-1)),st=M(()=>a("i",{class:"fas fa-thumbs-down"},null,-1)),nt=M(()=>a("i",{class:"fas fa-print"},null,-1)),it=M(()=>a("i",{class:"fas fa-download"},null,-1)),ot=M(()=>a("i",{class:"fas fa-reply"},null,-1)),lt={id:"print-invoice",class:"row invoice-info"},dt={class:"col-sm-4 invoice-col"},rt=M(()=>a("br",null,null,-1)),ct={key:1},ut=M(()=>a("br",null,null,-1)),ht={class:"col-sm-4 invoice-col"},mt=M(()=>a("br",null,null,-1)),pt=M(()=>a("br",null,null,-1)),_t={class:"col-sm-4 invoice-col"},gt=M(()=>a("br",null,null,-1)),bt=M(()=>a("br",null,null,-1)),yt=M(()=>a("br",null,null,-1)),ft={class:"card card-light"},vt={class:"card-header"},kt={class:"card-title"},wt={class:"card-body"},Ct={class:"table-responsive"},Dt={class:"table table-striped"},St={id:"product_price"},Mt={class:"card card-light"},Vt={class:"card-header"},Pt={class:"card-title"},It={class:"card-body"},qt={class:"table-responsive"},Ut={class:"table table-striped"},Tt={id:"status"},Ft={class:"card card-light"},Ot={class:"card-header"},Lt={class:"card-title"},At={class:"card-body"},Et={class:"table-responsive"},Bt={class:"table"},Nt={style:{width:"50%"}},zt={style:{width:"50%"}},Rt=M(()=>a("th",null,"Total:",-1)),Yt={class:"card-footer"},jt=M(()=>a("i",{class:"fas fa-sync"},null,-1));function Ht(e,t,n,d,s,i){const p=u("custom-loader"),r=u("alert"),g=u("number-field"),f=u("router-link"),v=u("invoice-modal"),b=u("unpaid-modal");return l(),h("div",xe,[s.hasDataPopulated===!1||s.loading===!0?(l(),h("div",Ge,[c(p,{duration:s.loadingSpeed},null,8,["duration"])])):m("",!0),c(r,{componentName:"invoice"}),s.hasDataPopulated===!0?(l(),h("section",Ke,[a("div",Je,[a("div",Qe,[a("div",Xe,[a("h4",null,[Ze,_(" "+o(s.company_name)+" ",1),a("div",$e,[et,a("div",tt,[s.total_amount-s.paid_amount>0?(l(),h("a",{key:0,id:"pay",href:"javascript:;",class:"dropdown-item",onClick:t[0]||(t[0]=k=>i.onSubmit())},[at,_(" "+o(e.lang("add_payment")),1)])):m("",!0),s.payable_amount-s.paid_amount<=0?(l(),h("a",{key:1,id:"unpaid",onClick:t[1]||(t[1]=k=>s.showUnpaidModal=!0),href:"javascript:;",class:"dropdown-item"},[st,_(" "+o(e.lang("mark_as_unpaid")),1)])):m("",!0),a("a",{id:"print",class:"dropdown-item",onClick:t[2]||(t[2]=k=>i.printInvoice("print-invoice"))},[nt,_(" "+o(e.lang("print")),1)]),a("a",{id:"pdf",href:"javascript:;",onClick:t[3]||(t[3]=k=>i.generatePDF()),class:"dropdown-item"},[it,_(" "+o(e.lang("generate_pdf")),1)]),a("a",{id:"mail",onClick:t[4]||(t[4]=k=>i.sendMail()),class:"dropdown-item"},[ot,_(" "+o(e.lang("send_mail")),1)])])])])])]),a("div",lt,[a("div",dt,[_(o(e.lang("from"))+" ",1),a("address",null,[a("strong",null,o(s.from.name),1),rt,s.from.address?(l(),h(L,{key:0},[],64)):m("",!0),s.from.address?(l(),h("br",ct)):m("",!0),_(" "+o(e.lang("phone"))+": "+o((s.from.phone_country_code?" +"+s.from.phone_country_code:"")+(s.from.phone?" "+s.from.phone:e.lang("not_mentioned"))+(s.from.ext?"-"+s.from.ext:""))+" ",1),ut,_(" "+o(e.lang("website"))+": "+o(s.from.website),1)])]),a("div",ht,[_(o(e.lang("to"))+" ",1),a("address",null,[a("strong",null,o(s.to.first_name)+o(s.to.last_name),1),mt,_(" "+o(e.lang("phone"))+": "+o(s.to.phone_country_code?"+"+s.to.phone_country_code:"")+" "+o(s.to.phone_number?s.to.phone_number:e.lang("not_mentioned"))+" "+o(s.to.ext?"-"+s.to.ext:"")+" ",1),pt,_(" "+o(e.lang("email"))+": "+o(s.to.email),1)])]),a("div",_t,[a("b",null,o(e.lang("invoice_details")),1),gt,a("b",null,o(e.lang("invoice"))+":",1),_(" #"+o(s.invoice_id),1),bt,a("b",null,o(e.lang("order_id"))+":",1),_(" "+o(s.order_id),1),yt,a("b",null,o(e.lang("paid_on"))+":",1),_(" "+o(e.formattedTime(s.paid_date)),1)])]),a("div",ft,[a("div",vt,[a("h3",kt,o(e.lang("product")),1)]),a("div",wt,[a("div",Ct,[a("table",Dt,[a("thead",null,[a("tr",null,[a("th",null,o(e.lang("name")),1),a("th",null,o(e.lang("description")),1),a("th",null,o(e.lang("validity")),1),a("th",null,o(e.lang("price")),1)])]),a("tbody",null,[a("tr",null,[a("td",null,o(s.packages.name),1),a("td",null,o(s.packages.description),1),a("td",null,o(s.packages.validity===null?"One time":s.packages.validity),1),a("td",St,[c(g,{label:e.lang("price"),value:s.payable_amount,name:"payable_amount",classname:"",labelStyle:s.labelStyle,onChange:i.onChange,type:"number",required:!0},null,8,["label","value","labelStyle","onChange"])])])])])])])]),a("div",Mt,[a("div",Vt,[a("h3",Pt,o(e.lang("transactions")),1)]),a("div",It,[a("div",qt,[a("table",Ut,[a("thead",null,[a("tr",null,[a("th",null,o(e.lang("id")),1),a("th",null,o(e.lang("payment_method")),1),a("th",null,o(e.lang("amount_paid")),1),a("th",null,o(e.lang("transacted_by")),1),a("th",null,o(e.lang("pay_date")),1),a("th",null,o(e.lang("status")),1)])]),a("tbody",null,[(l(!0),h(L,null,N(s.transactions,k=>(l(),h("tr",null,[a("td",null,o(k.transactionId),1),a("td",null,o(k.payment_method),1),a("td",null,o(k.amount_paid),1),a("td",null,[c(f,{to:"/user/"+k.paid_by.id},{default:y(()=>[_(o(k.paid_by.full_name),1)]),_:2},1032,["to"])]),a("td",null,o(e.formattedTime(k.created_at)),1),a("td",null,[a("a",Tt,[a("span",{title:"Status",class:O({"btn btn-success btn-xs":k.status!==0,"btn btn-danger btn-xs":k.status===0}),id:"edit_btn"},o(k.status?e.lang("successful"):e.lang("fail")),3)])])]))),256))])])])])]),a("div",Ft,[a("div",Ot,[a("h3",Lt,o(e.lang("payment_details"))+" "+o(e.formattedTime(s.paid_date)),1)]),a("div",At,[a("div",Et,[a("table",Bt,[a("tbody",null,[a("tr",null,[a("th",Nt,o(e.lang("paid_amount"))+" : ",1),a("td",null,o(i.getFormattedCurrency(s.paid_amount,s.currency)),1)]),a("tr",null,[a("th",zt,o(e.lang("balance"))+" : ",1),a("td",null,o(i.getFormattedCurrency(s.paid_amount-s.total_amount,s.currency)),1)]),a("tr",null,[Rt,a("td",null,o(i.getFormattedCurrency(s.total_amount,s.currency)),1)])])])])]),a("div",Yt,[a("button",{type:"button",id:"update_btn",class:"btn btn-primary",onClick:t[5]||(t[5]=k=>i.onUpdate())},[jt,_(" "+o(e.lang("update")),1)])])])])])):m("",!0),c(q,{name:"modal"},{default:y(()=>[s.showModal?(l(),w(v,{key:0,title:"add_payment",onClose:i.onClose,showModal:s.showModal,id:s.invoice_id},null,8,["onClose","showModal","id"])):m("",!0)]),_:1}),c(q,{name:"modal"},{default:y(()=>[s.showUnpaidModal?(l(),w(b,{key:0,title:"Mark as Unpaid",onClose:i.onClose,refreshPage:i.refreshPage,showModal:s.showUnpaidModal,id:s.invoice_id},null,8,["onClose","refreshPage","showModal","id"])):m("",!0)]),_:1})])}const Wt=C(We,[["render",Ht],["__scopeId","data-v-4fd69331"]]);const xt={name:"invoices-filter",description:"",components:{"dynamic-select":X,"static-select":G,"number-field":R,"date-time-field":pe},props:{apiChange:{type:Function},hideFilter:{type:Function},data:{type:[String,Object],default:""}},data(){return{created_date:"",due_date:"",amount_paid:"",payable_amount:"",statuses:[{id:"paid",name:"Paid",queryPerm:"status=1"},{id:"unpaid",name:"Unpaid",queryPerm:"status=0"}],status:"",modes:[{id:"online",name:"Online",queryPerm:"payment_mode[0]=online"},{id:"cash",name:"Cash",queryPerm:"payment_mode[1]=cash"},{id:"bank_transfer",name:"Bank transfer",queryPerm:"payment_mode[2]=bank_transfer"},{id:"marked_paid_by_agent",name:"Marked paid by agent",queryPerm:"payment_mode[3]=marked_paid_by_agent"}],payment_mode:[],users:[],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},loading:!1,filterApplied:!1}},beforeMount(){if(window.location.search.substring(1)==="status=0"&&(this.status="unpaid",this.apiChange(this.$data)),this.data){const e=this,t=this.$data;Object.keys(this.data).map(n=>{t.hasOwnProperty(n)&&(e[n]=this.data[n])})}},methods:{resetData(){this.filterApplied=!1,this.created_date="",this.due_date="",this.amount_paid="",this.payable_amount="",this.status="",this.payment_mode=[],this.users=[],setTimeout(()=>{this.loading=!1},1e3)},onChange(e,t){this[t]=e},onCancel(){this.hideFilter(this.$data),this.filterApplied?this.apiChange(this.$data):this.resetData()},onApply(){this.filterApplied=!0,this.apiChange(this.$data)},onReset(){this.loading=!0,this.resetData(),this.apiChange(this.$data)}}},Gt={class:"card card-light"},Kt={class:"card-header"},Jt={class:"card-title"},Qt={class:"card-body"},Xt={key:0,class:"row",style:{"margin-top":"80px","margin-bottom":"94px"}},Zt=a("h3",{class:"text-center"},"Loading filters...",-1),$t=[Zt],ea={key:1,class:"row",id:"invoice_filter"},ta={key:2,class:"row"},aa={key:0,class:"card-footer"},sa={class:"single-btn"},na=a("span",{class:"fas fa-check"},null,-1),ia={class:"single-btn"},oa=a("span",{class:"fas fa-undo"},null,-1),la={class:"single-btn"},da=a("span",{class:"fas fa-times"},null,-1);function ra(e,t,n,d,s,i){const p=u("date-time-field"),r=u("number-field"),g=u("static-select"),f=u("dynamic-select");return l(),h("div",Gt,[a("div",Kt,[a("h3",Jt,o(e.lang("filter")),1)]),a("div",Qt,[s.loading?(l(),h("div",Xt,$t)):m("",!0),s.loading?m("",!0):(l(),h("div",ea,[c(p,{label:e.lang("created_date"),value:s.created_date,type:"datetime",name:"created_date",onChange:i.onChange,range:"",required:!1,format:"YYYY-MM-DD HH:mm:ss",classname:"col-sm-4",clearable:!0,disabled:!1,editable:!0,currentYearDate:!1,"time-picker-options":s.timeOptions},null,8,["label","value","onChange","time-picker-options"]),c(p,{label:e.lang("due_date"),value:s.due_date,type:"datetime",name:"due_date",onChange:i.onChange,range:"",required:!1,format:"YYYY-MM-DD HH:mm:ss",classname:"col-sm-4",clearable:!0,disabled:!1,editable:!0,currentYearDate:!1,"time-picker-options":s.timeOptions},null,8,["label","value","onChange","time-picker-options"]),c(r,{label:e.lang("amount_paid"),value:s.amount_paid,name:"amount_paid",classname:"col-sm-2",onChange:i.onChange,type:"number"},null,8,["label","value","onChange"]),c(r,{label:e.lang("payable_amount"),value:s.payable_amount,name:"payable_amount",classname:"col-sm-2",onChange:i.onChange,type:"number"},null,8,["label","value","onChange"])])),s.loading?m("",!0):(l(),h("div",ta,[c(g,{label:e.lang("status"),elements:s.statuses,name:"status",value:s.status,classname:"col-sm-4 invoice_select",onChange:i.onChange,required:!1},null,8,["label","elements","value","onChange"]),c(f,{name:"payment_mode",classname:"col-sm-4",elements:s.modes,multiple:!0,prePopulate:!1,label:e.lang("payment_mode"),value:s.payment_mode,onChange:i.onChange},null,8,["elements","label","value","onChange"]),c(f,{name:"users",apiEndpoint:"api/dependency/users?meta=true",classname:"col-sm-4",multiple:!0,prePopulate:!0,label:e.lang("users"),value:s.users,onChange:i.onChange},null,8,["label","value","onChange"])]))]),s.loading?m("",!0):(l(),h("div",aa,[a("span",sa,[a("button",{id:"apply-btn",class:"btn btn-primary round-btn",type:"button",onClick:t[0]||(t[0]=(...v)=>i.onApply&&i.onApply(...v))},[na,_("  "+o(e.lang("apply")),1)])]),a("span",ia,[a("button",{id:"apply-btn",class:"btn btn-primary single-btn round-btn",type:"button",onClick:t[1]||(t[1]=(...v)=>i.onReset&&i.onReset(...v))},[oa,_("  "+o(e.lang("reset")),1)])]),a("span",la,[a("button",{id:"apply-btn",class:"btn btn-danger single-btn round-btn",type:"button",onClick:t[2]||(t[2]=(...v)=>i.onCancel&&i.onCancel(...v))},[da,_("  "+o(e.lang("cancel")),1)])])]))])}const ca=C(xt,[["render",ra]]),ua={name:"pacakges",description:"Pacakges data table component",props:{},data(){return{base:window.axios.defaults.baseURL,columns:["id","name","user","payment_mode","total_amount","payable_amount","amount_paid","due_by","status","action"],options:{},apiUrl:"",selectedData:[],showModal:!1,deleteUrl:"",isShowFilter:!1,hideData:"",show:!1,filterStyle:{}}},computed:{...$(["formattedTime","formattedDate"])},watch:{},beforeMount(){const e=this;this.options={headings:{id:this.trans("id"),name:this.trans("invoice_id"),user:this.trans("user"),payment_mode:this.trans("payment_mode"),total_amount:this.trans("total_amount"),payable_amount:this.trans("payable_amount"),amount_paid:this.trans("amount_paid"),due_by:this.trans("due_by"),status:this.trans("status"),action:this.trans("action")},texts:{filter:"",limit:""},sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},templates:{name:function(t,n){return e.h(z,{to:"/bill/package/"+n.id+"/user-invoice"},"#"+n.id)},due_by(t,n){return e.formattedTime(n.due_by)},payment_mode(t,n){return V(n.payment_mode)},status:function(t,n){let d=e.h("span",{class:n.order.status===1?"btn btn-success btn-xs":"btn btn-danger btn-xs"},n.order.status===1?this.lang("paid"):this.lang("unpaid"));return e.h("a",{},[d])},user:function(t,n){return e.h(z,{to:"/user/"+n.order.user.id},n.order.user.full_name)},action:(t,n)=>e.h(ie,{data:n})},sortable:["name","payment_mode","total_amount","payable_amount","amount_paid","due_by","user","status"],filterable:["name","validity","allowed_tickets","price","status"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.data.map(d=>(d.delete_url=`bill/delete-user-invoice?invoice_ids=${d.id}`,d.alertComponentName="dataTableModal",d)),count:t.data.total}}}},methods:{packages(e){this.selectedData=e},deletePackage(){this.deleteUrl="bill/delete-user-invoice?invoice_ids="+this.selectedData,this.showModal=!0},onClose(){this.showModal=!1,this.$store.dispatch("unsetValidationError")},toggleFilterView(){this.isShowFilter=!this.isShowFilter,this.show=!this.show,this.show?this.filterStyle={display:"block"}:this.filterStyle={display:"none"}},hideFilter(e){this.isShowFilter=!1,this.show=!1,this.hideData=e},apiChange(e){let t="/bill/package/get-user-invoice?meta="+!0+"&all-users=1&",n="";if(e.status){let d=e.status==="unpaid"?0:1;n+="status="+d+"&"}if(e.payable_amount&&(n+="payable_amount="+e.payable_amount+"&"),e.payment_mode&&e.payment_mode.forEach(function(d,s){n+="payment_mode["+s+"]="+d.id+"&"}),e.users&&e.users.length>0&&(t="/bill/package/get-user-invoice?meta="+!0+"&",e.users.forEach(function(d,s){n+="users["+s+"]="+d.id+"&"})),e.amount_paid&&(n+="amount_paid="+e.amount_paid+"&"),e.created_date){let d=e.created_date,s=d[0]!==null?H(d[0]).format("YYYY-MM-DD+HH:mm:ss"):"",i=d[1]!==null?H(d[1]).format("YYYY-MM-DD+HH:mm:ss"):"";n+="created_at_start="+s+"&created_at_end="+i+"&"}if(e.due_date){let d=e.due_date,s=d[0]!==null?H(d[0]).format("YYYY-MM-DD+HH:mm:ss"):"",i=d[1]!==null?H(d[1]).format("YYYY-MM-DD+HH:mm:ss"):"";n+="due_by_start="+s+"&due_by_end="+i+"&"}n[n.length-1]==="&"&&(n=n.slice(0,-1)),this.apiUrl=t+n}},components:{"delete-modal":oe,"invoices-filter":ca}},ha={class:"col-sm-12"},ma={class:"card card-light"},pa={class:"card-header"},_a={class:"card-title",id:"pack-title"},ga={class:"card-tools"},ba=a("i",{class:"glyphicon glyphicon-filter"},null,-1),ya=[ba],fa=a("span",{class:"fas fa-trash"},null,-1),va=[fa],ka={class:"card-body"};function wa(e,t,n,d,s,i){const p=u("alert"),r=u("invoices-filter"),g=u("data-table"),f=u("delete-modal"),v=T("tooltip");return l(),h("div",ha,[c(p,{componentName:"dataTableModal"}),a("div",ma,[a("div",pa,[a("h3",_a,o(e.lang("invoice_list")),1),a("div",ga,[a("a",{id:"advance-filter-btn",class:"btn btn-tool",onClick:t[0]||(t[0]=(...b)=>i.toggleFilterView&&i.toggleFilterView(...b))},ya),s.selectedData.length>1?S((l(),h("a",{key:0,class:"btn btn-tool",onClick:t[1]||(t[1]=b=>i.deletePackage())},va)),[[v,e.lang("delete-invoices")]]):m("",!0)])]),a("div",ka,[a("div",{style:E(s.filterStyle)},[S(c(r,{id:"filter-box",apiChange:i.apiChange,hideFilter:i.hideFilter,data:s.hideData},null,8,["apiChange","hideFilter","data"]),[[ye,s.isShowFilter]])],4),s.apiUrl?(l(),w(g,{key:0,url:s.apiUrl,dataColumns:s.columns,option:s.options,scroll_to:"pack-title",tickets:i.packages},null,8,["url","dataColumns","option","tickets"])):m("",!0)]),c(q,{name:"modal"},{default:y(()=>[s.showModal?(l(),w(f,{key:0,onClose:i.onClose,showModal:s.showModal,deleteUrl:s.deleteUrl},null,8,["onClose","showModal","deleteUrl"])):m("",!0)]),_:1})])])}const Ca=C(ua,[["render",wa]]);const Da={name:"order-details",description:"Order details component",data:()=>({loading:!1,size:60,order_id:0,orderData:{}}),computed:{...$(["formattedTime"])},beforeMount(){const e=window.location.pathname;this.order_id=B(e),this.getData()},methods:{getData(){this.loading=!0,D.get("/bill/package/user-order-info/"+this.order_id).then(e=>{this.loading=!1,this.orderData=e.data.data}).catch(e=>{this.loading=!1})}}},Sa={class:"col-sm-12"},Ma={class:"card card-light"},Va={class:"card-header"},Pa={class:"card-title"},Ia={class:"card-body"},qa={key:0,slot:"fields"},Ua={class:"callout",style:{"background-color":"rgb(0, 191, 239)",color:"rgb(249, 249, 249)"}},Ta={class:"row"},Fa={class:"col-md-3"},Oa={class:"col-md-3"},La={class:"col-md-3"},Aa={class:"col-md-3"},Ea={class:"row"},Ba={class:"col-md-12"},Na={class:"invoice_box box-solid"},za={class:"box-body"},Ra={class:"table table-striped"},Ya={key:0,class:"row",slot:"fields"};function ja(e,t,n,d,s,i){const p=u("reuse-loader");return l(),h("div",Sa,[a("div",Ma,[a("div",Va,[a("h3",Pa,o(e.lang("order")),1)]),a("div",Ia,[e.loading?m("",!0):(l(),h("div",qa,[a("div",Ua,[a("div",Ta,[a("div",Fa,[a("b",null,o(e.lang("package"))+" : ",1),_(" "+o(e.orderData.package.name),1)]),a("div",Oa,[a("b",null,o(e.lang("credit_type"))+" : ",1),_(" "+o(e.orderData.credit_type),1)]),a("div",La,[a("b",null,o(e.lang("credit_left"))+" : ",1),_(" "+o(e.orderData.credit),1)]),a("div",Aa,[a("b",null,o(e.lang("expiry_date"))+": ",1),_(" "+o(e.formattedTime(e.orderData.expiry_date)),1)])])]),a("div",Ea,[a("div",Ba,[a("div",Na,[a("div",za,[a("table",Ra,[a("thead",null,[a("tr",null,[a("th",null,o(e.lang("title")),1),a("th",null,o(e.lang("ticket_no")),1),a("th",null,o(e.lang("created_at")),1),a("th",null,o(e.lang("updated_at")),1)])]),a("tbody",null,[(l(!0),h(L,null,N(e.orderData.order_tickets,r=>(l(),h("tr",null,[a("td",null,o(r.ticket.first_thread.title),1),a("td",null,o("#"+r.ticket.ticket_number),1),a("td",null,o(e.formattedTime(r.ticket.created_at)),1),a("td",null,o(e.formattedTime(r.ticket.updated_at)),1)]))),256))])])])])])])]))]),e.loading?(l(),h("div",Ya,[c(p,{"animation-duration":4e3,color:"#1d78ff",size:e.size},null,8,["size"])])):m("",!0)])])}const Ha=C(Da,[["render",ja],["__scopeId","data-v-3915111f"]]);const Wa={name:"billing-packages-table",description:"Billing packages table page",setup(){const e=K();return{formattedTime:U(()=>e.getters.formattedTime),formattedDate:U(()=>e.getters.formattedDate)}},props:{category:{type:String,default:""},columnArray:{type:[Array,String],default:""},apiEndpoint:{type:String,default:""},optionsObj:{type:[Object,String],default:""},disableLoader:{type:Boolean,default:!1}},data(){return{base:window.axios.defaults.baseURL,columns:this.columnArray,options:{},apiUrl:this.apiEndpoint}},watch:{optionsObj(e,t){return this.updateTable(),e}},beforeMount(){this.updateTable()},methods:{updateTable(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},headings:e.optionsObj.headings,texts:{filter:"",limit:""},templates:e.optionsObj.templates,sortable:e.optionsObj.sortable,filterable:e.optionsObj.filterable,pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.data,count:t.data.total}}}},handelLoader(e){this.$emit("loaderValue",e)}}};function xa(e,t,n,d,s,i){const p=u("data-table");return l(),w(p,{url:n.apiEndpoint,dataColumns:n.columnArray,onLoaderState:i.handelLoader,disableLoader:n.disableLoader,option:s.options,scroll_to:"packages_title"},null,8,["url","dataColumns","onLoaderState","disableLoader","option"])}const Ga=C(Wa,[["render",xa]]);const Ka={name:"settings-modal",description:"Settings Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function},title:{type:String,default:""},id:{type:[String,Number],default:""},userId:{type:String,default:0}},data:()=>({containerStyle:{width:"800px"},loading:!1,size:60,status:0,packages:[],packageId:0,submitDisabled:!0,checked:!1}),beforeMount(){this.getData()},methods:{getData(){this.loading=!0,D.get("bill/package/get-active-packages").then(e=>{this.loading=!1,this.packages=e.data.data.data}).catch(e=>{this.submitDisabled=!0,this.loading=!1,P(e,"add-invoice")})},createInvoice(){let e=this.checked?1:0,t="?package_id="+this.packageId+"&user_id="+this.userId;window.location.pathname.includes("organizations")&&(t="?package_id="+this.packageId+"&organization_id="+this.userId+"&user_id="+this.userId),this.loading=!0,D.get("bill/package/user-checkout"+t+"&meta="+e).then(n=>{this.loading=!1,I(n,"add-invoice"),window.emitter.emit("refreshData"),setTimeout(()=>{this.onClose()},1500)}).catch(n=>{this.submitDisabled=!0,P(n,"add-invoice"),this.loading=!1})},usePackage(e,t){this.submitDisabled=e=="",this.packageId=e}},components:{"static-select":G}},Ja=e=>(Y("data-v-07cb3d60"),e=e(),j(),e),Qa={class:"modal-title"},Xa={key:0,class:"row"},Za={key:1},$a={class:"row"},es={class:"row"},ts={class:"form-group col-md-12",id:"align"},as={class:"label_align"},ss=["disabled"],ns=Ja(()=>a("i",{class:"fas fa-save"},null,-1));function is(e,t,n,d,s,i){const p=u("alert"),r=u("reuse-loader"),g=u("static-select"),f=u("modal");return n.showModal?(l(),w(f,{key:0,showModal:n.showModal,onClose:n.onClose,containerStyle:e.containerStyle},{title:y(()=>[a("h4",Qa,o(e.lang(n.title))+o(n.id),1)]),alert:y(()=>[c(p,{componentName:"add-invoice"})]),fields:y(()=>[e.loading?(l(),h("div",Xa,[c(r,{"animation-duration":4e3,color:"#1d78ff",size:e.size},null,8,["size"])])):m("",!0),e.loading?m("",!0):(l(),h("div",Za,[a("div",$a,[c(g,{label:e.lang("select_package"),elements:e.packages,name:"package",value:n.id,classname:"col-sm-12",onChange:i.usePackage,required:!0},null,8,["label","elements","value","onChange"])]),a("div",es,[a("div",ts,[a("label",as,[S(a("input",{class:"checkbox_align",type:"checkbox",name:"meta","onUpdate:modelValue":t[0]||(t[0]=v=>e.checked=v)},null,512),[[ne,e.checked]]),_(" "+o(e.lang("send_invoice_to_client")),1)])])])]))]),controls:y(()=>[a("button",{type:"button",class:"btn btn-primary",onClick:t[1]||(t[1]=v=>i.createInvoice()),disabled:e.submitDisabled},[ns,_(" "+o(e.lang("create")),1)],8,ss)]),_:1},8,["showModal","onClose","containerStyle"])):m("",!0)}const re=C(Ka,[["render",is],["__scopeId","data-v-07cb3d60"]]);const os={name:"orders-table",description:"Orders table page",setup(){const e=K();return{formattedTime:U(()=>e.getters.formattedTime),formattedDate:U(()=>e.getters.formattedDate)}},props:{category:{type:String,default:""},apiEndpoint:{type:String,default:""},disableLoader:{type:Boolean,default:!1}},data(){return{base:window.axios.defaults.baseURL,options:{},apiUrl:this.apiEndpoint,columns:["name","invoice","credit_type","credit","total_amount","period_expiry_date","expiry_date"],orderIds:[],order_id:0,showModal:!1}},beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},columnsClasses:{invoice:"order-invoice",credit_type:"order-type",credit:"order-credit",total_amount:"order-amount",period_expiry_date:V("period_expiry_date"),name:"order-name",expiry_date:"order-date"},texts:{filter:"",limit:""},templates:{invoice:function(t,n){return e.h(z,{to:"/bill/package/"+n.id+"/user-invoice"},"#"+n.id)},credit_type(t,n){return n.credit_type},credit(t,n){return n.credit},name(t,n){return e.h(z,{to:"/bill/order/"+n.id},n.package.name)},expiry_date(t,n){let d=new Date,s=e.formattedTime(n.expiry_date),i;return d>s?i=e.h("span",{class:"text-red"},e.formattedTime(n.expiry_date)):i=e.h("span",{class:"text-green"},e.formattedTime(n.expiry_date)),i},total_amount(t,n){return n.invoice.total_amount},period_expiry_date(t,n){return n.period_expiry_date?e.formattedTime(n.period_expiry_date):"---"}},sortable:["credit_type","credit","total_amount","expiry_date","status"],filterable:["credit_type","credit","total_amount","expiry_date","status"],pagination:{chunk:5,nav:"scroll"},headings:{name:this.trans("package_name"),invoice:this.trans("invoice"),credit_type:this.trans("credit_type"),credit:this.trans("credit"),total_amount:this.trans("total_amount"),period_expiry_date:this.trans("period_expiry_date"),expiry_date:this.trans("expiry_date")},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.data,count:t.data.total}}}},methods:{orderData(e){this.orderIds=e},onClick(e){this.order_id=e.id,this.showModal=!0},onClose(){this.showModal=!1,this.$store.dispatch("unsetValidationError")},deleteInvoices(){prompt("Are you sure to delete this","yes ")},handelLoader(e){this.$emit("loaderValue",e)}},components:{"orders-modal":re}},ls={class:"order-pack"};function ds(e,t,n,d,s,i){const p=u("data-table"),r=u("orders-modal");return l(),h("div",ls,[c(p,{url:n.apiEndpoint,dataColumns:s.columns,option:s.options,scroll_to:"packages_title",tickets:i.orderData,onLoaderState:i.handelLoader,disableLoader:n.disableLoader},null,8,["url","dataColumns","option","tickets","onLoaderState","disableLoader"]),c(q,{name:"modal"},{default:y(()=>[s.showModal?(l(),w(r,{key:0,title:"order_details",onClose:i.onClose,showModal:s.showModal,id:s.order_id},null,8,["onClose","showModal","id"])):m("",!0)]),_:1})])}const rs=C(os,[["render",ds]]);const cs={name:"invoices-table",description:"Invoices table page",setup(){const e=K();return{formattedTime:U(()=>e.getters.formattedTime),formattedDate:U(()=>e.getters.formattedDate)}},props:{category:{type:String,default:""},apiEndpoint:{type:String,default:""},disableLoader:{type:Boolean,default:!1}},data(){return{base:window.axios.defaults.baseURL,options:{},apiUrl:this.apiEndpoint,columns:["name","created_at","due_by","total_amount","payment_mode","status"],orderIds:[]}},beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},headings:{name:V("name"),created_at:V("created_at"),total_amount:V("total_amount"),status:V("status"),payment_mode:V("payment_mode"),due_by:V("due_by")},columnsClasses:{name:"invoice-name",created_at:"order-create",due_by:"order-due",total_amount:"order-amount",status:"order-status"},texts:{filter:"",limit:""},templates:{status:function(t,n){let d=e.h("span",{class:n.order.status===1?"btn btn-success btn-xs":"btn btn-danger btn-xs"},n.order.status===1?"Paid":"Unpaid");return e.h("a",{},[d])},created_at(t,n){return e.formattedTime(n.created_at)},due_by(t,n){return e.formattedTime(n.due_by)},payment_mode(t,n){return V(n.payment_mode)},name:function(t,n){return e.h(z,{to:"/bill/package/"+n.id+"/user-invoice"},"#"+n.name)}},sortable:["name","created_at","due_by","total_amount","payment_mode","status"],filterable:["name","created_at","due_by","total_amount","payment_mode"],pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.data,count:t.data.total}}}},methods:{orderData(e){this.orderIds=e},deleteOrders(){prompt("Are you sure to delete this","yes")},handelLoader(e){this.$emit("loaderValue",e)}}},us={class:"invoice-pack"};function hs(e,t,n,d,s,i){const p=u("data-table");return l(),h("div",us,[c(p,{url:n.apiEndpoint,dataColumns:s.columns,option:s.options,scroll_to:"packages_title",tickets:i.orderData,onLoaderState:i.handelLoader,disableLoader:n.disableLoader},null,8,["url","dataColumns","option","tickets","onLoaderState","disableLoader"])])}const ms=C(cs,[["render",hs]]);const ps={name:"billing-packages",description:"Billing packages datatable",props:{data:{type:[String,Object]},id:{type:[String,Number],default:""},ids:{type:[String,Number],default:""}},data(){return{pathName:"",category:"orders",tabs:[],user_id:"",org_id:"",loading:!0,apiUrl:"",showModal:!1,cardOpen:!1,loaderState:""}},beforeMount(){this.loaderState=JSON.parse(this.data).disableLoader},watch:{category(e,t){return e}},computed:{currentTableComponent(){return this.category==="orders"?"orders-table":"invoices-table"}},methods:{toggleCard(){if(this.cardOpen=!this.cardOpen,this.cardOpen){const e=window.location.pathname;this.pathNameArray=e.split("/"),this.pathName=this.pathNameArray.includes("organizations")?"organizations":"user",this.user_id=B(e),this.org_id=B(e),this.getCount(),this.getTableData(this.category)}},getTableData(e){this.pathName==="user"?this.apiUrl=e==="orders"?"/bill/package/get-user-packages?user_id="+this.user_id:"/bill/package/get-user-invoice?users[0]="+this.user_id:this.pathName==="organizations"&&(this.apiUrl=e==="orders"?"/bill/package/get-organization-packages/"+this.org_id:"/bill/package/get-organization-invoice/"+this.org_id)},packages(e){this.category=e,this.getCount(),this.getTableData(e)},getCount(){let e=this.pathName==="organizations"?this.org_id:this.user_id;D.get("/bill/package/get-all-count/"+e+"?category="+this.pathName).then(t=>{this.tabs=[{category:"orders",title:"orders",b_class:"badge bg-orange",count:t.data.data.userpackage},{category:"invoice",title:"invoice",b_class:"badge bg-red",count:t.data.data.invoice}]}).catch(t=>{this.tabs=[]})},onClose(){this.showModal=!1,this.packages("invoice"),this.$store.dispatch("unsetAlert")},addInvoice(){this.showModal=!0},handelLoader(e){this.loading=e}},components:{"billing-packages-table":Ga,"orders-table":rs,"invoices-table":ms,"order-modal":re}},ce=e=>(Y("data-v-6f37c75a"),e=e(),j(),e),_s={id:"billing-packages",class:"card card-light"},gs={class:"card-title"},bs={class:"card-tools"},ys={key:0,type:"button",class:"btn btn-tool rotating","data-card-widget":"refresh"},fs=ce(()=>a("i",{class:"fas fa-sync-alt"},null,-1)),vs=[fs],ks=ce(()=>a("i",{class:"fas fa-plus"},null,-1)),ws=[ks],Cs={type:"button",class:"btn btn-tool"},Ds={key:0,class:"card-body"},Ss={class:"nav nav-tabs",role:"tablist"},Ms={class:"nav-item"},Vs=["onClick"],Ps={class:"badge badge-primary"},Is={class:"tab-content"},qs={class:"active tab-pane"};function Us(e,t,n,d,s,i){const p=u("order-modal"),r=T("tooltip");return l(),h("div",_s,[a("div",{class:"card-header pointer",onClick:t[1]||(t[1]=(...g)=>i.toggleCard&&i.toggleCard(...g))},[a("h3",gs,o(e.lang("packages")),1),a("div",bs,[s.loading&&s.cardOpen?S((l(),h("button",ys,vs)),[[r,e.lang("refresh")]]):m("",!0),s.cardOpen&&s.category==="invoice"?S((l(),h("a",{key:1,class:"btn-tool",onClick:t[0]||(t[0]=g=>i.addInvoice()),href:"javascript:;"},ws)),[[r,e.lang("create_invoice")]]):m("",!0),a("button",Cs,[a("i",{class:O([{"fas fa-angle-up":s.cardOpen,"fas fa-angle-down":!s.cardOpen},"fs-25"])},null,2)])])]),s.cardOpen?(l(),h("div",Ds,[a("ul",Ss,[(l(!0),h(L,null,N(s.tabs,g=>(l(),h("li",Ms,[a("a",{class:O(["nav-link",{active:s.category===g.category}]),"data-toggle":"pill",role:"tab",href:"javascript:;",onClick:f=>i.packages(g.category)},[_(o(e.lang(g.title))+" ",1),a("span",Ps,o(g.count),1)],10,Vs)]))),256))]),a("div",Is,[a("div",qs,[(l(),w(fe(i.currentTableComponent),{id:s.org_id,ids:s.user_id,category:s.category,apiEndpoint:s.apiUrl,disableLoader:s.loaderState,onLoaderValue:i.handelLoader},null,40,["id","ids","category","apiEndpoint","disableLoader","onLoaderValue"]))])])])):m("",!0),c(q,{name:"modal"},{default:y(()=>[s.showModal?(l(),w(p,{key:0,showModal:s.showModal,onClose:i.onClose,orgId:s.org_id,userId:s.user_id,title:e.lang("create_invoice")},null,8,["showModal","onClose","orgId","userId","title"])):m("",!0)]),_:1})])}const ue=C(ps,[["render",Us],["__scopeId","data-v-6f37c75a"]]);const Ts={name:"pending-invoices",data(){return{pending:""}},beforeMount(){this.getCount()},methods:{getCount(){axios.get("/bill/package/get-user-invoice?meta=true&all-users=1&status=0").then(e=>{this.pending=e.data.data.total}).catch(e=>{this.pending=0})}}},Fs=a("i",{class:"far fa-file-pdf"},null,-1),Os=[Fs],Ls={class:"badge badge-danger navbar-badge",style:{position:"relative",top:"-7px",left:"-3px","font-weight":"bold"}};function As(e,t,n,d,s,i){const p=u("router-link"),r=T("tooltip");return s.pending?(l(),w(p,{key:0,id:"pending-invoices",class:"nav-link font-1",to:"/billing/invoices?status=0"},{default:y(()=>[S((l(),h("span",null,Os)),[[r,e.trans("invoices")]]),a("span",Ls,o(s.pending),1)]),_:1})):m("",!0)}const Es=C(Ts,[["render",As]]),Bs={name:"bill-options",data(){return{show_packages:1,allowWithoutPackage:1,invoice_due:"",currency:"",loading:!1,hasDataPopulated:!1,pageLoad:!1,currencyOptions:we()}},beforeMount(){this.getInitialValues()},methods:{getInitialValues(){this.loading=!0,D.get("/bill/api/get-billing-options").then(e=>{this.allowWithoutPackage=te(e.data.data.allowWithoutPackage),this.currency=e.data.data.currency?e.data.data.currency:"USD",this.invoice_due=e.data.data["invoice-due"]?e.data.data["invoice-due"]:"",this.show_packages=te(e.data.data.show_packages),this.loading=!1,this.hasDataPopulated=!0}).catch(e=>{this.loading=!1,this.hasDataPopulated=!0})},onChange(e,t){this[t]=e||""},isValid(){const{errors:e,isValid:t}=Ce(this.$data);return t},onSubmit(){if(this.isValid()){this.pageLoad=!0;const e={};e.allowWithoutPackage=this.allowWithoutPackage?1:0,e.currency=this.currency,e["invoice-due"]=this.invoice_due,e.show_packages=this.show_packages?1:0,e._method="PATCH",D.post("/bill/api/update-billing-options",e).then(t=>{this.pageLoad=!1,I(t,"bill_settings"),this.getInitialValues()}).catch(t=>{this.pageLoad=!1,P(t,"bill_settings")})}}},components:{"number-field":R,"status-switch":ee,"currency-select":De}},Ns={class:"col-sm-12"},zs={key:0,class:"row"},Rs={key:1,class:"row"},Ys={class:"form-group col-sm-4"},js={for:"status"},Hs=a("span",{style:{color:"red"}}," *",-1),Ws=a("br",null,null,-1),xs={class:"form-group col-sm-4"},Gs={for:"status"},Ks=a("span",{style:{color:"red"}}," *",-1),Js=a("br",null,null,-1),Qs={key:2,class:"row"},Xs={key:0,class:"card-footer"},Zs=a("i",{class:"fas fa-save"},null,-1),$s={key:0,class:"row"};function en(e,t,n,d,s,i){const p=u("alert"),r=u("reuse-loader"),g=u("status-switch"),f=u("number-field"),v=u("currency-select"),b=u("faveo-box"),k=u("custom-loader");return l(),h("div",Ns,[c(p,{componentName:"bill_settings"}),c(b,{title:e.trans("bill_settings")},{actions:y(()=>[s.hasDataPopulated?(l(),h("div",Xs,[a("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=F=>i.onSubmit())},[Zs,_(" "+o(e.trans("save")),1)])])):m("",!0)]),default:y(()=>[!s.hasDataPopulated||s.loading?(l(),h("div",zs,[c(r,{"animation-duration":4e3,size:60})])):m("",!0),s.hasDataPopulated?(l(),h("div",Rs,[a("div",Ys,[a("label",js,o(e.trans("show_packages")),1),Hs,Ws,c(g,{name:"show_packages",value:s.show_packages,onChange:i.onChange,bold:!0},null,8,["value","onChange"])]),a("div",xs,[a("label",Gs,o(e.trans("allowWithoutPackage")),1),Ks,Js,c(g,{name:"allowWithoutPackage",value:s.allowWithoutPackage,onChange:i.onChange,bold:!0},null,8,["value","onChange"])]),c(f,{label:e.trans("invoice-due-by"),value:s.invoice_due,name:"invoice_due",classname:"col-sm-4",onChange:i.onChange,type:"number",required:!0},null,8,["label","value","onChange"])])):m("",!0),s.hasDataPopulated?(l(),h("div",Qs,[c(v,{name:"currency",classname:"col-sm-4 faveo-dynamic-select",options:s.currencyOptions,label:e.lang("currency"),value:s.currency,onChange:i.onChange,required:!0},null,8,["options","label","value","onChange"])])):m("",!0)]),_:1},8,["title"]),s.pageLoad?(l(),h("div",$s,[c(k,{duration:4e3})])):m("",!0)])}const tn=C(Bs,[["render",en]]);function an(e){let t={};for(var n in e.extraTextFields)t[e.extraTextFields[n].name]=[e.extraTextFields[n].value,"isRequired"];const d=new x(V),{errors:s,isValid:i}=d.validate(t);return A.dispatch("setValidationError",s),{errors:s,isValid:i}}const sn={name:"settings-modal",description:"Settings Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function},title:{type:String,default:""},data:{type:Object}},data:()=>({isDisabled:!0,containerStyle:{width:"800px"},loading:!0,size:60,status:0,name:"",gateway_name:"",is_default:!1,checkDisabled:!1,extraTextFields:[],extraSwitchFields:[],extraFields:{}}),beforeMount(){this.getValues()},methods:{getValues(){let e=this.data.gateway_name?"/bill/gateway/"+this.data.name+"/"+this.data.gateway_name:"/bill/gateway/"+this.data.name;D.get(e).then(t=>{this.loading=!1,this.isDisabled=!1;let n=t.data.data;this.name=n.name,this.gateway_name=n.gateway_name,this.status=n.status,this.is_default=n.is_default,this.checkDisabled=n.is_default!==0,this.extraFields=n.extra;for(var d in n.extra)n.extra[d].name!=="testMode"?(n.extra[d].value=n.extra[d].value==null?"":n.extra[d].value,this.extraTextFields.push(n.extra[d])):this.extraSwitchFields.push(n.extra[d])}).catch(t=>{this.loading=!1,this.isDisabled=!1})},isValid(){const{errors:e,isValid:t}=an(this.$data);return!!t},onChange(e,t){this[t]=e;for(var n in this.extraTextFields)this.extraTextFields[n].name===t&&(this.extraTextFields[n].value=e);for(var n in this.extraSwitchFields)this.extraSwitchFields[n].name===t&&(this.extraSwitchFields[n].value=e)},onSubmit(){if(this.isValid()){let t={};for(var e in this.extraFields)t[this.extraFields[e].name]=this.extraFields[e].value;this.loading=!0,this.isDisabled=!0;let n={};n.name=this.name,this.gateway_name&&(n.gateway_name=this.gateway_name),n.is_default=this.is_default===!1||this.is_default===0?0:1,n.status=this.status==!1?0:1,Object.keys(t).length>0&&(n.extra=t),D.post("/bill/update/gateway",n).then(d=>{this.loading=!1,this.isDisabled=!1,I(d,"dataTableModal"),window.emitter.emit("refreshData"),this.onClose()}).catch(d=>{this.loading=!1,this.isDisabled=!1,P(d,"dataTableModal")})}}},components:{"text-field":Q,"dynamic-select":X,"status-switch":ee}},nn=e=>(Y("data-v-ee03df2d"),e=e(),j(),e),on={class:"modal-title"},ln={key:0},dn={class:"row"},rn={class:"col-sm-2"},cn={for:"package",class:"col-sm-12 control-label"},un={class:"col-sm-2"},hn={class:"row"},mn={class:"col-sm-12 control-label"},pn={class:"col-sm-2"},_n={class:"row"},gn={class:"form-group col-md-12",id:"align"},bn={class:"label_align"},yn=["disabled"],fn={key:1,class:"row"},vn=["disabled"],kn=nn(()=>a("i",{class:"fas fa-sync","aria-hidden":"true"},null,-1));function wn(e,t,n,d,s,i){const p=u("text-field"),r=u("status-switch"),g=u("reuse-loader"),f=u("modal"),v=T("focus-first-input");return n.showModal?(l(),w(f,{key:0,showModal:n.showModal,onClose:n.onClose,containerStyle:e.containerStyle},{title:y(()=>[a("h4",on,o(e.lang(n.title)),1)]),fields:y(()=>[e.loading?m("",!0):(l(),h("div",ln,[S((l(),h("div",dn,[c(p,{label:e.lang("name"),value:e.name,type:"text",name:"name",disabled:!0,onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-5"},null,8,["label","value","onChange","placehold"]),c(p,{label:e.lang("gateway_name"),value:e.gateway_name,type:"text",name:"gateway_name",disabled:!0,onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-5"},null,8,["label","value","onChange","placehold"]),a("div",rn,[a("label",cn,o(e.lang("status")),1),a("div",un,[c(r,{name:"status",value:e.status,onChange:i.onChange,classname:"pull-left",bold:!0},null,8,["value","onChange"])])])])),[[v]]),a("div",hn,[(l(!0),h(L,null,N(e.extraTextFields,(b,k)=>(l(),w(p,{key:b.index,label:e.lang(b.name),value:b.value,type:"text",name:b.name,onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-5",required:!0},null,8,["label","value","name","onChange","placehold"]))),128)),(l(!0),h(L,null,N(e.extraSwitchFields,(b,k)=>(l(),h("div",{key:b.index,class:"col-sm-2"},[a("label",mn,o(e.lang(b.name)),1),a("div",pn,[c(r,{name:b.name,value:b.value,onChange:i.onChange,classname:"pull-left",bold:!0},null,8,["name","value","onChange"])])]))),128))]),a("div",_n,[a("div",gn,[a("label",bn,[S(a("input",{class:"checkbox_align",type:"checkbox",name:"default","onUpdate:modelValue":t[0]||(t[0]=b=>e.is_default=b),disabled:e.checkDisabled},null,8,yn),[[ne,e.is_default]]),_(" "+o(e.lang("make-default-payment-gateway")),1)])])])])),e.loading?(l(),h("div",fn,[c(g,{"animation-duration":4e3,color:"#1d78ff",size:e.size},null,8,["size"])])):m("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[1]||(t[1]=b=>i.onSubmit()),class:"btn btn-primary",disabled:e.isDisabled},[kn,_(" "+o(e.lang("update")),1)],8,vn)]),_:1},8,["showModal","onClose","containerStyle"])):m("",!0)}const Cn=C(sn,[["render",wn],["__scopeId","data-v-ee03df2d"]]),Dn={name:"payments",description:"Payments data table component",data(){return{base:window.axios.defaults.baseURL,columns:["name","gateway_name","is_default","status","action"],options:{},apiUrl:"/bill/get-gateways-list",showModal:!1,data:{}}},beforeMount(){const e=this;this.options={headings:{name:this.trans("name"),gateway_name:this.trans("gateway_name"),is_default:this.trans("is_default"),status:this.trans("status"),action:this.trans("action")},texts:{filter:"",limit:""},sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},templates:{status:(t,n)=>e.h(de,{data:n}),action:function(t,n){let d=e.h("i",{class:"fa fa-cogs"});return e.h("button",{class:"btn btn-primary btn-xs",onClick(s){e.onClick(n)}},[d])},is_default:(t,n)=>e.h(Se,{data:n})},sortable:["name","gateway_name","is_default","status"],filterable:["name","gateway_name","is_default","status"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.data,count:t.data.data.length}}}},methods:{onClick(e){this.data=e,this.showModal=!0},onClose(){this.showModal=!1,this.$store.dispatch("unsetValidationError")}},components:{"payment-settings-modal":Cn}},Sn={class:"col-sm-12"},Mn={class:"card card-light"},Vn={class:"card-header"},Pn={class:"card-title",id:"payment-title"},In={class:"card-body"};function qn(e,t,n,d,s,i){const p=u("alert"),r=u("data-table"),g=u("payment-settings-modal");return l(),h("div",Sn,[c(p,{componentName:"dataTableModal"}),a("div",Mn,[a("div",Vn,[a("h3",Pn,o(e.lang("list_of_payment_gateways")),1)]),a("div",In,[c(r,{url:s.apiUrl,dataColumns:s.columns,option:s.options,scroll_to:"payment-title"},null,8,["url","dataColumns","option"])]),c(q,{name:"modal"},{default:y(()=>[s.showModal?(l(),w(g,{key:0,title:"settings",onClose:i.onClose,showModal:s.showModal,data:s.data},null,8,["onClose","showModal","data"])):m("",!0)]),_:1})])])}const Un=C(Dn,[["render",qn]]),Tn={name:"pacakges",description:"Pacakges data table component",data(){return{base:window.axios.defaults.baseURL,columns:["id","name","validity","allowed_tickets","price","status","action"],options:{},apiUrl:"/bill/package/get-inbox-data",selectedData:[],showModal:!1,deleteUrl:""}},beforeMount(){const e=this;this.options={headings:{id:this.trans("id"),name:this.trans("name"),validity:this.trans("validity"),allowed_tickets:this.trans("incident_credit"),price:this.trans("price"),status:this.trans("status"),action:this.trans("action")},texts:{filter:"",limit:""},sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},templates:{status:(t,n)=>e.h(de,{data:n}),action:(t,n)=>e.h(ie,{data:n}),validity(t,n){return n.validity===null?V("one_time"):V(n.validity)}},sortable:["name","validity","allowed_tickets","price","status"],filterable:["name","validity","allowed_tickets","price","status"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.message.data.map(n=>(n.edit_url="/billing/package/"+n.id+"/edit",n)),count:t.message.total}}}},methods:{packages(e){this.selectedData=e},deletePackage(){this.deleteUrl="bill/package/delete?package_ids="+this.selectedData,this.showModal=!0},onClose(){this.showModal=!1,this.$store.dispatch("unsetValidationError")}},components:{"delete-modal":oe}},Fn={class:"col-sm-12"},On={class:"card card-light"},Ln={class:"card-header"},An={class:"card-title",id:"pack-title"},En={class:"card-tools"},Bn=a("span",{class:"glyphicon glyphicon-plus"},null,-1),Nn=a("span",{class:"fas fa-trash"},null,-1),zn=[Nn],Rn={class:"card-body"};function Yn(e,t,n,d,s,i){const p=u("alert"),r=u("router-link"),g=u("data-table"),f=u("delete-modal"),v=T("tooltip");return l(),h("div",Fn,[c(p,{componentName:"dataTableModal"}),a("div",On,[a("div",Ln,[a("h3",An,o(e.lang("list_of_packages")),1),a("div",En,[S((l(),w(r,{class:"btn btn-tool",to:"/billing/package/create"},{default:y(()=>[Bn]),_:1})),[[v,e.lang("create-package")]]),s.selectedData.length>0?S((l(),h("a",{key:0,class:"btn btn-tool",onClick:t[0]||(t[0]=b=>i.deletePackage())},zn)),[[v,e.lang("delete-package")]]):m("",!0)])]),a("div",Rn,[c(g,{url:s.apiUrl,dataColumns:s.columns,option:s.options,scroll_to:"pack-title",tickets:i.packages},null,8,["url","dataColumns","option","tickets"])]),c(q,{name:"modal"},{default:y(()=>[s.showModal?(l(),w(f,{key:0,onClose:i.onClose,showModal:s.showModal,deleteUrl:s.deleteUrl},null,8,["onClose","showModal","deleteUrl"])):m("",!0)]),_:1})])])}const jn=C(Tn,[["render",Yn]]);function Hn(e){const{name:t,display_order:n,description:d,allowed_tickets:s,price:i,validity:p,kb_link:r,month_definition:g,selected_option:f,credit_type:v}=e;let b={name:[t,"isRequired"],display_order:[n,"minValue(1)","isRequired"],description:[d,"isRequired"],price:[i,"isRequired"],allowed_tickets:[s,"isRequired"],validity:[p,"isRequired"],kb_link:[r,"isUrl"]};e.credit_type!="all"&&(e.selected_option=="after_specific_number_of_days"&&(b.month_definition=[g,"isRequired","maxValue(31)","minValue(1)"]),b.selected_option=[f,"isRequired"]);const k=new x(V),{errors:F,isValid:J}=k.validate(b);return A.dispatch("setValidationError",F),{errors:F,isValid:J}}const Wn={name:"time-field",description:"time field component along with error block",props:{label:{type:String,required:!0},hint:{type:String,default:""},value:{required:!0},name:{type:String,required:!0},type:{type:String,default:"text"},onChange:{type:Function,Required:!0},classname:{type:String,default:""},required:{type:Boolean,default:!1},labelStyle:{type:Object},formStyle:{type:Object}},data(){return{yearsValue:0,monthsValue:0,daysValue:0,hoursValue:0,minutesValue:0}},created(){window.emitter.on("removeVal",this.initialState)},mounted(){this.value===""?(this.yearsValue=0,this.monthsValue=0,this.daysValue=0,this.hoursValue=0):(this.yearsValue=this.value.years,this.monthsValue=this.value.months,this.daysValue=this.value.days,this.hoursValue=this.value.hours)},methods:{onInput(){let e={years:this.yearsValue,months:this.monthsValue,days:this.daysValue,hours:this.hoursValue};this.onChange(e,this.name)},checkValue(e){e=e||window.event;var t=e.which?e.which:e.keyCode;if(t>31&&(t<48||t>57))e.preventDefault();else return!0},onPaste(e){e=e||window.event,e.preventDefault()},initialState(){this.hoursValue=0,this.monthsValue=0,this.yearssValue=0,this.daysValue=0}},components:{"form-field-template":_e}},xn={class:"inline"},Gn=["type"],Kn=["type"],Jn=["type"],Qn=["type"];function Xn(e,t,n,d,s,i){const p=u("form-field-template");return l(),w(p,{label:n.label,labelStyle:n.labelStyle,name:n.name,classname:n.classname,hint:n.hint,required:n.required},{default:y(()=>[a("span",xn,[S(a("input",{class:"form-control",style:E(n.formStyle),maxlength:"4",type:n.type,id:"txtYears","onUpdate:modelValue":t[0]||(t[0]=r=>s.yearsValue=r),onInput:t[1]||(t[1]=r=>i.onInput()),placeholder:"0",onKeypress:t[2]||(t[2]=(...r)=>i.checkValue&&i.checkValue(...r)),onPaste:t[3]||(t[3]=(...r)=>i.onPaste&&i.onPaste(...r))},null,44,Gn),[[W,s.yearsValue]]),_(" "+o(e.lang("years"))+" ",1),S(a("input",{class:"form-control",style:E(n.formStyle),maxlength:"4",type:n.type,id:"txtMonths","onUpdate:modelValue":t[4]||(t[4]=r=>s.monthsValue=r),onInput:t[5]||(t[5]=r=>i.onInput()),placeholder:"0",onKeypress:t[6]||(t[6]=(...r)=>i.checkValue&&i.checkValue(...r)),onPaste:t[7]||(t[7]=(...r)=>i.onPaste&&i.onPaste(...r))},null,44,Kn),[[W,s.monthsValue]]),_(" "+o(e.lang("months"))+" ",1),S(a("input",{class:"form-control",style:E(n.formStyle),maxlength:"4",type:n.type,id:"txtDays","onUpdate:modelValue":t[8]||(t[8]=r=>s.daysValue=r),onInput:t[9]||(t[9]=r=>i.onInput()),placeholder:"0",onKeypress:t[10]||(t[10]=(...r)=>i.checkValue&&i.checkValue(...r)),onPaste:t[11]||(t[11]=(...r)=>i.onPaste&&i.onPaste(...r))},null,44,Jn),[[W,s.daysValue]]),_(" "+o(e.lang("days"))+" ",1),S(a("input",{class:"form-control",style:E(n.formStyle),maxlength:"4",type:n.type,id:"txtHours","onUpdate:modelValue":t[12]||(t[12]=r=>s.hoursValue=r),onInput:t[13]||(t[13]=r=>i.onInput()),placeholder:"0",onKeypress:t[14]||(t[14]=(...r)=>i.checkValue&&i.checkValue(...r)),onPaste:t[15]||(t[15]=(...r)=>i.onPaste&&i.onPaste(...r))},null,44,Qn),[[W,s.hoursValue]]),_(" "+o(e.lang("hours")),1)])]),_:1},8,["label","labelStyle","name","classname","hint","required"])}const Zn=C(Wn,[["render",Xn],["__scopeId","data-v-5f058f9b"]]),$n={name:"pacakges",description:"Pacakges data table component",setup(){const e=K();return{getUserData:U(()=>e.getters.getUserData)}},data(){return{base:"",name:"",credit_type:"all",description:"",display_order:"",status:0,radioOptions:[{name:"ticket_credit_overall",value:"all"},{name:"ticket_credit_monthly",value:"monthly"}],is_private:0,cycle_options:[{id:"one_time",name:"One time"},{id:"monthly",name:"Monthly"},{id:"quarterly",name:"Quarterly"},{id:"semi_annually",name:"Semi annually"},{id:"annually",name:"Annually"}],validity:"one_time",title:"create_new_package",iconClass:"fas fa-save",btnName:"save",loading:!1,loadingSpeed:4e3,hasDataPopulated:!0,package_id:"",formStyle:{width:"15%"},price:"",allowed_tickets:"",package_pic:"",kb_link:"",departments:[],month_definition:31,createOption:[{id:"end_of_each_month",name:"At the end of each month"},{id:"after_specific_number_of_days",name:"After x days of credit purchase"}],selected_option:"end_of_each_month"}},watch:{getUserData(e,t){return this.base=e.system_url,e}},beforeMount(){const e=window.location.pathname;this.getValues(e),this.validity=="monthly"&&(this.radioOptions=[{name:"ticket_credit_overall",value:"all"}],this.credit_type="all")},created(){this.getUserData.system_url&&(this.base=this.getUserData.system_url)},methods:{getValues(e){const t=B(e);e.indexOf("edit")>=0?(this.title="edit-package",this.iconClass="fas fa-sync",this.btnName="update",this.hasDataPopulated=!1,this.getInitialValues(t)):(this.loading=!1,this.hasDataPopulated=!0)},getInitialValues(e){this.loading=!0,D.get("/api/bill/package/edit/"+e).then(t=>{this.package_id=e,this.hasDataPopulated=!0,this.loading=!1,this.updateStatesWithData(t.data.data)}).catch(t=>{P(t),this.hasDataPopulated=!0,this.loading=!1})},updateStatesWithData(e){const t=this,n=this.$data;Object.keys(e).map(d=>{n.hasOwnProperty(d)&&(t[d]=e[d])}),this.credit_type=e.allowed_tickets_period,this.validity=="monthly"&&(this.radioOptions=[{name:"ticket_credit_overall",value:"all"}],this.credit_type="all"),this.month_definition.includes("-days")?(this.selected_option="after_specific_number_of_days",this.month_definition=this.month_definition.replace("-days","")):(this.selected_option="end_of_each_month",this.month_definition=0)},isValid(){const{errors:e,isValid:t}=Hn(this.$data);return!!t},onSubmit(){if(this.kb_link=this.kb_link===null?"":this.kb_link,this.isValid()){this.loadingSpeed=8e3,this.loading=!0;var e=new FormData;this.package_id!=""&&e.append("id",parseInt(this.package_id)),e.append("name",this.name),e.append("status",this.status===!0||this.status===1?1:0),e.append("is_private",this.is_private===!0||this.is_private===1?1:0),e.append("description",this.description),e.append("display_order",this.display_order),e.append("price",parseInt(this.price)),e.append("validity",this.validity),this.departments.length>0&&e.append("departments",this.departments.map(n=>n.id)),e.append("period",this.credit_type),e.append("allowed_tickets",this.allowed_tickets),this.package_pic&&this.package_pic.id?e.append("package_pic_id",this.package_pic.id):this.package_pic===null?e.append("package_pic",""):this.package_pic.length===1?e.append("package_pic",this.package_pic.shift()):e.append("package_pic",this.package_pic),e.append("kb_link",this.kb_link),this.credit_type!=="all"&&e.append("month_definition",this.selected_option=="after_specific_number_of_days"?this.month_definition+"-days":"months_end");const t={headers:{"Content-Type":"multipart/form-data"}};D.post("/bill/package/store-update",e,t).then(n=>{this.loading=!1,I(n,"package"),this.package_id===""?setTimeout(()=>{this.$router.push({name:"Packages Index"})},3e3):this.getInitialValues(this.package_id)}).catch(n=>{this.loading=!1,P(n,"package")})}},onChange(e,t){this[t]=e,t=="validity"&&(e=="monthly"?(this.radioOptions=[{name:"ticket_credit_overall",value:"all"}],this.credit_type="all",this.selected_option="end_of_each_month"):(this.radioOptions=[{name:"ticket_credit_overall",value:"all"},{name:"ticket_credit_monthly",value:"monthly"}],this.credit_type=this.credit_type))}},components:{"text-field":Q,"number-field":R,"radio-button":ge,"static-select":G,"dynamic-select":X,"status-switch":ee,"time-field":Zn,"file-upload":be}},ei={class:"col-sm-12"},ti={key:0,class:"row"},ai={key:1,class:"card card-light"},si={class:"card-header"},ni={class:"card-title"},ii={class:"card-body"},oi={class:"row"},li={class:"row"},di={class:"row"},ri={class:"col-sm-2"},ci={for:"package",class:"col-sm-12 control-label"},ui={class:"col-sm-2"},hi={class:"col-sm-2"},mi={for:"package",class:"col-sm-12 control-label"},pi={class:"col-sm-2"},_i={key:0,class:"row"},gi={class:"row"},bi={class:"row"},yi={class:"card-footer"},fi=["disabled"];function vi(e,t,n,d,s,i){const p=u("custom-loader"),r=u("alert"),g=u("text-field"),f=u("number-field"),v=u("dynamic-select"),b=u("static-select"),k=u("radio-button"),F=u("status-switch"),J=u("file-upload"),he=T("focus-first-input");return l(),h("div",ei,[s.hasDataPopulated===!1||s.loading===!0?(l(),h("div",ti,[c(p,{duration:s.loadingSpeed},null,8,["duration"])])):m("",!0),c(r,{componentName:"package"}),s.hasDataPopulated===!0?(l(),h("div",ai,[a("div",si,[a("h3",ni,o(e.lang(s.title)),1)]),a("div",ii,[S((l(),h("div",oi,[c(g,{label:e.lang("name"),value:s.name,type:"text",name:"name",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-4",required:!0},null,8,["label","value","onChange","placehold"]),c(f,{label:e.lang("display_order"),value:s.display_order,name:"display_order",classname:"col-sm-4",onChange:i.onChange,placeholder:"n",type:"number",required:!0},null,8,["label","value","onChange"]),c(v,{label:e.lang("departments"),multiple:!0,name:"departments",prePopulate:!0,classname:"col-sm-4",apiEndpoint:"/api/dependency/departments",value:s.departments,onChange:i.onChange},null,8,["label","value","onChange"])])),[[he]]),a("div",li,[c(g,{label:e.lang("description"),value:s.description,type:"textarea",name:"description",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-12",required:!0},null,8,["label","value","onChange","placehold"])]),a("div",di,[c(b,{label:e.lang("billing_cycle"),elements:s.cycle_options,name:"validity",value:s.validity,classname:"col-sm-4",onChange:i.onChange,required:!0},null,8,["label","elements","value","onChange"]),c(k,{options:s.radioOptions,label:e.lang("credit_type"),name:"credit_type",value:s.credit_type,onChange:i.onChange,classname:"form-group col-sm-4"},null,8,["options","label","value","onChange"]),a("div",ri,[a("label",ci,o(e.lang("status")),1),a("div",ui,[c(F,{name:"status",value:s.status,onChange:i.onChange,classname:"pull-left",bold:!0},null,8,["value","onChange"])])]),a("div",hi,[a("label",mi,o(e.lang("private")),1),a("div",pi,[c(F,{name:"is_private",value:s.is_private,onChange:i.onChange,classname:"pull-left",bold:!0},null,8,["value","onChange"])])])]),s.credit_type!="all"?(l(),h("div",_i,[c(b,{value:s.selected_option,name:"selected_option",elements:s.createOption,label:e.lang("monthly_credit_reset_duration"),onChange:i.onChange,classname:"col-sm-6","hide-empty-select":!0,hint:e.lang("package_schedule"),required:!0},null,8,["value","elements","label","onChange","hint"]),s.selected_option!=="end_of_each_month"?(l(),w(f,{key:0,value:s.month_definition,name:"month_definition",label:e.lang("number_of_days"),type:"number",onChange:i.onChange,placeholder:"n",classname:"col-sm-6",required:!0},null,8,["value","label","onChange"])):m("",!0)])):m("",!0),a("div",gi,[c(f,{label:e.lang("incident_credit"),value:s.allowed_tickets,name:"allowed_tickets",classname:"col-sm-6",onChange:i.onChange,placeholder:"n",type:"number",required:!0},null,8,["label","value","onChange"]),c(f,{label:e.lang("price"),value:s.price,name:"price",classname:"col-sm-6",onChange:i.onChange,placeholder:"n",type:"number",required:!0},null,8,["label","value","onChange"])]),a("div",bi,[c(g,{label:e.lang("terms_conditions_page_link"),value:s.kb_link,type:"text",name:"kb_link",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-6"},null,8,["label","value","onChange","placehold"]),c(J,{label:e.lang("image"),value:s.package_pic,name:"package_pic",onChange:i.onChange,classname:"col-sm-6",accept:"image/*"},null,8,["label","value","onChange"])])]),a("div",yi,[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=Si=>i.onSubmit()),disabled:s.loading,class:"btn btn-primary"},[a("span",{class:O(s.iconClass)},null,2),_(" "+o(e.lang(s.btnName)),1)],8,fi)])])):m("",!0)])}const se=C($n,[["render",vi]]);let ki=[{path:"/bill",component:ae,name:"Packages",redirect:"/bill/package/:id/user-invoice",children:[{path:"package/:id/user-invoice",component:Wt,name:"Package Invoice",meta:{title:"user_invoice",crumb:{active:"user_invoice"}}},{path:"order/:id/",component:Ha,name:"Order Details",meta:{title:"order_details",crumb:{active:"order_details"}}}]},{path:"/billing",component:ae,name:"Invoices",redirect:"/billing/invoices",children:[{path:"invoices",component:Ca,name:"Billing Invoice",meta:{title:"invoices",crumb:{active:"invoices"}}}]}];ki.forEach(function(e){ve.addRoute(e)});Z("billing-packages",ue,"user-page-mounted","user-page-table");Z("billing-packages",ue,"org-page-mounted","org-page-div");Z("pending-invoices",Es,"navbar-mounted","nav-id");let wi={path:"/billing",component:le,name:"Billing",redirect:"/billing/settings",children:[{path:"settings",component:tn,name:"BillOptions",meta:{title:"bill",crumb:{link:{name:"admin_panel",to:"/"},active:"bill"}}},{path:"payment-gateways",component:Un,name:"PaymentIndex",meta:{title:"payment_gateway",crumb:{link:{name:"admin_panel",to:"/"},active:"payment_gateway"}}}]},Ci={path:"/billing/package",component:le,name:"Billing Packages",redirect:"/billing/package/list",children:[{path:"list",component:jn,name:"Packages Index",meta:{title:"packages",crumb:{link:{name:"admin_panel",to:"/"},active:"packages"}}},{path:"create",component:se,name:"Package Create",meta:{title:"packages",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"packages",to:"/billing/package"},active:"packages"}}},{path:":id/edit",component:se,name:"Package Edit",meta:{title:"packages",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"packages",to:"/billing/package"},active:"packages"}}}]},Di=[wi,Ci];Di.forEach(function(e){ke.addRoute(e)});A.dispatch("deleteUser");A.dispatch("updateUser");
