import{s as k,e as w,_ as z}from"../chunks/bootstrap.js";import{r as V,A as I}from"../chunks/adminRouter.js";import{$ as C,r as h,o as d,c as l,e as p,d as _,F as f,h as y,f as a,t as i,n as S,i as U,v as N,g as O,p as P,j as T}from"../chunks/vendor.js";import{S as x}from"../chunks/FormGenerator.js";import"../chunks/HelpSection.js";import"../chunks/DataTableActions.js";import"../chunks/AdminNavigationBar.js";const B={name:"dashboard-optimize",data(){return{moduleData:[],subModuleData:[],moduleLoad:!1,subModuleLoad:!1,updateModuleLoad:!1}},beforeMount(){this.getModuleData()},computed:{...C(["formattedTime"])},methods:{getModuleData(){this.moduleLoad=!0,axios.get("/api/modules").then(e=>{this.moduleData=e.data.data.helpdesk,this.moduleLoad=!1,this.getSubModulesData()}).catch(e=>{this.moduleLoad=!1})},getSubModulesData(){this.subModuleLoad=!0,axios.get("/api/sub-module/1?panel=admin").then(e=>{this.subModuleData=e.data.message.map(t=>({...t,display:t.display?t.display:!1,cache:t.cache?t.cache:0})),this.subModuleLoad=!1}).catch(e=>{this.subModuleLoad=!1})},onInput(e){if(e.cache.length<=3)return!0;e.cache=e.cache.substring(0,e.cache.length-1)},checkValue(e){e=e||window.event;let t=e.which?e.which:e.keyCode;if(t>31&&(t<48||t>57))e.preventDefault();else return!0},onPaste(e){e=e||window.event,e.preventDefault()},onChange(e,t){this[t]=e},updateDashboard(e,t){this.updateModuleLoad=!0;let c={};c.module_id=e.id,c.panel="admin",c.is_enabled=e.admin_enable?1:0,c.sub_module=t.map(n=>({id:n.id,display:n.display?1:0,cache:n.display?parseInt(n.cache):0})),axios.post("/update/sub-module",c).then(n=>{k(n,"dashboard-optimize"),this.updateModuleLoad=!1,this.getModuleData()}).catch(n=>{w(n,"dashboard-optimize"),this.updateModuleLoad=!1})}},components:{"status-switch":x}},A=e=>(P("data-v-8b985aa1"),e=e(),T(),e),F={class:"col-sm-12"},H={key:0,class:"row"},E={key:1,class:"p-50"},G={class:"card card-light"},K={class:"card-header"},R={class:"card-title mt-2"},q={class:"card-tools switch-pos"},J={class:"card-body"},Q={class:"row"},W={class:"col-sm-12"},X={class:"alert alert-info"},Y={class:"row p-2"},Z={key:0,class:"col-sm-12 p-50"},j={key:1,class:"table table-striped border"},$=["onUpdate:modelValue","onInput","disabled"],ee={key:0,class:"card-footer"},ae=["onClick"],te=A(()=>a("i",{class:"fas fa-sync-alt"},null,-1));function oe(e,t,c,n,s,u){const g=h("alert"),M=h("custom-loader"),D=h("reuse-loader"),b=h("toggle"),v=h("loader");return d(),l("div",F,[p(g,{componentName:"dashboard-optimize"}),s.updateModuleLoad?(d(),l("div",H,[p(M,{duration:4e3})])):_("",!0),s.moduleLoad?(d(),l("div",E,[p(D,{"animation-duration":4e3,color:"#1d78ff",size:60})])):(d(!0),l(f,{key:2},y(s.moduleData,m=>(d(),l("div",G,[a("div",K,[a("h3",R,i(e.trans("dashboard")),1),a("div",q,[p(b,{modelValue:m.admin_enable,"onUpdate:modelValue":o=>m.admin_enable=o,class:"toggle-switch"},null,8,["modelValue","onUpdate:modelValue"])])]),a("div",J,[a("div",Q,[a("div",W,[a("div",X,i(m.description),1),a("div",Y,[s.subModuleLoad?(d(),l("div",Z,[p(v,{"animation-duration":4e3,color:"#1d78ff",size:60})])):_("",!0),!s.subModuleLoad&&!s.moduleLoad?(d(),l("table",j,[a("thead",null,[a("tr",null,[a("th",null,i(e.trans("title")),1),a("th",null,i(e.trans("cache")),1),a("th",null,i(e.trans("updated_at")),1),a("th",null,i(e.trans("action")),1)])]),a("tbody",null,[(d(!0),l(f,null,y(s.subModuleData,(o,L)=>(d(),l("tr",{key:L,class:S(m.admin_enable?"":"row_disable")},[a("td",null,i(e.trans(o.label)),1),a("td",null,[U(a("input",{type:"number",min:"0","onUpdate:modelValue":r=>o.cache=r,max:"999",class:"form-control",onInput:r=>u.onInput(o),onKeypress:t[0]||(t[0]=(...r)=>u.checkValue&&u.checkValue(...r)),onPaste:t[1]||(t[1]=(...r)=>u.onPaste&&u.onPaste(...r)),disabled:!o.display},null,40,$),[[N,o.cache]])]),a("td",null,i(e.formattedTime(o.updated_at)),1),a("td",null,[p(b,{modelValue:o.display,"onUpdate:modelValue":r=>o.display=r,class:"toggle-switch"},null,8,["modelValue","onUpdate:modelValue"])])],2))),128))])])):_("",!0)])])])]),!s.subModuleLoad&&!s.moduleLoad?(d(),l("div",ee,[a("button",{class:"btn btn-primary float-right",onClick:o=>u.updateDashboard(m,s.subModuleData)},[te,O("Â "+i(e.trans("update")),1)],8,ae)])):_("",!0)]))),256))])}const se=z(B,[["render",oe],["__scopeId","data-v-8b985aa1"]]);let de={path:"/optimize",component:I,name:"Dashboard Optimize",redirect:"/optimize/dashboard",children:[{path:"dashboard",component:se,name:"DashboardOptimize",meta:{title:"optimize",crumb:{link:{name:"admin_panel",to:"/"},active:"optimize"}}}]};V.addRoute(de);
