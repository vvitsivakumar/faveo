import{_ as D,s as A,e as T,V as E,l as N,c as j,D as B,j as F,k as R,T as x,N as W}from"../chunks/bootstrap.js";import{a as k,r as c,q as I,o as n,c as r,e as h,f as s,t as m,F as S,h as $,i as w,b as M,w as y,n as V,d as v,g as C,u as X,m as Y,s as Z,T as O,p as P,j as H}from"../chunks/vendor.js";import{r as z,A as ee}from"../chunks/adminRouter.js";import{a as te}from"../chunks/DataTableActions.js";import{C as G,S as ae}from"../chunks/FormGenerator.js";import"../chunks/HelpSection.js";import"../chunks/AdminNavigationBar.js";const se={name:"template-index",data(){return{channels:null,pageLoad:!0,plugin:null}},beforeMount(){this.plugin=new URL(location.href).searchParams.get("plugin"),this.getNotificationChannels()},methods:{getNotificationChannels(){k.get("notify/api/notification-channels").then(e=>{this.pageLoad=!1,this.channels=e.data.data,A(e,"template-index")}).catch(e=>{this.pageLoad=!1,T(e,"template-index")})}}},ne={class:"col-sm-12"},le={key:0,class:"card card-light"},oe={class:"card-header"},ie={class:"card-title"},re={class:"card-body"},ce={class:"row"},de={class:"col-md-2 col-sm-6"},me={class:"settingiconblue"},he={class:"settingdivblue"},_e={class:"fa-stack fa-2x"},pe={class:"text-center text-sm fw_400"},ue={key:1,class:"row"};function ge(e,t,i,l,a,o){const p=c("alert"),g=c("router-link"),u=c("custom-loader"),b=I("tooltip");return n(),r("div",ne,[h(p,{componentName:"template-index"}),a.pageLoad?(n(),r("div",ue,[h(u,{duration:4e3})])):(n(),r("div",le,[s("div",oe,[s("h3",ie,m(e.trans("notifications-channels")),1)]),s("div",re,[s("div",ce,[(n(!0),r(S,null,$(a.channels,d=>(n(),r("div",de,[s("div",me,[s("div",he,[w((n(),M(g,{to:"/notify/manage/channels/"+d.channel+"/template-sets"+(a.plugin?"?plugin="+a.plugin:"")},{default:y(()=>[s("span",_e,[s("i",{class:V([d.icon,"fa-stack-1x"])},null,2)])]),_:2},1032,["to"])),[[b,e.trans(d.desc_lang_key)]])]),s("div",pe,m(e.trans(d.channel)),1)])]))),256))])])]))])}const fe=D(se,[["render",ge],["__scopeId","data-v-17809ed4"]]);function J(e){const{name:t,template_language:i,parent_template_set:l}=e;let a={name:[t,"isRequired"],template_language:[i,"isRequired"],parent_template_set:[l,"isRequired"]};const o=new E(N),{errors:p,isValid:g}=o.validate(a);return j.dispatch("setValidationError",p),{errors:p,isValid:g}}const be={name:"template-set-create-modal",data(){return{isLoading:!1,name:"",template_language:[],department_id:[],parent_template_set:[],containerStyle:{width:"800px"}}},props:{showModal:{type:Boolean,default:!1},onClose:{type:Function},apiUrl:{type:String},languages:{type:Array,required:!0,default:()=>[]}},methods:{onChange(e,t){this[t]=e||""},onSubmit(){if(this.isValidInputs()){let e={name:this.name,parent_template_set:this.parent_template_set.id,department_id:this.department_id?this.department_id.id:null,template_language:this.template_language.value};this.isLoading=!0,k.post("notify/api/template-sets/create",e).then(t=>{this.isLoading=!1,this.onClose(),A(t,"template-set-list-index"),window.emitter.emit("refreshData")}).catch(t=>{T(t,"template-set-create-modal"),this.isLoading=!1})}},isValidInputs(){const{errors:e,isValid:t}=J(this.$data);return t}},components:{"dynamic-select":B,"text-field":F}},ve={class:"modal-title"},ye={key:0},we={class:"row"},Ce={class:"row"},ke={key:1,class:"row"},Le=s("i",{class:"fas fa-save"}," ",-1);function Se(e,t,i,l,a,o){const p=c("alert"),g=c("text-field"),u=c("dynamic-select"),b=c("reuse-loader"),d=c("modal"),f=I("focus-first-input");return n(),r("div",null,[i.showModal?(n(),M(d,{key:0,showModal:!0,onClose:i.onClose,containerStyle:a.containerStyle},{title:y(()=>[s("h4",ve,m(e.trans("clone_language_set")),1)]),alert:y(()=>[h(p,{componentName:"template-set-create-modal"})]),fields:y(()=>[a.isLoading?v("",!0):(n(),r("div",ye,[w((n(),r("div",we,[h(g,{label:e.lang("name"),value:a.name,type:"text",name:"name",onChange:o.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold"]),h(u,{id:"parent_template_set",name:"parent_template_set",classname:"col-sm-6",apiEndpoint:i.apiUrl,label:e.lang("template_set_to_clone"),hint:e.lang("select_template_set_to_clone"),required:!0,multiple:!1,value:a.parent_template_set,onChange:o.onChange},null,8,["apiEndpoint","label","hint","value","onChange"])])),[[f]]),s("div",Ce,[h(u,{id:"department_id",name:"department_id",classname:"col-sm-6",apiEndpoint:"/api/dependency/departments",label:e.lang("department"),hint:e.lang("select_template_department"),value:a.department_id,multiple:!1,onChange:o.onChange},null,8,["label","hint","value","onChange"]),h(u,{id:"template_language",name:"template_language",classname:"col-sm-6",elements:i.languages,label:e.lang("template_language"),required:!0,hint:e.lang("select_language_for_cloned_template"),multiple:!1,value:a.template_language,onChange:o.onChange},null,8,["elements","label","hint","value","onChange"])])])),a.isLoading?(n(),r("div",ke,[h(b,{"animation-duration":4e3,color:"#1d78ff"})])):v("",!0)]),controls:y(()=>[s("button",{type:"button",class:"btn btn-primary",onClick:t[0]||(t[0]=(..._)=>o.onSubmit&&o.onSubmit(..._))},[Le,C(m(e.lang("submit")),1)])]),_:1},8,["onClose","containerStyle"])):v("",!0)])}const $e=D(be,[["render",Se]]),Ae={name:"template-translation-set-create-modal",data(){return{isLoading:!1,name:"",template_language:[],department_id:[],containerStyle:{width:"800px"}}},props:{showTranslateModal:{type:Boolean,default:!1},onClose:{type:Function},languages:{type:Array,required:!0,default:()=>[]}},methods:{onChange(e,t){this[t]=e||""},onSubmit(){if(this.isValidInputs()){let e=new URL(location.href),t=e.pathname.substring(0,e.pathname.lastIndexOf("/")),i=t.substring(t.lastIndexOf("/")+1),l={name:this.name,channel_name:i,department_id:this.department_id?this.department_id.id:null,template_language:this.template_language.value};this.isLoading=!0,k.post("notify/api/template-sets/create_translate",l).then(a=>{this.isLoading=!1,this.onClose(),A(a,"template-set-list-index"),window.emitter.emit("refreshData")}).catch(a=>{T(a,"template-translation-set-create-modal"),this.isLoading=!1})}},isValidInputs(){const{errors:e,isValid:t}=J(this.$data);return t}},components:{"dynamic-select":B,"text-field":F}},Te={class:"modal-title"},Me={key:0},De={class:"row"},Ie={class:"row"},Ve={key:1,class:"row"},Ue=s("i",{class:"fas fa-save"}," ",-1);function Ne(e,t,i,l,a,o){const p=c("alert"),g=c("text-field"),u=c("dynamic-select"),b=c("reuse-loader"),d=c("modal"),f=I("focus-first-input");return n(),r("div",null,[i.showTranslateModal?(n(),M(d,{key:0,"show-modal":i.showTranslateModal,onClose:i.onClose,containerStyle:a.containerStyle},{title:y(()=>[s("h4",Te,m(e.lang("create_translated_set")),1)]),alert:y(()=>[h(p,{componentName:"template-translation-set-create-modal"})]),fields:y(()=>[a.isLoading?v("",!0):(n(),r("div",Me,[w((n(),r("div",De,[h(g,{label:e.lang("name"),value:a.name,type:"text",name:"name",onChange:o.onChange,classname:"col-sm-6",required:!0},null,8,["label","value","onChange"]),h(u,{id:"template_language",name:"template_language",classname:"col-sm-6",elements:i.languages,label:e.lang("template_language"),required:!0,multiple:!1,value:a.template_language,onChange:o.onChange},null,8,["elements","label","value","onChange"])])),[[f]]),s("div",Ie,[h(u,{id:"department_id",name:"department_id",classname:"col-sm-6",apiEndpoint:"/api/dependency/departments",label:e.lang("department"),hint:e.lang("select_template_department"),value:a.department_id,multiple:!1,onChange:o.onChange},null,8,["label","hint","value","onChange"])])])),a.isLoading?(n(),r("div",Ve,[h(b,{"animation-duration":4e3,color:"#1d78ff"})])):v("",!0)]),controls:y(()=>[s("button",{type:"button",class:"btn btn-primary",onClick:t[0]||(t[0]=(..._)=>o.onSubmit&&o.onSubmit(..._))},[Ue,C(m(e.lang("submit")),1)])]),_:1},8,["show-modal","onClose","containerStyle"])):v("",!0)])}const qe=D(Ae,[["render",Ne]]);const Ee={name:"template-set-list-index",setup(){const e=X();return{formattedTime:Y(()=>e.getters.formattedTime)}},data(){return{apiUrl:"notify/api/template-sets",plugin:null,channel:null,columns:["name","active","template_language","department","actions"],showModal:!1,showTranslateModal:!1,languages:[],options:{},showDrop:!1}},beforeMount(){const e=this;let t=new URL(location.href);this.plugin=t.searchParams.get("plugin");let i=t.pathname.substring(0,t.pathname.lastIndexOf("/"));this.channel=i.substring(i.lastIndexOf("/")+1),this.apiUrl=this.apiUrl+"?channel="+this.channel,this.getLanguagesMenu(),this.options={sortIcon:{base:"glyphicon",down:"glyphicon-chevron-up",up:"glyphicon-chevron-down"},headings:{name:this.trans("name"),active:this.trans("status"),template_language:this.trans("language_code"),department:this.trans("department"),actions:this.trans("actions")},columnsClasses:{name:"template-list-name",active:"template-list-active",template_language:"template-list-language",department:"template-list-department",actions:"template-list-actions"},texts:{filter:"",limit:""},templates:{active:function(l,a){let o=e.h("span",{class:a.active?"btn btn-success btn-xs pointer_normal":"btn btn-danger btn-xs pointer_normal"},a.active?"Active":"Inactive");return e.h("a",{class:"pointer_normal"},[o])},department(l,a){return a.department?a.department.name:"--"},actions:(l,a)=>e.h(te,{data:a})},sortable:["name","active","template_language"],filterable:["name","template_language"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(l){return{"sort-field":l.orderBy?l.orderBy:"id","sort-order":l.ascending?"desc":"asc","search-query":l.query.trim(),page:l.page,limit:l.limit}},responseAdapter({data:l}){return{data:l.data.data.map(a=>(a.status_toggle_url=e.basePath()+"/notify/api/template-sets/change-status/"+a.id,a.view_url="/notify/manage/channels/"+e.channel+"/template-sets/"+a.id+"/templates"+(e.plugin?"?plugin="+e.plugin:""),a.delete_url=e.basePath()+"/notify/api/delete-template-sets/"+a.id,a.active_status=a.active,a.alertComponentName="template-set-list-index",a)),count:l.data.total}}},setTimeout(()=>{this.showDrop=!0},1e3)},methods:{toggleModal(){this.showModal=!this.showModal},toggleTranslateModal(){this.showTranslateModal=!this.showTranslateModal},onClose(){this.showModal=!1,this.showTranslateModal=!1},getLanguagesMenu(){k.get("api/dependency/languages?meta=true").then(e=>{this.languages=e.data.data.languages.map(function(t,i){return{name:t.name+" ("+t.translation+")",value:t.locale}})}).catch(e=>{})}},components:{"template-translation-set-create-modal":qe,"template-set-create-modal":$e}},q=e=>(P("data-v-ca9fc202"),e=e(),H(),e),je={class:"col-sm-12"},Fe={class:"card card-light"},Re={class:"card-header"},xe={id:"template-set-index",class:"card-title"},Oe={class:"card-tools"},Be=q(()=>s("a",{href:"javascript:;",class:"btn-tool dropdown-toggle","data-toggle":"dropdown"},[s("i",{class:"glyphicon glyphicon-plus"})],-1)),Pe={class:"dropdown-menu dropdown-menu-right",role:"menu"},He=q(()=>s("i",{class:"glyphicon glyphicon-plus"},null,-1)),ze=q(()=>s("hr",{class:"m-0"},null,-1)),Ge=q(()=>s("i",{class:"fas fa-language"},null,-1)),Je={class:"card-body",id:"template-set-list"};function Ke(e,t,i,l,a,o){const p=c("alert"),g=c("data-table"),u=c("template-set-create-modal"),b=c("template-translation-set-create-modal"),d=I("tooltip");return n(),r("div",je,[h(p,{componentName:"template-set-list-index"}),s("div",Fe,[s("div",Re,[s("h3",xe,m(e.trans("list_of_templates_sets")),1),s("div",Oe,[Be,w(s("div",Pe,[w((n(),r("a",{class:"dropdown-item pointer-cursor",onClick:t[0]||(t[0]=(...f)=>o.toggleModal&&o.toggleModal(...f))},[He,C(" "+m(e.trans("clone_language_set")),1)])),[[d,e.trans("clone_language_set")]]),ze,w((n(),r("a",{class:"dropdown-item pointer-cursor",onClick:t[1]||(t[1]=(...f)=>o.toggleTranslateModal&&o.toggleTranslateModal(...f))},[Ge,C(" "+m(e.trans("create_translated_set")),1)])),[[d,e.trans("create_translated_set")]])],512),[[Z,a.showDrop]])])]),s("div",Je,[h(g,{url:a.apiUrl,dataColumns:a.columns,option:a.options,scroll_to:"template-set-index"},null,8,["url","dataColumns","option"])])]),h(O,{name:"modal"},{default:y(()=>[a.showModal?(n(),M(u,{key:0,showModal:a.showModal,onClose:o.onClose,languages:a.languages,apiUrl:a.apiUrl},null,8,["showModal","onClose","languages","apiUrl"])):v("",!0)]),_:1}),h(O,{name:"modal"},{default:y(()=>[a.showTranslateModal?(n(),M(b,{key:0,showTranslateModal:a.showTranslateModal,onClose:o.onClose,languages:a.languages,apiUrl:a.apiUrl},null,8,["showTranslateModal","onClose","languages","apiUrl"])):v("",!0)]),_:1})])}const Qe=D(Ee,[["render",Ke],["__scopeId","data-v-ca9fc202"]]),We={name:"templates-list-index",data(){return{plugin:null,id:null,channel:"",pageLoadnig:!0,list:[]}},beforeMount(){let e=new URL(location.href);this.plugin=e.searchParams.get("plugin"),this.id=R(window.location.pathname),this.channel=location.href.substring(location.href.indexOf("channels/")+9,location.href.indexOf("/template-sets")),this.getTemplatesList()},methods:{getTemplatesList(){let e="notify/api/templates?set_id="+this.id+(this.plugin?"&plugin="+this.plugin:"");k.get(e).then(t=>{this.list=t.data.data,this.pageLoadnig=!1,A(t,"template-edit")}).catch(t=>{this.pageLoadnig=!1,T(t,"template-edit")})}},components:{"tool-tip":x}},Xe={class:"col-sm-12"},Ye={key:0,class:"card card-light"},Ze={class:"card-header"},et={class:"card-title"},tt={key:0,class:"card-body"},at={key:1,class:"card-body"},st={class:"nav nav-tabs",id:"custom-content-below-tab",role:"tablist"},nt={class:V(["nav-item"])},lt=["id","href","aria-controls"],ot={class:"tab-content",id:"custom-content-below-tabContent"},it=["id","aria-labelledby"],rt={class:"table table-bordered table-condensed"},ct={style:{width:"20%"}},dt={style:{width:"70%"}},mt={style:{width:"10%"}},ht={style:{width:"20%"}},_t={style:{width:"70%"}},pt={style:{width:"10%"}},ut=s("i",{class:"fas fa-edit"},null,-1),gt={key:1,class:"row"};function ft(e,t,i,l,a,o){const p=c("alert"),g=c("center"),u=c("router-link"),b=c("custom-loader"),d=I("tooltip");return n(),r("div",Xe,[h(p,{componentName:"templates-list-index"}),a.pageLoadnig?(n(),r("div",gt,[h(b,{duration:4e3})])):(n(),r("div",Ye,[s("div",Ze,[s("h3",et,m(e.trans("templates")),1)]),a.list.length==0?(n(),r("div",tt,[h(g,null,{default:y(()=>[s("p",null,m(e.trans("no_data_found")),1)]),_:1})])):(n(),r("div",at,[s("ul",st,[(n(!0),r(S,null,$(a.list,(f,_,L)=>(n(),r("li",nt,[w((n(),r("a",{class:V(["nav-link",L===0?"active":""]),id:_+"-tab","data-toggle":"pill",href:"#"+_,role:"tab","aria-controls":_,"aria-selected":"true"},[C(m(e.trans(_+"_lang_key")),1)],10,lt)),[[d,e.trans(_+"_desc_key")]])]))),256))]),s("div",ot,[(n(!0),r(S,null,$(a.list,(f,_,L)=>(n(),r("div",{class:V(["tab-pane","fade",L===0?"active show":""]),id:_,role:"tabpanel","aria-labelledby":_},[s("table",rt,[s("thead",null,[s("tr",null,[s("th",ct,m(e.trans("name")),1),s("th",dt,m(e.trans("description")),1),s("th",mt,m(e.trans("actions")),1)])]),s("tbody",null,[(n(!0),r(S,null,$(f,U=>(n(),r("tr",null,[s("td",ht,m(e.trans(U.template)),1),s("td",_t,m(e.trans(U.desc_lang_key)),1),s("td",pt,[w((n(),M(u,{class:"btn btn-primary",to:"/notify/manage/channels/"+a.channel+"/template-sets/"+a.id+"/templates/"+U.templates[0].id},{default:y(()=>[ut]),_:2},1032,["to"])),[[d,e.trans("edit")]])])]))),256))])])],10,it))),256))])]))]))])}const bt=D(We,[["render",ft]]);function vt(e){const{subject:t,content:i}=e;let l={subject:[t,"isRequired"],content:[i,"isRequired"]};const a=new E(N),{errors:o,isValid:p}=a.validate(l);return j.dispatch("setValidationError",o),{errors:o,isValid:p}}const yt={name:"template-edit",data(){return{template:null,id:null,showsubject:!1,isDisabled:!1,loading:!1,variable:!1,name:"",content:"",subject:""}},beforeMount(){this.id=R(window.location.pathname),this.getTemplateDetails()},methods:{getTemplateDetails(){this.toggleLoaders(!0),k.get("/notify/api/get-template/"+this.id).then(e=>{this.template=e.data.data,this.showsubject=this.template.variable==1,this.name=this.template.name,this.subject=this.template.subject,this.content=this.template.content,this.variable=this.template.variable==1,this.toggleLoaders(!1),A(e,"template-edit")}).catch(e=>{this.toggleLoaders(!1),T(e,"template-edit")})},onChange(e,t){this[t]=e},submit(){if(this.isValidInputs()){this.toggleLoaders(!0);let e={subject:this.subject,variable:this.variable,content:this.content};k.patch("notify/api/update-template/"+this.id,e).then(t=>{this.toggleLoaders(!1),A(t,"template-edit")}).catch(t=>{this.toggleLoaders(!1),T(t,"template-edit")})}},toggleLoaders(e){this.loading=e,this.isDisabled=e},isValidInputs(){const{errors:e,isValid:t}=vt(this.$data);return t}},components:{"text-field":F,"tool-tip":x}},wt={class:"col-sm-12"},Ct={class:"card card-light"},kt={key:0,class:"card-header"},Lt={class:"card-title"},St={class:"card-body"},$t={key:0,class:"row"},At={class:"col-md-12"},Tt={class:"lead"},Mt={class:"row"},Dt={class:"col-md-12"},It={class:"card card-light"},Vt={class:"card-header"},Ut={class:"card-title"},Nt={class:"card-tools"},qt={class:"btn btn-tool","data-card-widget":"collapse","data-toggle":"tooltip"},Et=s("i",{class:"fas fa-minus"},null,-1),jt=[Et],Ft={class:"card-body col-md-12"},Rt={class:"alert alert-info alert-dismissable"},xt=s("i",{class:"fas fa-info-circle"},null,-1),Ot=s("button",{type:"button",class:"close","data-dismiss":"alert","aria-hidden":"true"},"×",-1),Bt={key:0,class:"list-inline"},Pt={class:"list-inline-item",style:{width:"23%"}},Ht={"data-placement":"right"},zt={class:"row"},Gt={class:"col-md-12 form-group"},Jt={class:"card-footer"},Kt=["disabled"],Qt=s("i",{class:"fas fa-save","aria-hidden":"true"},null,-1);function Wt(e,t,i,l,a,o){const p=c("alert"),g=c("custom-loader"),u=c("text-field"),b=c("tiny-editor-with-validation"),d=I("tooltip");return n(),r("div",wt,[h(p,{componentName:"template-edit"}),a.loading?(n(),M(g,{key:0})):v("",!0),s("div",Ct,[a.template?(n(),r("div",kt,[s("h3",Lt,m(e.trans(a.name)),1)])):v("",!0),s("div",St,[a.template?(n(),r("div",$t,[s("div",At,[s("p",Tt,m(e.trans(a.template.template_name)),1)])])):v("",!0),s("div",Mt,[s("div",Dt,[s("div",It,[s("div",Vt,[s("h3",Ut,m(e.trans("list-of-available-shot-codes")),1),s("div",Nt,[w((n(),r("button",qt,jt)),[[d,e.trans("collapse-list")]])])]),s("div",Ft,[s("div",Rt,[xt,C("  "),s("span",null,m(e.trans("template-short-code-tips")),1),Ot]),s("div",null,[a.template?(n(),r("ul",Bt,[(n(!0),r(S,null,$(a.template.shortCodes,(f,_)=>(n(),r("li",Pt,[w((n(),r("span",Ht,[C(m(_),1)])),[[d,e.trans(f),void 0,{right:!0}]])]))),256))])):v("",!0)])])])])]),s("div",zt,[s("div",Gt,[a.showsubject?(n(),M(u,{key:0,autofocus:!0,label:e.trans("subject"),value:a.subject,type:"text",name:"subject",onChange:o.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold"])):v("",!0),h(b,{value:a.content,type:"text",onChange:o.onChange,name:"content",label:e.trans("content"),required:!0,classname:"col-sm-12 width55",lang:"en",convertURLs:!1},null,8,["value","onChange","label"])])])]),s("div",Jt,[s("button",{type:"button",id:"submitter",onClick:t[0]||(t[0]=(...f)=>o.submit&&o.submit(...f)),class:"btn btn-primary",disabled:a.isDisabled},[Qt,C(" "+m(e.trans("update")),1)],8,Kt)])])])}const Xt=D(yt,[["render",Wt]]);const Yt={name:"alert-settings",data(){return{isDisabled:!1,loading:!1,alerts:null,setAlerts:null}},beforeMount(){this.id=R(window.location.pathname),this.getAlerts()},methods:{checkAlertIsSet(e,t=0){for(let i=0;i<e.length;i++){let l=this.setAlerts[e[i].associate_id].join();if(l.includes(t))return!0;if(l!=""&&!t)return!0}return!1},onChange(e,t){e?this.enableAllChannelsForAlert(t):this.toggleAllChannelsForAlert(t,!0)},enableAllChannelsForAlert(e){for(var t=0;t<this.alerts[e].associates.length;t++)if(this.setAlerts[this.alerts[e].associates[t].associate_id].length>0)return!1;this.toggleAllChannelsForAlert(e,!1)},toggleAllChannelsForAlert(e,t){this.alerts[e].allowedChannels.forEach(i=>{this.toggleChannelForAlert(t,this.alerts[e].associates,i.id)})},toggleChannelForAlert(e,t,i){t.forEach(l=>{this.toggleChannel(e,l.associate_id,i)})},toggleChannel(e,t,i){let l=this.setAlerts[t].indexOf(i);l>-1&&this.setAlerts[t].splice(l,1),e||this.setAlerts[t].push(i)},toggleLoaders(e){this.loading=e,this.isDisabled=e},updateSetAlerts(){let e={};for(const[t,i]of Object.entries(this.alerts))i.associates.forEach(function(l){let a=[],o=l.associate_id;l.channels.length>0&&(a=l.channels),e[o]=a});this.setAlerts=e},getAlerts(){this.toggleLoaders(!0),k.get("/notify/api/base-alerts").then(e=>{this.alerts=e.data.data,this.updateSetAlerts(),this.toggleLoaders(!1),A(e,"alert-settings")}).catch(e=>{this.toggleLoaders(!1),T(e,"alert-settings")})},formatAlertFormData(){let e=[];for(const[t,i]of Object.entries(this.setAlerts)){let l={};l.associate=t,l.channels=[],i.forEach(function(a,o){l.channels[o]={channel_id:a}}),e.push(l)}return e},submit(){this.toggleLoaders(!0);let e={alerts:this.formatAlertFormData()};k.patch("notify/api/base-alerts",e).then(t=>{this.toggleLoaders(!1),A(t,"alert-settings")}).catch(t=>{this.toggleLoaders(!1),T(t,"alert-settings")})}},components:{checkbox:G,"tool-tip":x,"status-switch":ae}},K=e=>(P("data-v-3773fbb8"),e=e(),H(),e),Zt={class:"col-sm-12"},ea={key:1,class:"card card-light"},ta={class:"card-header"},aa={class:"card-title"},sa={class:"card-body"},na={class:"row"},la={class:"col-md-12 form-group"},oa={class:"table table-sm",style:{"text-align":"center"}},ia={class:"align-middle"},ra={style:{"vertical-align":"middle",width:"5%"}},ca={style:{"vertical-align":"middle",width:"10%"}},da={class:"table table-borderless table-sm"},ma={style:{"vertical-align":"middle"}},ha=["onClick"],_a={style:{"vertical-align":"middle","text-align":"left"}},pa={class:"alert-tooltip"},ua=K(()=>s("i",{class:"fas fa-info-circle"},null,-1)),ga=[ua],fa={class:"table table-borderless table-sm"},ba={style:{"width=":"100%"}},va={style:{"text-align":"right"}},ya={style:{width:"5%","text-align":"left"}},wa=["onClick"],Ca={slot:"actions",class:"card-footer"},ka=["disabled"],La=K(()=>s("i",{class:"fas fa-save","aria-hidden":"true"},null,-1));function Sa(e,t,i,l,a,o){const p=c("alert"),g=c("custom-loader"),u=c("status-switch"),b=I("tooltip");return n(),r("div",Zt,[h(p,{componentName:"alert-settings"}),a.loading?(n(),M(g,{key:0})):v("",!0),a.alerts?(n(),r("div",ea,[s("div",ta,[s("h3",aa,m(e.trans("alerts")),1)]),s("div",sa,[s("div",na,[s("div",la,[s("table",oa,[s("tbody",null,[(n(!0),r(S,null,$(a.alerts,(d,f)=>(n(),r("tr",ia,[s("td",ra,[h(u,{name:f,value:o.checkAlertIsSet(d.associates),classname:"btn-tool",onChange:o.onChange},null,8,["name","value","onChange"])]),s("td",ca,[s("table",da,[(n(!0),r(S,null,$(d.allowedChannels,_=>(n(),r("tr",null,[s("td",ma,[s("i",{class:V([_.icon,o.checkAlertIsSet(d.associates,_.id)?"active":"inactive"]),style:{"pointer-events":"initial",cursor:"pointer"},onClick:L=>o.toggleChannelForAlert(o.checkAlertIsSet(d.associates,_.id),d.associates,_.id)},null,10,ha)])]))),256))])]),s("td",_a,[C(m(e.trans(d.name))+" ",1),w((n(),r("span",pa,ga)),[[b,e.trans(d.description)]])]),s("td",null,[s("table",fa,[(n(!0),r(S,null,$(d.associates,_=>(n(),r("tr",ba,[s("td",va,[w((n(),r("span",null,[C(m(e.trans(_.name)),1)])),[[b,e.trans(_.description)]])]),(n(!0),r(S,null,$(d.allowedChannels,L=>(n(),r("td",ya,[s("i",{class:V([L.icon,a.setAlerts[_.associate_id].includes(L.id)?"active":"inactive"]),"aria-hidden":"true",onClick:U=>o.toggleChannel(a.setAlerts[_.associate_id].includes(L.id),_.associate_id,L.id),style:{"pointer-events":"initial",cursor:"pointer"}},null,10,wa)]))),256))]))),256))])])]))),256))])])])])]),s("div",Ca,[s("button",{type:"button",id:"submitter",onClick:t[0]||(t[0]=(...d)=>o.submit&&o.submit(...d)),class:"btn btn-primary",disabled:a.isDisabled},[La,C(" "+m(e.trans("submit")),1)],8,ka)])])):v("",!0)])}const $a=D(Yt,[["render",Sa],["__scopeId","data-v-3773fbb8"]]);function Aa(e){const{days_to_delete:t}=e;let i={days_to_delete:[t,"isRequired",{"minValue(1)":N("invalid_input")}]};const l=new E(N),{errors:a,isValid:o}=l.validate(i);return j.dispatch("setValidationError",a),{errors:a,isValid:o}}const Ta={name:"inapp-settings",data(){return{pageLoad:!1,loading:!1,days_to_delete:"",showModal:!1,only_read:!1}},methods:{isValid(){const{errors:e,isValid:t}=Aa(this.$data);return t},onChange(e,t){this[t]=e},onSubmit(){if(this.isValid()){this.pageLoad=!0;const e={};e.days_to_delete=this.days_to_delete,e.only_read=this.only_read,k.delete("/api/clear-notifications",{data:e}).then(t=>{this.pageLoad=!1,A(t,"inapp-settings"),this.days_to_delete="",this.only_read=!1}).catch(t=>{this.pageLoad=!1,T(t,"inapp-settings")})}},triggerEvent(e){var t=e.which||e.keyCode;t===13&&this.onSubmit()}},components:{"number-field":W,checkbox:G}},Ma={class:"col-sm-12"},Da={class:"card card-light"},Ia={class:"card-header"},Va={class:"card-title"},Ua={class:"card-body"},Na={class:"row"},qa={class:"row"},Ea={class:"card-footer"},ja=s("i",{class:"fas fa-trash"},null,-1),Fa={key:0,class:"row"};function Ra(e,t,i,l,a,o){const p=c("alert"),g=c("number-field"),u=c("checkbox"),b=c("custom-loader"),d=I("focus-first-input");return n(),r("div",Ma,[h(p,{componentName:"inapp-settings"}),s("div",Da,[s("div",Ia,[s("h3",Va,m(e.trans("notification_settings")),1)]),s("div",Ua,[w((n(),r("div",Na,[h(g,{label:e.trans("noti_msg1"),value:a.days_to_delete,name:"days_to_delete",onChange:o.onChange,classname:"col-sm-6",keyupListener:o.triggerEvent,type:"number",required:!0,placeholder:"n",hint:e.trans("noti_msg2")},null,8,["label","value","onChange","keyupListener","hint"])])),[[d]]),s("div",qa,[h(u,{id:"delete-read",name:"only_read",value:a.only_read,label:e.trans("delete_noti"),onChange:o.onChange,classname:"col-md-12",hint:e.trans("delete_only_read_tooltip")},null,8,["value","label","onChange","hint"])])]),s("div",Ea,[s("button",{class:"btn btn-danger",onClick:t[0]||(t[0]=f=>o.onSubmit())},[ja,C(" "+m(e.trans("delete")),1)])])]),a.pageLoad?(n(),r("div",Fa,[h(b,{duration:4e3})])):v("",!0)])}const xa=D(Ta,[["render",Ra]]);let Oa={path:"/notify/manage",component:ee,name:"Notify",redirect:"/notify/manage/alerts",children:[{path:"channels",component:fe,name:"TemplateSettings",meta:{title:"channels",crumb:{link:{name:"admin_panel",to:"/"},active:"channels"}}},{path:"channels/:channel/template-sets",component:Qe,name:"TemplateSetList",meta:{identifier:"template_sets",title:"template-sets",crumb:{link:{name:"admin_panel",to:"/"},parent_link:{name:"channels",to:"/notify/manage/channels"},active:":channel"}}},{path:"channels/:channel/template-sets/:id/templates",component:bt,name:"TemplatesList",meta:{identifier:"templates",title:"template-sets",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"channels",to:"/notify/manage/channels"},parent_link:{name:":channel",to:"/notify/manage/channels/:channel/template-sets"},active:"set :id"}}},{path:"channels/:channel/template-sets/:set/templates/:id",component:Xt,name:"TemplateEdit",meta:{identifier:"template_edit",title:"templates",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"channels",to:"/notify/manage/channels"},parent_link:{name:"set :set",to:"/notify/manage/channels/:channel/template-sets/:set/templates"},active:"template :id"}}},{path:"alerts",component:$a,name:"AlertSettings",meta:{title:"alerts-settings",crumb:{link:{name:"admin_panel",to:"/"},active:"alerts-settings"}}},{path:"in-app",component:xa,name:"InAppSettings",meta:{title:"manage-in-app-logs",crumb:{link:{name:"admin_panel",to:"/"},active:"manage-in-app-logs"}}}]};z.addRoute(Oa);z.beforeEach((e,t,i)=>{if(e.meta.identifier!==void 0){let l={template_sets:{link:{name:"admin_panel",to:"/"},parent_link:{name:"channels",to:"/notify/manage/channels"},active:":channel"},templates:{link:{name:"admin_panel",to:"/"},root_link:{name:"channels",to:"/notify/manage/channels"},parent_link:{name:":channel",to:"/notify/manage/channels/:channel/template-sets"},active:"set :id"},template_edit:{link:{name:"admin_panel",to:"/"},root_link:{name:"channels",to:"/notify/manage/channels"},parent_link:{name:"set :set",to:"/notify/manage/channels/:channel/template-sets/:set/templates"},active:"template :id"}};e.meta.crumb=l[e.meta.identifier],Object.keys(e.params).forEach(a=>{Q(":"+a,e.params[a],e.meta)})}i()});function Q(e,t,i){Object.keys(i).forEach(l=>{typeof i[l]=="string"?i[l]=i[l].replace(e,t):typeof i[l]=="object"&&Q(e,t,i[l])})}
