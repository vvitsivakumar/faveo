import{V as ce,l as ae,c as ie,_ as C,k as W,s as U,e as A,j as le,D as G,u as He,v as ve,M as ft,w as gt,b as we,f as pe,n as ht,x as $s,T as tt,g as $e,y as ka,p as oe,z as Ns,q as bt,S as st,B as Ye,E as We,G as je,H as Je,A as ke,C as Ne,a as Re,o as xe,R as Ee,r as Es,N as yt,I as Tt,J as qs,i as ss,m as ge,K as as}from"../chunks/bootstrap.js";import{u as B,m as L,a as S,r as u,q as N,o,c as l,e as m,d as c,n as j,f as a,t as r,i as w,b as v,w as y,g,p as K,j as z,T as q,W as se,F as I,K as Os,h as $,a1 as x,a2 as te,a3 as Ce,a4 as vt,y as Lt,$ as Ca,v as js,V as ze,x as qe,a5 as Da,G as Ue,z as ns,B as mt,a6 as os,a7 as Sa,a0 as Fa,a8 as Ma,a9 as Ia,_ as is,aa as Aa,N as Pa}from"../chunks/vendor.js";import{C as Rs,a as xs,b as Bs,D as Ta}from"../chunks/FormGenerator.js";import{C as Ut,a as Va,b as La,_ as Ks}from"../chunks/SDReports.js";import{r as Ua,a as ls}from"../chunks/clientRouter.js";import{u as Ge,a as Ze,b as $a,D as Na,S as rs,C as Ea,r as qa,A as Be}from"../chunks/agentRouter.js";import{a as _e,d as $t,N as Nt,S as Et,c as De,e as Oa,C as ja}from"../chunks/DataTableActions.js";import{C as zs}from"../chunks/Loader.js";import{A as Hs,a as Ra,T as xa,v as Ba}from"../chunks/TicketsIndex.js";import{T as Ka}from"../chunks/TaskActionButtons.js";import{M as za,_ as Ha,d as Ya,v as Wa,r as Ja,A as de,e as ut,S as _t}from"../chunks/adminRouter.js";import{c as Ga,g as Za,b as Qa}from"../chunks/CurrencySelect.js";import"../chunks/AdminNavigationBar.js";import"../chunks/PermaLink.js";import"../chunks/LoginLogs.js";import"../chunks/BarcodeModal.js";import"../chunks/approvalTicketRules.js";import"../chunks/HelpSection.js";function Xa(e){const{subject:t,identifier:s,from:d,department_id:n,impact_id:i,status_type_id:h,priority_id:_,description:f}=e;var p={subject:[t,"isRequired",{"max(50)":"The subject should be less than 50 characters."}],identifier:[s,{"max(45)":"The identifier should be less than 45 characters."}],from:[d,"isRequired"],department_id:[n,"isRequired"],impact_id:[i,"isRequired"],status_type_id:[h,"isRequired"],priority_id:[_,"isRequired"],description:[f,"isRequired"]};const b=new ce(ae),{errors:k,isValid:D}=b.validate(p);return ie.dispatch("setValidationError",k),{errors:k,isValid:D}}const en={setup(){const e=B();return{getStoredTicketId:L(()=>e.getters.getStoredTicketId)}},props:{box_class:{type:String,default:"card card-light "},title_val:{type:String,default:""},closePopup:{type:Function},alert:{type:String,default:"problem"}},data(){return{title:"create_problem",iconClass:"fas fa-save",btnName:"submit",hasDataPopulated:!1,loading:!1,problem_id:"",subject:"",identifier:"",description:"",from:"",department_id:"",impact_id:"",status_type_id:"",location_id:"",priority_id:"",assigned_id:"",asset_ids:[],attachment:"",deleteUrl:"",apiUrl:"",show_attach_assets:!0,selectedFile:"",attachment_delete:!1}},beforeMount(){const e=window.location.pathname;this.getValues(e)},mounted(){this.getActions()},methods:{getActions(){S.get("/service-desk/get/permissions").then(e=>{this.show_attach_assets=e.data.data.actions.attach_asset}).catch(e=>{})},getValues(e){const t=W(e);e.indexOf("edit")>=0?(this.title="edit_problem",this.iconClass="fas fa-sync-alt",this.btnName="update",this.hasDataPopulated=!1,this.getInitialValues(t)):(this.loading=!1,this.hasDataPopulated=!0,this.subject=this.box_class==="problem_card"?this.title_val:"")},getInitialValues(e){this.loading=!0,S.get("/service-desk/api/problem/"+e).then(t=>{this.loading=!1,this.hasDataPopulated=!0,this.problem_id=t.data.data.id,this.updateStatesWithData(t.data.data),this.asset_ids=t.data.data.assets,this.from=t.data.data.requester_id}).catch(t=>{this.loading=!1})},updateStatesWithData(e){const t=this,s=this.$data;Object.keys(e).map(d=>{s.hasOwnProperty(d)&&(t[d]=e[d])}),this.attachment&&(this.attachment.link="/service-desk/download/"+this.attachment.id+"/sd_problem:"+this.problem_id+"/attachment")},isValid(){const{errors:e,isValid:t}=Xa(this.$data);return!!t},onFileSelected(e,t,s){this.selectedFile=e[0],this.attachment_delete=s},onChange(e,t){this[t]=e,e===null&&(this[t]="")},onSubmit(){if(this.apiUrl=this.box_class==="problem_card"?"/service-desk/api/problem?ticket_id="+this.getStoredTicketId:"/service-desk/api/problem/",this.isValid()){this.loading=!0;var e=new FormData;if(this.problem_id!=""&&e.append("id",this.problem_id),e.append("subject",this.subject),e.append("identifier",this.identifier),e.append("description",this.description),e.append("requester_id",this.from.id),e.append("department_id",this.department_id.id),e.append("impact_id",this.impact_id.id),e.append("status_type_id",this.status_type_id.id),e.append("priority_id",this.priority_id.id),this.asset_ids.length)for(var t in this.asset_ids)e.append("asset_ids["+t+"]",this.asset_ids[t].id);else e.append("asset_ids","");e.append("location_id",this.location_id?this.location_id.id:""),e.append("assigned_id",this.assigned_id?this.assigned_id.id:""),this.selectedFile&&e.append("attachment",this.selectedFile),this.attachment&&!this.attachment_delete&&!this.selectedFile&&e.append("attachment_ids[0]",this.attachment.id),this.attachment_delete&&e.append("attachment_delete",this.attachment_delete);const s={headers:{"Content-Type":"multipart/form-data"}};S.post(this.apiUrl,e,s).then(d=>{this.loading=!1,U(d,this.alert),window.emitter.emit("updateAgentSidebar"),this.problem_id===""&&this.box_class!=="problem_card"?setTimeout(()=>{let n=d.data.data.id;this.$router.push("/service-desk/problem/"+n+"/show")},3e3):this.getInitialValues(this.problem_id),this.box_class==="problem_card"?this.actionMethod():window.scrollTo(0,0)}).catch(d=>{window.scrollTo(0,0),this.loading=!1,A(d,"problem")})}},actionMethod(){this.closePopup(),window.emitter.emit("actionDone","external")}},components:{"text-field":le,"dynamic-select":G,"file-upload":He}},tn={key:0,class:"row"},sn={key:0,class:"card-header"},an={class:"card-title"},nn={key:0,class:"card-tools"},on=a("i",{class:"fas fa-eye"},null,-1),ln={class:"card-body"},rn={class:"row"},dn={class:"row"},cn={class:"row"},un={class:"row"},hn={class:"row"},mn={class:"ml_7"},_n={class:"row"},pn={key:1,class:"card-footer"};function fn(e,t,s,d,n,i){const h=u("custom-loader"),_=u("alert"),f=u("router-link"),p=u("text-field"),b=u("dynamic-select"),k=u("tiny-editor"),D=u("file-upload"),P=N("tooltip"),E=N("focus-first-input");return o(),l("div",{class:j({"col-sm-12":s.box_class!="problem_card"})},[n.hasDataPopulated===!1||n.loading===!0?(o(),l("div",tn,[m(h,{duration:4e3})])):c("",!0),m(_,{componentName:"problem"}),n.hasDataPopulated===!0?(o(),l("div",{key:1,class:j(s.box_class)},[s.box_class!=="problem_card"?(o(),l("div",sn,[a("h3",an,r(e.lang(n.title)),1),n.problem_id!==""?(o(),l("div",nn,[w((o(),v(f,{class:"btn btn-tool",id:"view_problem",to:"/service-desk/problem/"+n.problem_id+"/show"},{default:y(()=>[on]),_:1},8,["to"])),[[P,e.lang("view")]])])):c("",!0)])):c("",!0),a("div",ln,[w((o(),l("div",rn,[m(p,{label:e.lang("subject"),value:n.subject,type:"text",name:"subject",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold"]),m(p,{label:e.lang("identifier"),value:n.identifier,type:"text",name:"identifier",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-6"},null,8,["label","value","onChange","placehold"])])),[[E]]),a("div",dn,[m(b,{label:e.lang("requester"),multiple:!1,name:"from",classname:"col-sm-6",apiEndpoint:"/api/dependency/users?meta=true",value:n.from,onChange:i.onChange,required:!0,strlength:"40"},null,8,["label","value","onChange"]),m(b,{label:e.lang("department"),multiple:!1,name:"department_id",prePopulate:!1,classname:"col-sm-6",apiEndpoint:"/api/dependency/departments",value:n.department_id,onChange:i.onChange,required:!0,strlength:"40"},null,8,["label","value","onChange"])]),a("div",cn,[m(b,{label:e.lang("impact"),multiple:!1,name:"impact_id",strlength:"40",classname:"col-sm-6",apiEndpoint:"/service-desk/api/dependency/impacts",value:n.impact_id,onChange:i.onChange,required:!0},null,8,["label","value","onChange"]),m(b,{label:e.lang("status"),multiple:!1,name:"status_type_id",strlength:40,classname:"col-sm-6",apiEndpoint:"/service-desk/api/status/list?module=1",value:n.status_type_id,onChange:i.onChange,required:!0},null,8,["label","value","onChange"])]),a("div",un,[m(b,{label:e.lang("location"),multiple:!1,name:"location_id",prePopulate:!1,strlength:"40",classname:"col-sm-6",apiEndpoint:"/api/dependency/locations",value:n.location_id,onChange:i.onChange},null,8,["label","value","onChange"]),m(b,{label:e.lang("priority"),multiple:!1,name:"priority_id",strlength:"40",classname:"col-sm-6",apiEndpoint:"/api/dependency/priorities",value:n.priority_id,onChange:i.onChange,required:!0},null,8,["label","value","onChange"])]),a("div",hn,[m(b,{label:e.lang("assigned-to"),multiple:!1,name:"assigned_id",strlength:"40",classname:"col-sm-6",apiEndpoint:"/api/dependency/agents?meta=true",value:n.assigned_id,onChange:i.onChange},null,8,["label","value","onChange"]),n.show_attach_assets?(o(),v(b,{key:0,label:e.lang("attach_assets"),multiple:!0,name:"asset_ids",strlength:"40",classname:"col-sm-6",apiEndpoint:"/service-desk/api/dependency/assets",value:n.asset_ids,onChange:i.onChange},null,8,["label","value","onChange"])):c("",!0)]),a("div",mn,[m(k,{value:n.description,type:"text",onChange:i.onChange,name:"description",label:e.lang("description"),classname:"col-sm-12",required:!0,lang:"en",id:"problem_editor"},null,8,["value","onChange","label"])]),a("div",_n,[m(D,{label:e.lang("attachments"),value:n.attachment,formType:"service_desk",name:"attachment",onChange:i.onFileSelected,classname:"col-sm-6",id:n.problem_id},null,8,["label","value","onChange","id"])])]),s.box_class!=="problem_card"?(o(),l("div",pn,[a("button",{id:"submit_btn",class:"btn btn-primary",onClick:t[0]||(t[0]=M=>i.onSubmit())},[a("i",{class:j(n.iconClass)},null,2),g(" "+r(e.lang(n.btnName)),1)])])):c("",!0)],2)):c("",!0)],2)}const gn=C(en,[["render",fn]]);const bn={name:"problem-modal",description:"Problem Modal component",props:{showModal:{type:Boolean,default:!1},title:{type:String,default:""},onClose:{type:Function},data:{type:[Object,String],required:!0}},data:()=>({isDisabled:!1,containerStyle:{width:"850px"},loading:!1,size:60,classname:"",createLoader:!1,problem:""}),watch:{problem(e,t){return this.isDisabled=!(this.title==="attach_existing_problem"&&e!==""),e}},computed:{titleParsed(){return JSON.parse(this.data).title},ticketId(){return JSON.parse(this.data).id},alertName(){return JSON.parse(this.data).alertName?JSON.parse(this.data).alertName:"problem-modal"}},beforeMount(){this.isDisabled=this.title==="attach_existing_problem"&&this.problem==="",this.title=="attach_new_problem"&&(this.classname="problem_fileds",this.createLoader=!0,setTimeout(()=>{this.createLoader=!1},1e3))},methods:{onSubmit(){this.title==="attach_new_problem"?this.$refs.create_problem.onSubmit():(this.loading=!0,S.post("/service-desk/api/problem-attach-ticket/"+this.ticketId+"/"+this.problem.id).then(e=>{U(e,this.alertName),this.loading=!1,window.emitter.emit("actionDone","external"),this.onClose()}).catch(e=>{A(e,this.alertName),this.loading=!1}))},onChange(e,t){this[t]=e}},components:{problem:gn,"dynamic-select":G}},yn={class:"modal-title"},vn={key:0},wn={key:0,class:"row",id:"load_margin"},kn={key:1},Cn={key:1,class:"row"},Dn={key:2,class:"row"},Sn=["disabled"],Fn=a("i",{class:"fas fa-save"},null,-1);function Mn(e,t,s,d,n,i){const h=u("reuse-loader"),_=u("problem"),f=u("dynamic-select"),p=u("custom-loader"),b=u("modal");return s.showModal?(o(),v(b,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:e.containerStyle,modalBodyClass:e.classname},{title:y(()=>[a("h4",yn,r(e.lang(s.title)),1)]),fields:y(()=>[s.title==="attach_new_problem"?(o(),l("div",vn,[e.createLoader?(o(),l("div",wn,[m(h,{duration:4e3})])):(o(),l("div",kn,[m(_,{box_class:"problem_card",title_val:i.titleParsed,closePopup:s.onClose,ref:"create_problem",alert:"timeline"},null,8,["title_val","closePopup"])]))])):c("",!0),s.title==="attach_existing_problem"?(o(),l("div",Cn,[m(f,{label:e.lang("problems"),multiple:!1,name:"problem",classname:"col-sm-12",apiEndpoint:"/service-desk/api/dependency/problems",value:e.problem,onChange:i.onChange,required:!0},null,8,["label","value","onChange"])])):c("",!0),e.loading===!0?(o(),l("div",Dn,[m(p,{duration:4e3})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=(...k)=>i.onSubmit&&i.onSubmit(...k)),class:"btn btn-primary",disabled:e.isDisabled},[Fn,g(" "+r(e.lang("attach")),1)],8,Sn)]),_:1},8,["showModal","onClose","containerStyle","modalBodyClass"])):c("",!0)}const In=C(bn,[["render",Mn]]);const An={name:"create-problem-modal",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function},data:{type:[Object,String],required:!0}},data(){return{formUniqueKey:"",submitFormInProgress:!1,scenario:"create",panel:"agent",page:"add_ticket_with_form",fetchFormFieldApi:"/api/form/render/",selectedForm:"",formSelected:!1}},mixins:[ve],beforeMount(){this.getDefaultFormValue()},methods:{getDefaultFormValue(){this.showLoader=!0,S.get("/from/forms/problem").then(e=>{this.selectedForm=e.data.data.data[0],this.showLoader=!1,this.updateFetchApi()}).catch(e=>{this.showLoader=!1,A(e,"faveo-form")})},updateFetchApi(){this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey),this.$store.dispatch("unsetValidationError"),this.fetchFormFieldApi="/render/form?id="+this.selectedForm.id+"&mode=render",setTimeout(()=>{this.$store.dispatch("createNewFormInstance",{formUniqueKey:this.formUniqueKey,scenario:this.scenario||this.mode}),this.formSelected=!0},1)},popUpSubmit(){document.getElementById("create-problem-submit").click()},formSubmit(e,t){this.onSubmit()},afterSubmit(e){setTimeout(()=>{window.emitter.emit("AssociatedProblemrefreshData"),window.emitter.emit("closeTimelineActions"),window.emitter.emit("actionDone","external"),this.onClose()},1e3)}},beforeDestroy(){this.$store.dispatch("unsetAlert")},components:{Modal:ft,FormWithCaptcha:gt,FormRenderer:we}},Pn=e=>(K("data-v-634b4926"),e=e(),z(),e),Tn={class:"attach-new-problem"},Vn={key:1,id:"problem_modal_body"},Ln=["disabled"],Un=Pn(()=>a("i",{class:"fas fa-save"},null,-1));function $n(e,t,s,d,n,i){const h=u("custom-loader"),_=u("loader"),f=u("alert"),p=u("FormRenderer"),b=u("ValidationObserver"),k=u("FormWithCaptcha"),D=u("Modal");return o(),l("div",Tn,[n.submitFormInProgress?(o(),v(h,{key:0})):c("",!0),s.showModal?(o(),v(D,{key:1,showModal:s.showModal,onClose:s.onClose},{title:y(()=>[a("h4",null,r(e.trans("attach_new_problem")),1)]),fields:y(()=>[e.showLoader?(o(),v(_,{key:0})):c("",!0),n.formUniqueKey&&n.formSelected?(o(),l("div",Vn,[m(f,{componentName:"faveo-form"}),m(k,{loading:!e.showLoader,btnClass:"btn btn-primary float-right",btnName:"submit",componentName:"faveo-form",btn_id:"create-problem-submit",formSubmit:i.formSubmit,recaptchaContainerClass:"mt-2",disableSubmit:n.submitFormInProgress},{fields:y(()=>[m(b,{ref:"faveoFormObserver"},{default:y(({values:P,errors:E,validate:M})=>[(o(),v(p,{key:n.formUniqueKey,fetchFormFieldApi:n.fetchFormFieldApi,formUniqueKey:n.formUniqueKey,scenario:n.scenario,category:"problem",panel:n.panel},null,8,["fetchFormFieldApi","formUniqueKey","scenario","panel"]))]),_:1},512)]),_:1},8,["loading","formSubmit","disableSubmit"])])):c("",!0)]),controls:y(()=>[e.showLoader?c("",!0):(o(),l("button",{key:0,type:"submit",class:"btn btn-primary pull-right",disabled:n.submitFormInProgress,onClick:t[0]||(t[0]=P=>i.popUpSubmit())},[Un,g("  "+r(e.trans("save")),1)],8,Ln))]),_:1},8,["showModal","onClose"])):c("",!0)])}const Nn=C(An,[["render",$n],["__scopeId","data-v-634b4926"]]);const En={props:{actions:{type:Object,default:()=>{}},data:{type:[Object,String],required:!0}},data(){return{showModal:!1,title:"",showNewProblemModal:!1}},methods:{showModalMethod(e){this.currentModal=e,this.title=e==="attach_new"?"attach_new_problem":"attach_existing_problem",this.showModal=!0},onClose(){this.showModal=!1,this.showNewProblemModal=!1,this.$store.dispatch("unsetValidationError")}},components:{AttachNewProblemModal:Nn,"problem-modal":In}},qt=e=>(K("data-v-67f63678"),e=e(),z(),e),qn={class:"btn-group"},On={type:"button",class:"btn btn-xs btn-default dropdown-toggle","data-toggle":"dropdown"},jn=qt(()=>a("i",{class:"fas fa-bug"},null,-1)),Rn={class:"dropdown-menu"},xn=qt(()=>a("i",{class:"fas fa-bug"},null,-1)),Bn=qt(()=>a("i",{class:"fas fa-bug"},null,-1));function Kn(e,t,s,d,n,i){const h=u("problem-modal"),_=u("AttachNewProblemModal");return o(),l("div",qn,[a("button",On,[jn,g(" "+r(e.lang("problem")),1)]),a("div",Rn,[s.actions.show_attach_new_problem?(o(),l("a",{key:0,class:"dropdown-item",onClick:t[0]||(t[0]=f=>n.showNewProblemModal=!0),id:"attach_new"},[xn,g(" "+r(e.lang("attach_new_problem")),1)])):c("",!0),s.actions.show_attach_existing_problem?(o(),l("a",{key:1,class:"dropdown-item",onClick:t[1]||(t[1]=f=>i.showModalMethod("attach_exists")),id:"attach_exists"},[Bn,g(" "+r(e.lang("attach_existing_problem")),1)])):c("",!0)]),m(q,{name:"modal"},{default:y(()=>[n.showModal?(o(),v(h,{key:0,onClose:i.onClose,showModal:n.showModal,title:n.title,data:s.data},null,8,["onClose","showModal","title","data"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showNewProblemModal?(o(),v(_,{key:0,onClose:i.onClose,showModal:n.showNewProblemModal,data:s.data},null,8,["onClose","showModal","data"])):c("",!0)]),_:1})])}const zn=C(En,[["render",Kn],["__scopeId","data-v-67f63678"]]),Hn={name:"delete-modal",description:"Delete Modal component",setup(){const e=B();return{getStoredTicketId:L(()=>e.getters.getStoredTicketId)}},props:{showModal:{type:Boolean,default:!1},assetId:{type:Number,default:0},onClose:{type:Function},from:{type:String,default:""},problemId:{type:[Number,String],default:""},data:{type:[Object,String],default:""},alert:{type:String,default:""}},data:()=>({isDisabled:!1,containerStyle:{width:"500px"},loading:!1,size:60,lang_locale:"",ticketId:0,apiUrl:""}),computed:{alertName(){return JSON.parse(this.data).alertName?JSON.parse(this.data).alertName:"problem-modal"}},created(){this.lang_locale=localStorage.getItem("LANGUAGE"),this.ticketId=this.getStoredTicketId},methods:{onSubmit(){this.apiUrl=this.from!=="modal"?"/service-desk/api/detach-asset/"+this.ticketId+"/"+this.assetId:"/service-desk/api/problem-detach-ticket/"+this.problemId+"/"+this.ticketId,this.loading=!0,this.isDisabled=!0,S.delete(this.apiUrl).then(e=>{this.from!=="modal"?(this.alert=="timeline"?(U(e,this.alert),window.emitter.emit("AssetListrefreshData")):(U(e,"dataTableModal"),window.emitter.emit("refreshData")),this.onClose()):(U(e,this.alertName),this.actionMethod()),this.loading=!1,this.isDisabled=!0}).catch(e=>{A(e,"dataTableModal"),this.onClose()})},actionMethod(){window.emitter.emit("actionDone","external"),this.onClose()}}},Yn={class:"modal_title"},Wn={key:0},Jn={key:1,class:"row"},Gn=["disabled"],Zn=a("i",{class:"fas fa-unlink","aria-hidden":"true"},null,-1);function Qn(e,t,s,d,n,i){const h=u("reuse-loader"),_=u("modal");return s.showModal?(o(),v(_,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:e.containerStyle},{title:y(()=>[a("h4",Yn,r(e.lang("detach")),1)]),fields:y(()=>[e.loading?c("",!0):(o(),l("div",Wn,[a("span",null,r(e.lang("are_you_sure")),1)])),e.loading?(o(),l("div",Jn,[m(h,{"animation-duration":4e3,color:"#1d78ff",size:e.size},null,8,["size"])])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=f=>i.onSubmit()),class:"btn btn-danger",disabled:e.isDisabled},[Zn,g(" "+r(e.lang("detach")),1)],8,Gn)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const Ys=C(Hn,[["render",Qn]]);const Xn={name:"asset-list-with-checkbox",description:"Assets table component",setup(){const e=B();return{getStoredTicketId:L(()=>e.getters.getStoredTicketId)}},props:{apiUrl:{type:String,default:""},tickets:{type:Function,default:()=>{}},componentTitle:{type:String,default:""},from:{type:String,default:""}},data:()=>({columns:["id","name","used_by","managed_by","contract"],options:{}}),beforeMount(){const e=this;this.options={texts:{filter:"",limit:""},headings:{id:this.trans("id"),name:this.trans("name"),used_by:this.trans("used_by"),managed_by:this.trans("managed_by"),contract:this.trans("contract")},columnsClasses:{id:"asset-check-id",name:"asset-check-name",used_by:"asset-check-used",managed_by:"asset-check-manage",contract:"asset-check-contract"},templates:{used_by(t,s){var d,n;return((n=(d=s.used_by)==null?void 0:d.full_name)==null?void 0:n.replace(/<[^>]+>/g,""))??"--"},managed_by(t,s){var d,n;return((n=(d=s.managed_by)==null?void 0:d.full_name)==null?void 0:n.replace(/<[^>]+>/g,""))??"--"},contract:function(t,s){return s.contract&&!Array.isArray(s.contract)?e.from=="admin"?e.h("a",{href:e.basePath()+"/panel/service-desk/contracts/"+s.contract.id+"/show",style:"color:#007bff !important",target:"_blank"},s.contract.name):e.h(se,{to:"/service-desk/contracts/"+s.contract.id+"/show",style:"color:#007bff !important",target:"_blank"},s.contract.name):"--"}},sortable:["name"],filterable:["name"],pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"name","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.data.map(s=>(s.detach=!0,s)),count:t.data.total}}}}},eo={id:"asset-checkbox"};function to(e,t,s,d,n,i){const h=u("data-table");return o(),l("div",eo,[m(h,{url:s.apiUrl,dataColumns:e.columns,option:e.options,tickets:s.tickets,componentTitle:s.componentTitle,scroll_to:"asset-checkbox"},null,8,["url","dataColumns","option","tickets","componentTitle"])])}const Oe=C(Xn,[["render",to]]);const so={name:"asset-attach-modal",description:"Attach asset Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},data:{type:[Object,String],required:!0},from:{type:String,default:""},alert:{type:String,default:"attach-asset-modal"}},data:()=>({used_by_ids:"",asset_type_ids:"",managed_by_ids:"",org_ids:"",isDisabled:!0,containerStyle:{width:"950px"},loading:!1,size:60,asset_types:[],asset_type:"",apiUrl:"",assetIds:[],selectedFilters:{},componentTitle:"AttachAsset"}),watch:{assetIds(e){this.isDisabled=!(e.length>0)}},computed:{ticketId(){return JSON.parse(this.data).id}},methods:{onChange(e,t){window.emitter.emit(this.componentTitle+"uncheckCheckbox"),this[t]=e||"",this.selectedFilters[t]=e||""},onApply(){let e="/service-desk/api/asset-list?ticket_id="+this.ticketId+"&",t="";for(var s in this.selectedFilters)this.selectedFilters[s].id&&(t+=s+"="+this.selectedFilters[s].id+"&");t[t.length-1]==="&"&&(t=t.slice(0,-1)),this.apiUrl=e+t},assetsData(e){this.assetIds=e},onSubmit(){if(this.assetIds.length>0){this.loading=!0;const e={};e.ticket_id=this.ticketId,e.asset_ids=this.assetIds;const t={headers:{"Content-Type":"application/json"}};S.post("/service-desk/api/ticket-attach-assets",e,t).then(s=>{this.loading=!1,U(s,this.alert),window.emitter.emit("AssetListrefreshData"),this.onClose()}).catch(s=>{this.loading=!1,A(s,"attach-asset-modal")})}}},components:{"asset-list-with-checkbox":Oe,"dynamic-select":G}},ao={class:"modal-title"},no={class:"attach-asset"},oo={class:"row"},io={class:"col-sm-12"},lo=a("span",{class:"fas fa-check"},null,-1),ro=a("br",null,null,-1),co={class:"height-limit"},uo={key:0,class:"row"},ho=["disabled"],mo=a("i",{class:"fas fa-paperclip"},null,-1);function _o(e,t,s,d,n,i){const h=u("alert"),_=u("dynamic-select"),f=u("asset-list-with-checkbox"),p=u("custom-loader"),b=u("modal");return s.showModal?(o(),v(b,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:e.containerStyle},{alert:y(()=>[m(h,{componentName:"attach-asset-modal"})]),title:y(()=>[a("h4",ao,r(e.lang("attach_assets")),1)]),fields:y(()=>[a("div",no,[a("div",oo,[m(_,{label:e.lang("asset_types"),multiple:!1,name:"asset_type_ids",classname:"col-sm-3",apiEndpoint:"/service-desk/api/dependency/asset_types",value:e.asset_type_ids,onChange:i.onChange,clearable:!!e.asset_type_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),m(_,{label:e.lang("used_by"),multiple:!1,name:"used_by_ids",classname:"col-sm-3",apiEndpoint:"api/dependency/users?meta=true",value:e.used_by_ids,onChange:i.onChange,clearable:!!e.used_by_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),m(_,{label:e.lang("managed_by"),multiple:!1,name:"managed_by_ids",classname:"col-sm-3",apiEndpoint:"api/dependency/agents?meta=true",value:e.managed_by_ids,onChange:i.onChange,clearable:!!e.managed_by_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),m(_,{label:e.lang("organizations"),multiple:!1,name:"org_ids",classname:"col-sm-3",apiEndpoint:"api/dependency/organizations",value:e.org_ids,onChange:i.onChange,clearable:!!e.org_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),a("div",io,[a("button",{id:"apply-btn",class:"btn btn-primary round-btn float-left",type:"button",onClick:t[0]||(t[0]=k=>i.onApply())},[lo,g("  "+r(e.lang("apply")),1)])])]),ro,a("div",co,[e.apiUrl?(o(),v(f,{key:0,apiUrl:e.apiUrl,tickets:i.assetsData,componentTitle:e.componentTitle},null,8,["apiUrl","tickets","componentTitle"])):c("",!0)])]),e.loading===!0?(o(),l("div",uo,[m(p,{duration:4e3})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[1]||(t[1]=k=>i.onSubmit()),class:"btn btn-primary",disabled:e.isDisabled},[mo,g(" "+r(e.lang("attach")),1)],8,ho)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const po=C(so,[["render",_o]]);const fo={name:"attach-change-modal",description:"Attach change Modal component",props:{showModal:{type:Boolean,default:!1},title:{type:String,default:""},type:{type:String,default:""},onClose:{type:Function},data:{type:[Object,String],required:!0}},data(){return{isDisabled:!1,containerStyle:{width:"850px"},loading:!1,change:"",createLoader:!1,classname:""}},computed:{ticketId(){return JSON.parse(this.data).id}},beforeMount(){this.isDisabled=this.title==="link_to_an_existing_change"&&!this.change,this.title=="create_a_change_to_this_ticket"&&(this.classname="create-box",this.createLoader=!0,setTimeout(()=>{this.createLoader=!1},1e3))},methods:{onSubmit(){if(this.title==="link_to_an_existing_change"){this.loading=!0;const e={};e.ticket_id=this.ticketId,e.change_id=this.change.id,e.type=this.type,S.post("/service-desk/api/attach-change/ticket",e).then(t=>{U(t,"timeline"),this.onCompleted()}).catch(t=>{A(t,"change-attach-modal"),this.loading=!1})}},onCompleted(){this.loading=!1,window.emitter.emit("AssociatedChangerefreshData"),window.emitter.emit("closeTimelineActions"),window.emitter.emit("actionDone","external"),this.onClose()},onChange(e,t){this[t]=e,this.isDisabled=!e}},components:{"dynamic-select":G}},go={class:"modal-title"},bo={key:0,class:"row"},yo={key:1,class:"row"},vo=["disabled"],wo=a("i",{class:"fas fa-paperclip"},null,-1);function ko(e,t,s,d,n,i){const h=u("alert"),_=u("dynamic-select"),f=u("custom-loader"),p=u("modal");return s.showModal?(o(),v(p,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle,modalBodyClass:n.classname},{title:y(()=>[a("h4",go,r(e.lang(s.title)),1)]),fields:y(()=>[s.title==="link_to_an_existing_change"?(o(),l("div",bo,[m(_,{label:e.lang("changes"),multiple:!1,name:"change",classname:"col-sm-12",apiEndpoint:"/service-desk/api/dependency/changes_based_on_ticket?meta=true&ticket_id="+i.ticketId,value:n.change,onChange:i.onChange,required:!0,clearable:!!n.change},null,8,["label","apiEndpoint","value","onChange","clearable"])])):c("",!0),n.loading?(o(),l("div",yo,[m(f,{duration:4e3})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=(...b)=>i.onSubmit&&i.onSubmit(...b)),class:"btn btn-primary",disabled:n.isDisabled},[wo,g(" "+r(e.lang("attach")),1)],8,vo)]),default:y(()=>[m(h,{componentName:"change-attach-modal"})]),_:1},8,["showModal","onClose","containerStyle","modalBodyClass"])):c("",!0)}const Co=C(fo,[["render",ko]]);const Do={name:"create-change-modal",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function},data:{type:[Object,String],required:!0}},data(){return{formUniqueKey:"",submitFormInProgress:!1,scenario:"create",panel:"agent",page:"add_ticket_with_form",fetchFormFieldApi:"/api/form/render/",selectedForm:"",formSelected:!1}},mixins:[ve],beforeMount(){this.getDefaultFormValue()},methods:{getDefaultFormValue(){this.showLoader=!0,S.get("/from/forms/changes").then(e=>{this.selectedForm=e.data.data.data[0],this.showLoader=!1,this.updateFetchApi()}).catch(e=>{this.showLoader=!1,A(e,"faveo-form")})},updateFetchApi(){this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey),this.$store.dispatch("unsetValidationError"),this.fetchFormFieldApi="/render/form?id="+this.selectedForm.id+"&mode=render",setTimeout(()=>{this.$store.dispatch("createNewFormInstance",{formUniqueKey:this.formUniqueKey,scenario:this.scenario||this.mode}),this.formSelected=!0},1)},popUpSubmit(){document.getElementById("create-change-submit").click()},formSubmit(e,t){this.onSubmit()},afterSubmit(e){setTimeout(()=>{window.emitter.emit("AssociatedChangerefreshData"),window.emitter.emit("closeTimelineActions"),window.emitter.emit("actionDone","external"),this.onClose()},1e3)}},beforeDestroy(){this.$store.dispatch("unsetAlert")},components:{FormWithCaptcha:gt,FormRenderer:we}},So=e=>(K("data-v-8f30e189"),e=e(),z(),e),Fo={class:"attach-new-change"},Mo={key:1,id:"change_modal_body"},Io=["disabled"],Ao=So(()=>a("i",{class:"fas fa-save"},null,-1));function Po(e,t,s,d,n,i){const h=u("custom-loader"),_=u("loader"),f=u("alert"),p=u("FormRenderer"),b=u("ValidationObserver"),k=u("FormWithCaptcha"),D=u("modal");return o(),l("div",Fo,[n.submitFormInProgress?(o(),v(h,{key:0})):c("",!0),s.showModal?(o(),v(D,{key:1,showModal:s.showModal,onClose:s.onClose},{title:y(()=>[a("h4",null,r(e.trans("create_a_change_to_this_ticket")),1)]),fields:y(()=>[e.showLoader?(o(),v(_,{key:0})):c("",!0),n.formUniqueKey&&n.formSelected?(o(),l("div",Mo,[m(f,{componentName:"faveo-form"}),m(k,{loading:!e.showLoader,btnClass:"btn btn-primary float-right",btnName:"submit",componentName:"faveo-form",btn_id:"create-change-submit",formSubmit:i.formSubmit,recaptchaContainerClass:"mt-2",disableSubmit:n.submitFormInProgress},{fields:y(()=>[m(b,{ref:"faveoFormObserver"},{default:y(({values:P,errors:E,validate:M})=>[(o(),v(p,{key:n.formUniqueKey,fetchFormFieldApi:n.fetchFormFieldApi,formUniqueKey:n.formUniqueKey,scenario:n.scenario,category:"changes",panel:n.panel},null,8,["fetchFormFieldApi","formUniqueKey","scenario","panel"]))]),_:1},512)]),_:1},8,["loading","formSubmit","disableSubmit"])])):c("",!0)]),controls:y(()=>[e.showLoader?c("",!0):(o(),l("button",{key:0,type:"submit",class:"btn btn-primary pull-right",disabled:n.submitFormInProgress,onClick:t[0]||(t[0]=P=>i.popUpSubmit())},[Ao,g("  "+r(e.trans("save")),1)],8,Io))]),_:1},8,["showModal","onClose"])):c("",!0)])}const To=C(Do,[["render",Po],["__scopeId","data-v-8f30e189"]]);const Vo={props:{actions:{type:Object,default:()=>{}},data:{type:[Object,String],required:!0}},data(){return{showModal:!1,showNewChangeModal:!1,title:"",type:""}},methods:{showModalMethod(e){this.currentModal=e,this.title=e==="attach_new"?"create_a_change_to_this_ticket":"link_to_an_existing_change",this.type=e==="attach_initiating"?"initiating":"initiated",this.showModal=!0},onClose(){this.showModal=!1,this.showNewChangeModal=!1,this.$store.dispatch("unsetValidationError")}},components:{"change-attach-modal":Co,"change-new-modal":To}},wt=e=>(K("data-v-7fdab575"),e=e(),z(),e),Lo={class:"btn-group"},Uo={type:"button",class:"btn btn-xs btn-default dropdown-toggle change-btn","data-toggle":"dropdown"},$o=wt(()=>a("i",{class:"fas fa-sync-alt"},null,-1)),No={class:"dropdown-menu dropdown-menu-right"},Eo={class:"dropdown-item dropdown-header"},qo={class:"ml-15"},Oo=wt(()=>a("i",{class:"far fa-circle"},null,-1)),jo={class:"ml-15"},Ro=wt(()=>a("i",{class:"far fa-circle"},null,-1)),xo=wt(()=>a("i",{class:"fas fa-sync-alt"},null,-1));function Bo(e,t,s,d,n,i){const h=u("change-attach-modal"),_=u("change-new-modal");return o(),l("div",Lo,[a("button",Uo,[$o,g(" "+r(e.lang("attach_change")),1)]),a("div",No,[s.actions.attach_change_initiated?(o(),l(I,{key:0},[a("span",Eo,r(e.lang("change_initiated_by_this_ticket")),1),a("a",{class:"dropdown-item",onClick:t[0]||(t[0]=f=>n.showNewChangeModal=!0),id:"attach_new",href:"javascript:;"},[a("span",qo,[Oo,g(" "+r(e.lang("new_change")),1)])]),a("a",{class:"dropdown-item",onClick:t[1]||(t[1]=f=>i.showModalMethod("attach_exists")),id:"attach_exists",href:"javascript:;"},[a("span",jo,[Ro,g(" "+r(e.lang("existing_change")),1)])])],64)):c("",!0),s.actions.attach_change_initiating?(o(),l("a",{key:1,class:"dropdown-item",onClick:t[2]||(t[2]=f=>i.showModalMethod("attach_initiating")),href:"javascript:;",id:"attach_initiating"},[xo,g(" "+r(e.lang("change_initiating_this_ticket")),1)])):c("",!0)]),m(q,{name:"modal"},{default:y(()=>[n.showModal?(o(),v(h,{key:0,onClose:i.onClose,showModal:n.showModal,title:n.title,data:s.data,type:n.type},null,8,["onClose","showModal","title","data","type"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showNewChangeModal?(o(),v(_,{key:0,onClose:i.onClose,showModal:n.showNewChangeModal,data:s.data},null,8,["onClose","showModal","data"])):c("",!0)]),_:1})])}const Ko=C(Vo,[["render",Bo],["__scopeId","data-v-7fdab575"]]);const zo={name:"sd-ticket-actions",description:"Contains ticket actions on timline page, specific to Service Desk",setup(){const e=B();return{ticketActions:L(()=>e.getters.getTicketActions)}},props:{data:{type:[String,Object],required:!0}},data(){return{showModal:!1,modals:["attach_asset","detach_modal"],currentModal:""}},watch:{currentModal(e,t){return e}},computed:{currentModalComponent(){return this.currentModal==="attach_asset"?"attach-asset-modal":this.currentModal==="detach_modal"?"detach-modal":""},problemId(){if(JSON.parse(this.data).associated_problem)return JSON.parse(this.data).associated_problem.id},showProblem(){return this.ticketActions.show_attach_new_problem||this.ticketActions.show_attach_existing_problem},associateChange(){return this.ticketActions.attach_change_initiated||this.ticketActions.attach_change_initiating}},methods:{modalMethod(e){this.showModal=!0,this.currentModal=e},onClose(){this.showModal=!1,this.$store.dispatch("unsetValidationError")}},components:{"attach-problem":zn,"detach-modal":Ys,"attach-asset-modal":po,"attach-change":Ko}},Ho={id:"sd-ticket-actions"},Yo=a("i",{class:"fas fa-server"},null,-1),Wo=a("i",{class:"fas fa-unlink"},null,-1);function Jo(e,t,s,d,n,i){const h=u("attach-problem"),_=u("attach-change");return o(),l("div",Ho,[d.ticketActions.show_attach_assets?(o(),l("button",{key:0,id:"attach-assets",onClick:t[0]||(t[0]=f=>i.modalMethod("attach_asset")),class:"btn btn-xs btn-default"},[Yo,g(" "+r(e.lang("attach_assets")),1)])):c("",!0),i.showProblem?(o(),v(h,{key:1,data:s.data,actions:d.ticketActions},null,8,["data","actions"])):c("",!0),d.ticketActions.show_detach_problem?(o(),l("button",{key:2,id:"detach-problem",onClick:t[1]||(t[1]=f=>i.modalMethod("detach_modal")),class:"btn btn-xs btn-default"},[Wo,g(" "+r(e.lang("detach_problem")),1)])):c("",!0),i.associateChange?(o(),v(_,{key:3,data:s.data,actions:d.ticketActions},null,8,["data","actions"])):c("",!0),m(q,{name:"modal"},{default:y(()=>[n.showModal?(o(),v(Os(i.currentModalComponent),{key:0,onClose:i.onClose,showModal:n.showModal,from:"modal",problemId:i.problemId,data:s.data,alert:"timeline"},null,40,["onClose","showModal","problemId","data"])):c("",!0)]),_:1})])}const Go=C(zo,[["render",Jo]]);const Zo={name:"sdesk-data-table-action",description:"Contains detach button which can be used as a component as whole. It is built basically for displaying deatch button in a datable.",props:{data:{type:Object,required:!0}},data(){return{showModal:!1,disabled:""}},created(){this.alertName=this.data.alertName?this.data.alertName:"",this.disabled=pe(this.data.is_default)},watch:{data(e,t){return this.disabled=pe(e.is_default),e}},methods:{onClose(){this.showModal=!1,this.$store.dispatch("unsetValidationError")}},components:{"detach-modal":Ys}},Qo={class:"btn-group"},Xo=["title","disabled"],ei=a("i",{class:"fa fa-unlink"},null,-1),ti=[ei];function si(e,t,s,d,n,i){const h=u("detach-modal");return o(),l("div",Qo,[s.data.detach?(o(),l("a",{key:0,id:"detach-button",onClick:t[0]||(t[0]=()=>n.showModal=!0),href:"javascript:;"},[a("span",{title:e.trans("detach"),class:"btn btn-primary",id:"detach_btn",disabled:n.disabled},ti,8,Xo)])):c("",!0),m(q,{name:"modal"},{default:y(()=>[n.showModal?(o(),v(h,{key:0,onClose:i.onClose,showModal:n.showModal,assetId:s.data.id,alert:e.alertName},null,8,["onClose","showModal","assetId","alert"])):c("",!0)]),_:1})])}const ai=C(Zo,[["render",si]]),ni={name:"asset-name",description:"Asset name component.",props:{data:{type:Object,required:!0},archive:{type:Boolean,default:!1}},data(){return{url:"/service-desk/assets/"+this.data.id+"/show"}},methods:{archiveAsset(e){return this.basePath()+"/panel/service-desk/assets/"+e+"/show"}}},oi={key:1},ii=["href"];function li(e,t,s,d,n,i){const h=u("router-link"),_=N("tooltip");return s.archive?(o(),l("div",oi,[a("a",{href:i.archiveAsset(this.data.id),target:"_blank"},r(s.data.name),9,ii)])):(o(),v(h,{key:0,id:"asset-name",to:n.url,target:"_blank"},{default:y(()=>[w((o(),l("span",null,[g(r(s.data.name),1)])),[[_,s.data.name]])]),_:1},8,["to"]))}const ri=C(ni,[["render",li]]);const di={name:"associated-assets",description:"Associated Assets table component",setup(){const e=B();return{getStoredTicketId:L(()=>e.getters.getStoredTicketId)}},props:{data:{type:[Object,String],default:()=>{}},alertName:{type:String,default:""},disableLoader:{type:Boolean,default:!1},archive:{type:Boolean,default:!1}},data:()=>({base:window.axios.defaults.baseURL,columns:[],options:{},apiUrl:""}),watch:{getStoredTicketId(e,t){this.apiUrl="/service-desk/api/asset-list?ticket_ids="+e}},beforeMount(){const e=this,t=JSON.parse(this.data);if(t.from){let s="/service-desk/api/asset-list",d=t.from==="user"?"used_by_ids="+t.user_id:"org_ids="+t.org_id;this.apiUrl=s+"?"+d}else this.apiUrl="/service-desk/api/asset-list?ticket_ids="+this.getStoredTicketId+"&isArchive="+ht(this.$route.path);this.columns=JSON.parse(this.data).show_detach_asset?["name","managed_by","used_by","contract","action"]:["name","managed_by","used_by","contract"],this.options={texts:{filter:"",limit:""},headings:{name:this.lang("name"),managed_by:this.lang("managed_by"),used_by:this.lang("used_by"),contract:this.lang("contract"),action:this.lang("action")},columnsClasses:{name:"asset-name",managed_by:"asset-manage",used_by:"asset-used",contract:"asset-contract",action:"asset-action"},templates:{name:(s,d)=>e.h(ri,{data:d,archive:e.archive}),managed_by(s,d){var n,i;return((i=(n=d.managed_by)==null?void 0:n.full_name)==null?void 0:i.replace(/<[^>]+>/g,""))??"--"},used_by(s,d){var n,i;return((i=(n=d.used_by)==null?void 0:n.full_name)==null?void 0:i.replace(/<[^>]+>/g,""))??"--"},contract:function(s,d){return d.contract&&!Array.isArray(d.contract)?e.archive?e.h("a",{href:e.basePath()+"/panel/service-desk/contracts/"+d.contract.id+"/show",target:"_blank"},d.contract.name):e.h(se,{to:"/service-desk/contracts/"+d.contract.id+"/show",target:"_blank"},d.contract.name):"--"},action:(s,d)=>e.h(ai,{data:d})},sortable:["name"],filterable:["name"],pagination:{chunk:5,nav:"scroll"},requestAdapter(s){return{"sort-field":s.orderBy?s.orderBy:"name","sort-order":s.ascending?"desc":"asc","search-query":s.query.trim(),page:s.page,limit:s.limit}},responseAdapter({data:s}){return{data:s.data.data.map(d=>(d.detach=!0,d.alertName=e.alertName,d)),count:s.data.total}}}},methods:{handelLoader(e){this.$emit("assetLoaderValue",e)}}},ci={class:"asset-list"};function ui(e,t,s,d,n,i){const h=u("data-table");return o(),l("div",ci,[m(h,{url:e.apiUrl,dataColumns:e.columns,onLoaderState:i.handelLoader,disableLoader:s.disableLoader,option:e.options,scroll_to:"associated-asset-list",componentTitle:"AssetList"},null,8,["url","dataColumns","onLoaderState","disableLoader","option"])])}const hi=C(di,[["render",ui]]);const mi={name:"associated_assets",description:"Associated assets data table page",props:{data:{type:[String,Object]},from:{type:String,default:""},alert:{type:String,default:""},disableLoader:{type:Boolean,default:!1},archive:{type:Boolean,default:!1}},data(){return{currentComponent:"associated_assets",loading:!1}},methods:{handelLoader(e){this.$emit("loaderValue",e)}},components:{"associated-assets":hi}},_i={id:"associated-asset-list"},pi={key:0,class:"card-header"},fi={class:"card-title"};function gi(e,t,s,d,n,i){const h=u("alert"),_=u("associated-assets");return o(),l("div",_i,[m(h,{componentName:"dataTableModal"}),a("div",{class:j([{"card card-light ":!s.from}])},[s.from!="tab"?(o(),l("div",pi,[a("h3",fi,r(e.lang("associated_assets")),1)])):c("",!0),a("div",{class:j([{"card-body":!s.from}])},[n.loading?c("",!0):(o(),v(_,{key:0,data:s.data,disableLoader:s.disableLoader,archive:s.archive,onAssetLoaderValue:i.handelLoader,alertName:s.alert},null,8,["data","disableLoader","archive","onAssetLoaderValue","alertName"]))],2)],2)])}const bi=C(mi,[["render",gi],["__scopeId","data-v-153f7415"]]),yi={name:"contract-name",description:"Contract name component.",props:{data:{type:Object,required:!0},archive:{type:Boolean,default:!1}},data(){return{url:"/service-desk/contracts/"+this.data.id+"/show"}},methods:{archiveContract(e){return this.basePath()+"/panel/service-desk/contracts/"+e+"/show"}}},vi={key:1},wi=["href"];function ki(e,t,s,d,n,i){const h=u("router-link");return s.archive?(o(),l("div",vi,[a("a",{href:i.archiveContract(this.data.id),target:"_blank"},r(s.data.name),9,wi)])):(o(),v(h,{key:0,id:"contract-name",to:n.url,target:"_blank"},{default:y(()=>[g(r(s.data.name),1)]),_:1},8,["to"]))}const ds=C(yi,[["render",ki]]);const Ci={name:"associated_contracts",description:"Associated contracts data table page",setup(){const e=B();return{getStoredTicketId:L(()=>e.getters.getStoredTicketId),formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},props:{data:{type:[String,Object],default:""},from:{type:String,default:""},disableLoader:{type:Boolean,default:!1},archive:{type:Boolean,default:!1}},data(){return{currentComponent:"associated_contracts",loading:!1,apiUrl:null,columns:null,options:null}},watch:{getStoredTicketId(e,t){this.apiUrl="/service-desk/api/contract/ticket/"+e}},beforeMount(){const e=JSON.parse(this.data);e&&e.from==="org"?this.apiUrl="/service-desk/contract/organization/"+e.org_id:e&&e.from==="user"?this.apiUrl="/service-desk/api/contract-list?user_ids="+e.user_id:this.apiUrl="/service-desk/api/contract/ticket/"+this.getStoredTicketId+"?isArchive="+ht(this.$route.path);const t=this;this.columns=["name","cost","contract_start_date","contract_end_date"],this.options={texts:{filter:"",limit:""},headings:{name:this.trans("name"),cost:this.trans("cost"),contract_start_date:this.trans("contract_start_date"),contract_end_date:this.trans("contract_end_date")},columnsClasses:{name:"contract-name",cost:"contract-cost",contract_start_date:"contract-start",contract_end_date:"contract-end"},templates:{name:(s,d)=>t.h(ds,{data:d,archive:t.archive}),contract_start_date:function(s,d){return t.formattedTime(d.contract_start_date)},contract_end_date:function(s,d){return t.formattedTime(d.contract_end_date)}},sortable:["name","cost","contract_start_date","contract_end_date"],pagination:{chunk:5,nav:"scroll"},requestAdapter(s){return{"sort-field":s.orderBy?s.orderBy:"name","sort-order":s.ascending?"desc":"asc","search-query":s.query.trim(),page:s.page,limit:s.limit}},responseAdapter({data:s}){return{data:e.from=="user"?s.data.contracts:s.data.data,count:s.data.total}}}},methods:{handelLoader(e){this.$emit("loaderValue",e)}},components:{"contract-name":ds}},Di={id:"associated-contracts"},Si={key:0,class:"card-header"},Fi={class:"card-title"};function Mi(e,t,s,d,n,i){const h=u("data-table");return o(),l("div",Di,[a("div",{class:j([{"card card-light":!s.from}])},[s.from!="tab"?(o(),l("div",Si,[a("h3",Fi,r(e.lang("associated_contracts")),1)])):c("",!0),a("div",{class:j([[{"card-body":!s.from}],"my_contracts"])},[m(h,{url:n.apiUrl,dataColumns:n.columns,onLoaderState:i.handelLoader,disableLoader:s.disableLoader,option:n.options,scroll_to:"associated-contracts"},null,8,["url","dataColumns","onLoaderState","disableLoader","option"])],2)],2)])}const Ii=C(Ci,[["render",Mi]]),Ai={name:"detach-change-modal",description:"Detach Change Modal component",props:{showModal:{type:Boolean,default:!1},changeId:{type:[String,Number],default:""},ticketId:{type:[String,Number],default:""},type:{type:String,default:""},onClose:{type:Function},alert:{type:String,default:"AssociatedChange"}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1}},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,S.delete("/service-desk/api/detach-change/ticket",{params:{ticket_id:this.ticketId,change_id:this.changeId,type:this.type}}).then(e=>{U(e,this.alert),window.emitter.emit("AssociatedChangerefreshData"),window.emitter.emit("closeTimelineActions"),window.emitter.emit("actionDone","external"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(e=>{this.loading=!1,this.isDisabled=!1,A(e,this.alert)})}}},Pi={class:"modal-title"},Ti={key:0},Vi={key:1,class:"row"},Li=["disabled"],Ui=a("i",{class:"fa fa-unlink"},null,-1);function $i(e,t,s,d,n,i){const h=u("reuse-loader"),_=u("modal");return s.showModal?(o(),v(_,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{title:y(()=>[a("h4",Pi,r(e.lang("detach")),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",Ti,[a("span",null,r(e.lang("are_you_sure")),1)])),n.loading?(o(),l("div",Vi,[m(h,{"animation-duration":4e3,color:"#1d78ff",size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=f=>i.onSubmit()),class:"btn btn-danger",disabled:n.isDisabled},[Ui,g(" "+r(e.lang("detach")),1)],8,Li)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const Ni=C(Ai,[["render",$i]]);const Ei={name:"associated_contracts",description:"Associated contracts data table page",setup(){const e=B();return{getStoredTicketId:L(()=>e.getters.getStoredTicketId)}},props:{data:{type:[String,Object]},from:{type:String,default:""},disableLoader:{type:Boolean,default:!1},archive:{type:Boolean,default:!1}},data(){return{currentComponent:"associated_changes",loading:!1,apiUrl:"",columns:["change_number","subject","type"],options:null,changeId:"",change_type:"",showModal:!1}},watch:{getStoredTicketId(e,t){this.apiUrl="/service-desk/api/attached-change/ticket?ticket_id="+e}},beforeMount(){const e=this;this.apiUrl="/service-desk/api/attached-change/ticket?ticket_id="+this.getStoredTicketId+"&isArchive="+ht(this.$route.path),ht(this.$route.path)||this.columns.push("action"),this.options={texts:{filter:"",limit:""},headings:{change_number:this.lang("change_number"),subject:this.lang("subject"),type:this.lang("type"),action:this.lang("action")},columnsClasses:{change_number:"changes-number",subject:"changes-subject",type:"changes-created",action:"changes-action"},sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},templates:{subject(t,s){return e.archive?e.h("a",{href:e.basePath()+"/panel/service-desk/changes/"+s.id+"/show",target:"_blank"},s.subject):e.h(se,{to:"/service-desk/changes/"+s.id+"/show",target:"_blank"},s.subject)},action(t,s){var d=JSON.parse(e.data);let n=e.h("i",{class:"fa fa-unlink"});return e.h("a",{class:"btn btn-primary",title:this.trans("detach"),disabled:!d.detach_change,href:"javascript:;",onClick:function(){e.onDetach(s.id,s.type,d.detach_change)}},[n])}},sortable:["subject","created_at"],filterable:["subject","created_at"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc",search_query:t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.changes,count:t.data.total}}}},methods:{onDetach(e,t,s){s&&(this.changeId=e,this.change_type=t,this.showModal=!0)},onClose(){this.showModal=!1},handelLoader(e){this.$emit("loaderValue",e)}},components:{"change-detach-modal":Ni}},qi={id:"associated-changes"},Oi={key:0,class:"card-header"},ji={class:"card-title"};function Ri(e,t,s,d,n,i){const h=u("alert"),_=u("data-table"),f=u("change-detach-modal");return o(),l("div",qi,[m(h,{componentName:"AssociatedChange"}),a("div",{class:j([{"card card-light":!s.from}])},[s.from!="tab"?(o(),l("div",Oi,[a("h3",ji,r(e.lang("associated_changes")),1)])):c("",!0),a("div",{class:j([[{"card-body":!s.from}],"changes-list"])},[m(_,{url:n.apiUrl,dataColumns:n.columns,onLoaderState:i.handelLoader,disableLoader:s.disableLoader,option:n.options,componentTitle:"AssociatedChange",scroll_to:"associated-changes"},null,8,["url","dataColumns","onLoaderState","disableLoader","option"])],2)],2),m(q,{name:"modal"},{default:y(()=>[n.showModal?(o(),v(f,{key:0,onClose:i.onClose,showModal:n.showModal,ticketId:d.getStoredTicketId,changeId:n.changeId,type:n.change_type,alert:"timeline"},null,8,["onClose","showModal","ticketId","changeId","type"])):c("",!0)]),_:1})])}const xi=C(Ei,[["render",Ri]]),Bi={name:"license-name",description:"License name component.",props:{data:{type:Object,required:!0},archive:{type:Boolean,default:!1}},data(){return{url:"/service-desk/software/license/"+this.data.id+"/show"}},methods:{archiveLicense(e){return this.basePath()+"/panel/service-desk/software/license/"+e+"/show"}}},Ki={key:1},zi=["href"];function Hi(e,t,s,d,n,i){const h=u("router-link");return s.archive?(o(),l("div",Ki,[a("a",{href:i.archiveLicense(this.data.id),target:"_blank"},r(s.data.name),9,zi)])):(o(),v(h,{key:0,id:"license-name",to:n.url,target:"_blank"},{default:y(()=>[g(r(s.data.name),1)]),_:1},8,["to"]))}const pt=C(Bi,[["render",Hi]]),Yi={name:"AssociatedLicenseList",description:"Associated contracts data table page",setup(){const e=B();return{formattedDate:L(()=>e.getters.formattedDate),formattedTime:L(()=>e.getters.formattedTime)}},props:{data:{type:[String,Object,Number],default:""},from:{type:String,default:""},disableLoader:{type:Boolean,default:!1},archive:{type:Boolean,default:!1}},data(){return{currentComponent:"associated_license",apiUrl:null,columns:null,options:null}},beforeMount(){const e=JSON.parse(this.data);this.apiUrl="/service-desk/api/software-license-list?used_by_ids="+e.user_id;const t=this;this.columns=["name","license_key","purchase_order_number","licensed_to_email","version","purchase_date","renewal_date","expiration_date"],this.options={texts:{filter:"",limit:""},headings:{name:this.trans("name"),license_key:this.trans("license_key"),purchase_order_number:this.trans("purchase_order_number"),licensed_to_email:this.trans("licensed_to_email"),version:this.trans("version"),purchase_date:this.trans("purchase_date"),renewal_date:this.trans("renewal_date"),expiration_date:this.trans("expiration_date")},columnsClasses:{name:"license-name",license_key:"license-key",purchase_order_number:"license-purchase-order",licensed_to_email:"licensed-email",version:"license-version",purchase_date:"license-purchase-date",renewal_date:"license-renewal-date",expiration_date:"license-expiration-date"},templates:{name:(s,d)=>t.h(pt,{data:d,archive:t.archive}),license_key:(s,d)=>d.license_key?d.license_key:"--",purchase_order_number:(s,d)=>d.purchase_order_number?d.purchase_order_number:"--",licensed_to_email:(s,d)=>d.licensed_to_email?d.licensed_to_email:"--",version:(s,d)=>d.version?d.version:"--",purchase_date:function(s,d){return t.formattedTime(d.purchase_date)},renewal_date:function(s,d){return t.formattedTime(d.renewal_date)},expiration_date:function(s,d){return t.formattedTime(d.expiration_date)}},filterable:["name"],sortable:["name","license_key","purchase_order_number","licensed_to_email","version","purchase_date","renewal_date","expiration_date"],pagination:{chunk:5,nav:"scroll"},requestAdapter(s){return{"sort-field":s.orderBy?s.orderBy:"name","sort-order":s.ascending?"desc":"asc","search-query":s.query.trim(),page:s.page,limit:s.limit}},responseAdapter({data:s}){return{data:s.data.data,count:s.data.total}}}},methods:{handelLoader(e){this.$emit("loaderValue",e)}},components:{"license-name":pt}},Wi={id:"associated-license"};function Ji(e,t,s,d,n,i){const h=u("data-table");return o(),l("div",Wi,[m(h,{url:n.apiUrl,dataColumns:n.columns,onLoaderState:i.handelLoader,disableLoader:s.disableLoader,option:n.options,scroll_to:"associated-license"},null,8,["url","dataColumns","onLoaderState","disableLoader","option"])])}const Gi=C(Yi,[["render",Ji]]);const Zi={name:"ticket-associated-list",description:"Tickets Assocites List",props:{data:{type:[String,Object]}},data(){return{tabs:[{id:"assets",title:"associated_assets"},{id:"changes",title:"associated_changes"},{id:"contracts",title:"associated_contracts"}],category:"assets",alertName:"",loading:!0,cardOpen:!1,loaderState:"",archive:!1}},beforeMount(){this.loaderState=JSON.parse(this.data).disableLoader,this.archive=JSON.parse(this.data).archive,JSON.parse(this.data).from==="org"?(this.tabs=[{id:"assets",title:"associated_assets"},{id:"contracts",title:"associated_contracts"}],this.alertName=""):JSON.parse(this.data).from==="user"?(this.tabs=[{id:"assets",title:"associated_assets"},{id:"contracts",title:"associated_contracts"},{id:"license",title:"associated_license"}],this.alertName=""):this.alertName="timeline"},created(){window.emitter.on("TicketChanged",this.associateMethod)},computed:{currentComponent(){let e=this.category,t;switch(e){case"assets":t="associated-asset-list";break;case"changes":t="associated-changes";break;case"contracts":t="associated-contracts";break;case"license":t="associated-license-list";break}return t},componentData(){return this.data}},methods:{toggleCard(){this.cardOpen=!this.cardOpen},associateMethod(){this.category="assets",this.loading=!0,setTimeout(()=>{this.associates(this.category)},3e3)},refreshAssociates(){this.category="assets",window.emitter.emit("AssetListrefreshData")},associates(e){this.category!==e&&(this.loading=!0,this.category=e)},handelLoader(e){this.loading=e}},components:{"associated-asset-list":bi,"associated-contracts":Ii,"associated-changes":xi,"associated-license-list":Gi}},Qi=e=>(K("data-v-3bb7fd97"),e=e(),z(),e),Xi={class:"card card-light"},el={class:"card-title"},tl={class:"card-tools"},sl={type:"button",class:"btn btn-tool"},al={key:0,class:"card-body",id:"associated_tasks"},nl={id:"ticket-associated-list",class:"card card-light card-tabs"},ol={class:"card-header p-0 pt-1"},il={class:"nav nav-tabs",role:"tablist"},ll={class:"nav-item"},rl=["onClick"],dl={class:"nav-item ml-auto mt-04"},cl=Qi(()=>a("i",{class:"fas fa-sync-alt"},null,-1)),ul=[cl],hl={class:"card-body"},ml={class:"tab-content"},_l={class:"active tab-pane",role:"tabpanel"};function pl(e,t,s,d,n,i){const h=N("tooltip");return o(),l("div",Xi,[a("div",{class:"card-header pointer",onClick:t[0]||(t[0]=(..._)=>i.toggleCard&&i.toggleCard(..._))},[a("h3",el,r(e.lang("sd_associates")),1),a("div",tl,[a("button",sl,[a("i",{class:j([{"fas fa-angle-up":n.cardOpen,"fas fa-angle-down":!n.cardOpen},"fs-25"])},null,2)])])]),n.cardOpen?(o(),l("div",al,[a("div",nl,[a("div",ol,[a("ul",il,[(o(!0),l(I,null,$(n.tabs,_=>(o(),l("li",ll,[a("a",{class:j(["nav-link",{active:n.category===_.id}]),"data-toggle":"pill",role:"tab",href:"javascript:;",onClick:f=>i.associates(_.id)},r(e.lang(_.title)),11,rl)]))),256)),a("li",dl,[w((o(),l("a",{class:j(["btn-tool",n.loading?"rotating":""]),onClick:t[1]||(t[1]=(..._)=>i.refreshAssociates&&i.refreshAssociates(..._)),href:"javascript:;"},ul,2)),[[h,e.lang("refresh")]])])])]),a("div",hl,[a("div",ml,[a("div",_l,[(o(),v(Os(i.currentComponent),{data:i.componentData,from:"tab",alert:n.alertName,onLoaderValue:i.handelLoader,archive:n.archive,disableLoader:n.loaderState},null,40,["data","alert","onLoaderValue","archive","disableLoader"]))])])])])])):c("",!0)])}const Ot=C(Zi,[["render",pl],["__scopeId","data-v-3bb7fd97"]]);const fl={name:"associated-problem",description:"Shows associated problem related to the ticket",props:{data:{type:[String,Object],required:!0}},computed:{showAssociatedProblem(){return JSON.parse(this.data).associated_problem!=null},associatedProblem(){return JSON.parse(this.data).associated_problem}}},gl={key:0,id:"associated-problem",class:"d-flex row info-flex"},bl={class:"col-md-6"},yl={class:"col-sm-6"};function vl(e,t,s,d,n,i){const h=u("router-link"),_=N("tooltip");return i.showAssociatedProblem?(o(),l("div",gl,[a("div",bl,[a("label",null,r(e.lang("associated_problem")),1)]),a("div",yl,[w((o(),v(h,{id:"associated-problem-link",to:i.associatedProblem.redirect_to.replace(e.basePath(),"")},{default:y(()=>[g(r(i.associatedProblem.name),1)]),_:1},8,["to"])),[[_,i.associatedProblem.name]])])])):c("",!0)}const wl=C(fl,[["render",vl],["__scopeId","data-v-ca556653"]]);const kl={name:"restor-modal",description:"Restore Modal component",props:{showModal:{type:Boolean,default:!1},userId:{type:[String,Number],default:""},onClose:{type:Function,default:()=>{}},permissions:{type:Array,default:()=>[]}},data(){return{isDisabled:!1,containerStyle:{width:"800px"},loading:!1,permissionsList:[]}},beforeMount(){this.getInitialValues()},methods:{getInitialValues(){this.loading=!0,this.isDisabled=!0,S.get("/service-desk/get/permissions?limit=all&role=user").then(e=>{this.permissionsList=$s(e.data),this.updatePermissions(),this.checkExistingPermissions()}).catch(e=>{this.loading=!1,this.isDisabled=!1,A(e)})},updatePermissions(){this.permissionsList.forEach(function(e){e.checked=!1,e.disabled=!1,e.title=""})},checkExistingPermissions(){var e=this;this.permissions.forEach(function(t,s,d){e.checkBoxOperations(!0,t.key,!0)}),this.loading=!1,this.isDisabled=!1},checkBoxOperations(e,t,s){this.permissionsList.forEach(function(d){if(d.key==t){d.checked=e;return}})},onSubmit(){this.loading=!0,this.isDisabled=!0;let e={};e.user_id=this.userId,e.permission_ids=this.permissionsList.filter(t=>t.checked).map(t=>t.id),e._method="PATCH",S.post("/api/user/attach-permissions",e).then(t=>{window.emitter.emit("refreshUserData"),window.emitter.emit("refreshUserActions"),U(t,"user-view"),this.loading=!1,this.isDisabled=!1,this.onClose()}).catch(t=>{this.loading=!1,this.isDisabled=!1,A(t,"user-view"),this.onClose()})}},components:{checkbox:Rs}},Cl=e=>(K("data-v-f72aaf64"),e=e(),z(),e),Dl={class:"modal-title"},Sl={key:0,class:"user_permission_box"},Fl={class:"row"},Ml={key:1,class:"row"},Il=["disabled"],Al=Cl(()=>a("i",{class:"fas fa-sync"},null,-1));function Pl(e,t,s,d,n,i){const h=u("checkbox"),_=u("reuse-loader"),f=u("modal");return s.showModal?(o(),v(f,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{title:y(()=>[a("h4",Dl,r(e.lang("user_permissions")),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",Sl,[a("div",Fl,[(o(!0),l(I,null,$(n.permissionsList,p=>(o(),l("div",{class:"col-sm-4",style:{},key:p.id},[m(h,{name:p.key,value:p.checked,disabled:p.disabled,label:p.key,title:"",onChange:i.checkBoxOperations,id:p.key,hint:e.lang("view_assets_perm_tooltip")},null,8,["name","value","disabled","label","onChange","id","hint"])]))),128))])])),n.loading?(o(),l("div",Ml,[m(_,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",onClick:t[0]||(t[0]=(...p)=>i.onSubmit&&i.onSubmit(...p)),class:"btn btn-primary",disabled:n.isDisabled},[Al,g(" "+r(e.lang("update")),1)],8,Il)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const Tl=C(kl,[["render",Pl],["__scopeId","data-v-f72aaf64"]]);const Vl={name:"user-permissions",props:{data:{type:[String,Object],required:!0}},data(){return{showModal:!1}},computed:{userId(){return JSON.parse(this.data).user_id},permissions(){return JSON.parse(this.data).permissions}},methods:{onClose(){this.showModal=!1}},components:{"permission-modal":Tl}},Ll=e=>(K("data-v-3d63aeb8"),e=e(),z(),e),Ul={class:"sd-user-permissions-block"},$l=Ll(()=>a("i",{class:"fas fa-book-reader"},"  ",-1));function Nl(e,t,s,d,n,i){const h=u("permission-modal");return o(),l("span",Ul,[a("button",{type:"button",class:"btn btn-xs btn-default mt_5",onClick:t[0]||(t[0]=_=>n.showModal=!0)},[$l,g(r(e.trans("update_permissions")),1)]),m(q,{name:"modal"},{default:y(()=>[n.showModal?(o(),v(h,{key:0,onClose:i.onClose,showModal:n.showModal,userId:i.userId,permissions:i.permissions},null,8,["onClose","showModal","userId","permissions"])):c("",!0)]),_:1})])}const El=C(Vl,[["render",Nl],["__scopeId","data-v-3d63aeb8"]]),ql={class:"card card-light dashboard-widget-box"},Ol={class:"card-header"},jl={class:"card-title"},Rl=a("i",{class:"fas fa-desktop","aria-hidden":"true"},null,-1),xl={class:"card-tools"},Bl=["disabled"],Kl={key:0,class:"card-body scrollable-area"},zl={__name:"DashboardChartBox",props:{item:{type:Object,default:()=>{}},from:{type:String,default:""}},setup(e){let s=e.item;const d=x(!1),n=i=>{d.value=!0,axios.get("/service-desk/api/get/dashboard-charts/"+i).then(h=>{s=h.data.data[0],setTimeout(()=>{d.value=!1},1e3)}).catch(h=>{A(h),d.value=!1})};return(i,h)=>(o(),l("div",ql,[a("div",Ol,[a("h3",jl,[Rl,g(" "+r(te(s).name),1)]),a("div",xl,[a("button",{type:"button",class:"btn btn-tool","data-card-widget":"refresh",onClick:h[0]||(h[0]=_=>n(te(s).id)),disabled:d.value},[a("i",{class:j(["fas fa-sync-alt",d.value?"fa-spin":""])},null,2)],8,Bl)])]),d.value?c("",!0):(o(),l("div",Kl,[m(Ut,{chartData:te(s),from:e.from,type:te(s).chart_type==="bar_chart"?"bar":"doughnut",showTitle:!1,redirectUrls:te(s).result.map(_=>_.redirect_url)},null,8,["chartData","from","type","redirectUrls"])]))]))}},Hl={class:"row"},Yl={class:"col-sm-6"},Wl={__name:"DashboardCharts",setup(e){const t=x([]);Ce(()=>{s()});const s=()=>{axios.get("/service-desk/api/get/dashboard-charts").then(d=>{t.value=d.data.data}).catch(d=>{t.value=[]})};return(d,n)=>(o(),l("div",Hl,[(o(!0),l(I,null,$(t.value,i=>(o(),l("div",Yl,[(o(),v(zl,{from:"dashboard",key:i.id,item:i},null,8,["item"]))]))),256))]))}},Jl={name:"sd-agent-permission",description:"Service desk permission list box component",data:()=>({permissionsListSD:[],showSelectAll:!1,selectAll:!1}),props:{data:{type:String}},beforeMount(){this.getpermissonListApi(),(this.$route.name==="personal_access_token.create"||this.$route.name==="personal_access_token.edit")&&(this.showSelectAll=!0)},methods:{selectAllPermissions(){this.selectAll?this.permissionsListSD.forEach(function(s){s.checked=!0}):this.permissionsListSD.forEach(function(s){s.checked=!1});let e=this.permissionsListSD.filter(s=>s.checked).map(s=>s.id),t=this.permissionsListSD.filter(s=>s.checked).map(s=>s.key);this.showSelectAll?window.emitter.emit("selected-permission-list",{permissions:t,all_selected:this.selectAll}):window.emitter.emit("selected-permission-list",e)},getpermissonListApi(){S.get("service-desk/get/permissions",{}).then(e=>{this.permissionsListSD=$s(e.data.permissions),this.permissionsListSD.forEach(function(t){t.checked=!1}),this.data!="undefined"&&this.selectCheckboxInEdit()}).catch(e=>{A(e)})},selectCheckboxInEdit(){let e=this,t=JSON.parse(this.data);t=this.showSelectAll?t.data:t,this.showSelectAll&&(this.selectAll=JSON.parse(this.data).all_sd_permission_selected),t.forEach(function(s){e.checkBoxOperationsSD(!0,s.id)})},checkBoxOperationsSD(e,t){e||(this.selectAll=!1),this.permissionsListSD.forEach(function(n){if(n.id==t){n.checked=e;return}});let s=this.permissionsListSD.filter(n=>n.checked).map(n=>n.id),d=this.permissionsListSD.filter(n=>n.checked).map(n=>n.key);this.showSelectAll?window.emitter.emit("selected-permission-list",{permissions:d,all_selected:this.selectAll}):window.emitter.emit("selected-permission-list",s)}},components:{checkbox:Rs,"tool-tip":tt}},Gl={class:"card-tools"},Zl={class:"form-check"},Ql={class:"form-check-label",for:"select-all-sd"},Xl={class:"row"};function er(e,t,s,d,n,i){const h=u("tool-tip"),_=u("checkbox"),f=u("faveo-box");return o(),v(f,{title:e.lang("service-desk-permissions"),boxClass:"card-light"},vt({headerTooltip:y(()=>[m(h,{message:e.lang("view_is_mandatory_to_perform_all_actions"),size:"medium"},null,8,["message"])]),default:y(()=>[a("div",Xl,[(o(!0),l(I,null,$(e.permissionsListSD,p=>(o(),l("div",{class:"col-sm-3",id:"assign_groups",style:{},key:p.id},[m(_,{name:p.id,value:p.checked,label:e.lang(p.key),title:p.name,onChange:i.checkBoxOperationsSD,id:p.id},null,8,["name","value","label","title","onChange","id"])]))),128))])]),_:2},[e.showSelectAll?{name:"customActions",fn:y(()=>[a("div",Gl,[a("div",Zl,[w(a("input",{type:"checkbox",class:"form-check-input",id:"select-all-sd","onUpdate:modelValue":t[0]||(t[0]=p=>e.selectAll=p),onChange:t[1]||(t[1]=(...p)=>i.selectAllPermissions&&i.selectAllPermissions(...p))},null,544),[[Lt,e.selectAll]]),a("label",Ql,r(e.trans("select_all")),1)])])]),key:"0"}:void 0]),1032,["title"])}const tr=C(Jl,[["render",er]]),sr={name:"create-form-group-button",data:()=>({base:window.axios.defaults.baseURL})},ar={id:"create-form-group-button"};function nr(e,t,s,d,n,i){const h=u("router-link");return o(),l("span",ar,[m(h,{class:"dropdown-item",to:"/service-desk/form-group/create/asset"},{default:y(()=>[g(r(e.lang("new_asset_form_group")),1)]),_:1}),m(h,{class:"dropdown-item",to:"/service-desk/form-group/create/change"},{default:y(()=>[g(r(e.lang("new_change_form_group")),1)]),_:1})])}const or=C(sr,[["render",nr]]),ir={name:"filter-dropdown",components:{"dynamic-select":G},props:{metaData:{type:Array,required:!0}},data(){return{componentMetaData:this.metaData,selectedFilterObj:{}}},methods:{onChange(e,t){this.selectedFilterObj[t]=e,this.$emit("onChangeFilter",this.selectedFilterObj)}},computed:{getClassname:function(){const e=this.componentMetaData.length;let t="col-md-12";return e===2?t="col-md-6":e>2&&(t="col-md-4"),t}}},lr={class:"row"};function rr(e,t,s,d,n,i){const h=u("dynamic-select");return o(),l("div",lr,[(o(!0),l(I,null,$(n.componentMetaData,_=>(o(),v(h,{key:_.key,id:_.key,name:_.key,apiEndpoint:_.apiEndpoint,elements:_.elements,multiple:_.multiple,label:e.trans(_.label),value:_.value,onChange:i.onChange,classname:i.getClassname,strlength:17},null,8,["id","name","apiEndpoint","elements","multiple","label","value","onChange","classname"]))),128))])}const dr=C(ir,[["render",rr]]);const cr={name:"dynamic-select-with-filter",props:{node:{type:Object,required:!0},filterApiEndpoint:{type:String,required:!0},multiple:{type:Boolean,default:!1},onChange:{type:Function,required:!0},selectedAssets:{type:Array,required:!1},clearSelectedValue:{type:Function,required:!1},changeSelectedAsset:{type:Function,required:!1},isInlineForm:{type:Boolean,default:!0},showDivClass:{type:Boolean,default:!0}},data:()=>({showFilterPopup:!1,isLoading:!1,filterOptions:[],apiParameters:{},filterParams:{},selectedFilters:{},formattedFilterString:""}),computed:{apiEndpoint:function(){let e=$e.convertStringOfPropertiesToObject(this.node.api_info).url;return!e&&this.formField.api_info&&(e=this.formField.api_info+"?mode=render"),e},optionLabel(){return $e.convertStringOfPropertiesToObject(this.node.api_info).url.split("?").includes("extra_format=1")?"format":"name"},apiParams(){return Object.keys(this.filterParams).length?this.filterParams:this.apiParameters},...Ca(["getReporter"])},watch:{getReporter(e,t){e?(this.apiParameters={"used_by_ids[n]":e},this.$store.dispatch("setSelectedValues",[]),this.clearSelectedValue()):this.apiParameters={}}},methods:{openFilterPopup(){this.showFilterPopup=!0,this.filterOptions.length===0&&(this.isLoading=!0,S.get(this.filterApiEndpoint).then(e=>{this.filterOptions=e.data.data}).catch(e=>{console.error(e)}).finally(()=>{this.isLoading=!1}))},applyFilter(){this.filterOptions.map(t=>t.value=this.selectedFilters[t.key]);const e=ka(this.filterOptions);this.formattedFilterString=e.formatedText,this.filterParams=e.apiParams,this.showFilterPopup=!1,this.changeSelectedAsset()},onChangeFilter(e){this.selectedFilters={...this.selectedFilters,...e}}},components:{modal:ft,"dynamic-select":G,"filter-dropdowns":dr}},ur=["innerHTML"],hr={class:"ds-filter-modal"};function mr(e,t,s,d,n,i){const h=u("dynamic-select"),_=u("loader"),f=u("filter-dropdowns"),p=u("modal"),b=N("tooltip");return o(),l("div",{class:j(s.showDivClass?"row":"")},[a("div",{class:j(s.showDivClass?"dynamic-select-with-filter-container col-md-12":"")},[m(h,{id:s.node.key,name:s.node.key,"api-endpoint":i.apiEndpoint,"api-parameters":i.apiParams,multiple:s.multiple,value:s.selectedAssets,required:!!s.node.required,label:s.node.label,onChange:s.onChange,isInlineForm:s.isInlineForm,actionBtn:{text:"filter",isFor:"requester",action:i.openFilterPopup},"tip-rule":s.node.show_description,hint:s.node.description,optionLabel:i.optionLabel},{dsHelpText:y(()=>[a("small",null,[w(a("span",{innerHTML:e.formattedFilterString},null,8,ur),[[b,{content:e.formattedFilterString,html:!0}]])])]),_:1},8,["id","name","api-endpoint","api-parameters","multiple","value","required","label","onChange","isInlineForm","actionBtn","tip-rule","hint","optionLabel"])],2),m(q,{name:"modal"},{default:y(()=>[e.showFilterPopup?(o(),v(p,{key:0,showModal:e.showFilterPopup,onClose:()=>e.showFilterPopup=!1,containerStyle:{width:"800px"}},{title:y(()=>[a("h4",null,r(e.trans("filter")),1)]),fields:y(()=>[a("div",hr,[e.isLoading?(o(),v(_,{key:0,"animation-duration":4e3,size:60})):c("",!0),e.isLoading?c("",!0):(o(),v(f,{key:1,metaData:e.filterOptions,onOnChangeFilter:i.onChangeFilter},null,8,["metaData","onOnChangeFilter"]))])]),controls:y(()=>[a("button",{class:"btn btn-primary",type:"button",onClick:t[0]||(t[0]=k=>i.applyFilter())},r(e.trans("apply")),1)]),_:1},8,["showModal","onClose"])):c("",!0)]),_:1})],2)}const _r=C(cr,[["render",mr]]),pr={props:{data:{type:String,required:!0}},data:()=>({nodeData:null,selectedAssets:[]}),beforeMount(){this.nodeData=JSON.parse(this.data),this.nodeData.scenario==="edit"&&this.nodeData.category==="changes"&&(this.selectedAssets=this.$store.getters.getSelectedValues)},computed:{apiEndpoint:function(){return $e.convertStringOfPropertiesToObject(this.nodeData.node.api_info).url},optionLabel(){return $e.convertStringOfPropertiesToObject(this.nodeData.node.api_info).url.split("?").includes("extra_format=1")?"format":"name"}},methods:{clearSelectedValue(){this.selectedAssets=[]},changeSelectedAsset(){if(this.selectedAssets=[],this.$store.getters.getSelectedValues.length>0)for(let e in this.$store.getters.getSelectedValues)this.selectedAssets.push(this.$store.getters.getSelectedValues[e])},onChange(e){const t={id:this.nodeData.node.key,isDefault:!!this.nodeData.node.default,formUniqueKey:this.nodeData.formUniqueKey,selectedValue:e};this.$store.dispatch("setFormData",t),this.changeSelectedAsset()}},components:{"dynamic-select-with-filter":_r,"dynamic-select":G}},fr={key:0},gr={key:1};function br(e,t,s,d,n,i){const h=u("dynamic-select-with-filter"),_=u("dynamic-select");return e.nodeData?(o(),l("div",fr,[e.nodeData.showFilter?(o(),v(h,{key:0,node:e.nodeData.node,multiple:!0,isInlineForm:e.nodeData.isInlineForm??!0,showDivClass:e.nodeData.showDivClass,selectedAssets:e.selectedAssets,changeSelectedAsset:i.changeSelectedAsset,clearSelectedValue:i.clearSelectedValue,"filter-api-endpoint":"/service-desk/api/module-filter-structure/asset","on-change":i.onChange},null,8,["node","isInlineForm","showDivClass","selectedAssets","changeSelectedAsset","clearSelectedValue","on-change"])):(o(),l("div",gr,[m(_,{id:e.nodeData.node.key,name:e.nodeData.node.key,"api-endpoint":e.isUserLoggedIn?i.apiEndpoint:"",multiple:!0,value:e.nodeData.node.value,required:e.nodeData.node.required,label:e.nodeData.node.label,onChange:i.onChange,isInlineForm:e.nodeData.isInlineForm??!0,"tip-rule":e.nodeData.node.show_description_under_form_field,hint:e.nodeData.node.description,optionLabel:i.optionLabel},null,8,["id","name","api-endpoint","value","required","label","onChange","isInlineForm","tip-rule","hint","optionLabel"])]))])):c("",!0)}const yr=C(pr,[["render",br]]),vr={name:"create-workflow-button"},wr={id:"create-workflow-button"};function kr(e,t,s,d,n,i){const h=u("router-link");return o(),l("span",wr,[m(h,{class:"dropdown-item",to:"/service-desk/workflow/create?page_type=change"},{default:y(()=>[g(r(e.lang("new_change_workflow")),1)]),_:1})])}const Cr=C(vr,[["render",kr]]),Dr={name:"create-listener-button"},Sr={id:"create-listener-button"};function Fr(e,t,s,d,n,i){const h=u("router-link");return o(),l("span",Sr,[m(h,{class:"dropdown-item",to:"/service-desk/listener/create?page_type=change"},{default:y(()=>[g(r(e.lang("new_change_listener")),1)]),_:1})])}const Mr=C(Dr,[["render",Fr]]);function Ws(e){const{comment:t}=e;let s={};e.action!=="approve"&&(s.comment=[t,{isRequired:ae("comment_is_mandatory_for_cab_deny_action")}]);const d=new ce(ae),{errors:n,isValid:i}=d.validate(s);return ie.dispatch("setValidationError",n),{errors:n,isValid:i}}const Ir={name:"change-conversation",description:"Change Conversation Component",props:{layout:{type:Object,default:()=>{}},auth:{type:Object,default:()=>{}}},data(){return{changeDetails:"",loading:!0,hasDataPopulated:!1,isDisabled:!1,comment:"",lang_locale:this.layout.language,hash:"",statusText:"",shallShowApprovalAction:!0}},beforeMount(){this.$Progress.start(),this.getInitialValues()},methods:{getHashFromUrl(e){let t=e.split("/");return t[t.length-1]},getInitialValues(){const e=window.location.pathname;this.hash=this.getHashFromUrl(e),S.get("/service-desk/api/change-conversation/"+this.hash).then(t=>{this.changeDetails=t.data.data.change,this.loading=!1,this.hasDataPopulated=!0,this.$Progress.finish()}).catch(t=>{this.statusText=t.response.data.message,this.hasDataPopulated=!0,this.loading=!1,this.$Progress.fail(),this.$router.push({path:"/not-found",name:"NotFound",params:{statusText:this.statusText}})})},isValid(){const{errors:e,isValid:t}=Ws(this.$data);return t?!0:(this.$refs.textarea.focus(),!1)},onChange(e,t){this[t]=e},onSubmit(e){e==="deny"&&!this.isValid()||(this.loading=!0,this.isDisabled=!0,this.$Progress.start(),S.post("/service-desk/api/approval-action/"+this.hash,{action_type:e,comment:this.comment}).then(t=>{U(t),this.loading=!1,this.isDisabled=!1,this.comment="",this.shallShowApprovalAction=!1,this.$Progress.finish()}).catch(t=>{A(t),this.loading=!1,this.isDisabled=!1,this.shallShowApprovalAction=!0,this.$Progress.fail()}))}},components:{"text-field":le}},jt=e=>(K("data-v-1a548cb2"),e=e(),z(),e),Ar={class:"change-conversation"},Pr={key:0,class:"row"},Tr={id:"content",class:"site-content col-sm-12 userContent"},Vr={class:"hentry"},Lr={class:"entry-header"},Ur=["title"],$r=jt(()=>a("i",{class:"fas fa-exchange-alt"},null,-1)),Nr={class:"row"},Er={id:"box",class:"col-md-5 p-3 mr-4 rounded"},qr=["innerHTML"],Or={class:"col-md-4 border-left p-3 rounded"},jr={class:"row"},Rr={class:"col"},xr=["innerHTML"],Br={class:"col"},Kr=["innerHTML"],zr={class:"row mt-1"},Hr={class:"col mt-2"},Yr=["innerHTML"],Wr={class:"col mt-2"},Jr=["innerHTML"],Gr={class:"input-group"},Zr={class:"input-group-addon"},Qr={class:"fa fa-info-circle userIcon"},Xr={class:"btns"},ed=["disabled"],td=jt(()=>a("span",{class:"fa fa-check"},null,-1)),sd=["disabled"],ad=jt(()=>a("span",{class:"fa fa-times"},null,-1)),nd={key:1,id:"loader",class:"row"};function od(e,t,s,d,n,i){const h=u("meta-component"),_=u("alert"),f=u("text-field"),p=u("reuse-loader"),b=N("tooltip"),k=N("focus-first-input");return o(),l("div",Ar,[m(h,{dynamic_title:e.lang("approval_settings-page-title"),dynamic_description:e.lang("approval_settings-page-description"),layout:s.layout},null,8,["dynamic_title","dynamic_description","layout"]),m(_),n.statusText===""&&n.hasDataPopulated?(o(),l("div",Pr,[a("div",Tr,[a("article",Vr,[a("header",Lr,[a("h3",{class:j(["entry-title",{align1:n.lang_locale=="ar"}]),title:n.changeDetails.subject},[$r,g(" "+r(n.changeDetails.subject),1)],10,Ur)]),a("div",{class:j(["entry-content clearfix",{align1:n.lang_locale=="ar"}])},[a("div",Nr,[a("div",Er,[a("div",null,[a("div",{innerHTML:n.changeDetails.description},null,8,qr)])]),a("div",Or,[a("div",null,[a("div",jr,[a("div",Rr,[a("label",null,[a("b",null,r(e.lang("id")),1)]),a("div",{innerHTML:n.changeDetails.id},null,8,xr)]),a("div",Br,[a("label",null,[a("b",null,r(e.lang("identifier")),1)]),a("div",{innerHTML:n.changeDetails.identifier},null,8,Kr)])]),a("div",zr,[a("div",Hr,[a("label",null,[a("b",null,r(e.lang("change_raised_on")),1)]),a("div",{innerHTML:n.changeDetails.change_raised_on},null,8,Yr)]),a("div",Wr,[a("label",null,[a("b",null,r(e.lang("status")),1)]),a("div",{innerHTML:n.changeDetails.status.name},null,8,Jr)])])])])])],2)]),!n.loading&&n.shallShowApprovalAction?(o(),l("div",{key:0,id:"approval-action-form",class:j({align1:n.lang_locale=="ar"})},[w((o(),l("div",Gr,[m(f,{id:"textarea",label:e.lang("comment"),value:n.comment,type:"textarea",placehold:e.lang("enter_a_comment"),name:"comment",onChange:i.onChange,classname:"col-xs-12",style:{width:"39%"}},null,8,["label","value","placehold","onChange"]),a("span",Zr,[w(a("i",Qr,null,512),[[b,e.trans("comment_is_mandatory_for_cab_deny_action"),void 0,{top:!0,right:!0}]])])])),[[k]]),a("div",Xr,[a("button",{id:"approve",onClick:t[0]||(t[0]=D=>i.onSubmit("approve")),class:"btn btn-success",disabled:n.isDisabled},[td,g(" "+r(e.lang("approve")),1)],8,ed),a("button",{id:"deny",onClick:t[1]||(t[1]=D=>i.onSubmit("deny")),class:"btn btn-danger mx-3",disabled:n.isDisabled},[ad,g(" "+r(e.lang("deny")),1)],8,sd)])],2)):c("",!0)])])):c("",!0),n.loading?(o(),l("div",nd,[m(p,{"animation-duration":4e3,size:60,color:s.layout.portal.client_header_color},null,8,["color"])])):c("",!0)])}const id=C(Ir,[["render",od],["__scopeId","data-v-1a548cb2"]]);function ld(e){const{comment:t}=e;let s={comment:[t,"isRequired"]};const d=new ce(ae),{errors:n,isValid:i}=d.validate(s);return ie.dispatch("setValidationError",n),{errors:n,isValid:i}}const rd={name:"contract-conversation",description:"Contract Conversation Component",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},props:{layout:{type:Object,default:()=>{}},auth:{type:Object,default:()=>{}}},data(){return{contractDetails:"",loading:!0,hasDataPopulated:!1,isDisabled:!1,lang_locale:this.layout.language,details:{},statusText:"",comment:"",shallShowApprovalAction:!0,actionType:""}},beforeMount(){this.$Progress.start(),this.getInitialValues()},methods:{subString(e,t=15){return oe(e,t)},getHashFromUrl(e){let t={},s=e.split("/");return t.hash=s[s.length-2],t.id=s[s.length-1],t},isValid(){const{errors:e,isValid:t}=ld(this.$data);return t},onChange(e,t){this[t]=e},onClick(e){this.actionType=e,e=="reject"?this.isValid()&&this.onSubmit():this.onSubmit()},onSubmit(){this.loading=!0,this.isDisabled=!0,this.$Progress.start();let e={};e.actionType=this.actionType,this.actionType=="reject"&&(e.purpose_of_rejection=this.comment),this.actionType=="approve"&&(e.purpose_of_approval=this.comment),S.post("/service-desk/api/contract-approval/"+this.details.hash+"/"+this.details.id,e).then(t=>{U(t),this.loading=!1,this.isDisabled=!1,this.comment="",this.shallShowApprovalAction=!1,this.$Progress.finish(),setTimeout(()=>{this.$router.push({path:"/",name:"Home"})},2e3)}).catch(t=>{A(t),this.loading=!1,this.isDisabled=!1,this.shallShowApprovalAction=!0,this.$Progress.fail()})},getInitialValues(){const e=window.location.pathname;this.details=this.getHashFromUrl(e),S.get("/service-desk/api/contract-details/"+this.details.hash+"/"+this.details.id).then(t=>{this.contractDetails=t.data.data.contract,this.loading=!1,this.hasDataPopulated=!0,this.$Progress.finish()}).catch(t=>{this.statusText=t.response.data.message,this.hasDataPopulated=!0,this.loading=!1,this.$Progress.fail(),this.$router.push({path:"/not-found",name:"NotFound",params:{statusText:this.statusText}})})}},components:{"text-field":le}},at=e=>(K("data-v-39dc4846"),e=e(),z(),e),dd={class:"contract-conversation"},cd={key:0,class:"row"},ud={id:"content",class:"site-content col-sm-12"},hd={class:"hentry"},md={class:"entry-header"},_d=at(()=>a("i",{class:"fas fa-file-contract pr-1"},null,-1)),pd={class:"h3 fw-700"},fd={class:"row"},gd={class:"col-md-12"},bd={class:"alert alert-info"},yd={class:"row"},vd={class:"col-md-4"},wd={class:"col-md-4"},kd={class:"col-md-4"},Cd={class:"row"},Dd={class:"col-md-6"},Sd={class:"table"},Fd=at(()=>a("div",{class:"clearfix"},null,-1)),Md={class:"col-md-6"},Id={class:"table"},Ad=at(()=>a("div",{class:"clearfix"},null,-1)),Pd={class:"col-sm-12"},Td=["disabled"],Vd=at(()=>a("span",{class:"fas fa-check"},null,-1)),Ld=["disabled"],Ud=at(()=>a("span",{class:"fas fa-times"},null,-1)),$d={key:1,id:"loader",class:"row"};function Nd(e,t,s,d,n,i){const h=u("meta-component"),_=u("alert"),f=u("text-field"),p=u("reuse-loader"),b=N("tooltip"),k=N("focus-first-input");return o(),l("div",dd,[m(h,{dynamic_title:e.trans("approval_settings-page-title"),dynamic_description:e.trans("approval_settings-page-description"),layout:s.layout},null,8,["dynamic_title","dynamic_description","layout"]),m(_),n.statusText===""&&n.hasDataPopulated?(o(),l("div",cd,[a("div",ud,[a("article",hd,[a("header",md,[a("h3",{class:j(["entry-title",{align1:n.lang_locale=="ar"}])},[_d,w((o(),l("span",pd,[g(r(n.contractDetails.name),1)])),[[b,n.contractDetails.name]])],2)]),a("div",{class:j(["entry-content clearfix",{align1:n.lang_locale=="ar"}])},[a("div",fd,[a("div",gd,[a("div",bd,[a("div",yd,[a("div",vd,[a("b",null,r(e.trans("start_date"))+" : ",1),w((o(),l("span",null,[g(r(d.formattedTime(n.contractDetails.contract_start_date)),1)])),[[b,d.formattedTime(n.contractDetails.contract_start_date)]])]),a("div",wd,[a("b",null,r(e.trans("expiry_date"))+" : ",1),w((o(),l("span",null,[g(r(d.formattedTime(n.contractDetails.contract_end_date)),1)])),[[b,d.formattedTime(n.contractDetails.contract_end_date)]])]),a("div",kd,[a("b",null,r(e.trans("contract_type"))+" : ",1),w((o(),l("span",null,[g(r(n.contractDetails.contractType?i.subString(n.contractDetails.contractType.name,20):"---"),1)])),[[b,n.contractDetails.contractType?n.contractDetails.contractType.name:"---"]])])])])])]),a("div",Cd,[a("div",Dd,[a("table",Sd,[a("tbody",null,[a("tr",null,[a("td",null,[a("b",null,r(e.trans("vendor"))+" :",1)]),a("td",null,[w((o(),l("span",null,[g(r(n.contractDetails.vendor?i.subString(n.contractDetails.vendor.name):"---"),1)])),[[b,n.contractDetails.vendor?n.contractDetails.vendor.name:"---"]])])]),a("tr",null,[a("td",null,[a("b",null,r(e.trans("contract_status"))+" :",1)]),a("td",null,[w((o(),l("span",null,[g(r(i.subString(n.contractDetails.status.name)),1)])),[[b,n.contractDetails.status.name]])])]),a("tr",null,[a("td",null,[a("b",null,r(e.trans("license_type"))+" :",1)]),a("td",null,[w((o(),l("span",null,[g(r(n.contractDetails.licence?i.subString(n.contractDetails.licence.name):"---"),1)])),[[b,n.contractDetails.licence?n.contractDetails.licence.name:"---"]])])])])]),Fd]),a("div",Md,[a("table",Id,[a("tbody",null,[a("tr",null,[a("td",null,[a("b",null,r(e.trans("cost"))+" :",1)]),a("td",null,[w((o(),l("span",null,[g(r(n.contractDetails.cost),1)])),[[b,n.contractDetails.cost.toString()]])])]),a("tr",null,[a("td",null,[a("b",null,r(e.trans("contract_creator"))+" :",1)]),a("td",null,[w((o(),l("span",null,[g(r(n.contractDetails.owner?i.subString(n.contractDetails.owner.name):"---"),1)])),[[b,n.contractDetails.owner?n.contractDetails.owner.name:"---"]])])]),a("tr",null,[a("td",null,[a("b",null,r(e.trans("license_count"))+" :",1)]),a("td",null,[w((o(),l("span",null,[g(r(n.contractDetails.licensce_count?i.subString(n.contractDetails.licensce_count):"---"),1)])),[[b,n.contractDetails.licensce_count?n.contractDetails.licensce_count.toString():"---"]])])])])]),Ad])])],2)]),!n.loading&&n.shallShowApprovalAction?w((o(),l("div",{key:0,id:"approval-action-form",class:j({align1:n.lang_locale=="ar"})},[m(f,{id:"textarea",label:e.trans("comment"),value:n.comment,type:"textarea",name:"comment",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-12",hint:e.trans("contarct_approval_comment")},null,8,["label","value","onChange","placehold","hint"]),a("div",Pd,[a("button",{id:"approve",onClick:t[0]||(t[0]=D=>i.onClick("approve")),class:"btn btn-success",disabled:n.isDisabled},[Vd,g(" "+r(e.trans("approve")),1)],8,Td),a("button",{id:"deny",onClick:t[1]||(t[1]=D=>i.onClick("reject")),class:"btn btn-danger",disabled:n.isDisabled},[Ud,g(" "+r(e.trans("reject")),1)],8,Ld)])],2)),[[k]]):c("",!0)])])):c("",!0),n.loading?(o(),l("div",$d,[m(p,{"animation-duration":4e3,size:60,color:s.layout.portal.client_header_color},null,8,["color"])])):c("",!0)])}const Ed=C(rd,[["render",Nd],["__scopeId","data-v-39dc4846"]]);const Js=e=>(K("data-v-ac274911"),e=e(),z(),e),qd={class:"col-sm-12"},Od={key:1},jd={class:"card-header"},Rd={class:"card-title"},xd={class:"card-body"},Bd={class:"table-responsive"},Kd={class:"table"},zd={id:"report-icon",style:{width:"1%"}},Hd={class:"fa-stack fa-2x"},Yd={id:"report-description",style:{width:"100%"}},Wd={class:"text-uppercase"},Jd={class:"text-overflow"},Gd=Js(()=>a("br",null,null,-1)),Zd={class:"float-right report-modify"},Qd={id:"report-label",style:{width:"9%"}},Xd={key:0,class:"badge badge-info"},ec=["onClick"],tc=Js(()=>a("i",{class:"fas fa-trash","aria-hidden":"true"},null,-1)),sc=[tc],ac={__name:"ReportEntry",setup(e){const t=x([]),s=x(!1);Ce(()=>{d()});const d=()=>{s.value=!0,S.get("/service-desk/api/sd-reports/list").then(h=>{t.value=h.data.data}).catch(h=>{A(h,"report-home-page")}).finally(()=>{s.value=!1})},n=h=>{confirm("Are you sure you want to delete this report?")&&(s.value=!0,S.delete("api/report/"+h).then(f=>{d(),U(f,"report-home-page")}).catch(f=>{A(f,"report-home-page"),s.value=!1}))},i=h=>({1:"problem-report",2:"change-report",3:"release-report",4:"asset-report",5:"contract-report",7:"software-license-report"})[h]||"report";return(h,_)=>{const f=u("alert"),p=u("custom-loader"),b=u("router-link"),k=N("tooltip");return o(),l("div",qd,[m(f,{componentName:"report-home-page"}),s.value?(o(),v(p,{key:0,duration:4e3})):c("",!0),t.value?(o(),l("div",Od,[(o(!0),l(I,null,$(t.value,(D,P)=>(o(),l("div",{class:"card card-light",key:P},[a("div",jd,[a("h3",Rd,r(h.lang(P)),1)]),a("div",xd,[a("div",Bd,[a("table",Kd,[a("tbody",null,[(o(!0),l(I,null,$(D,E=>(o(),l("tr",{class:"default",key:E.id},[a("td",zd,[a("span",Hd,[a("i",{class:j(E.icon_class+" fa-stack-1x")},null,2)])]),a("td",Yd,[a("dl",null,[a("dt",Wd,[m(b,{to:"/service-desk/reports/"+i(E.module)+"/"+E.module+"/"+E.id,class:"fw-500"},{default:y(()=>[g(r(E.report),1)]),_:2},1032,["to"])]),a("dd",Jd,[g(r(E.description)+" ",1),Gd,a("small",Zd,[g(r(h.lang("last_modified_on"))+": ",1),a("strong",null,r(E.updated_at),1)])])])]),a("td",Qd,[E.is_default?(o(),l("div",Xd,r(h.trans("default")),1)):w((o(),l("button",{key:1,class:"btn btn-danger ml-6",onClick:M=>n(E.id)},sc,8,ec)),[[k,h.trans("delete")]])])]))),128))])])])])]))),128))])):c("",!0)])}}},nc=C(ac,[["__scopeId","data-v-ac274911"]]);const oc={name:"report-list",description:"Report lists table component",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},data:()=>({columns:["name","description","created_at","updated_at","action"],options:{},apiUrl:"/service-desk/api/reports"}),beforeMount(){const e=this;this.options={headings:{name:this.trans("name"),description:this.trans("description"),created_at:this.trans("created_at"),updated_at:this.trans("updated_at"),action:this.trans("actions")},columnsClasses:{name:"report-name",description:"report-desc",created_at:"report-time",updated_at:"report-time",action:"report-action"},sortIcon:{base:"glyphicon",up:"glyphicon-chevron-up",down:"glyphicon-chevron-down"},texts:{filter:"",limit:""},templates:{created_at(t,s){return e.formattedTime(s.created_at)},updated_at(t,s){return e.formattedTime(s.updated_at)},action:(t,s)=>e.h(_e,{data:s})},sortable:["name","description","created_at","updated_at"],filterable:["name","description"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.reports.data.map(s=>(s.from="agent",s.view_url="/service-desk/reports/assets/"+s.id,s.edit_url="/service-desk/reports/assets/edit/"+s.id,s.delete_url=e.basePath()+"/service-desk/api/reports/"+s.id,s)),count:t.data.reports.total}}}}},ic={class:"col-sm-12"},lc={class:"card card-light"},rc={class:"card-header"},dc={id:"report-list",class:"card-title"},cc={class:"card-tools"},uc=a("i",{class:"glyphicon glyphicon-plus"},null,-1),hc={class:"card-body",id:"my_asset_report_list"};function mc(e,t,s,d,n,i){const h=u("alert"),_=u("router-link"),f=u("data-table"),p=N("tooltip");return o(),l("div",ic,[m(h,{componentName:"dataTableModal"}),a("div",lc,[a("div",rc,[a("h3",dc,r(e.lang("assets_reports")),1),a("div",cc,[w((o(),v(_,{class:"btn btn-tool",to:"/service-desk/reports/assets/create"},{default:y(()=>[uc]),_:1})),[[p,e.lang("create_asset_report")]])])]),a("div",hc,[m(f,{url:e.apiUrl,dataColumns:e.columns,option:e.options,scroll_to:"report-list"},null,8,["url","dataColumns","option"])])])])}const _c=C(oc,[["render",mc]]);function pc(e){const{name:t}=e;var s={name:[t,"isRequired","max(25)"]};const d=new ce(ae),{errors:n,isValid:i}=d.validate(s);return ie.dispatch("setValidationError",n),{errors:n,isValid:i}}const fc={name:"agent-asset-list",description:"Agent asset lists table component",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},props:{from:{type:String,default:""},ApiUrl:{type:String,default:"/service-desk/api/asset-list?config=true&"}},data(){return{columns:[],options:{},apiUrl:this.ApiUrl}},watch:{ApiUrl(e,t){return t}},computed:{columnsValues(){return this.$emit("columns-list",this.columns.filter(e=>e.display).map(e=>e.key)),this.columns.filter(e=>e.display).map(e=>e.key)},isSingleDisplayTrue(){return this.columns.filter(e=>e.display).length===1}},beforeMount(){this.getColumns();const e=this;this.options={headings:{name:this.trans("name"),used_by:this.trans("used_by"),managed_by:this.trans("managed_by"),action:this.trans("actions"),identifier:this.trans("identifier"),created_at:this.trans("created_at"),updated_at:this.trans("updated_at"),asset_type:this.trans("asset_type"),asset_status:this.trans("asset_status")},sortIcon:{base:"glyphicon",up:"glyphicon-chevron-up",down:"glyphicon-chevron-down"},texts:{filter:"",limit:""},templates:{assigned_on(t,s){return e.formattedTime(s.assigned_on)},created_at(t,s){return e.formattedTime(s.created_at)},updated_at(t,s){return e.formattedTime(s.updated_at)},managed_by(t,s){var d,n;return((n=(d=s.managed_by)==null?void 0:d.full_name)==null?void 0:n.replace(/<[^>]+>/g,""))??"--"},used_by(t,s){var d,n;return((n=(d=s.used_by)==null?void 0:d.full_name)==null?void 0:n.replace(/<[^>]+>/g,""))??"--"},attachment(t,s){return s.attachment?e.h("a",{href:e.basePath()+"/uploads/service-desk/attachments/"+s.attachment.value,target:"_blank"},ae("click_to_see_attachment")):"--"},name(t,s){return e.h(se,{to:"/service-desk/assets/"+s.asset_id+"/show"},s.name)},asset_type(t,s){return s.asset_type?s.asset_type.name:"--"},asset_status(t,s){return s.asset_status?s.asset_status.name:"--"},department(t,s){return s.department?e.h("a",{href:e.basePath()+"/admin/department/"+s.department.id,target:"_blank"},s.department.name.replace(/<[^>]+>/g,"")):"--"},impact_type(t,s){return s.impact_type?s.impact_type.name:"--"},location(t,s){return s.location?s.location.name:"--"},organization(t,s){return s.organization?e.h(se,{to:"/organizations/"+s.organization.id},s.organization.name.replace(/<[^>]+>/g,"")):"--"},product(t,s){return s.product?e.h("a",{href:e.basePath()+"/admin/service-desk/products/"+s.product.id+"/show",target:"_blank"},s.product.name):"--"}},sortable:["asset_id","name","identifier","assigned_on","created_at","updated_at"],filterable:["name","identifier","assigned_on","created_at","updated_at"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return e.$emit("asset-report-data",t.data.data),{data:t.data.data,count:t.data.total}}}},methods:{columnToggle(e){this.columns[e].display=!this.columns[e].display},getColumns(){const e=window.location.pathname,t=W(e),s=t?"/service-desk/api/asset-list?column=true&filter_id="+t:"/service-desk/api/asset-list?column=true";S.get(s).then(d=>{this.columns=d.data.data.asset_columns}).catch(d=>{this.columns=[]})}}},gc={class:"card-body"},bc={key:0,class:"column-list-right"},yc={class:"btn btn-default dropdown-toggle mt-10",type:"button","data-toggle":"dropdown"},vc=a("i",{class:"fas fa-columns"},null,-1),wc={class:"dropdown-menu dropdown-menu-right",id:"cols"},kc={key:0,class:"dropdown-item asset-col",href:"javascript:;"},Cc={class:"label_align"},Dc=["onClick","disabled","onUpdate:modelValue"],Sc=a("span",{class:"checkbox-label-space mr-2"},null,-1),Fc={class:"agent-asset-table"};function Mc(e,t,s,d,n,i){const h=u("alert"),_=u("data-table");return o(),l("div",gc,[m(h,{componentName:"dataTableModal"}),s.from!="view"?(o(),l("div",bc,[g("    "),a("button",yc,[vc,g(" "+r(e.lang("columns")),1)]),a("div",wc,[(o(!0),l(I,null,$(n.columns,(f,p)=>(o(),l(I,null,[f.key!="id"&&f.key!="description"?(o(),l("a",kc,[a("label",Cc,[w(a("input",{class:"checkbox_align",type:"checkbox",onClick:b=>i.columnToggle(p),disabled:i.isSingleDisplayTrue&&f.display,"onUpdate:modelValue":b=>f.display=b},null,8,Dc),[[Lt,f.display]]),Sc,g(r(e.lang(f.value)),1)])])):c("",!0)],64))),256))])])):c("",!0),a("div",Fc,[m(_,{url:s.ApiUrl,dataColumns:i.columnsValues,option:n.options,scroll_to:"asset-list"},null,8,["url","dataColumns","option"])])])}const Rt=C(fc,[["render",Mc]]);const Ic={name:"custom-filter",description:"Custom Fields Filter Component",props:{updateFilterFields:{type:Function,default:()=>{}},selectedFilterFields:{type:Array,default:()=>[]},endPoint:{type:String,required:!0}},data(){return{customFields:[],loading:!0,selectedFields:this.selectedFilterFields,search:"",locale:"",hasMoreData:!0,page:1}},created(){window.emitter.on("clearCustomFields",this.clearFields)},computed:{filteredList(){return this.customFields.filter(e=>e.label.toLowerCase().includes(this.search.toLowerCase()))}},methods:{handleFilterScroll(){const e=document.getElementById("filter-dropdown"),t=e.scrollHeight,s=e.scrollTop,d=e.clientHeight;s+d>=t-100&&!this.loading&&this.hasMoreData&&this.getFields()},clearFields(){this.selectedFields=[]},subString(e){return oe(e,30)},onCancel(){var e=document.getElementById("filter-div");e.classList.remove("open")},onClick(e){if(this.selectedFields.map(s=>s.id).includes(e.id)){for(var t in this.selectedFields)if(this.selectedFields[t].id===e.id){this.selectedFields.splice(t,1);break}}else e.name="custom_"+e.id,e.isCustom=!0,e.value="",e.className="col-sm-4",this.selectedFields.push(e);this.updateFilterFields(this.selectedFields)},async getFields(){try{this.loading=!0;const e=await S.get(`${this.endPoint}&page=${this.page}`);e.data.data.data.length>0?(this.customFields=[...this.customFields,...e.data.data.data],this.page++):this.hasMoreData=!1}catch(e){console.error("Error fetching data:",e)}finally{this.loading=!1}},getCustomFields(e,t){this.customFields=[],this.selectedFields=[],S.get(e).then(s=>{let d=s.data.data.data;if(this.page++,d.length){for(var n in d){if(t.length)for(var i in t)t[i].key===d[n].key&&(d[n].name=t[i].key,d[n].isCustom=!0,d[n].className="col-sm-4",d[n].value||(d[n].data_type==="checkbox"?d[n].value=t[i].value.split(","):d[n].value=t[i].value,this.selectedFields.push(d[n]),this.selectedFields.length===t.length&&this.updateFilterFields(this.selectedFields)));for(var h in this.selectedFields)this.selectedFields[h].id===d[n].id&&(d[n].value=this.selectedFields[h].value)}this.customFields=d}}).catch(s=>{})}},components:{}},Ac=e=>(K("data-v-9f06e038"),e=e(),z(),e),Pc={id:"filter-div",class:"card-tools"},Tc=Ac(()=>a("i",{class:"glyphicon glyphicon-plus"},null,-1)),Vc=[Tc],Lc={key:0,class:"nav-item"},Uc={class:"form-group has-feedback has-search filter_div"},$c=["placeholder"],Nc=["onClick"],Ec={key:0,class:"fa fa-check field_select"},qc={id:"field_title"},Oc={key:1},jc={class:"text-center"},Rc={key:2,class:"field_loader nav-item"};function xc(e,t,s,d,n,i){const h=u("loader"),_=N("tooltip");return o(),l("div",Pc,[w((o(),l("button",{type:"button",class:"btn btn-tool dropdown-toggle","data-toggle":"dropdown",id:"labels-button",onClick:t[0]||(t[0]=f=>i.getFields())},Vc)),[[_,e.trans("add_custom_field")]]),a("ul",{id:"filter-dropdown",class:"dropdown-menu dropdown-menu-right filter_menu",onClick:t[2]||(t[2]=f=>f.stopPropagation()),onScroll:t[3]||(t[3]=f=>i.handleFilterScroll())},[n.loading?c("",!0):(o(),l("li",Lc,[a("div",Uc,[w(a("input",{type:"text",class:"form-control",name:"label",placeholder:e.trans("search"),"onUpdate:modelValue":t[1]||(t[1]=f=>n.search=f)},null,8,$c),[[js,n.search]])])])),(o(!0),l(I,null,$(i.filteredList,f=>w((o(),l("li",{class:"nav-item fields",onClick:p=>i.onClick(f)},[a("a",{class:j(["nav-link",{active:n.selectedFields.map(p=>p.id).includes(f.id)}]),href:"javascript:;"},[n.selectedFields.map(p=>p.id).includes(f.id)?(o(),l("i",Ec)):c("",!0),a("span",qc,r(i.subString(f.label)),1)],2)],8,Nc)),[[_,f.hover?f.hover:e.trans(f.label)]])),256)),!n.loading&&n.customFields.length===0?(o(),l("li",Oc,[a("p",jc,r(e.trans("no_results_found")),1)])):c("",!0),n.loading?(o(),l("li",Rc,[m(h,{size:30,duration:4e3,color:"#1d78ff"})])):c("",!0)],32)])}const Bc=C(Ic,[["render",xc],["__scopeId","data-v-9f06e038"]]),Kc={name:"custom-asset-form-fields",props:{formField:{type:Object,required:!0},allFields:{type:Array,default:()=>[]},classname:{type:String,default:"col-sm-6"}},data(){return{selectedVal:this.formField.value,uniqueId:this.formField.key,updatedFields:this.allFields,dropdownOptions:[],dropdownLabel:"label",country_code:null,showMobileField:!1}},watch:{allFields(e,t){this.updatedFields=e},formField(e,t){this.uniqueId=e.key,this.selectedVal=e.value,e.data_type==="checkbox"&&(this.selectedVal=Array.isArray(this.selectedVal)?this.selectedVal:this.selectedVal.split(",")),e.data_type==="mobile"&&this.selectedVal&&this.selectedVal.includes(" ")&&(this.selectedVal=this.selectedVal.split(" ")[1])}},beforeMount(){this.formField.data_type==="mobile"&&this.formField.value&&this.formField.value.includes(" ")?(this.country_code=this.formField.value.split(" ")[0],this.showMobileField=!0):this.showMobileField=!0},computed:{apiInfoUrl(){let e=$e.convertStringOfPropertiesToObject(this.formField.api_info).url;return!e&&this.formField.api_info&&(e=this.formField.api_info),e},dropdownKey(){return $e.convertStringOfPropertiesToObject(this.formField.api_info).key||"label"},selectedValue(){let e=this.updatedFields.findIndex(t=>t.key==this.uniqueId);if(e!=-1){if(this.formField.data_type==="mobile"&&this.selectedVal&&this.selectedVal.includes(" "))return this.selectedVal.split(" ")[1];if(Array.isArray(this.selectedVal)&&this.selectedVal!=null){let t=[];return this.selectedVal.forEach(s=>{typeof s=="object"?t.push(s.label):t.push(s)}),this.updatedFields[e].value=t.map(s=>s).toString(),this.updatedFields[e].options.filter(s=>t.includes(s.label))}else if(pe(this.updatedFields[e].options)){let t="";return typeof this.selectedVal=="object"?t=this.selectedVal.label:t=this.selectedVal,this.updatedFields[e].options.find(s=>s.label===t)}else return this.selectedVal?this.selectedVal:""}else return this.selectedVal}},methods:{keypressEvent(e,t,s){if(s==="number"||s==="mobile"){e=e||window.event;var d=e.which?e.which:e.keyCode;if(d>31&&(d<48||d>57))e.preventDefault();else return!0}else if(s==="float"||s==="decimal"){e=e||window.event;var d=e.which?e.which:e.keyCode;if(d>=48&&d<=57||d==46)return!0;e.preventDefault()}},pasteEvent(e,t,s){if(s==="number"||s==="mobile")e=e||window.event,e.clipboardData.getData("Text").match(/[^\d]/)&&e.preventDefault();else if(s==="float"||s==="decimal"){e=e||window.event;var d=e.clipboardData||window.clipboardData,n=d.getData("Text");/^\d*\.\d*$/.test(n)||e.preventDefault()}},onCountryCodeUpdate(e,t){this[t]=e},onChange(e,t){let s=this.updatedFields.findIndex(d=>d.key==t);Array.isArray(e)&&e!=null?(this.updatedFields[s].value=e.map(d=>d.label).toString(),this.selectedVal=e):typeof e=="object"&&e!=null?(this.updatedFields[s].value=e[this.dropdownLabel],this.selectedVal=e):this.formField.data_type==="mobile"?(this.updatedFields[s].value=e?this.country_code+" "+e:"",this.selectedVal=e?this.country_code+" "+e:""):(this.updatedFields[s].value=e||"",this.selectedVal=e||""),this.$emit("updated",this.updatedFields)}},components:{MobileField:Ns,"dynamic-select":G,"text-field":le,"radio-field":xs,"checkbox-field":Bs,"date-time-field":bt}};function zc(e,t,s,d,n,i){const h=u("date-time-field"),_=u("dynamic-select"),f=u("text-field"),p=u("radio-field"),b=u("checkbox-field"),k=u("MobileField");return o(),l("div",{class:j(s.classname)},[s.formField.data_type==="date"?(o(),v(h,{key:0,type:"datetime",label:s.formField.label,value:i.selectedValue,id:s.formField.key,required:!1,name:s.formField.key,onChange:i.onChange,format:"MMMM DD YYYY HH:mm",clearable:!0,outputFormat:"YYYY-MM-DD HH:mm:ss"},null,8,["label","value","id","name","onChange"])):c("",!0),s.formField.data_type==="select"?(o(),v(_,{key:1,id:s.formField.key,label:s.formField.label,multiple:!1,name:s.formField.key,apiEndpoint:i.apiInfoUrl,value:i.selectedValue,onChange:i.onChange,optionLabel:n.dropdownLabel},null,8,["id","label","name","apiEndpoint","value","onChange","optionLabel"])):c("",!0),s.formField.data_type==="text"||s.formField.data_type==="textarea"||s.formField.data_type==="number"||s.formField.data_type==="decimal"||s.formField.data_type==="email"?(o(),v(f,{key:2,id:s.formField.key,label:s.formField.label,type:s.formField.data_type,name:s.formField.key,value:i.selectedValue,onChange:i.onChange,from:"filter",keypressEvt:i.keypressEvent,pasteEvt:i.pasteEvent},null,8,["id","label","type","name","value","onChange","keypressEvt","pasteEvt"])):c("",!0),s.formField.data_type==="radio"?(o(),v(p,{key:3,name:s.formField.key,label:s.formField.label,options:s.formField.options,value:i.selectedValue,onChange:i.onChange,from:"filter"},null,8,["name","label","options","value","onChange"])):c("",!0),s.formField.data_type==="checkbox"?(o(),v(b,{key:4,name:s.formField.key,label:s.formField.label,options:s.formField.options,value:i.selectedValue,onChange:i.onChange,from:"filter"},null,8,["name","label","options","value","onChange"])):c("",!0),n.showMobileField&&s.formField.data_type==="mobile"?(o(),v(k,{key:5,id:s.formField.key,label:s.formField.label,type:s.formField.data_type,name:s.formField.key,value:i.selectedValue,onChange:i.onChange,isInlineForm:!1,countryCode:n.country_code,onCountryCode:t[0]||(t[0]=D=>i.onCountryCodeUpdate(D,"country_code")),keypressEvt:i.keypressEvent,pasteEvt:i.pasteEvent,extensionEnabled:0,ext:[]},null,8,["id","label","type","name","value","onChange","countryCode","keypressEvt","pasteEvt"])):c("",!0)],2)}const Hc=C(Kc,[["render",zc]]);const Yc={name:"table-filter",description:"Table filter component",props:{titleText:String,metaData:{type:Array,required:!0},appliedFilters:{type:Object,default:()=>{}},from:{type:String,default:""},showCustomFilter:{type:Boolean,default:!1},updateFields:{type:Function,default:()=>{}},selectedFields:{type:Array,default:()=>[]},endPoint:{type:String,default:""},saveFilter:{type:Boolean,default:!1},filterFor:{type:String,default:""},filterNum:{type:[String,Number],default:""},redirectTo:{type:String,default:""},deleteUrl:{type:String,default:""},closeFilter:{type:Function,default:()=>{}},save_endpoint:{type:String,default:""}},data(){return{selectedFilters:this.appliedFilters,close_on_select:!this.multiple,isShowFilter:!1,componentMetaData:this.metaData,loading:!1,formStyle:{width:"49.5%"},numberStyle:{width:"20%"},showModal:!1,filterName:"",selectedFilterId:this.filterNum,departments:[],agents:[],filterMode:"",icon_class:"",dashboardWidget:!1,isDefault:!1,icon_color:""}},beforeMount(){this.updateSelectedFieldValues(),this.filterNum&&this.getFilterValue()},methods:{updatedCustomFields(e){for(var t in e)this.onChange(e[t].value,e[t].name)},updateSelectedFieldValues(){this.updateFields(this.selectedFields);for(var e in this.selectedFields)this.onChange(this.selectedFields[e].value,this.selectedFields[e].name)},onChange(e,t){this.selectedFilters[t]=e},onCancel(){this.$emit("selectedFilters","closeEvent")},onApply(){this.$emit("selectedFilters",this.selectedFilters)},onSave(e){this.$emit("selectedFilters",this.selectedFilters),this.filterMode=e,this.showModal=!0},toggleFilterPopUp(e){this.showModal=e},onReset(){this.selectedFilters={},this.loading=!0,setTimeout(()=>{this.loading=!1},1e3),this.$emit("selectedFilters","resetEvent")},getFilterValue(){this.loading=!0,axios.get("/service-desk/api/agent/sd-filter/"+this.selectedFilterId).then(e=>{this.loading=!1;let t={},s=[];this.isDefault=e.data.data.is_default,e.data.data.fields.map(d=>{d.key.indexOf("custom_")!==-1?(s.push(d),t[d.key]=d.value):t[d.key]=d.value_meta}),s.length&&this.appendCustomFieldFilter(s),this.selectedFilters=t,this.componentMetaData.map(function(d){d.section.map(function(n){t.hasOwnProperty(n.name)&&(n.value=t[n.name])})}),this.selectedFilterId=e.data.data.id,this.filterName=this.isDefault?"":e.data.data.name,this.icon_class=this.isDefault?"":{icon_class:e.data.data.icon_class},this.departments=e.data.data.departments,this.agents=e.data.data.agents,this.dashboardWidget=e.data.data.is_dashboard_widget,this.icon_color=this.isDefault?"#00C0EF":e.data.data.icon_color}).catch(e=>{})},appendCustomFieldFilter(e){this.$refs.custom_table_filter.getCustomFields(this.endPoint,e)}},components:{"custom-form-fields":Hc,"custom-filter":Bc,"dynamic-select":G,"date-time-field":$t,"number-range-field":Nt,"text-field":le,"save-table-filter":Et}},Wc={key:0,class:"card-body"},Jc={class:"row"},Gc={key:1,id:"table-filter"},Zc={class:"row"},Qc={class:"card-footer"},Xc=a("span",{class:"fas fa-check"},null,-1),eu=a("span",{class:"fas fa-sync"},null,-1),tu=a("span",{class:"fas fa-trash-alt"},null,-1),su=a("span",{class:"fas fa-save"},null,-1),au=a("span",{class:"fas fa-undo"},null,-1),nu=a("span",{class:"fas fa-times"},null,-1);function ou(e,t,s,d,n,i){const h=u("custom-filter"),_=u("custom-loader"),f=u("custom-form-fields"),p=u("dynamic-select"),b=u("number-range-field"),k=u("text-field"),D=u("date-time-field"),P=u("save-table-filter"),E=u("faveo-box");return o(),v(E,{"box-class":"card card-light ",title:e.lang("filter")},{customActions:y(()=>[s.showCustomFilter?(o(),v(h,{key:0,updateFilterFields:s.updateFields,selectedFilterFields:s.selectedFields,endPoint:s.endPoint,ref:"custom_table_filter"},null,8,["updateFilterFields","selectedFilterFields","endPoint"])):c("",!0)]),actions:y(()=>[a("div",Qc,[a("button",{id:"filter-apply-btn",class:"btn btn-primary",type:"button",onClick:t[0]||(t[0]=(...M)=>i.onApply&&i.onApply(...M))},[Xc,g("  "+r(e.lang("apply")),1)]),s.saveFilter?(o(),l(I,{key:0},[s.filterNum&&!n.isDefault?(o(),l(I,{key:0},[a("button",{id:"filter-upd",class:"btn btn-primary",type:"button",onClick:t[1]||(t[1]=M=>i.onSave("update"))},[eu,g("  "+r(e.lang("update")),1)]),a("button",{id:"filetr-del",class:"btn btn-danger",type:"button",onClick:t[2]||(t[2]=M=>i.onSave("delete"))},[tu,g("  "+r(e.lang("delete")),1)])],64)):(o(),l("button",{key:1,id:"filetr-save",class:"btn btn-primary",type:"button",onClick:t[3]||(t[3]=M=>i.onSave("save"))},[su,g("  "+r(e.lang("save")),1)]))],64)):c("",!0),a("button",{id:"reset-btn",class:"btn btn-primary",type:"button",onClick:t[4]||(t[4]=(...M)=>i.onReset&&i.onReset(...M))},[au,g("  "+r(e.lang("reset")),1)]),s.from!=="report"?(o(),l("button",{key:1,id:"filter-cancel-btn",class:"btn btn-danger",type:"button",onClick:t[5]||(t[5]=(...M)=>i.onCancel&&i.onCancel(...M))},[nu,g("  "+r(e.lang("cancel")),1)])):c("",!0)])]),default:y(()=>[n.loading?(o(),l("div",Wc,[a("div",Jc,[m(_,{"animation-duration":4e3,color:"#1d78ff",size:60})])])):(o(),l("div",Gc,[(o(!0),l(I,null,$(n.componentMetaData,M=>(o(),l("div",Zc,[(o(!0),l(I,null,$(M.section,F=>(o(),l(I,null,[F.isCustom?(o(),v(f,{key:0,formField:F,allFields:s.selectedFields,onUpdated:i.updatedCustomFields,classname:F.className},null,8,["formField","allFields","onUpdated","classname"])):(o(),l(I,{key:1},[F.type!=="date"&&F.type!=="number"&&F.type!=="text"?(o(),v(p,{key:F.name,id:F.name,name:F.name,apiEndpoint:F.url,classname:F.className,elements:F.elements,multiple:F.isMultiple,label:e.lang(F.label),value:F.value,onChange:i.onChange,strlength:"35",hint:e.lang(F.hint)},null,8,["id","name","apiEndpoint","classname","elements","multiple","label","value","onChange","hint"])):c("",!0),F.type==="number"?(o(),v(b,{label:e.lang(F.label),formStyle:n.formStyle,value:F.value,key:F.name,id:F.name,name:F.name,classname:F.className,type:"text",onChange:i.onChange,min_placeholder:F.min_placeholder,max_placeholder:F.max_placeholder,required:!1},null,8,["label","formStyle","value","id","name","classname","onChange","min_placeholder","max_placeholder"])):c("",!0),F.type==="text"?(o(),v(k,{label:e.lang(F.label),value:F.value,key:F.name,id:F.name,name:F.name,onChange:i.onChange,classname:F.className,required:!1},null,8,["label","value","id","name","onChange","classname"])):c("",!0),F.type==="date"?(o(),v(D,{label:F.label,value:F.value,type:"datetime",key:F.name,id:F.name,name:F.name,onChange:i.onChange,range:F.range,required:!1,format:"MMMM DD YYYY, h:mm a",classname:F.className,clearable:!1,disabled:!1,editable:!0,pickers:F.pickers,currentYearDate:!1,"time-picker-options":F.timeOptions,isDateSelector:!1,numberStyle:n.numberStyle,confirm:!0},null,8,["label","value","id","name","onChange","range","classname","pickers","time-picker-options","numberStyle"])):c("",!0)],64))],64))),256))]))),256))])),n.showModal?(o(),v(P,{key:2,filterName:n.filterName,icon:n.icon_class,filterValues:n.selectedFilters,filterId:n.selectedFilterId,toggleFilterPopUp:i.toggleFilterPopUp,source:s.filterFor,filterArray:n.componentMetaData,intitialDepartments:n.departments,initialAgents:n.agents,mode:n.filterMode,is_default:n.isDefault,redirectTo:s.redirectTo,deleteUrl:s.deleteUrl,closeFilter:s.closeFilter,"title-text":e.mode==="save"?e.trans("save_filter"):e.mode==="update"?e.trans("update_filter"):e.trans("delete_filter"),save_endpoint:s.save_endpoint,dashboardWidget:n.dashboardWidget,icon_color:n.icon_color},null,8,["filterName","icon","filterValues","filterId","toggleFilterPopUp","source","filterArray","intitialDepartments","initialAgents","mode","is_default","redirectTo","deleteUrl","closeFilter","title-text","save_endpoint","dashboardWidget","icon_color"])):c("",!0)]),_:1},8,["title"])}const Gs=C(Yc,[["render",ou]]);const iu={name:"report-nested-filter",description:"Report Nested Filter component",data(){return{title:"create_asset_report",iconClass:"fas fa-save",btnName:"save",filter_id:"",editData:"",apiUrl:"",name:"",description:"",selectedFilters:{},componentMetaData:[{section:[{name:"asset_ids",url:"/service-desk/api/asset-list?meta=true",label:"assets"},{name:"asset_type_ids",url:"/service-desk/api/dependency/asset_types",label:"asset_types"},{name:"used_by_ids",url:"api/dependency/users?meta=true",label:"used_by"}]},{section:[{name:"managed_by_ids",url:"api/dependency/agents?meta=true",label:"managed_by"},{name:"location_ids",url:"api/dependency/locations",label:"location"},{name:"dept_ids",url:"api/dependency/departments",label:"departments"}]},{section:[{name:"org_ids",url:"api/dependency/organizations",label:"organizations"},{name:"product_ids",url:"/service-desk/api/dependency/products",label:"products"},{name:"ticket_ids",url:"api/dependency/tickets",label:"ticket"}]},{section:[{name:"impact_type_ids",url:"/service-desk/api/dependency/impacts",label:"impact_types"},{name:"assigned_on",type:"date",label:["assigned_on","assigned_on"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"}}]}],sections:[1,2,3],loading:!0,fieldsArr:[],chart_types:[{id:"bar",name:"Bar"},{id:"pie",name:"Pie"},{id:"horizontal",name:"Horizontal Bar"},{id:"doughnut",name:"Doughnut"}],chart_type:"bar",showChart:!1,chartData:"",chartApiUrl:"",columns:"",reset:!1}},beforeMount(){const e=window.location.pathname;this.getValues(e)},methods:{selectedFiltersMethod(e){return e==="resetEvent"?this.onReset():this.applyFilter(e)},getColumns(e){this.columns=e},getValues(e){const t=W(e);e.indexOf("edit")>=0?(this.title="edit_asset_report",this.iconClass="fas fa-sync",this.btnName="update",this.getInitialValues(t)):(this.apiUrl="/service-desk/api/asset-list?config=true&",this.chartApiUrl="/service-desk/api/asset-list?count=true&",this.filterData(),this.getChartData(),this.loading=!1,this.reset=!1)},getInitialValues(e){this.loading=!0,this.reset=!0,S.get("/service-desk/api/reports/"+e).then(t=>{this.loading=!1,this.reset=!1,this.editData=t.data.data.report_filter,this.filter_id=this.editData.id,this.name=this.editData.name,this.description=this.editData.description,this.filterData(this.editData.filter_meta);for(var s in this.editData.filter_meta)this.selectedFilters[this.editData.filter_meta[s].key]=this.editData.filter_meta[s].value_meta;this.applyFilter(this.selectedFilters)}).catch(t=>{this.loading=!1,this.reset=!1})},onChange(e,t){this.selectedFilters[t]=e},onFieldChange(e,t){this[t]=e,t==="chart_type"&&e&&(this.showChart=!1,this.getChartData())},isValid(){const{errors:e,isValid:t}=pc(this.$data);return!!t},filterAction(e){this.isValid()&&this.storeFields(this.selectedFilters)},applyFilter(e){this.selectedFilters=e,this.loading=!0;let t="/service-desk/api/asset-list?config=true&";this.chartApiUrl="/service-desk/api/asset-list?count=true&";let s=this.commonMethod(e,"apply");s[s.length-1]==="&"&&(s=s.slice(0,-1)),this.apiUrl=t+s,this.chartApiUrl=this.chartApiUrl+s,this.getChartData(this.chartApiUrl),this.loading=!1},commonMethod(e,t){let s="";for(var d in this.componentMetaData)for(var n in this.componentMetaData[d].section)if(e[this.componentMetaData[d].section[n].name])if(this.componentMetaData[d].section[n].value=e[this.componentMetaData[d].section[n].name],t==="apply")if(this.componentMetaData[d].section[n].name==="assigned_on"){let i=e.assigned_on;const h=i.includes("last::")||i.includes("date::")?`${e.assigned_on}`:"date::"+i.map(_=>ze(_).format("YYYY-MM-DD HH:mm:ss")).join("~");s+=this.componentMetaData[d].section[n].name+"="+h+"&"}else e[this.componentMetaData[d].section[n].name].forEach(function(i,h){s+=this.componentMetaData[d].section[n].name+"["+h+"]="+i.id+"&"},this);else{let i=this.componentMetaData[d].section[n],h=i.name==="assigned_on",_=i.value.includes("last::")||i.value.includes("date::"),f=h?_?i.value:"date::"+i.value.map(b=>ze(b).format("YYYY-MM-DD HH:mm:ss")).join("~"):i.value.map(b=>b.id),p=h?_?i.value:f:i.value;this.fieldsArr.push({key:i.name,value:f,value_meta:p})}return s},storeFields(e){this.loading=!0,this.commonMethod(e,"store");const t={};t.name=this.name,t.description=this.description,t.type="asset",t.fields=this.fieldsArr,t.report_column_keys=this.columns,this.filter_id!=""&&(t.id=this.filter_id),S.post("/service-desk/api/reports/create",t).then(s=>{this.loading=!1,U(s),this.filter_id||setTimeout(()=>{this.$router.push({name:"SD Reports Index"})},3e3)}).catch(s=>{this.loading=!1,A(s)})},onReset(){this.fieldsArr=[],this.selectedFilters={},this.apiUrl="/service-desk/api/asset-list?config=true&",this.chartApiUrl="/service-desk/api/asset-list?count=true&",this.getChartData(this.chartApiUrl),this.componentMetaData=this.componentMetaData.map(function(e){return e.section.map(function(t){t.elements=[],t.isMultiple=!0,t.isPrepopulate=!1,t.value="",t.className="col-sm-4"}),e},this)},getChartData(){this.showChart=!1,S.get(this.chartApiUrl).then(e=>{this.showChart=!0,this.chartData=e.data}).catch(e=>{this.showChart=!0})},filterData(e){this.componentMetaData.map(function(t){t.section.map(function(s){e?e.map(function(d){d.key===s.name&&(s.value=d.value_meta)}):s.value="",s.elements=[],s.isMultiple=!0,s.isPrepopulate=!1,s.className="col-sm-4"})}),this.loading=!1}},components:{"dynamic-select":G,"static-select":st,"agent-asset-index":Rt,"asset-filter":Gs,"text-field":le,chart:Ut}},lu={class:"col-sm-12"},ru={key:0,class:"row"},du={class:"card card-light"},cu={class:"card-header"},uu={class:"card-title"},hu={class:"card-body"},mu={class:"card card-light"},_u={class:"card-header"},pu={class:"card-title"},fu={class:"card-body"},gu={class:"row"},bu={class:"card card-light"},yu={class:"card-header"},vu={class:"card-title"},wu={class:"card card-light"},ku={class:"card-header"},Cu={class:"card-title"},Du={class:"card-body"},Su={class:"row"},Fu={class:"card card-light"},Mu={class:"card-header"},Iu={class:"card-title"},Au={class:"card-footer"};function Pu(e,t,s,d,n,i){const h=u("custom-loader"),_=u("alert"),f=u("text-field"),p=u("asset-filter"),b=u("static-select"),k=u("chart"),D=u("agent-asset-index"),P=N("focus-first-input");return o(),l("div",lu,[n.loading?(o(),l("div",ru,[m(h,{duration:4e3})])):c("",!0),m(_),a("div",du,[a("div",cu,[a("h3",uu,r(e.lang(n.title)),1)]),a("div",hu,[a("div",mu,[a("div",_u,[a("h3",pu,r(e.lang("report_info")),1)]),a("div",fu,[w((o(),l("div",gu,[m(f,{label:e.lang("name"),value:n.name,type:"text",name:"name",onChange:i.onFieldChange,placehold:e.lang("enter_a_value"),classname:"col-sm-12",required:!0},null,8,["label","value","onChange","placehold"]),m(f,{label:e.lang("description"),value:n.description,type:"textarea",name:"description",onChange:i.onFieldChange,placehold:e.lang("enter_a_value"),classname:"col-sm-12"},null,8,["label","value","onChange","placehold"])])),[[P]])])]),a("div",bu,[a("div",yu,[a("h3",vu,r(e.lang("report_filter")),1)]),n.reset?c("",!0):(o(),v(p,{key:0,id:"filter-box",metaData:n.componentMetaData,onSelectedFilters:i.selectedFiltersMethod,appliedFilters:n.selectedFilters,from:"report"},null,8,["metaData","onSelectedFilters","appliedFilters"]))]),a("div",wu,[a("div",ku,[a("h3",Cu,r(e.lang("graph")),1)]),a("div",Du,[a("div",Su,[m(b,{label:e.lang("select_chart_type"),elements:n.chart_types,name:"chart_type",value:n.chart_type,classname:"col-sm-6",onChange:i.onFieldChange,hideEmptySelect:!0},null,8,["label","elements","value","onChange"]),n.showChart?(o(),v(k,{key:0,chartData:n.chartData,type:n.chart_type},null,8,["chartData","type"])):c("",!0)])])]),a("div",Fu,[a("div",Mu,[a("h3",Iu,r(e.lang("list_of_assets")),1)]),n.apiUrl?(o(),v(D,{key:0,onColumnsList:i.getColumns,ApiUrl:n.apiUrl},null,8,["onColumnsList","ApiUrl"])):c("",!0)])]),a("div",Au,[a("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=E=>i.filterAction("save")),type:"button"},[a("i",{class:j(n.iconClass)},null,2),g(" "+r(e.lang(n.btnName)),1)])])])])}const cs=C(iu,[["render",Pu],["__scopeId","data-v-97942134"]]);const Tu={name:"report-view",description:"Report view component",beforeMount(){let e="";this.apiUrl="/service-desk/api/asset-list?config=true&",this.chartApiUrl="/service-desk/api/asset-list?count=true&",S.get("service-desk/api/reports/"+this.getIDfromURL()).then(t=>{this.reportData=t.data.data.report_filter;for(const s of t.data.data.report_filter.filter_meta)s.key==="assigned_on"?e+=s.key==="assigned_on"?"assigned_on="+s.value_meta+"&":"":s.value.forEach((d,n)=>{e+=s.key+"["+n+"]="+d+"&"}),this.chartApiUrl+=e,this.apiUrl+=e;e="",this.chartApiUrl.charAt(this.chartApiUrl.length-1)==="&"&&(this.chartApiUrl=this.chartApiUrl.slice(0,-1)),this.getChartData(),this.apiUrl.charAt(this.apiUrl.length-1)==="&"&&(this.apiUrl=this.apiUrl.slice(0,-1))}).catch(t=>{console.log(t)})},data(){return{layout:{portal:{client_header_color:"#009aba",client_button_color:"#009aba",client_button_border_color:"#00c0ef",client_input_fild_color:"#d2d6de"}},chart_types:[{id:"bar",name:"Bar"},{id:"pie",name:"Pie"},{id:"horizontal",name:"Horizontal Bar"},{id:"doughnut",name:"Doughnut"}],chart_type:"bar",reportData:"",apiUrl:"",chartApiUrl:"",filterName:"",filterDescription:"",selectedFilters:{},close_on_select:!this.multiple,isShowFilter:!1,showChart:!1,chartData:"",columns:"",table:""}},methods:{getColumns(e){this.columns=e},getTableData(e){this.table=e},onChange(e,t){this.selectedFilters[t]=e},getChartData(){this.showChart=!1,S.get(this.chartApiUrl).then(e=>{this.showChart=!0,this.chartData=e.data}).catch(e=>{this.showChart=!0})},onFieldChange(e,t){this[t]=e,t==="chart_type"&&e&&(this.showChart=!1,this.getChartData())},getIDfromURL(){let e=window.location.pathname.split("/");return e[e.length-1]},deleteReport(){let e="/service-desk/api/reports/"+this.getIDfromURL();S.delete(e).then(t=>{t&&(U(t,"report-view"),setTimeout(()=>{this.$router.push({name:"SD Reports Index"})},3e3))}).catch(t=>console.log(t))},exportAs(e){window.open(this.basePath()+"/service-desk/api/export/"+e+"?filter_id="+this.getIDfromURL())}},components:{"agent-asset-index":Rt,"static-select":st,chart:Ut}},kt=e=>(K("data-v-d6098822"),e=e(),z(),e),Vu={class:"col-sm-12"},Lu={class:"card card-light"},Uu={class:"card-header"},$u={class:"card-title"},Nu={class:"card-tools"},Eu=kt(()=>a("i",{class:"fa fa-trash"},null,-1)),qu=[Eu],Ou=kt(()=>a("i",{class:"fas fa-edit"},null,-1)),ju={class:"btn-group",id:"export"},Ru={class:"btn btn-tool dropdown-toggle",type:"button","data-toggle":"dropdown"},xu=kt(()=>a("i",{class:"fas fa-download"},null,-1)),Bu=[xu],Ku={class:"dropdown-menu dropdown-menu-right"},zu={class:"card-body"},Hu={key:0,class:"text-muted well well-sm no-shadow",id:"rep_desc"},Yu=kt(()=>a("strong",null,"Description ",-1)),Wu={class:"card card-light"},Ju={class:"card-header"},Gu={class:"card-title"},Zu={class:"card-body"},Qu={class:"row"},Xu={key:1,class:"row",id:"reset"},eh={class:"row mt-2"},th={class:"col-sm-12"};function sh(e,t,s,d,n,i){const h=u("alert"),_=u("router-link"),f=u("static-select"),p=u("chart"),b=u("reuse-loader"),k=u("agent-asset-index"),D=N("tooltip");return o(),l("div",Vu,[m(h,{componentName:"report-view"}),a("div",Lu,[a("div",Uu,[a("h3",$u,r(n.reportData.name),1),a("div",Nu,[w((o(),l("button",{class:"btn btn-tool",onClick:t[0]||(t[0]=(...P)=>i.deleteReport&&i.deleteReport(...P))},qu)),[[D,e.lang("delete")]]),w((o(),v(_,{class:"btn btn-tool",to:"/service-desk/reports/assets/edit/"+i.getIDfromURL()},{default:y(()=>[Ou]),_:1},8,["to"])),[[D,e.lang("edit")]]),a("div",ju,[w((o(),l("button",Ru,Bu)),[[D,e.lang("export")]]),a("div",Ku,[a("a",{href:"javascript:;",class:"dropdown-item text-dark",onClick:t[1]||(t[1]=P=>i.exportAs("csv"))},r(e.lang("csv")),1),a("a",{href:"javascript:;",class:"dropdown-item text-dark",onClick:t[2]||(t[2]=P=>i.exportAs("excel"))},r(e.lang("xlsx")),1)])])])]),a("div",zu,[n.reportData.description?(o(),l("p",Hu,[Yu,g(" : "+r(n.reportData.description),1)])):c("",!0),a("div",Wu,[a("div",Ju,[a("h3",Gu,r(e.lang("graph")),1)]),a("div",Zu,[a("div",Qu,[m(f,{label:e.lang("select_chart_type"),elements:n.chart_types,name:"chart_type",value:n.chart_type,classname:"col-sm-6",onChange:i.onFieldChange,hideEmptySelect:!0},null,8,["label","elements","value","onChange"]),n.showChart?(o(),v(p,{key:0,chartData:n.chartData,type:n.chart_type},null,8,["chartData","type"])):(o(),l("div",Xu,[m(b,{"animation-duration":4e3,size:60})]))])])]),a("div",eh,[a("div",th,[m(k,{ApiUrl:n.apiUrl,onColumnsList:i.getColumns,onAssetReportData:i.getTableData,from:"view"},null,8,["ApiUrl","onColumnsList","onAssetReportData"])])])])])])}const ah=C(Tu,[["render",sh],["__scopeId","data-v-d6098822"]]);const nh={name:"Asset-list",description:"Asset lists table component",props:{filterIndex:{type:Boolean,default:!1}},data:()=>({assetIds:[],columns:[],visibleColumns:{},appliedFilters:{},staticColumns:["id","asset_image","actions"],hasDataPopulated:!1,apiUrl:"/service-desk/api/asset-list",filterOptions:[{section:[{name:"asset_ids",url:"/service-desk/api/dependency/assets",label:"assets",isCustom:!1},{name:"problem_ids",url:"/service-desk/api/dependency/problems",label:"problems",isCustom:!1},{name:"change_ids",url:"/service-desk/api/dependency/changes",label:"changes",isCustom:!1}]},{section:[{name:"release_ids",url:"/service-desk/api/dependency/releases",label:"releases",isCustom:!1},{name:"contract_ids",url:"/service-desk/api/dependency/contracts",label:"contracts",isCustom:!1},{name:"asset_type_ids",url:"/service-desk/api/dependency/asset_types",label:"asset_types",isCustom:!1}]},{section:[{name:"used_by_ids",url:"api/dependency/users?meta=true",label:"used_by",isCustom:!1},{name:"managed_by_ids",url:"api/dependency/agents?meta=true",label:"managed_by",isCustom:!1},{name:"location_ids",url:"api/dependency/locations",label:"location",isCustom:!1}]},{section:[{name:"dept_ids",url:"api/dependency/departments",label:"departments",isCustom:!1},{name:"org_ids",url:"api/dependency/organizations",label:"organizations",isCustom:!1},{name:"product_ids",url:"/service-desk/api/dependency/products",label:"products",isCustom:!1}]},{section:[{name:"assigned_on",type:"date",label:["assigned_on","assigned_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},isCustom:!1,range:!0},{name:"created_at",type:"date",label:["created_at","created_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},isCustom:!1,range:!0},{name:"updated_at",type:"date",label:["updated_at","updated_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},isCustom:!1,range:!0}]},{section:[{name:"impact_type_ids",url:"/service-desk/api/dependency/impacts",label:"impact_types",isCustom:!1},{name:"ticket_ids",url:"/api/dependency/tickets",label:"ticket",isCustom:!1},{name:"asset_status_ids",url:"/service-desk/api/status/list?module=4",label:"asset_status",isCustom:!1}]},{section:[{name:"depreciation_ids",url:"/service-desk/api/dependency/depreciation",label:"Depreciation",isCustom:!1}]},{section:[]}],assetFilterId:"",isShowFilter:!1,customFields:[],showIcon:!1,columnData:null,reportType:"asset",assetData:null,exportData:"",loading:!0,showPagination:!0,newReportId:"",dataCount:"",requiredPayload:[]}),created(){window.emitter.on("onColumnUpdate",this.onColumnUpdate),window.emitter.on("updateFilter",this.updateFilter),window.emitter.on("dataCount",this.handleDataCount)},beforeMount(){const e=window.location.pathname;this.assetFilterId=W(e);const t=Ye();t&&t.hasOwnProperty("filter-by-url")?We("/service-desk/api/filter-dependencies",t,{},n=>{n&&this.applyFilter(n)},n=>{A(n)}):this.apiUrl=this.filterIndex?"/service-desk/api/asset-list?filter_id="+this.assetFilterId:"/service-desk/api/asset-list",this.filterData(),this.getAssetData()},methods:{handleDataCount(e){this.showIcon=!!e,this.dataCount=e},updateFilter(e){this.filterOptions.map(function(t){t.section.map(function(s){e.name==s.name&&(s.value=e.value)})})},getAssetData(){this.hasDataPopulated=!1,S.get("api/agent/report-config/asset-report").then(e=>{this.assetData=e.data.data,this.newReportId=e.data.data.id,this.columnData=e.data.data.sub_reports,this.hasDataPopulated=!0,this.columnData.forEach(t=>{t.columns.forEach(s=>{}),this.columns=t.columns}),this.columns.map(t=>{t.is_visible=!!t.is_visible}),this.updateVisibleColumns()}).catch(e=>{this.hasDataPopulated=!0,this.columns=[],A(e)})},onColumnUpdate(e){this.columns=e,this.updateVisibleColumns()},updateVisibleColumns(){this.visibleColumns={},this.columns.map(e=>{pe(e.is_visible)&&(this.visibleColumns[e.key]=e.label)})},updateFilterFields(e){e.forEach(t=>{t.isCustom&&t.type=="checkbox"&&t.value&&(t.value=Array.isArray(t.value)?t.value:t.value.split(","))}),this.customFields=e,this.filterOptions[7].section=e},generateLabel(){let e="/service-desk/generate-barcode?",t="";if(this.assetIds.length!=0){for(let d in this.assetIds)t+="ids["+d+"]="+this.assetIds[d]+"&";let s=e+t;this.redirect(s)}else alert(this.lang("barcode_no_asset"))},filterData(){this.filterOptions.map(function(e){e.section.map(function(t){t.isCustom||(t.elements=[],t.isMultiple=!0),t.isPrepopulate=!1,t.value="",t.className="col-sm-4"})})},selectedFilters(e){return e==="closeEvent"?this.isShowFilter=!1:e==="resetEvent"?this.resetFilter():this.applyFilter(e)},resetFilter(){this.apiUrl=this.filterIndex?"/service-desk/api/asset-list?filter_id="+this.assetFilterId:"/service-desk/api/asset-list",this.updateFilterFields([]),window.emitter.emit("clearCustomFields"),this.filterOptions=this.filterOptions.map(function(e){return e.section.map(function(t){t.isCustom||(t.elements=[],t.isMultiple=!0),t.isPrepopulate=!1,t.value="",t.className="col-sm-4"}),e})},applyFilter(e){this.appliedFilters=e;for(var t in this.customFields)this.customFields[t].value=e[this.customFields[t].name];let s="/service-desk/api/asset-list?",d=new URLSearchParams(je(this.filterOptions,e));const i=d,h=new URLSearchParams(i),_={};for(const[f,p]of h)_[f]=p;d[d.length-1]==="&"&&(d=d.slice(0,-1)),this.apiUrl=s+d,this.exportData=this.reformatExportData(_)},assetsData(e){this.assetIds=e},toggleFilterView(){this.isShowFilter=!this.isShowFilter},reformatExportData(e){const t={};for(const s in e){const d=s.match(/([a-zA-Z_]+)\[(\d+)\]/);if(d){const[n,i,h]=d;t[i]=t[i]||[],t[i][h]=parseInt(e[s],10)}}return t},exportReport(){this.loading=!0;let e={};this.filterIndex&&(e.filter_id=this.assetFilterId);const t={...this.exportData,total:this.dataCount},s={...this.exportData,...e,total:this.dataCount};S.post("api/agent/report-export/"+this.newReportId,this.filterIndex?s:t).then(d=>{U(d,"dataTableModal")}).catch(d=>{A(d,"dataTableModal")}).finally(()=>{this.loading=!1})},scheduleList(){this.requiredPayload=JSON.stringify(this.exportData);const e={...this.exportData,filter_id:this.assetFilterId};this.$router.push({path:"/reports/schedule/add/"+this.assetData.type+"/"+this.newReportId,query:{params:this.filterIndex?JSON.stringify(e):this.requiredPayload}})}},components:{"user-column-list":Ge,"dynamic-datatable":Ze,"asset-filter":Gs,"asset-list-with-checkbox":Oe}},oh={class:"col-sm-12"},ih={key:0,class:"card card-light"},lh={class:"card-header"},rh={id:"asset-list",class:"card-title"},dh={class:"card-tools"},ch=a("i",{class:"glyphicon glyphicon-plus"},null,-1),uh=a("span",{class:"glyphicon glyphicon-filter"},null,-1),hh=[uh],mh=a("i",{class:"fas fa-print","aria-hidden":"true"},null,-1),_h=[mh],ph=a("i",{class:"fas fa-paper-plane"},null,-1),fh=[ph],gh=a("i",{class:"fas fa-calendar"},null,-1),bh=[gh],yh={class:"card-body",id:"asset_index"};function vh(e,t,s,d,n,i){const h=u("alert"),_=u("router-link"),f=u("asset-filter"),p=u("user-column-list"),b=u("dynamic-datatable"),k=N("tooltip");return o(),l("div",oh,[m(h,{componentName:"dataTableModal"}),e.hasDataPopulated?(o(),l("div",ih,[a("div",lh,[a("h3",rh,r(e.lang("list_of_assets")),1),a("div",dh,[w((o(),v(_,{class:"btn btn-tool",to:"/service-desk/assets/create"},{default:y(()=>[ch]),_:1})),[[k,e.lang("create_asset")]]),w((o(),l("a",{class:"btn btn-tool",onClick:t[0]||(t[0]=(...D)=>i.toggleFilterView&&i.toggleFilterView(...D)),href:"javascript:;"},hh)),[[k,e.lang("filter")]]),w((o(),l("button",{class:"btn btn-tool label-btn",onClick:t[1]||(t[1]=(...D)=>i.generateLabel&&i.generateLabel(...D)),href:"javascript:;"},_h)),[[k,e.lang("generate_label")]]),e.showIcon?w((o(),l("a",{key:0,id:"export-report-btn",class:"btn btn-tool",onClick:t[2]||(t[2]=D=>i.exportReport()),href:"javascript:;"},fh)),[[k,e.lang("export")]]):c("",!0),e.showIcon?w((o(),l("a",{key:1,id:"schedule-report",class:"btn btn-tool",onClick:t[3]||(t[3]=D=>i.scheduleList()),href:"javascript:;"},bh)),[[k,e.lang("schedule")]]):c("",!0)])]),a("div",yh,[e.isShowFilter?(o(),v(f,{key:0,id:"filter-box",metaData:e.filterOptions,selectedFields:e.customFields,onSelectedFilters:i.selectedFilters,showCustomFilter:!0,updateFields:i.updateFilterFields,appliedFilters:e.appliedFilters,endPoint:"/custom-field-flattened?category=asset&type=asset&module=filter&filter_id="+e.assetFilterId,saveFilter:!0,filterFor:"asset",filterNum:e.assetFilterId,redirectTo:"/service-desk/assets",deleteUrl:"/service-desk/api/agent/sd-filter/"+e.assetFilterId,closeFilter:i.toggleFilterView,save_endpoint:"/service-desk/api/agent/sd-filter"},{default:y(()=>[g(" > ")]),_:1},8,["metaData","selectedFields","onSelectedFilters","updateFields","appliedFilters","endPoint","filterNum","deleteUrl","closeFilter"])):c("",!0),(o(!0),l(I,null,$(e.columnData,D=>(o(),l("section",{key:D},[m(p,{"table-columns":D.columns,reportId:D.id,columnId:e.newReportId},null,8,["table-columns","reportId","columnId"]),e.columns.length?(o(),v(b,{key:0,"data-url":e.apiUrl,columns:e.visibleColumns,columnsMeta:D.columns,staticColumns:e.staticColumns,show_pagination:e.showPagination,tickets:i.assetsData},null,8,["data-url","columns","columnsMeta","staticColumns","show_pagination","tickets"])):c("",!0)]))),128))])])):c("",!0)])}const us=C(nh,[["render",vh]]),wh={name:"asset-form",props:{category:{type:String,required:!0},panel:{type:String,default:"agent"},showViewButton:{type:Boolean,default:!1}},data(){return{fetchFormFieldApi:"/api/form/render/",formUniqueKey:null,submitFormInProgress:!1,editId:"",selectedForm:"",formSelected:!1}},mixins:[ve],beforeMount(){if(this.mode==="edit"){const e=W(this.currentPath());this.fetchFormFieldApi="service-desk/api/edit-asset/"+e,this.editId=W(this.currentPath()),this.formSelected=!0}else this.getDefaultFormValue()},computed:{mode(){return this.currentPath().indexOf("edit")!==-1?"edit":"create"}},methods:{getDefaultFormValue(){this.showLoader=!0,S.get("/from/forms/"+this.category).then(e=>{this.selectedForm=e.data.data.data[0],this.showLoader=!1,this.updateFetchApi()}).catch(e=>{this.showLoader=!1,A(e,"faveo-form")})},updateFetchApi(){this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey),this.$store.dispatch("unsetValidationError"),this.fetchFormFieldApi="/render/form?id="+this.selectedForm.id+"&mode=render",setTimeout(()=>{this.$store.dispatch("createNewFormInstance",{formUniqueKey:this.formUniqueKey,scenario:this.scenario||this.mode}),this.formSelected=!0},1)},afterSubmit(e){window.emitter.emit("updateAgentSidebar"),this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey);let t=Je(this.category);this.$store.dispatch("createNewFormInstance",{formUniqueKey:t,scenario:this.mode}),this.formUniqueKey=t,this.mode==="create"&&setTimeout(()=>{let s=e.data.data.id;this.$router.push("/service-desk/assets/"+s+"/show")},1e3)}},components:{Alert:ke,CustomLoader:Ne,FormRenderer:we,FaveoBox:Re}},kh={key:0,class:"col-sm-12"},Ch={key:0,class:"pull-right"},Dh=a("span",null,[a("i",{class:"fas fa-eye"})],-1),Sh={key:0,class:"form-group row mt-3"},Fh={class:"col-md-12"},Mh=["disabled"],Ih={key:0},Ah=a("i",{class:"fas fa-sync"},null,-1),Ph=[Ah],Th={key:1},Vh=a("i",{class:"fas fa-save"},null,-1),Lh=[Vh];function Uh(e,t,s,d,n,i){const h=u("Alert"),_=u("CustomLoader"),f=u("router-link"),p=u("FormRenderer"),b=u("ValidationObserver"),k=u("FaveoBox"),D=N("tooltip");return n.formUniqueKey&&n.formSelected?(o(),l("div",kh,[m(k,{title:e.lang(i.mode)},{headerMenu:y(()=>[s.showViewButton?(o(),l("span",Ch,[w((o(),v(f,{to:"/service-desk/assets/"+n.editId+"/show",class:"btn btn-tool has-tooltip"},{default:y(()=>[Dh]),_:1},8,["to"])),[[D,e.trans("view")]])])):c("",!0)]),default:y(()=>[m(h,{componentName:"faveo-form"}),e.showLoader||n.submitFormInProgress?(o(),v(_,{key:0,duration:4e3})):c("",!0),m(b,{ref:"faveoFormObserver"},{default:y(({values:P,errors:E,validate:M})=>[(o(),v(p,{key:n.formUniqueKey,fetchFormFieldApi:n.fetchFormFieldApi,formUniqueKey:n.formUniqueKey,scenario:i.mode,category:s.category,panel:s.panel,selectDependencyId:n.editId},null,8,["fetchFormFieldApi","formUniqueKey","scenario","category","panel","selectDependencyId"])),e.showLoader?c("",!0):(o(),l("div",Sh,[a("div",Fh,[a("button",{type:"button",class:"btn btn-primary pull-right",disabled:n.submitFormInProgress,onClick:t[0]||(t[0]=F=>e.onSubmit())},[i.mode==="edit"?(o(),l("span",Ih,Ph)):(o(),l("span",Th,Lh)),g(" "+r(i.mode==="edit"?e.trans("update"):e.trans("submit")),1)],8,Mh)])]))]),_:1},512)]),_:1},8,["title"])])):c("",!0)}const hs=C(wh,[["render",Uh]]);const $h={name:"asset-description",description:"Asset description Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},description:{type:String,default:""}}},Nh={class:"modal-title"},Eh={id:"log_desc"},qh=["innerHTML"];function Oh(e,t,s,d,n,i){const h=u("modal");return s.showModal?(o(),v(h,{key:0,showModal:s.showModal,onClose:s.onClose},{title:y(()=>[a("h4",Nh,r(e.trans("description")),1)]),fields:y(()=>[a("div",Eh,[a("span",{innerHTML:s.description},null,8,qh)])]),_:1},8,["showModal","onClose"])):c("",!0)}const Zs=C($h,[["render",Oh],["__scopeId","data-v-74397061"]]),jh={name:"asset-associate-modal",description:"Asset Associates Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},assetId:{type:[String,Number],default:""},associate:{type:String,default:""}},data(){return{associated:[],loading:!1,category:""}},beforeMount(){this.category=this.$store.getters.getAssetAssociateCategory},computed:{endPoint(){let e=this.associate=="tickets"?"assets":this.associate=="contracts"?"attachAsset":"attachAssets",t=this.associate=="tickets"?"type_id":"asset_id";return"/service-desk/api/dependency/"+this.associate+"?supplements[relation_name]="+e+"&supplements[attribute_name]="+t+"&supplements[attribute_value]="+this.assetId}},methods:{onChange(e,t){this[t]=e},onSubmit(){this.loading=!0;let e="";this.associate=="tickets"?e="tickets":this.associate=="problems"?e="sd_problem":e="sd_"+this.associate;let t={};var s=[];for(var d in this.associated)s.push(this.associated[d].id);t.type=e,t.type_ids=s,S.post("/service-desk/api/attach-asset-services/"+this.assetId,t).then(n=>{this.loading=!1,this.onClose(),U(n,"asset-view"),window.emitter.emit("updateAssetAssociates");let i=this.associate.replace(/s$/,"");this.category==="activity"?window.emitter.emit("updateAssetActivity"):window.emitter.emit("Asset"+i+"refreshData")}).catch(n=>{this.loading=!1,this.onClose(),A(n,"asset-view")})}},components:{"dynamic-select":G}},Rh={class:"modal-title"},xh={key:0},Bh={class:"row"},Kh={key:1,class:"row"},zh=["disabled"],Hh=a("i",{class:"fas fa-paperclip"},null,-1);function Yh(e,t,s,d,n,i){const h=u("dynamic-select"),_=u("reuse-loader"),f=u("modal");return s.showModal?(o(),v(f,{key:0,showModal:s.showModal,onClose:s.onClose},{title:y(()=>[a("h4",Rh,r(e.trans("attach")+" "+e.trans(s.associate)),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",xh,[a("div",Bh,[m(h,{label:e.trans(s.associate),multiple:!0,name:"associated",prePopulate:!1,classname:"col-sm-12",apiEndpoint:i.endPoint,value:n.associated,onChange:i.onChange,required:!0},null,8,["label","apiEndpoint","value","onChange"])])])),n.loading?(o(),l("div",Kh,[m(_,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=p=>i.onSubmit()),class:"btn btn-primary",disabled:!(n.associated.length>0)},[Hh,g(" "+r(e.trans("attach")),1)],8,zh)]),_:1},8,["showModal","onClose"])):c("",!0)}const Wh=C(jh,[["render",Yh]]),Jh={name:"asset-actions",description:"Asset actions component",props:{asset:{type:Object,default:()=>{}},actionsData:{type:Object,default:()=>{}}},data(){return{showDeleteModal:!1,showAssociateModal:!1,associate:""}},methods:{associateMethod(e){this.showAssociateModal=!0,this.associate=e},onClose(){this.showDeleteModal=!1,this.showAssociateModal=!1}},components:{"delete-modal":De,"asset-associate-modal":Wh}},Gh={class:"card-tools"},Zh={class:"btn-group"},Qh={type:"button",class:"btn btn-tool dropdown-toggle","data-toggle":"dropdown"},Xh=a("i",{class:"fas fa-link"},null,-1),em={class:"dropdown-menu"},tm=a("i",{class:"far fa-circle"},null,-1),sm=a("i",{class:"far fa-circle"},null,-1),am=a("i",{class:"far fa-circle"},null,-1),nm=a("i",{class:"far fa-circle"},null,-1),om=a("i",{class:"far fa-circle"},null,-1),im=a("i",{class:"fas fa-edit"},null,-1),lm=a("i",{class:"fas fa-trash"},null,-1);function rm(e,t,s,d,n,i){const h=u("router-link"),_=u("delete-modal"),f=u("asset-associate-modal");return o(),l("div",Gh,[a("div",Zh,[a("button",Qh,[Xh,g(" "+r(e.trans("associate")),1)]),a("div",em,[a("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[0]||(t[0]=p=>i.associateMethod("tickets"))},[tm,g(" "+r(e.trans("attach_tickets")),1)]),a("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[1]||(t[1]=p=>i.associateMethod("problems"))},[sm,g(" "+r(e.trans("attach_problems")),1)]),a("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[2]||(t[2]=p=>i.associateMethod("changes"))},[am,g(" "+r(e.trans("attach_changes")),1)]),a("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[3]||(t[3]=p=>i.associateMethod("releases"))},[nm,g(" "+r(e.trans("attach_releases")),1)]),a("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[4]||(t[4]=p=>i.associateMethod("contracts"))},[om,g(" "+r(e.trans("attach_contracts")),1)])])]),s.actionsData.edit_asset?(o(),v(h,{key:0,to:"/service-desk/assets/"+s.asset.id+"/edit",class:"btn btn-tool"},{default:y(()=>[im,g(" "+r(e.trans("edit")),1)]),_:1},8,["to"])):c("",!0),s.actionsData.delete_asset?(o(),l("button",{key:1,class:"btn btn-tool",onClick:t[5]||(t[5]=p=>n.showDeleteModal=!0)},[lm,g(" "+r(e.trans("delete")),1)])):c("",!0),m(q,{name:"modal"},{default:y(()=>[n.showDeleteModal?(o(),v(_,{key:0,onClose:i.onClose,showModal:n.showDeleteModal,alertComponentName:"asset-view",deleteUrl:"/service-desk/api/asset-delete/"+s.asset.id,redirectUrl:"/service-desk/assets/list",from:"agent"},null,8,["onClose","showModal","deleteUrl"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showAssociateModal?(o(),v(f,{key:0,onClose:i.onClose,showModal:n.showAssociateModal,assetId:s.asset.id,associate:n.associate},null,8,["onClose","showModal","assetId","associate"])):c("",!0)]),_:1})])}const dm=C(Jh,[["render",rm]]);const cm={name:"asset-details",description:"Asset details Component",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime)}},props:{assetId:{type:[String,Number],required:!0},actionsData:{type:Object,default:{}}},data(){return{purchaseDate:"",purchaseCost:"",depreciationId:0,bookValue:"",currency:"",assetData:"",loading:!0,showDescription:!1,showImage:!1}},beforeMount(){this.getData()},methods:{getData(){S.get("/service-desk/api/asset/"+this.assetId).then(e=>{this.loading=!1,this.assetData=e.data.data,this.depreciationId=e.data.data.depreciation_id,this.currency=e.data.data.currency}).catch(e=>{this.loading=!1})},subString(e,t=15){return oe(e,t)},onClose(){this.showDescription=!1,this.showImage=!1},downloadFile(e){window.open(this.basePath()+"/service-desk/download/"+e+"/sd_assets:"+this.assetData.id+"/attachment")}},components:{AssetImageModal:$a,"asset-description":Zs,"asset-actions":dm}},Qs=e=>(K("data-v-e74bc509"),e=e(),z(),e),um={class:"card card-light"},hm={class:"card-header"},mm={class:"card-title"},_m={class:"card-body"},pm={class:"row"},fm={class:"col-md-12"},gm={class:"callout callout-info bg-info"},bm={class:"row"},ym={class:"col-md-4"},vm={class:"col-md-4"},wm={class:"col-md-4"},km={class:"col-md-12"},Cm={class:"row"},Dm={key:0,class:"col-md-6 d-flex mr-4"},Sm={class:"col-md-6"},Fm={class:"col-md-6"},Mm={key:0},Im=["src"],Am={key:1},Pm={key:1,class:"col-md-6 info-row d-flex"},Tm={class:"col-md-6"},Vm={class:"col-md-6"},Lm={class:"text-primary"},Um={key:2,class:"col-md-6 info-row d-flex"},$m={class:"col-md-6"},Nm={class:"col-md-6"},Em={class:"text-primary"},qm={class:"col-md-6 info-row d-flex"},Om={class:"col-md-6"},jm={class:"col-md-6"},Rm=Qs(()=>a("i",{class:"fas fa-file-code"},"  ",-1)),xm={key:3,class:"col-md-6 info-row d-flex"},Bm={class:"col-md-6"},Km={key:0,class:"col-md-6"},zm={class:"text-primary"},Hm={key:4,class:"col-md-6 info-row d-flex"},Ym={class:"col-md-6"},Wm={key:0,class:"col-md-6"},Jm={class:"text-primary"},Gm={key:5,class:"col-md-6 info-row d-flex"},Zm={class:"col-md-6"},Qm={class:"col-md-6"},Xm={class:"text-primary"},e_={key:6,class:"col-md-6 info-row d-flex"},t_={class:"col-md-6"},s_={class:"col-md-6"},a_={class:"text-primary"},n_={key:7,class:"col-md-6 info-row d-flex"},o_={class:"col-md-6"},i_={class:"col-md-6"},l_={class:"text-primary"},r_={key:8,class:"col-md-6 info-row d-flex"},d_={class:"col-md-6"},c_={class:"col-md-6"},u_={class:"text-primary"},h_={key:9,class:"col-md-6 info-row d-flex"},m_={class:"col-md-6"},__={class:"col-md-6"},p_={class:"text-primary"},f_={key:10,class:"col-md-6 info-row d-flex"},g_={class:"col-md-6"},b_={class:"col-md-6"},y_={class:"text-primary"},v_={key:11,class:"col-md-6 info-row d-flex"},w_={class:"col-md-6"},k_={class:"col-md-6"},C_={class:"text-primary"},D_={key:12,class:"col-md-6 info-row d-flex"},S_={class:"col-md-6"},F_={class:"col-md-6"},M_={class:"text-primary"},I_={key:13,class:"col-md-6 info-row d-flex"},A_={class:"col-md-6"},P_={class:"col-md-6"},T_={class:"text-primary"},V_={key:14,class:"col-md-6 info-row d-flex"},L_={class:"col-md-6"},U_={class:"col-md-6"},$_={class:"text-primary"},N_={key:15,class:"col-md-6 info-row d-flex"},E_={class:"col-md-6"},q_={class:"col-md-6"},O_={class:"text-primary"},j_={class:"col-md-6 info-row d-flex"},R_={class:"col-md-6"},x_={class:"col-md-6"},B_={key:0},K_={onClick:"return false",class:"text-primary"},z_={key:0},H_={key:1,onClick:"return false",class:"text-primary"},Y_={key:17,class:"col-md-6 info-row d-flex",id:"vendor"},W_={class:"col-md-6"},J_={class:"col-md-6"},G_={class:"text-primary"},Z_=Qs(()=>a("hr",null,null,-1)),Q_={key:0,class:"card card-secondary"},X_={class:"card-header"},ep={class:"card-title"},tp={class:"card-body"},sp={class:"col-md-12 asset_row"},ap={class:"row"},np={class:"col-md-6 info-row d-flex"},op={class:"col-md-6"},ip={class:"col-md-6"},lp={key:0},rp={onClick:"return false",class:"text-primary"},dp={key:0},cp={key:1,onClick:"return false",class:"text-primary"},up={key:1,class:"card card-secondary"},hp={class:"card-header"},mp={class:"card-title"},_p={class:"card-body"},pp={class:"col-sm-12 asset_row"},fp={class:"row"},gp={class:"col-md-6 info-row d-flex"},bp={class:"col-md-6"},yp={class:"col-md-6"},vp={key:0},wp={onClick:"return false",class:"text-primary"},kp={key:0},Cp={key:1,onClick:"return false",class:"text-primary"},Dp={key:0,class:"card card-light collapsed-card"},Sp=["onClick"],Fp={class:"card-title"},Mp={class:"card-tools"},Ip={type:"button",class:"btn btn-tool"},Ap={class:"card-body"},Pp={class:"col-md-12 asset_row"},Tp={class:"row"},Vp={class:"col-md-6 info-row d-flex"},Lp={class:"col-md-6"},Up={class:"col-md-6"},$p={key:0},Np={onClick:"return false",class:"text-primary"},Ep={key:0},qp={key:1,onClick:"return false",class:"text-primary"},Op={key:1,class:"card-body",id:"loader_margin"};function jp(e,t,s,d,n,i){const h=u("asset-actions"),_=u("asset-description"),f=u("asset-image-modal"),p=u("reuse-loader"),b=N("tooltip");return o(),l("div",um,[!n.loading&&n.assetData?(o(),l(I,{key:0},[a("div",hm,[w((o(),l("h3",mm,[g(r(i.subString(n.assetData.name,50)),1)])),[[b,n.assetData.name]]),m(h,{asset:n.assetData,actionsData:s.actionsData},null,8,["asset","actionsData"])]),a("div",_m,[a("div",pm,[a("div",fm,[a("div",gm,[a("div",bm,[a("div",ym,[a("b",null,r(e.trans("created_date"))+" : ",1),w((o(),l("span",null,[g(r(d.formattedTime(n.assetData.created_at)),1)])),[[b,d.formattedTime(n.assetData.created_at)]])]),a("div",vm,[a("b",null,r(e.trans("department"))+" : ",1),w((o(),l("span",null,[g(r(n.assetData.department?i.subString(n.assetData.department.name):"---"),1)])),[[b,n.assetData.department?n.assetData.department.name:"---"]])]),a("div",wm,[a("b",null,r(e.trans("asset_type"))+" : ",1),w((o(),l("span",null,[g(r(i.subString(n.assetData.asset_type.name)),1)])),[[b,n.assetData.asset_type.name]])])])])])]),a("div",km,[a("div",Cm,[n.assetData.asset_image?(o(),l("div",Dm,[a("div",Sm,[a("label",null,r(e.trans("asset_image")),1)]),a("div",Fm,[a("a",{href:"javascript:;",onClick:t[0]||(t[0]=k=>n.showImage=!0),class:"text-primary custom-class"},[n.assetData.asset_image?(o(),l("div",Mm,[a("img",{src:n.assetData.asset_image.view_url,class:"asset-image-details"},null,8,Im)])):(o(),l("div",Am,r("---")))])])])):c("",!0),n.assetData.asset_status?(o(),l("div",Pm,[a("div",Tm,[a("label",null,r(e.trans("asset_status")),1)]),a("div",Vm,[w((o(),l("a",Lm,[g(r(n.assetData.asset_status?i.subString(n.assetData.asset_status.name):"---"),1)])),[[b,n.assetData.asset_status?n.assetData.asset_status.name:"---"]])])])):c("",!0),n.assetData.organization?(o(),l("div",Um,[a("div",$m,[a("label",null,r(e.trans("organization")),1)]),a("div",Nm,[w((o(),l("a",Em,[g(r(n.assetData.organization?i.subString(n.assetData.organization.name,20):"---"),1)])),[[b,n.assetData.organization?n.assetData.organization.name:"---"]])])])):c("",!0),a("div",qm,[a("div",Om,[a("label",null,r(e.trans("description")),1)]),a("div",jm,[a("a",{href:"javascript:;",class:"btn btn-info btn-xs",onClick:t[1]||(t[1]=k=>n.showDescription=!0)},[Rm,g(r(e.trans("show_description")),1)])])]),n.assetData.managed_by?(o(),l("div",xm,[a("div",Bm,[a("label",null,r(e.trans("managed_by")),1)]),n.assetData.managed_by?(o(),l("div",Km,[w((o(),l("a",zm,[g(r(n.assetData.managed_by.full_name?i.subString(n.assetData.managed_by.full_name):n.assetData.managed_by.meta_name),1)])),[[b,n.assetData.managed_by.full_name?n.assetData.managed_by.full_name:n.assetData.managed_by.meta_name]])])):c("",!0)])):c("",!0),n.assetData.used_by?(o(),l("div",Hm,[a("div",Ym,[a("label",null,r(e.trans("used_by")),1)]),n.assetData.used_by?(o(),l("div",Wm,[w((o(),l("a",Jm,[g(r(n.assetData.used_by.full_name?i.subString(n.assetData.used_by.full_name):n.assetData.used_by.meta_name),1)])),[[b,n.assetData.used_by.full_name?n.assetData.used_by.full_name:n.assetData.used_by.meta_name]])])):c("",!0)])):c("",!0),n.assetData.identifier?(o(),l("div",Gm,[a("div",Zm,[a("label",null,r(e.trans("identifier")),1)]),a("div",Qm,[w((o(),l("a",Xm,[g(r(n.assetData.identifier?n.assetData.identifier:"---"),1)])),[[b,n.assetData.identifier?n.assetData.identifier:"---"]])])])):c("",!0),n.assetData.assigned_on?(o(),l("div",e_,[a("div",t_,[a("label",null,r(e.trans("assigned_on")),1)]),a("div",s_,[w((o(),l("a",a_,[g(r(n.assetData.assigned_on?n.assetData.assigned_on:"---"),1)])),[[b,n.assetData.assigned_on?n.assetData.assigned_on:"---"]])])])):c("",!0),n.assetData.eol?(o(),l("div",n_,[a("div",o_,[a("label",null,r(e.trans("end-of-life")),1)]),a("div",i_,[w((o(),l("a",l_,[g(r(n.assetData.eol),1)])),[[b,n.assetData.eol]])])])):c("",!0),n.assetData.product?(o(),l("div",r_,[a("div",d_,[a("label",null,r(e.trans("product")),1)]),a("div",c_,[w((o(),l("a",u_,[g(r(n.assetData.product?i.subString(n.assetData.product.name):"---"),1)])),[[b,n.assetData.product?n.assetData.product.name:"---"]])])])):c("",!0),n.assetData.impact_type?(o(),l("div",h_,[a("div",m_,[a("label",null,r(e.trans("impact_type")),1)]),a("div",__,[w((o(),l("a",p_,[g(r(n.assetData.impact_type?i.subString(n.assetData.impact_type.name):"---"),1)])),[[b,n.assetData.impact_type?n.assetData.impact_type.name:"---"]])])])):c("",!0),n.assetData.location?(o(),l("div",f_,[a("div",g_,[a("label",null,r(e.trans("location")),1)]),a("div",b_,[w((o(),l("a",y_,[g(r(n.assetData.location?i.subString(n.assetData.location.name):"---"),1)])),[[b,n.assetData.location?n.assetData.location.name:"---"]])])])):c("",!0),n.assetData.purchase_date?(o(),l("div",v_,[a("div",w_,[a("label",null,r(e.trans("purchase_date")),1)]),a("div",k_,[w((o(),l("a",C_,[g(r(n.assetData.purchase_date?n.assetData.purchase_date:"---"),1)])),[[b,n.assetData.purchase_date?n.assetData.purchase_date:"---"]])])])):c("",!0),n.assetData.purchase_cost?(o(),l("div",D_,[a("div",S_,[a("label",null,r(e.trans("purchase_cost")),1)]),a("div",F_,[w((o(),l("a",M_,[g(r(n.assetData.purchase_cost?n.assetData.purchase_cost+" "+n.currency:"---"),1)])),[[b,n.assetData.purchase_cost?n.assetData.purchase_cost+" "+n.currency:"---"]])])])):c("",!0),n.assetData.book_value?(o(),l("div",I_,[a("div",A_,[a("label",null,r(e.trans("book_value")),1)]),a("div",P_,[w((o(),l("a",T_,[g(r(n.assetData.book_value?n.assetData.book_value+" "+n.currency:"---"),1)])),[[b,n.assetData.book_value?n.assetData.book_value+" "+n.currency:"---"]])])])):c("",!0),n.assetData.salvage?(o(),l("div",V_,[a("div",L_,[a("label",null,r(e.trans("salvage")),1)]),a("div",U_,[w((o(),l("a",$_,[g(r(n.assetData.salvage?n.assetData.salvage+" "+n.currency:"---"),1)])),[[b,n.assetData.salvage?n.assetData.salvage+" "+n.currency:"---"]])])])):c("",!0),n.assetData.depreciation?(o(),l("div",N_,[a("div",E_,[a("label",null,r(e.trans("depreciation")),1)]),a("div",q_,[w((o(),l("a",O_,[g(r(n.assetData.depreciation?n.assetData.depreciation.name:"---"),1)])),[[b,n.assetData.depreciation?n.assetData.depreciation.name:"---"]])])])):c("",!0),n.assetData.custom_field_values&&n.assetData.custom_field_values.length>0?(o(!0),l(I,{key:16},$(n.assetData.custom_field_values,k=>(o(),l("div",j_,[a("div",R_,[a("label",null,r(k.label),1)]),a("div",x_,[Array.isArray(k.value)?(o(),l("div",B_,[(o(!0),l(I,null,$(k.value,(D,P)=>w((o(),l("a",K_,[g(r(i.subString(D)),1),P!=Object.keys(k.value).length-1?(o(),l("span",z_,",")):c("",!0),g("  ")])),[[b,D]])),256))])):w((o(),l("a",H_,[g(r(k.field_type=="date"?k.value:k?i.subString(k.value):"---"),1)])),[[b,k.field_type=="date"?k.value:k.value?k.value.replace(/\r?\n/g,"<br />"):"---"]])])]))),256)):c("",!0),n.assetData.vendor?(o(),l("div",Y_,[a("div",W_,[a("label",null,r(e.trans("vendor")),1)]),a("div",J_,[w((o(),l("a",G_,[g(r(n.assetData.vendor.name),1)])),[[b,n.assetData.vendor.name]])])])):c("",!0)])]),Z_,n.assetData.custom_field_values_for_asset_type&&n.assetData.custom_field_values_for_asset_type.length>0?(o(),l("div",Q_,[a("div",X_,[a("h3",ep,r(n.assetData.asset_type.name+" "+e.trans("properties")),1)]),a("div",tp,[a("div",sp,[a("div",ap,[(o(!0),l(I,null,$(n.assetData.custom_field_values_for_asset_type,k=>(o(),l("div",np,[a("div",op,[a("label",null,r(k.label),1)]),a("div",ip,[Array.isArray(k.value)?(o(),l("div",lp,[(o(!0),l(I,null,$(k.value,(D,P)=>w((o(),l("a",rp,[g(r(i.subString(D)),1),P!=Object.keys(k.value).length-1?(o(),l("span",dp,",")):c("",!0),g("  ")])),[[b,D]])),256))])):w((o(),l("a",cp,[g(r(k.field_type=="date"?k.value:i.subString(k.value)),1)])),[[b,(k.field_type=="date",k.value)]])])]))),256))])])])])):c("",!0),n.assetData.custom_field_values_for_department&&n.assetData.custom_field_values_for_department.length>0?(o(),l("div",up,[a("div",hp,[a("h3",mp,r(n.assetData.department.name+" "+e.trans("properties")),1)]),a("div",_p,[a("div",pp,[a("div",fp,[(o(!0),l(I,null,$(n.assetData.custom_field_values_for_department,k=>(o(),l("div",gp,[a("div",bp,[a("label",null,r(k.label),1)]),a("div",yp,[Array.isArray(k.value)?(o(),l("div",vp,[(o(!0),l(I,null,$(k.value,(D,P)=>w((o(),l("a",wp,[g(r(i.subString(D)),1),P!=Object.keys(k.value).length-1?(o(),l("span",kp,",")):c("",!0),g("  ")])),[[b,D]])),256))])):w((o(),l("a",Cp,[g(r(k.field_type=="date"?k.value:i.subString(k.value)),1)])),[[b,(k.field_type=="date",k.value)]])])]))),256))])])])])):c("",!0),n.assetData.asset_types&&n.assetData.asset_types.length?(o(!0),l(I,{key:2},$(n.assetData.asset_types,(k,D)=>(o(),l(I,{key:D},[k.custom_field_values.length?(o(),l("div",Dp,[a("div",{class:"card-header pointer","data-card-widget":"collapse",onClick:P=>k.collapsed=!k.collapsed},[a("h3",Fp,r(k.name),1),a("div",Mp,[a("button",Ip,[a("i",{class:j(k.collapsed?"fas fa-angle-up":"fas fa-angle-down")},null,2)])])],8,Sp),a("div",Ap,[a("div",Pp,[a("div",Tp,[(o(!0),l(I,null,$(k.custom_field_values,P=>(o(),l("div",Vp,[a("div",Lp,[a("label",null,r(P.label),1)]),a("div",Up,[Array.isArray(P.value)?(o(),l("div",$p,[(o(!0),l(I,null,$(P.value,(E,M)=>w((o(),l("a",Np,[g(r(i.subString(E))+" ",1),M!=Object.keys(P.value).length-1?(o(),l("span",Ep,",")):c("",!0),g("  ")])),[[b,E]])),256))])):w((o(),l("a",qp,[g(r(P.field_type==="date"?P.value:i.subString(P.value)),1)])),[[b,(P.field_type==="date",P.value)]])])]))),256))])])])])):c("",!0)],64))),128)):c("",!0)]),n.showDescription?(o(),v(_,{key:0,onClose:i.onClose,showModal:n.showDescription,description:n.assetData.description},null,8,["onClose","showModal","description"])):c("",!0),n.showImage&&n.assetData.asset_image?(o(),v(f,{key:1,onClose:i.onClose,showModal:n.showImage,imageSrc:n.assetData.asset_image.view_url},null,8,["onClose","showModal","imageSrc"])):c("",!0)],64)):c("",!0),n.loading?(o(),l("div",Op,[m(p,{"animation-duration":4e3,size:60})])):c("",!0)])}const Rp=C(cm,[["render",jp],["__scopeId","data-v-e74bc509"]]);const xp={name:"asset-activity",description:"Asset activity page",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},props:{assetId:{type:[String,Number],default:""}},data(){return{loading:!0,apiUrl:"/service-desk/api/asset-log/"+this.assetId,activity_log:[],perPage:"10",total:0,maxSize:5,pagination:1,paramsObj:{},filtering:!1,sort_key:"desc",refreshActivity:!1}},created(){window.emitter.on("updateAssetActivity",()=>this.refreshActivity=!0)},beforeMount(){this.paramsObj.page=this.pagination,this.getValues(this.paramsObj)},watch:{pagination(e,t){this.filtering=!0;var s=document.getElementById("activity_log_div");return s.scrollIntoView({behavior:"smooth"}),this.paramsObj.page=e,this.getValues(this.paramsObj),e},filtering(e){this.$emit("loaderValue",e)},loading(e){this.$emit("loaderValue",e)},refreshActivity(e,t){e===!0&&this.getUpdateActivity(),this.refreshActivity=!1}},computed:{PerPage:function(){return this.perPage?parseInt(this.perPage):10},Records:function(){return this.total?parseInt(this.total):0}},methods:{getUpdateActivity(){this.pagination=1,this.sort_key="desc",this.perPage=10,this.total=0,this.paramsObj.page=1,this.paramsObj.limit=10,this.paramsObj["sort-order"]="desc",this.getValues(this.paramsObj)},commonFilter(){this.filtering=!0,this.pagination=1,this.paramsObj.page=1,this.getValues(this.paramsObj)},logLimit(e){this.paramsObj.limit=e,this.commonFilter()},orderBy(e){this.sort_key=e,this.paramsObj["sort-order"]=e,this.commonFilter()},getValues(e){S.get(this.apiUrl,{params:e}).then(t=>{this.loading=!1,this.filtering=!1,this.activity_log=t.data.data.asset_activity_logs.data,this.activity_log.forEach(function(s,d){s.name="<div>"+s.name+"</div>"}),this.total=t.data.data.asset_activity_logs.total,this.perPage=t.data.data.asset_activity_logs.per_page}).catch(t=>{this.loading=!1,this.filtering=!1})},checkDate(e){let t="",s="";return e&&(t=this.formattedDate(this.activity_log[e-1].created_at),s=this.formattedDate(this.activity_log[e].created_at)),!e||t!=s},showThreadEnd(e){return e===this.activity_log.length-1}},components:{"activity-parser":xe}},Se=e=>(K("data-v-86fb54f0"),e=e(),z(),e),Bp={class:"row",id:"activity_log_div"},Kp={class:"col-sm-12 mb-2"},zp={key:0,id:"select_limit"},Hp=Se(()=>a("option",{value:"10"},"10",-1)),Yp=Se(()=>a("option",{value:"25"},"25",-1)),Wp=Se(()=>a("option",{value:"50"},"50",-1)),Jp=Se(()=>a("option",{value:"100"},"100",-1)),Gp=[Hp,Yp,Wp,Jp],Zp={key:1,id:"choose_order"},Qp={id:"sort_btn",type:"button","data-toggle":"dropdown",class:"btn btn-default dropdown-toggle"},Xp={class:"dropdown-menu",style:{"z-index":"9999"}},ef=Se(()=>a("i",{class:"fas fa-sort-amount-up"},null,-1)),tf=Se(()=>a("i",{class:"fas fa-sort-amount-down"},null,-1)),sf={key:2,id:"page_div"},af={class:"col-md-12"},nf={key:0,class:"timeline"},of={key:0,class:"time-label"},lf={class:"bg-default border"},rf={class:"asset-activity"},df=Se(()=>a("i",{class:"far fa-dot-circle"},null,-1)),cf={class:"timeline-item"},uf={class:"time"},hf=Se(()=>a("i",{class:"far fa-clock"},null,-1)),mf={key:0,class:"timeline-header"},_f={class:"timeline-body break"},pf={key:1},ff=Se(()=>a("i",{class:"far fa-clock bg-gray"},null,-1)),gf=[ff],bf={key:1,class:"float-right",id:"page_div"},yf={key:0,class:"col-sm-12"},vf={class:"text-center"};function wf(e,t,s,d,n,i){const h=u("uib-pagination"),_=u("faveo-image-element"),f=u("router-link"),p=u("activity-parser");return o(),l("div",Bp,[a("div",Kp,[!n.loading&&n.activity_log.length>0?(o(),l("div",zp,[w(a("select",{class:"form-control cursor-pointer","onUpdate:modelValue":t[0]||(t[0]=b=>n.perPage=b),onChange:t[1]||(t[1]=b=>i.logLimit(n.perPage))},Gp,544),[[qe,n.perPage]])])):c("",!0),!n.loading&&n.activity_log.length>0?(o(),l("div",Zp,[a("button",Qp,r(e.lang("created_time"))+" - "+r(e.lang(n.sort_key)),1),a("div",Xp,[a("a",{href:"javascript:;",class:"dropdown-item",onClick:t[2]||(t[2]=b=>i.orderBy("asc"))},[ef,g(" "+r(e.lang("asc")),1)]),a("a",{href:"javascript:;",onClick:t[3]||(t[3]=b=>i.orderBy("desc")),class:"dropdown-item"},[tf,g(" "+r(e.lang("desc")),1)])])])):c("",!0),!n.loading&&n.total>10?(o(),l("div",sf,[m(h,{id:"page2",records:i.Records,modelValue:n.pagination,"onUpdate:modelValue":t[4]||(t[4]=b=>n.pagination=b),class:"pagination","boundary-links":!1,"per-page":i.PerPage,options:{chunk:n.maxSize,chunksNavigation:"scroll"}},null,8,["records","modelValue","per-page","options"])])):c("",!0)]),a("div",af,[!n.loading&&n.activity_log.length>0?(o(),l("div",nf,[(o(!0),l(I,null,$(n.activity_log,(b,k)=>(o(),l(I,null,[i.checkDate(k)?(o(),l("div",of,[a("span",lf,r(d.formattedDate(b.created_at)),1)])):c("",!0),a("div",rf,[df,a("div",cf,[a("span",uf,[hf,g(" "+r(d.formattedTime(b.created_at)),1)]),b.creator?(o(),l("h3",mf,[m(_,{id:"asset_img","source-url":b.creator.profile_pic,classes:["img-circle","img-bordered-sm"],"alternative-text":"User Image","img-width":25,"img-height":25},null,8,["source-url"]),m(f,{to:"/user/"+b.creator.id},{default:y(()=>[g(" "+r(b.creator.full_name),1)]),_:2},1032,["to"])])):c("",!0),a("div",_f,[m(p,{data:b.name},null,8,["data"])])])]),i.showThreadEnd(k)?(o(),l("div",pf,gf)):c("",!0)],64))),256))])):c("",!0),!n.loading&&n.total>10?(o(),l("div",bf,[m(h,{id:"page2",records:i.Records,modelValue:n.pagination,"onUpdate:modelValue":t[5]||(t[5]=b=>n.pagination=b),class:"pagination","boundary-links":!1,"per-page":i.PerPage,options:{chunk:n.maxSize,chunksNavigation:"scroll"}},null,8,["records","modelValue","per-page","options"])])):c("",!0)]),!n.filtering&&!n.loading&&n.activity_log.length===0?(o(),l("div",yf,[a("h6",vf,r(e.lang("no_data_found")),1)])):c("",!0)])}const kf=C(xp,[["render",wf],["__scopeId","data-v-86fb54f0"]]),Cf={name:"asset-associate-detach",description:"Asset Associate Detach Modal component",props:{showModal:{type:Boolean,default:!1},assetId:{type:[String,Number],default:""},associateId:{type:[String,Number],default:""},category:{type:String,default:""},onClose:{type:Function},compName:{type:String,default:""}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1}},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0;let e="";this.category=="ticket"?e="tickets":this.category=="problem"?e="sd_problem":e="sd_"+this.category+"s";const t={type:e,type_ids:this.associateId};S.delete("/service-desk/api/detach-asset-services/"+this.assetId,{data:t}).then(s=>{U(s,"asset-view"),window.emitter.emit(this.compName+"refreshData"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(s=>{this.loading=!1,this.isDisabled=!1,this.onClose(),A(s,"asset-view")})}}},Df={class:"modal-title"},Sf={key:0},Ff={key:1,class:"row"},Mf=["disabled"],If=a("i",{class:"fas fa-unlink"},null,-1);function Af(e,t,s,d,n,i){const h=u("reuse-loader"),_=u("modal");return s.showModal?(o(),v(_,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{title:y(()=>[a("h4",Df,r(e.trans("detach")),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",Sf,[a("span",null,r(e.trans("are_you_sure")),1)])),n.loading?(o(),l("div",Ff,[m(h,{"animation-duration":4e3,color:"#1d78ff",size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=f=>i.onSubmit()),class:"btn btn-danger",disabled:n.isDisabled},[If,g(" "+r(e.trans("detach")),1)],8,Mf)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const Pf=C(Cf,[["render",Af]]);const Tf={name:"asset-associate-table",description:"Asset associates table page",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime)}},props:{assetId:{type:[String,Number],default:""},category:{type:String,default:""},componentTitle:{type:String,default:""},columns:{type:Array,default:()=>[]},sortable:{type:Array,default:()=>[]},filterable:{type:Array,default:()=>[]},disableLoader:{type:Boolean,default:!1}},data(){return{options:{},showModal:!1,associateId:"",totalCount:"",searchTerm:""}},computed:{apiEndPoint(){let e=this.category=="ticket"?"asset-ids[]=":"asset_ids[]=";return"/service-desk/api/"+this.category+"-list?"+e+this.assetId}},beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},headings:{title:this.lang("subject"),status_type_id:this.lang("status"),assignedTo:this.lang("assigned_to"),identifier:this.lang("identifier"),subject:this.lang("subject"),requester:this.lang("requester"),priority:this.lang("priority"),department:this.lang("department"),status:this.lang("status"),planned_start_date:this.lang("planned_start_date"),planned_end_date:this.lang("planned_end_date"),action:this.lang("action"),ticket_number:this.lang("ticket_number"),release_type:this.lang("release_type"),created_at:this.lang("created_at"),expiry:this.lang("expiry"),contract_status:this.lang("contract_status"),contract_renewal_status:this.lang("contract_renewal_status"),vendor:this.lang("vendor"),contract_type:this.lang("contract_type"),assigned:this.lang("assigned"),name:this.lang("name"),managed_by:this.lang("managed_by"),used_by:this.lang("used_by"),contract:this.lang("contract"),id:"Id",cost:this.lang("cost"),expiration:this.lang("expiration"),license_key:this.lang("license_key")},texts:{filter:"",limit:""},templates:{subject:function(t,s){let d=e.category=="problem"?"problem":e.category+"s";return e.h(se,{to:"/service-desk/"+d+"/"+s.id+"/show"},s.subject)},name:function(t,s){return e.h(se,{to:"/service-desk/contracts/"+s.id+"/show"},s.name)},requester:function(t,s){var d,n;return s.requester?e.h(se,{to:"/user/"+s.requester.id},((n=(d=s.requester)==null?void 0:d.full_name)==null?void 0:n.replace(/<[^>]+>/g,""))??s.requester.email):"---"},department:function(t,s){var d,n;return s.department?e.h("a",{href:e.basePath()+"/department/"+s.department.id,target:"_blank"},(n=(d=s.department)==null?void 0:d.name)==null?void 0:n.replace(/<[^>]+>/g,"")):"---"},status:function(t,s){return s.status?e.h("span",{},[e.h("i",{class:s.status.icon_class,style:{color:s.status.icon_color,marginRight:"5px"}})],s.status.name):"---"},priority(t,s){return s.priority?s.priority.name?s.priority.name:s.priority.priority:"---"},planned_start_date(t,s){return s.planned_start_date&&s.planned_start_date!="0000-00-00 00:00:00"?e.formattedTime(s.planned_start_date):"---"},planned_end_date(t,s){return s.planned_end_date&&s.planned_end_date!="0000-00-00 00:00:00"?e.formattedTime(s.planned_end_date):"---"},status_type_id:function(t,s){return s.status?e.h("span",{},[e.h("i",{class:s.status.icon_class,style:{color:s.status.icon_color,marginRight:"5px"}})],s.status.name):"---"},assignedTo:function(t,s){var d,n;return s.assignedTo?e.h(se,{to:"/user/"+s.assignedTo.id},((n=(d=s.assignedTo)==null?void 0:d.full_name)==null?void 0:n.replace(/<[^>]+>/g,""))??s.assignedTo.email):"--"},release_type(t,s){return s.release_type?s.release_type.name:"---"},created_at(t,s){return e.formattedTime(s.created_at)},expiry(t,s){return s.expiry&&s.expiry.title?e.h("span",{title:s.expiry.timestamp?e.formattedTime(s.expiry.timestamp):""},s.expiry.title):"---"},contract_status:function(t,s){return s.contract_status?e.h("span",{},[e.h("i",{class:s.contract_status.icon_class,style:{color:s.contract_status.icon_color,marginRight:"5px"}})],s.contract_status.name):"---"},contract_renewal_status(t,s){return s.contract_renewal_status?ae(s.contract_renewal_status.name):"---"},vendor(t,s){return s.vendor?e.h("a",{href:e.basePath()+"/service-desk/vendor/"+s.id+"/show"},s.vendor.name):"---"},contract_type(t,s){return s.contract_type?s.contract_type.name:"---"},title:function(t,s){return e.h(se,{to:"/thread/"+s.id},s.title)},ticket_number:function(t,s){return e.h(se,{to:"/thread/"+s.id},"#"+s.ticket_number)},assigned(t,s){return s.assigned?s.assigned.full_name:"---"},action(t,s){let d=e.h("i",{class:"fa fa-unlink"});return e.h("a",{class:"btn btn-primary",title:this.trans("detach"),href:"javascript:;",onClick(){e.onDetach(s.id)}},[d])},identifier:function(t,s){let d=e.category=="problem"?"problem":e.category+"s";return e.h(se,{to:"/service-desk/"+d+"/"+s.id+"/show"},s.identifier)}},sortable:e.sortable,filterable:e.filterable,pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return e.searchTerm=t.query.trim(),{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return e.totalCount=t.data.total,{data:t.data[e.category+"s"],count:e.totalCount}}}},methods:{onDetach(e){this.associateId=e,this.showModal=!0},onClose(){this.showModal=!1},handelLoader(e){this.$emit("loaderValue",e)}},watch:{totalCount(e){!this.searchTerm&&e===0&&(window.emitter.emit("updateAssetTables"),window.emitter.emit("updateAssetAssociates"))},searchTerm(e){this.searchTerm=e}},components:{"asset-associate-detach":Pf}},Vf={id:"asset_associates"};function Lf(e,t,s,d,n,i){const h=u("data-table"),_=u("asset-associate-detach");return o(),l("div",Vf,[m(h,{url:i.apiEndPoint,dataColumns:s.columns,option:n.options,scroll_to:"asset-associates",componentTitle:s.componentTitle,onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","componentTitle","onLoaderState","disableLoader"]),m(q,{name:"modal"},{default:y(()=>[n.showModal?(o(),v(_,{key:0,onClose:i.onClose,showModal:n.showModal,associateId:n.associateId,assetId:s.assetId,category:s.category,compName:s.componentTitle},null,8,["onClose","showModal","associateId","assetId","category","compName"])):c("",!0)]),_:1})])}const Uf=C(Tf,[["render",Lf]]);function $f(e){const{assets:t,forward_relation:s,inverse_relation:d}=e;let n={assets:[t,"isRequired"]},i,h;i=Nf(s,d);const f=new ce(ae).validate(n);return h=f.errors,i=i&&f.isValid,ie.dispatch("setValidationError",h),{errors:h,isValid:i}}function Nf(e,t){let s=0;if(!e&&!t){let d=ae("atleast_one_frelation_is_required_to_create_relationship");s++,ie.dispatch("setAlert",{type:"danger",message:d,component_name:"asset-relation-modal"})}return!(s>0)}const Ef={name:"asset-relation-modal",description:"Asset Relation Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},assetId:{type:[String,Number],default:""},pivotId:{type:[String,Number],default:""},onComplete:{type:Function,default:()=>{}},parentValue:{type:[String,Number],default:""}},data(){return{inverse_relation:"",forward_relation:"",assets:[],loading:!1}},computed:{endPoint(){return"/service-desk/api/dependency/assets?supplements[asset_id]="+(this.parentValue?this.parentValue:this.assetId)}},methods:{onChange(e,t){this[t]=e,this.forward_relation=this.inverse_relation?"":this.forward_relation,this.inverse_relation=this.forward_relation?"":this.inverse_relation},isValid(){const{errors:e,isValid:t}=$f(this.$data);return t},onSubmit(){if(this.isValid()){this.loading=!0;let e=[];for(let s in this.assets)e.push(this.assets[s].id);const t={};t.relation=this.forward_relation?"forward":"inverse",t.child_asset_ids=e,t.parent_asset_id=this.parentValue?this.parentValue:this.assetId,t.cmdb_id=this.forward_relation?this.forward_relation.id:this.inverse_relation.id,S.post("/service-desk/api/make-cmdb",t).then(s=>{this.loading=!1,this.onClose(),this.onComplete(),U(s,"assetAssociates")}).catch(s=>{this.loading=!1,A(s,"asset-relation-modal")})}}},components:{"dynamic-select":G}},qf={class:"modal-title"},Of={key:0},jf={class:"row"},Rf={key:1,class:"row"},xf=["disabled"],Bf=a("i",{class:"fas fa-paperclip"},null,-1);function Kf(e,t,s,d,n,i){const h=u("alert"),_=u("dynamic-select"),f=u("reuse-loader"),p=u("modal");return s.showModal?(o(),v(p,{key:0,showModal:s.showModal,onClose:s.onClose},{title:y(()=>[a("h4",qf,r(e.trans("add_relationship")),1)]),alert:y(()=>[m(h,{componentName:"asset-relation-modal"})]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",Of,[a("div",jf,[n.inverse_relation?c("",!0):(o(),v(_,{key:0,label:e.trans("forward_relation"),multiple:!1,name:"forward_relation",prePopulate:!1,classname:n.forward_relation?"col-sm-6":"col-sm-4",apiEndpoint:"/service-desk/api/dependency/forward_relations",value:n.forward_relation,onChange:i.onChange,required:!0},null,8,["label","classname","value","onChange"])),n.forward_relation?c("",!0):(o(),v(_,{key:1,label:e.trans("inverse_relation"),multiple:!1,name:"inverse_relation",prePopulate:!1,classname:n.inverse_relation?"col-sm-6":"col-sm-4",apiEndpoint:"/service-desk/api/dependency/inverse_relations",value:n.inverse_relation,onChange:i.onChange,required:!0},null,8,["label","classname","value","onChange"])),m(_,{name:"assets",apiEndpoint:i.endPoint,label:e.trans("assets"),value:n.assets,required:!0,classname:!n.forward_relation&&!n.inverse_relation?"col-sm-4":"col-sm-6",multiple:!0,onChange:i.onChange,strlength:30},null,8,["apiEndpoint","label","value","classname","onChange"])])])),n.loading?(o(),l("div",Rf,[m(f,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=b=>i.onSubmit()),class:"btn btn-primary",disabled:n.loading},[Bf,g(" "+r(e.trans("attach")),1)],8,xf)]),_:1},8,["showModal","onClose"])):c("",!0)}const Xs=C(Ef,[["render",Kf]]);const zf={name:"map-view",description:"Map View Representation",props:{assetId:{type:[String,Number],default:""},gridArr:{type:[String,Object],default:()=>{}},onComplete:{type:Function,default:()=>{}}},data(){return{showModal:!1,paramsObj:{},parentId:"",pivotId:"",dialog:void 0,nodes:[],links:[],nodeSize:15,canvas:!1}},beforeMount(){this.updateData()},computed:{options(){return{force:6e3,nodeSize:this.nodeSize,nodeLabels:!0,linkLabels:!0,canvas:this.canvas,linkWidth:2,strLinks:!1}},dialogStyle(){let{dialog:e}=this,t={};if(e){let{x:s,y:d}=e;t.left=`${s+35}px`,t.top=`${d+95}px`}return t}},methods:{updateData(){for(let e in this.gridArr.nodes)this.gridArr.nodes[e].id==this.assetId&&(this.gridArr.nodes[e]._size=25,this.gridArr.nodes[e]._labelClass="text-bold");this.nodes=this.gridArr.nodes;for(let e in this.gridArr.edges)this.gridArr.edges[e].sid=this.gridArr.edges[e].parent_asset_id,this.gridArr.edges[e].tid=this.gridArr.edges[e].child_asset_id,this.gridArr.edges[e].name=this.gridArr.edges[e].relation_name;this.links=this.gridArr.edges},lcb(e){return e._svgAttrs={"marker-end":"url(#m-end)"},e},showDialog(e,t){this.dialog=Object.assign({},t)},addNode(e){this.parentId=e.id,this.showModal=!0,this.dialog=void 0},onClose(){this.showModal=!1,this.showDeleteModal=!1},onDone(){this.onComplete()}},components:{D3Network:Da,"asset-relation-modal":Xs}},Hf={class:"grid-view-rel"},Yf={key:0,class:"container tree-container"},Wf={class:"btn-group"},Jf=a("i",{class:"fas fa-plus"},null,-1),Gf=[Jf],Zf=a("i",{class:"fas fa-eye"},null,-1),Qf=a("svg",null,[a("defs",null,[a("marker",{id:"m-end",markerWidth:"10",markerHeight:"10",refX:"14",refY:"3",orient:"auto",markerUnits:"userSpaceOnUse"},[a("path",{d:"M0,0 L0,6 L9,3 z"})])])],-1);function Xf(e,t,s,d,n,i){const h=u("router-link"),_=u("d3-network"),f=u("asset-relation-modal"),p=N("tooltip");return o(),l("div",Hf,[s.gridArr?(o(),l("div",Yf,[n.dialog?(o(),l("div",{key:0,class:"dialog",style:Ue(i.dialogStyle)},[a("div",Wf,[w((o(),l("button",{class:"btn btn-outline-primary",onClick:t[0]||(t[0]=b=>i.addNode(n.dialog))},Gf)),[[p,e.trans("add_relationship")]]),w((o(),v(h,{class:"btn btn-outline-info",to:"/service-desk/assets/"+n.dialog.id+"/show",target:"_blank"},{default:y(()=>[Zf]),_:1},8,["to"])),[[p,e.trans("view_asset")]])]),w(a("span",{class:"fas fa-times-circle pointer absolute",onClick:t[1]||(t[1]=()=>n.dialog=void 0)},null,512),[[p,e.trans("close")]])],4)):c("",!0),m(_,{ref:"net","net-nodes":n.nodes,"net-links":n.links,options:i.options,"link-cb":i.lcb,onNodeClick:i.showDialog},null,8,["net-nodes","net-links","options","link-cb","onNodeClick"]),Qf])):c("",!0),m(q,{name:"modal"},{default:y(()=>[n.showModal?(o(),v(f,{key:0,onClose:i.onClose,showModal:n.showModal,parentValue:n.parentId,assetId:s.assetId,onComplete:i.onDone},null,8,["onClose","showModal","parentValue","assetId","onComplete"])):c("",!0)]),_:1})])}const eg=C(zf,[["render",Xf]]),tg={name:"delete-relation-modal",description:"Delete Relation Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},onDone:{type:Function,default:()=>{}},params:{type:Object,default:()=>{}}},data:()=>({containerStyle:{width:"500px"},loading:!1}),methods:{onSubmit(){this.loading=!0,S.delete("/service-desk/api/remove-cmdb",{data:this.params}).then(e=>{U(e,"assetAssociates"),this.onDone(),this.onClose()}).catch(e=>{A(e,"assetAssociates"),this.onClose()})}}},sg={class:"modal_title"},ag={key:0},ng={key:1,class:"row"},og=["disabled"],ig=a("i",{class:"fas fa-trash","aria-hidden":"true"},null,-1);function lg(e,t,s,d,n,i){const h=u("reuse-loader"),_=u("modal");return s.showModal?(o(),v(_,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:e.containerStyle},{title:y(()=>[a("h4",sg,r(e.trans("delete_relationship")),1)]),fields:y(()=>[e.loading?c("",!0):(o(),l("div",ag,[a("span",null,r(e.trans("are_you_sure")),1)])),e.loading?(o(),l("div",ng,[m(h,{"animation-duration":4e3,color:"#1d78ff",size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=f=>i.onSubmit()),class:"btn btn-danger",disabled:e.loading},[ig,g(" "+r(e.trans("delete")),1)],8,og)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const rg=C(tg,[["render",lg]]),dg={name:"list-view-relation",props:{assetId:{type:[String,Number],default:""},listArr:{type:[String,Object],default:()=>{}},onComplete:{type:Function,default:()=>{}}},data(){return{showModal:!1,paramsObj:{}}},methods:{deleteRelation(e,t,s){let d=[];d.push(t),this.paramsObj.child_asset_ids=d,this.paramsObj.parent_asset_id=this.assetId,this.paramsObj.cmdb_id=e,this.paramsObj.relation=s,this.showModal=!0},onClose(){this.showModal=!1},onDone(){this.onComplete()}},components:{"delete-relation-modal":rg}},cg={key:0},ug={class:"table table-bordered text-sm"},hg={style:{width:"40%"}},mg={style:{width:"50%"}},_g=["rowspan"],pg=["onClick"],fg=a("i",{class:"fas fa-trash"},null,-1),gg=[fg],bg=["onClick"],yg=a("i",{class:"fas fa-trash"},null,-1),vg=[yg];function wg(e,t,s,d,n,i){const h=u("router-link"),_=u("delete-relation-modal");return s.listArr.length?(o(),l("div",cg,[a("table",ug,[a("thead",null,[a("tr",null,[a("th",hg,r(e.trans("dependency")),1),a("th",mg,r(e.trans("asset")),1),a("th",null,r(e.trans("action")),1)])]),a("tbody",null,[(o(!0),l(I,null,$(s.listArr,f=>(o(),l(I,null,[a("tr",null,[a("td",{rowspan:f.child_assets.length},r(f.child_assets[0].pivot.relation=="forward"?f.forward_relation_name:f.inverse_relation_name),9,_g),a("td",null,[m(h,{to:"/service-desk/assets/"+f.child_assets[0].id+"/show",target:"_blank"},{default:y(()=>[g(r(f.child_assets[0].name),1)]),_:2},1032,["to"])]),a("td",null,[a("button",{type:"button",class:"btn btn-default table_btn btn-sm",onClick:p=>i.deleteRelation(f.id,f.child_assets[0].id,f.child_assets[0].pivot.relation)},gg,8,pg)])]),(o(!0),l(I,null,$(f.child_assets.slice(1),p=>(o(),l("tr",null,[a("td",null,[m(h,{to:"/service-desk/assets/"+p.id+"/show",target:"_blank"},{default:y(()=>[g(r(p.name),1)]),_:2},1032,["to"])]),a("td",null,[a("button",{type:"button",class:"btn btn-default table_btn btn-sm",onClick:b=>i.deleteRelation(f.id,p.id,p.pivot.relation)},vg,8,bg)])]))),256))],64))),256))]),m(q,{name:"modal"},{default:y(()=>[n.showModal?(o(),v(_,{key:0,onClose:i.onClose,showModal:n.showModal,onDone:i.onDone,params:n.paramsObj},null,8,["onClose","showModal","onDone","params"])):c("",!0)]),_:1})])])):c("",!0)}const kg=C(dg,[["render",wg]]);const Cg={name:"asset-relation",description:"Asset relation page",props:{assetId:{type:[String,Number],default:""}},data(){return{showModal:!1,assetPopulated:!1,view_mode:"list",loading:!0,nodeConfig:[],treeConfig:[]}},beforeMount(){this.getCMDBDataByAssestId()},methods:{getCMDBDataByAssestId(){Promise.all([this.loadList(),this.loadGrid()]).then(e=>{[this.nodeConfig,this.treeConfig]=e,this.assetPopulated=!0,this.loading=!1}).catch(function(e){this.loading=!1,A(e,"assetAssociates")})},loadList(){return S.get("/service-desk/api/cmdb-asset-table/"+this.assetId).then(e=>e.data.data.cmdb_data)},loadGrid(){return S.get("/service-desk/api/cmdb-asset/"+this.assetId).then(e=>e.data.data)},onClose(){this.showModal=!1,this.$store.dispatch("unsetValidationError")},onComplete(){this.loading=!0,this.getCMDBDataByAssestId()}},watch:{loading(e){this.$emit("loaderValue",e)}},components:{"list-view":kg,"grid-view":eg,"asset-relation-modal":Xs,"radio-button":Ee}},Ke=e=>(K("data-v-13a8b555"),e=e(),z(),e),Dg={class:"asset-relation"},Sg={key:0},Fg={class:"card-header border-0"},Mg={class:"card-tools m-0 pb-0 pt-0"},Ig={class:"btn-group btn-group-toggle"},Ag=Ke(()=>a("span",{class:"hidden"},".",-1)),Pg=Ke(()=>a("i",{class:"fas fa-list"},null,-1)),Tg=Ke(()=>a("span",{class:"hidden"},".",-1)),Vg=Ke(()=>a("span",{class:"hidden"},".",-1)),Lg=Ke(()=>a("i",{class:"fas fa-sitemap"},null,-1)),Ug=Ke(()=>a("span",{class:"hidden"},".",-1)),$g=Ke(()=>a("i",{class:"glyphicon glyphicon-plus"},null,-1)),Ng={class:"card-body"},Eg={key:1},qg={class:"text-center"};function Og(e,t,s,d,n,i){const h=u("list-view"),_=u("grid-view"),f=u("asset-relation-modal"),p=N("tooltip");return o(),l("div",Dg,[n.assetPopulated&&!n.loading?(o(),l(I,{key:0},[n.nodeConfig.length?(o(),l("div",Sg,[a("div",Fg,[a("div",Mg,[a("div",Ig,[w((o(),l("label",{class:j(["btn btn-sm",{"btn-primary active":n.view_mode=="list","bg-view":n.view_mode=="map"}])},[w(a("input",{type:"radio",value:"list","onUpdate:modelValue":t[0]||(t[0]=b=>n.view_mode=b)},null,512),[[ns,n.view_mode]]),Ag,Pg,g(),Tg],2)),[[p,e.trans("list_view")]]),w((o(),l("label",{class:j(["btn btn-sm",{"btn-primary active":n.view_mode=="map","bg-view":n.view_mode=="list"}])},[w(a("input",{type:"radio",value:"map","onUpdate:modelValue":t[1]||(t[1]=b=>n.view_mode=b)},null,512),[[ns,n.view_mode]]),Vg,g(),Lg,g(),Ug],2)),[[p,e.trans("map_view")]])]),a("button",{class:"btn btn-primary btn-sm",onClick:t[2]||(t[2]=b=>n.showModal=!0)},[$g,g(" "+r(e.trans("add_relationship")),1)])])]),a("div",Ng,[n.view_mode=="list"?(o(),v(h,{key:0,assetId:s.assetId,listArr:n.nodeConfig,onComplete:i.onComplete},null,8,["assetId","listArr","onComplete"])):c("",!0),n.view_mode=="map"?(o(),v(_,{key:1,assetId:s.assetId,gridArr:n.treeConfig,onComplete:i.onComplete},null,8,["assetId","gridArr","onComplete"])):c("",!0)])])):c("",!0),n.nodeConfig.length?c("",!0):(o(),l("div",Eg,[a("p",qg,[g(r(e.trans("no_relationships_available"))+" ",1),a("a",{href:"javascript:;",onClick:t[3]||(t[3]=b=>n.showModal=!0)},r(e.trans("add_new")),1)])]))],64)):c("",!0),m(q,{name:"modal"},{default:y(()=>[n.showModal?(o(),v(f,{key:0,onClose:i.onClose,showModal:n.showModal,assetId:s.assetId,onComplete:i.onComplete},null,8,["onClose","showModal","assetId","onComplete"])):c("",!0)]),_:1})])}const jg=C(Cg,[["render",Og],["__scopeId","data-v-13a8b555"]]);const Rg={name:"attachment-list",description:"Attachment List",props:{assetId:{type:[String,Number],default:""},disableLoader:{type:Boolean,default:!1}},setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},data(){return{apiUrl:`service-desk/api/attachment-list/${this.assetId}`,columns:["name","size","type","created_at","action"],options:{},selectedFile:null,tableKey:0}},beforeMount(){const e=this;this.options={headings:{size:this.lang("size"),name:this.lang("attachment_name"),type:this.lang("type"),created_at:this.lang("created_at"),action:this.lang("actions")},sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},columnsClasses:{owner:"attachment-owner",size:"attachment-size",value:"attachment-value",type:"attachment-type",created_at:"attachment-created",action:"attachment-action"},texts:{filter:"",limit:""},templates:{created_at(t,s){return e.formattedTime(s.created_at)},action:(t,s)=>{const{view_url:d,...n}=s;return n.client_view_url=s.view_url,e.h(_e,{data:n})}},sortable:["owner","size","name","type","created_at"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-by":t.orderBy,order:t.ascending?"asc":"desc","search-query":t.query.trim(),id:this.assetId,page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.data.map(d=>(d.delete_url=`service-desk/api/asset/attachment-delete/${d.id}`,d)),count:t.data.total}}}},mounted(){this.$refs.uploadModal.addEventListener("hidden.bs.modal",()=>{this.selectedFile=null})},methods:{openUploadModal(){this.$refs.uploadModal.classList.add("show"),this.$refs.uploadModal.style.display="block"},closeUploadModal(){this.$refs.uploadModal.classList.remove("show"),this.$refs.uploadModal.style.display="none",this.selectedFile=null,this.$refs.fileInput.value=""},handleFileUpload(e){this.selectedFiles=Array.from(e.target.files)},uploadFile(){if(this.selectedFiles.length>0){const e=new FormData;for(let t=0;t<this.selectedFiles.length;t++)e.append("attachments[]",this.selectedFiles[t]);S.post(`service-desk/api/attach-asset-attachment/${this.assetId}`,e,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{U(t,"asset-view"),console.log("Files uploaded successfully"),this.closeUploadModal(),this.selectedFiles=[],this.$refs.fileInput.value="",this.tableKey++}).catch(t=>{A(t,"attachmentModal"),console.error("Error uploading files",t)})}},handelLoader(e){this.$emit("loaderValue",e)}},components:{DataTableActions:_e}},xt=e=>(K("data-v-27653984"),e=e(),z(),e),xg={id:"org-list",class:"col-sm-12"},Bg={class:"card card-light"},Kg={class:"card-header"},zg={class:"card-title"},Hg={class:"card-body",id:"my_attachments"},Yg={class:"modal fade",ref:"uploadModal",id:"uploadModal",tabindex:"-1",role:"dialog","aria-labelledby":"uploadModalLabel","aria-hidden":"true"},Wg={class:"modal-dialog pt-4",role:"document"},Jg={class:"modal-content box-modal"},Gg={class:"modal-header"},Zg={class:"modal-title",id:"uploadModalLabel"},Qg=xt(()=>a("span",{"aria-hidden":"true"},"×",-1)),Xg=[Qg],eb={class:"modal-body"},tb={class:"modal-footer"},sb=xt(()=>a("br",null,null,-1)),ab=xt(()=>a("br",null,null,-1));function nb(e,t,s,d,n,i){const h=u("alert"),_=u("data-table");return o(),l("div",xg,[m(h,{componentName:"dataTableModal"}),a("div",Bg,[a("div",Kg,[a("h3",zg,r(e.lang("attachment_list")),1)]),a("div",Hg,[a("a",{onClick:t[0]||(t[0]=(...f)=>i.openUploadModal&&i.openUploadModal(...f)),class:"btn btn-primary"},r(e.lang("upload_file")),1),a("div",Yg,[a("div",Wg,[a("div",Jg,[a("div",Gg,[a("h5",Zg,r(e.lang("upload_file")),1),a("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",onClick:t[1]||(t[1]=(...f)=>i.closeUploadModal&&i.closeUploadModal(...f))},Xg)]),a("div",eb,[m(h,{componentName:"attachmentModal"}),a("input",{type:"file",ref:"fileInput",onChange:t[2]||(t[2]=(...f)=>i.handleFileUpload&&i.handleFileUpload(...f)),accept:"*",multiple:""},null,544)]),a("div",tb,[a("button",{type:"button",class:"btn btn-secondary",onClick:t[3]||(t[3]=(...f)=>i.closeUploadModal&&i.closeUploadModal(...f))},r(e.lang("cancel")),1),a("button",{type:"button",class:"btn btn-primary",onClick:t[4]||(t[4]=(...f)=>i.uploadFile&&i.uploadFile(...f))},r(e.lang("upload")),1)])])])],512),sb,ab,(o(),v(_,{url:n.apiUrl,dataColumns:n.columns,option:n.options,scroll_to:"attachment_list",key:n.tableKey,onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","onLoaderState","disableLoader"]))])])])}const ob=C(Rg,[["render",nb],["__scopeId","data-v-27653984"]]),ib={name:"AssociatedLicenseList",description:"Associated contracts data table page",setup(){const e=B();return{formattedDate:L(()=>e.getters.formattedDate),formattedTime:L(()=>e.getters.formattedTime)}},props:{assetId:{type:[String,Number],default:""},disableLoader:{type:Boolean,default:!1}},data(){return{currentComponent:"associated_license",apiUrl:null,columns:null,options:null}},beforeMount(){this.apiUrl="/service-desk/api/software-license-list?asset_ids="+this.assetId;const e=this;this.columns=["name","license_key","purchase_order_number","licensed_to_email","version","purchase_date","renewal_date","expiration_date"],this.options={texts:{filter:"",limit:""},headings:{name:this.lang("name"),license_key:this.lang("license_key"),purchase_order_number:this.lang("purchase_order_number"),licensed_to_email:this.lang("licensed_to_email"),version:this.lang("version"),purchase_date:this.lang("purchase_date"),renewal_date:this.lang("renewal_date"),expiration_date:this.lang("expiration_date")},columnsClasses:{name:"license-name",license_key:"license-key",purchase_order_number:"license-purchase-order",licensed_to_email:"licensed-email",version:"license-version",purchase_date:"license-purchase-date",renewal_date:"license-renewal-date",expiration_date:"license-expiration-date"},templates:{name:(t,s)=>e.h(pt,{data:s}),license_key:(t,s)=>s.license_key?s.license_key:"--",purchase_order_number:(t,s)=>s.purchase_order_number?s.purchase_order_number:"--",licensed_to_email:(t,s)=>s.licensed_to_email?s.licensed_to_email:"--",version:(t,s)=>s.version?s.version:"--",purchase_date:function(t,s){return e.formattedTime(s.purchase_date)},renewal_date:function(t,s){return e.formattedTime(s.renewal_date)},expiration_date:function(t,s){return e.formattedTime(s.expiration_date)}},filterable:["name"],sortable:["name","license_key","purchase_order_number","licensed_to_email","version","purchase_date","renewal_date","expiration_date"],pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"name","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.data,count:t.data.total}}}},methods:{handelLoader(e){this.$emit("loaderValue",e)}},components:{"license-name":pt}},lb={id:"associated-contracts"};function rb(e,t,s,d,n,i){const h=u("data-table");return o(),l("div",lb,[m(h,{url:n.apiUrl,dataColumns:n.columns,option:n.options,scroll_to:"associated-contracts",onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","onLoaderState","disableLoader"])])}const db=C(ib,[["render",rb]]);const cb={name:"create-edit-asset-component-modal",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function},assetId:{type:[String,Number],default:""},assetCompId:{type:[String,Number],default:""},scenario:{type:String,default:"create"},reloadDetails:{type:Function},selectedCategoryValue:{type:Object,default:()=>{}}},data(){return{formUniqueKey:"",submitFormInProgress:!1,scenario:this.scenario,panel:"agent",selectedCategory:this.selectedCategoryValue,categorySelected:!1,fetchFormFieldApi:""}},beforeMount(){this.scenario==="edit"&&(this.fetchFormFieldApi="/service-desk/api/edit-associate-asset-components/"+this.assetCompId,this.categorySelected=!0)},mixins:[ve],methods:{onChange(e,t){this[t]=e,this.categorySelected=!1,this.updateFetchApi()},updateFetchApi(){this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey),this.$store.dispatch("unsetValidationError"),this.fetchFormFieldApi="/render/form?category="+this.selectedCategory.category+"&mode=render&&panel=agent&model_id="+this.assetId,setTimeout(()=>{this.$store.dispatch("createNewFormInstance",{formUniqueKey:this.formUniqueKey,scenario:this.scenario}),this.categorySelected=!0},1)},popUpSubmit(){document.getElementById("asset-comp--submit").click()},formSubmit(e,t){this.$store.dispatch("setRecaptchaKey",t),this.onSubmit()},afterSubmit(e){window.emitter.emit("reset-captcha"),setTimeout(()=>{this.reloadDetails(),this.onClose()},1e3)}},beforeDestroy(){this.$store.dispatch("unsetAlert")},components:{DynamicSelect:G,Alert:ke,Modal:ft,CustomLoader:Ne,Loader:zs,FormWithCaptcha:gt,FormRenderer:we}},ub={class:"modal-title"},hb={key:1,class:"form_select"},mb={id:"ticket_modal_body"},_b=["disabled"];function pb(e,t,s,d,n,i){const h=u("CustomLoader"),_=u("Alert"),f=u("Loader"),p=u("DynamicSelect"),b=u("FormRenderer"),k=u("ValidationObserver"),D=u("FormWithCaptcha"),P=u("Modal");return o(),l("div",null,[n.submitFormInProgress?(o(),v(h,{key:0})):c("",!0),s.showModal?(o(),v(P,{key:1,showModal:s.showModal,onClose:s.onClose,containerStyle:{width:"1200px",maxWidth:"1200px !important"}},{title:y(()=>[a("h4",ub,r(n.scenario==="create"?e.trans("add_new_component"):e.trans("edit_component")),1)]),alert:y(()=>[m(_,{componentName:"faveo-form"})]),fields:y(()=>[e.showLoader?(o(),v(f,{key:0})):c("",!0),!e.showLoader&&n.scenario==="create"?(o(),l("div",hb,[m(p,{label:e.trans("select_category"),multiple:!1,name:"selectedCategory",apiEndpoint:"service-desk/api/asset-components/"+s.assetId,value:n.selectedCategory,onChange:i.onChange,clearable:!1},null,8,["label","apiEndpoint","value","onChange"])])):c("",!0),a("div",mb,[n.formUniqueKey&&n.categorySelected&&n.fetchFormFieldApi?(o(),v(D,{key:0,loading:!e.showLoader,btnClass:"btn btn-primary pull-right",btnName:"submit",componentName:"faveo-form",btn_id:"asset-comp--submit",formSubmit:i.formSubmit,recaptchaContainerClass:"mt-2",disableSubmit:n.submitFormInProgress},{fields:y(()=>[m(k,{ref:"faveoFormObserver"},{default:y(({values:E,errors:M,validate:F})=>[m(b,{category:n.selectedCategory.category,fetchFormFieldApi:n.fetchFormFieldApi,scenario:n.scenario,panel:n.panel,isInlineForm:!1,formUniqueKey:n.formUniqueKey,selectDependencyId:s.assetCompId,selectDependencyKey:"id"},null,8,["category","fetchFormFieldApi","scenario","panel","formUniqueKey","selectDependencyId"])]),_:1},512)]),_:1},8,["loading","formSubmit","disableSubmit"])):c("",!0)])]),controls:y(()=>[e.showLoader?c("",!0):(o(),l("button",{key:0,type:"button",class:"btn btn-primary pull-right",disabled:n.submitFormInProgress,onClick:t[0]||(t[0]=E=>i.popUpSubmit())},[a("i",{class:j(n.scenario==="create"?"fas fa-save":"fas fa-sync")},null,2),g(" "+r(n.scenario==="create"?e.trans("save"):e.trans("update")),1)],8,_b))]),_:1},8,["showModal","onClose"])):c("",!0)])}const fb=C(cb,[["render",pb],["__scopeId","data-v-f613f504"]]);const Ct=e=>(K("data-v-d9eb2d6e"),e=e(),z(),e),gb={class:"asset-components"},bb={id:"asset_components"},yb={class:"row mb-3"},vb={class:"col-sm-2 add_comp"},wb=Ct(()=>a("i",{class:"glyphicon glyphicon-plus"},null,-1)),kb=Ct(()=>a("div",{class:"col-sm-10"},null,-1)),Cb={class:"card"},Db={class:"card-body"},Sb={key:0,class:"asset-comp"},Fb={class:"table table-bordered"},Mb={key:0},Ib=["rowspan"],Ab={class:"custom-field-list"},Pb={class:"row"},Tb={class:"col-sm-11"},Vb=Ct(()=>a("br",null,null,-1)),Lb={class:"comp-tools col-sm-1"},Ub=["onClick"],$b=["onClick"],Nb={class:"custom-field-list"},Eb={class:"row"},qb={class:"col-sm-11"},Ob=Ct(()=>a("br",null,null,-1)),jb={class:"comp-tools col-sm-1"},Rb=["onClick"],xb=["onClick"],Bb={key:1,class:"no-asset-comp"},Kb={class:"text-center text-muted"},zb={__name:"AssetComponentsIndex",props:{assetId:{type:[String,Number],default:""}},setup(e){const t=B(),s=e,d=x(!1),n=x([]),i=x(!1);let h=!0,_=1;const f=x(null),p=x("create"),b=x(null),k=(O="",Z)=>{t.dispatch("unsetAlert"),b.value=O.id,f.value=O.category,p.value=Z,d.value=!0},D=()=>{b.value=null,f.value="",p.value="create",d.value=!1,F.value=!1},P=()=>{n.value=[],_=1,E()},E=async()=>{try{i.value=!0;const O=await S.get(`/service-desk/api/associate-asset-components/${s.assetId}?page=${_}`);O.data.data.data.length>0?(n.value=[...n.value,...O.data.data.data],_++):h=!1}catch(O){console.error("Error fetching data:",O)}finally{i.value=!1}},M=()=>{const O=document.getElementById("comp-container"),Z=O.scrollHeight,J=O.scrollTop,ee=O.clientHeight;J+ee>=Z-100&&!i.value&&h&&E()},F=x(!1),T=O=>{t.dispatch("unsetAlert"),b.value=O.id,F.value=!0};return Ce(()=>{E()}),window.emitter.on("entryDeleted",P),(O,Z)=>{const J=N("tooltip");return o(),l("div",gb,[m(ke,{componentName:"asset-components"}),a("div",bb,[a("div",yb,[a("div",vb,[a("button",{type:"button",class:"btn btn-default",onClick:Z[0]||(Z[0]=mt(ee=>k("","create"),["prevent"]))},[wb,g(" "+r(O.trans("add_component")),1)])]),kb,m(q,{name:"modal"},{default:y(()=>[d.value?(o(),v(fb,{key:0,onClose:D,showModal:d.value,assetId:e.assetId,selectedCategoryValue:f.value,scenario:p.value,assetCompId:b.value,reloadDetails:P},null,8,["showModal","assetId","selectedCategoryValue","scenario","assetCompId"])):c("",!0)]),_:1})]),a("div",Cb,[a("div",Db,[a("div",{id:"comp-container",onScroll:M},[n.value.length>0?(o(),l("div",Sb,[a("table",Fb,[(o(!0),l(I,null,$(n.value,(ee,be)=>(o(),l(I,{key:"comp_"+be},[ee.length?(o(),l("tr",Mb,[a("th",{class:"w_30",rowspan:ee.length},r(ee[0].name),9,Ib),a("td",Ab,[a("div",Pb,[a("div",Tb,[(o(!0),l(I,null,$(ee[0].custom_field_values,re=>(o(),l(I,null,[a("strong",null,r(re.label)+" : ",1),a("span",null,r(re.value),1),Vb],64))),256))]),a("div",Lb,[w(a("i",{class:"fas fa-trash comp-delete",onClick:re=>T(ee[0]),"aria-hidden":"true"},null,8,Ub),[[J,O.lang("remove")]]),g("   "),w(a("i",{class:"fas fa-pencil-alt pointer",onClick:re=>k(ee[0],"edit"),"aria-hidden":"true"},null,8,$b),[[J,O.lang("edit")]])])])])])):c("",!0),ee.length>1?(o(!0),l(I,{key:1},$(ee.slice(1),re=>(o(),l("tr",null,[a("td",Nb,[a("div",Eb,[a("div",qb,[(o(!0),l(I,null,$(re.custom_field_values,fe=>(o(),l(I,null,[a("strong",null,r(fe.label)+" : ",1),a("span",null,r(fe.value),1),Ob],64))),256))]),a("div",jb,[w(a("i",{class:"fas fa-trash comp-delete",onClick:fe=>T(re),"aria-hidden":"true"},null,8,Rb),[[J,O.lang("remove")]]),g("   "),w(a("i",{class:"fas fa-pencil-alt",onClick:fe=>k(re,"edit"),"aria-hidden":"true"},null,8,xb),[[J,O.lang("edit")]])])])])]))),256)):c("",!0)],64))),128))])])):c("",!0),!n.value.length&&!i.value?(o(),l("div",Bb,[a("h2",Kb,r(O.trans("no-components-found")),1),a("button",{type:"button",class:"btn btn-default mt-3",onClick:Z[1]||(Z[1]=mt(ee=>k("","create"),["prevent"]))},r(O.trans("add_component")),1)])):c("",!0)],32)])])]),F.value?(o(),v(De,{key:0,onClose:D,showModal:F.value,deleteUrl:"/service-desk/api/associate-asset-components/"+b.value,alertComponentName:"asset-components","modal-message":"are_you_sure_you_want_to_delete"},null,8,["showModal","deleteUrl"])):c("",!0)])}}},Hb=C(zb,[["__scopeId","data-v-d9eb2d6e"]]);const Yb={name:"asset-associates",description:"Asset associates page",props:{assetId:{type:[String,Number],default:""}},data(){return{tabs:"",category:"activity",loading:!0,counter:0,dynamicKeys:{activity:1,relationships:1,attachment:1,license:1,components:1}}},beforeMount(){this.getActionsList()},created(){window.emitter.on("updateAssetAssociates",this.updateAssociates),window.emitter.on("updateAssetTables",()=>this.associates("activity")),this.$store.dispatch("setAssetAssociateCategory",this.category)},computed:{columns(){switch(this.category){case"problem":return["identifier","subject","requester","assignedTo","priority","department","status_type_id","action"];case"change":return["identifier","subject","requester","status","priority","department","created_at","action"];case"release":return["identifier","subject","release_type","priority","status","planned_start_date","planned_end_date","action"];case"contract":return["identifier","name","cost","expiry","contract_status","contract_renewal_status","vendor","contract_type","action"];case"ticket":return["ticket_number","title","assigned","action"]}},filterable(){switch(this.category){case"problem":return["subject","identifier"];case"change":return["identifier","subject","requester","status","priority","department"];case"release":return["identifier","subject","release_type","priority","status","planned_start_date","planned_end_date"];case"contract":return["identifier","name","cost","expiry","contract_status","contract_renewal_status","vendor","contract_type"];case"ticket":return["ticket_number"]}},sortable(){switch(this.category){case"problem":return["subject","identifier"];case"change":return["identifier","subject","created_at"];case"release":return["subject","identifier","planned_start_date","planned_end_date"];case"contract":return["identifier","name","contract_number","expiry","cost"];case"ticket":return["ticket_number"]}}},methods:{getActionsList(){S.get("/service-desk/api/asset-action/"+this.assetId).then(e=>{let t=e.data.data.asset_actions;this.$emit("actions-loaded",t),this.tabs=[{id:"activity",title:"activity_log",show:!0},{id:"attachment",title:"attachments",show:!0},{id:"relationships",title:this.trans("relationships"),show:!0},{id:"license",title:"associated_license",show:!0},{id:"components",title:"components",show:t.asset_component},{id:"problem",title:"associated_problems",show:t.associated_problems_tab_viewable},{id:"change",title:"associated_changes",show:t.associated_changes_tab_viewable},{id:"release",title:"associated_releases",show:t.associated_releases_tab_viewable},{id:"contract",title:"associated_contracts",show:t.associated_contracts_tab_viewable},{id:"ticket",title:"associated_tickets",show:t.associated_tickets_tab_viewable}]}).catch(e=>{this.tabs=[]})},updateAssociates(e){window.emitter.emit("updateAssetView")},associates(e){this.category!==e&&(this.loading=!0,this.category=e),this.updateKey(e)},handelLoader(e){this.loading=e},updateKey(e){this.dynamicKeys={...this.dynamicKeys,[e]:this.dynamicKeys[e]+1}}},watch:{category(e,t){e!==t&&this.$store.dispatch("setAssetAssociateCategory",e)}},components:{AssetAttachment:ob,"asset-activity":kf,"asset-relation":jg,"asset-associate-table":Uf,"asset-license-table":db,"asset-components":Hb}},Wb=e=>(K("data-v-4e6352e4"),e=e(),z(),e),Jb={class:"card-header p-0 pt-1"},Gb={class:"nav nav-tabs"},Zb={key:0,class:"nav-item"},Qb=["onClick"],Xb={key:0,class:"nav-item ml-auto mt-04"},ey={key:0,type:"button",class:"btn btn-tool rotating","data-card-widget":"refresh"},ty=Wb(()=>a("i",{class:"fas fa-refresh"},null,-1)),sy=[ty],ay={class:"card-body"},ny={class:"tab-content"},oy={class:"active tab-pane",id:"activity"};function iy(e,t,s,d,n,i){const h=u("alert"),_=u("asset-components"),f=u("asset-activity"),p=u("asset-relation"),b=u("asset-attachment"),k=u("asset-license-table"),D=u("asset-associate-table");return n.tabs?(o(),l("div",{id:"asset-associates",class:"card card-light card-tabs",key:n.counter},[m(h,{componentName:"assetAssociates"}),a("div",Jb,[a("ul",Gb,[(o(!0),l(I,null,$(n.tabs,P=>(o(),l(I,null,[P.show?(o(),l("li",Zb,[a("a",{id:"asset_tab",class:j(["nav-link",{active:n.category===P.id}]),"data-toggle":"pill",onClick:E=>i.associates(P.id)},r(e.trans(P.title)),11,Qb)])):c("",!0)],64))),256)),n.category!=="components"?(o(),l("li",Xb,[n.loading?(o(),l("a",ey,sy)):c("",!0)])):c("",!0)])]),a("div",ay,[a("div",ny,[a("div",oy,[n.category==="components"?(o(),v(_,{assetId:s.assetId,onLoaderValue:i.handelLoader,key:"asset_components"+n.dynamicKeys.components},null,8,["assetId","onLoaderValue"])):n.category==="activity"?(o(),v(f,{assetId:s.assetId,onLoaderValue:i.handelLoader,key:"asset_activity"+n.dynamicKeys.activity},null,8,["assetId","onLoaderValue"])):n.category==="relationships"?(o(),v(p,{assetId:s.assetId,onLoaderValue:i.handelLoader,key:"asset_relation"+n.dynamicKeys.relationships},null,8,["assetId","onLoaderValue"])):n.category==="attachment"?(o(),v(b,{assetId:s.assetId,disableLoader:"true",onLoaderValue:i.handelLoader,key:"asset_attachment"+n.dynamicKeys.attachment},null,8,["assetId","onLoaderValue"])):n.category==="license"?(o(),v(k,{assetId:s.assetId,disableLoader:"true",onLoaderValue:i.handelLoader,key:"asset_license"+n.dynamicKeys.license},null,8,["assetId","onLoaderValue"])):(o(),v(D,{category:n.category,columns:i.columns,assetId:s.assetId,sortable:i.sortable,filterable:i.filterable,componentTitle:"Asset"+n.category,disableLoader:"true",onLoaderValue:i.handelLoader,key:"asset_associates"+n.category},null,8,["category","columns","assetId","sortable","filterable","componentTitle","onLoaderValue"]))])])])])):c("",!0)}const ly=C(Yb,[["render",iy],["__scopeId","data-v-4e6352e4"]]);const ry={name:"asset-view",description:"Asset view page",computed:{assetId(){return W(this.currentPath())}},data(){return{loading:!1,counter:0,actionsData:{}}},created(){window.emitter.on("updateAssetView",()=>{this.counter++})},methods:{handelActions(e){this.actionsData=e}},components:{"asset-details":Rp,"asset-associates":ly}};function dy(e,t,s,d,n,i){const h=u("alert"),_=u("asset-details"),f=u("asset-associates");return o(),l("div",{class:"col-sm-12",key:n.counter},[m(h,{componentName:"asset-view"}),m(_,{actionsData:n.actionsData,assetId:i.assetId},null,8,["actionsData","assetId"]),m(f,{actionsData:n.actionsData,onActionsLoaded:i.handelActions,assetId:i.assetId},null,8,["actionsData","onActionsLoaded","assetId"])])}const cy=C(ry,[["render",dy]]);const uy=e=>(K("data-v-df0dca18"),e=e(),z(),e),hy={id:"filter-div",class:"card-tools"},my={type:"button",class:"btn btn-tool dropdown-toggle","data-toggle":"dropdown",id:"labels-button"},_y=uy(()=>a("i",{class:"glyphicon glyphicon-plus"},null,-1)),py=[_y],fy={key:0,class:"nav-item"},gy={class:"form-group has-feedback has-search filter_div"},by=["placeholder"],yy=["onClick","id"],vy={key:0,class:"fa fa-check field_select"},wy={id:"field_title"},ky={key:1},Cy={class:"text-center"},Dy={key:2,class:"field_loader nav-item"},Sy={__name:"ModuleCustomFieldFilter",props:{updateFilterFields:{type:Function,default:()=>{}},selectedFilterFields:{type:Array,default:()=>[]},endPoint:{type:String,required:!0},filterId:{type:[String.Number],default:""}},setup(e,{expose:t}){const s=e,d=x([]),n=x(!0);let i=s.selectedFilterFields;const h=x("");let _=!0,f=1,p=[];const b=L(()=>d.value.filter(T=>T.label.toLowerCase().includes(h.value.toLowerCase()))),k=()=>{const T=document.getElementById("filter-dropdown"),O=T.scrollHeight,Z=T.scrollTop,J=T.clientHeight;Z+J>=O-100&&!n.value&&_&&M()},D=()=>{i=[]},P=T=>oe(T,30),E=T=>{if(i.map(Z=>Z.id).includes(T.id)){for(var O in i)if(i[O].id===T.id){i.splice(O,1);break}}else T.name="custom_"+T.id,T.isCustom=!0,T.value="",T.className="col-sm-4",i.push(JSON.parse(JSON.stringify(T)));s.updateFilterFields(i)},M=async()=>{try{n.value=!0;let J=location.search.substring(1),ee,be;J&&(ee=JSON.parse('{"'+decodeURI(J).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"').replace(/%2F/g,"/")+'"}')),ee&&(be=Object.keys(ee).find(fe=>fe.includes("custom_")));const re=await S.get(`${s.endPoint}&page=${f}&time=${Date.now()}&module=filter&filter_id=${s.filterId}&filter_key=${be||""}`);if(re.data.data.data.length>0){if(d.value=[...d.value,...re.data.data.data],d.value.length)for(var T in d.value){if(p.length)for(var O in p)p[O].key===d.value[T].key&&(d.value[T].name=p[O].key,d.value[T].isCustom=!0,d.value[T].className="col-sm-4",d.value[T].value||(d.value[T].data_type==="checkbox"?d.value[T].value=p[O].value.split(","):d.value[T].value=p[O].value,i.some(fe=>fe.key===d.value[T].key)||i.push(d.value[T]),i.length===p.length&&s.updateFilterFields(i)));for(var Z in i)i[Z].id===d.value[T].id&&(d.value[T].value=i[Z].value)}f++}else _=!1}catch(J){console.error("Error fetching data:",J)}finally{n.value=!1}},F=T=>{p=T};return Ce(()=>{setTimeout(()=>{M()},1e3)}),t({getCustomFields:F}),window.emitter.on("clearCustomFields",D),(T,O)=>{const Z=u("loader"),J=N("tooltip");return o(),l("div",hy,[w((o(),l("button",my,py)),[[J,T.trans("add_custom_field")]]),a("ul",{id:"filter-dropdown",class:"dropdown-menu dropdown-menu-right filter_menu",onClick:O[1]||(O[1]=ee=>ee.stopPropagation()),onScroll:O[2]||(O[2]=ee=>k())},[n.value?c("",!0):(o(),l("li",fy,[a("div",gy,[w(a("input",{type:"text",class:"form-control",name:"label",placeholder:T.trans("search"),"onUpdate:modelValue":O[0]||(O[0]=ee=>h.value=ee)},null,8,by),[[js,h.value]])])])),(o(!0),l(I,null,$(b.value,(ee,be)=>w((o(),l("li",{class:"nav-item fields",onClick:re=>E(ee),id:"filter-field-"+be},[a("a",{class:j(["nav-link",{active:te(i).map(re=>re.id).includes(ee.id)}]),href:"javascript:;"},[te(i).map(re=>re.id).includes(ee.id)?(o(),l("i",vy)):c("",!0),a("span",wy,r(P(ee.label)),1)],2)],8,yy)),[[J,ee.hover?ee.hover:T.trans(ee.label)]])),256)),!n.value&&d.value.length===0?(o(),l("li",ky,[a("p",Cy,r(T.trans("no_results_found")),1)])):c("",!0),n.value?(o(),l("li",Dy,[m(Z,{size:30,duration:4e3,color:"#1d78ff"})])):c("",!0)],32)])}}},Fy=C(Sy,[["__scopeId","data-v-df0dca18"]]),ms="label",My={__name:"ModuleCustomFields",props:{formField:{type:Object,required:!0},allFields:{type:Array,default:()=>[]},classname:{type:String,default:"col-sm-6"}},emits:["updated"],setup(e,{emit:t}){const s=e;let d=s.formField.value,n=s.formField.key,i=s.allFields;os(()=>s.allFields,(M,F)=>{i=M}),os(()=>s.formField,(M,F)=>{n=M.key,d=M.value,M.data_type==="checkbox"&&(d=Array.isArray(d)?d:d.split(","))});const h=L(()=>{var F;let M=(F=$e.convertStringOfPropertiesToObject(s.formField.api_info))==null?void 0:F.url;return!M&&s.formField.api_info&&(M=s.formField.api_info),M});L(()=>{var M;return((M=$e.convertStringOfPropertiesToObject(s.formField.api_info))==null?void 0:M.key)||"label"});const _=L(()=>{let M=i.findIndex(F=>F.key===n);if(s.formField.data_type==="mobile"&&d&&d.includes(" "))return d.split(" ")[1];if(M!==-1)if(Array.isArray(d)&&d!=null){let F=[];return d.forEach(T=>{typeof T=="object"?F.push(T.label):F.push(T)}),i[M].value=F.map(T=>T).toString(),i[M].options.filter(T=>F.includes(T.label))}else if(pe(i[M].options)){let F="";return typeof d=="object"?F=d.label:F=d,i[M].options.find(T=>T.label===F)}else return d||"";else return d}),f=t,p=(M,F)=>{let T=i.findIndex(O=>O.key===F);Array.isArray(M)&&M!=null?(i[T].value=M.map(O=>O.label).toString(),d=M):typeof M=="object"&&M!=null?(i[T].value=M[ms],d=M):s.formField.data_type==="mobile"?(i[T].value=M?D.value+" "+M:"",d=M?D.value+" "+M:""):(i[T].value=M||"",d=M||""),f("updated",i)},b=(M,F,T)=>{if(T==="number"||T==="mobile"){M=M||window.event;var O=M.which?M.which:M.keyCode;if(O>31&&(O<48||O>57))M.preventDefault();else return!0}else if(T==="float"||T==="decimal"){M=M||window.event;var O=M.which?M.which:M.keyCode,Z=M.target.value;if(O==46&&Z.indexOf(".")!==-1||O==46&&Z.length===0)M.preventDefault();else{if(O>=48&&O<=57||O==46)return!0;M.preventDefault()}}},k=(M,F,T)=>{if(T==="number"||T==="mobile")M=M||window.event,M.clipboardData.getData("Text").match(/[^\d]/)&&M.preventDefault();else if(T==="float"||T==="decimal"){M=M||window.event;var O=M.clipboardData||window.clipboardData,Z=O.getData("Text");/^[-]?\d*\.?\d*$/.test(Z)||M.preventDefault()}},D=x(null),P=x(!1),E=(M,F)=>{F==="country_code"&&(D.value=M)};return Ce(()=>{s.formField.data_type==="mobile"&&s.formField.value&&s.formField.value.includes(" ")&&(D.value=s.formField.value.split(" ")[0]),P.value=!0}),(M,F)=>(o(),l("div",{class:j(e.classname)},[e.formField.data_type==="date"?(o(),v(bt,{key:0,type:"datetime",label:e.formField.label,value:_.value,id:e.formField.key,required:!1,name:e.formField.key,onChange:p,format:"MMMM DD YYYY HH:mm",clearable:!0,outputFormat:"YYYY-MM-DD HH:mm:ss"},null,8,["label","value","id","name"])):c("",!0),e.formField.data_type==="select"?(o(),v(G,{key:1,id:e.formField.key,label:e.formField.label,multiple:!1,name:e.formField.key,apiEndpoint:h.value,value:_.value,onChange:p,optionLabel:ms},null,8,["id","label","name","apiEndpoint","value"])):c("",!0),e.formField.data_type==="text"||e.formField.data_type==="textarea"||e.formField.data_type==="number"||e.formField.data_type==="decimal"||e.formField.data_type==="email"?(o(),v(le,{key:2,id:e.formField.key,label:e.formField.label,type:e.formField.data_type,name:e.formField.key,value:_.value,onChange:p,from:"filter",keypressEvt:b,pasteEvt:k},null,8,["id","label","type","name","value"])):c("",!0),e.formField.data_type==="radio"?(o(),v(xs,{key:3,name:e.formField.key,label:e.formField.label,options:e.formField.options,value:_.value,onChange:p,from:"filter"},null,8,["name","label","options","value"])):c("",!0),e.formField.data_type==="checkbox"?(o(),v(Bs,{key:4,name:e.formField.key,label:e.formField.label,options:e.formField.options,value:_.value,onChange:p,from:"filter"},null,8,["name","label","options","value"])):c("",!0),P.value&&e.formField.data_type==="mobile"?(o(),v(Ns,{key:5,id:e.formField.key,label:e.formField.label,type:e.formField.data_type,name:e.formField.key,value:_.value,onChange:p,isInlineForm:!1,countryCode:D.value,onCountryCode:F[0]||(F[0]=T=>E(T,"country_code")),keypressEvt:b,pasteEvt:k,extensionEnabled:0,ext:[]},null,8,["id","label","type","name","value","countryCode"])):c("",!0)],2))}};const Iy={key:0,class:"card-body"},Ay={key:1,id:"module-table-filter"},Py={class:"row"},Ty={class:"card-footer"},Vy=a("span",{class:"fas fa-check"},null,-1),Ly=a("span",{class:"fas fa-sync"},null,-1),Uy=a("span",{class:"fas fa-trash-alt"},null,-1),$y=a("span",{class:"fas fa-save"},null,-1),Ny=a("span",{class:"fas fa-undo"},null,-1),Ey=a("span",{class:"fas fa-times"},null,-1),Bt={__name:"ModuleFilter",props:{metaData:{type:Array,required:!0},appliedFilters:{type:Object,default:()=>{}},from:{type:String,default:""},showCustomFilter:{type:Boolean,default:!1},updateFields:{type:Function,default:()=>{}},selectedFields:{type:Array,default:()=>[]},endPoint:{type:String,default:""},saveFilter:{type:Boolean,default:!1},filterFor:{type:String,default:""},filterNum:{type:[String,Number],default:""},redirectTo:{type:String,default:""},deleteUrl:{type:String,default:""},closeFilter:{type:Function,default:()=>{}},save_endpoint:{type:String,default:""}},emits:["selectedFilters"],setup(e,{emit:t}){const s=e;let d=s.appliedFilters;s.multiple,x(!1);let n=s.metaData;const i=x(!1),h=x({width:"49.5%"}),_=x({width:"20%"}),f=x(!1),p=x("");let b=s.filterNum;const k=x([]),D=x([]),P=x(""),E=x(""),M=X=>{for(var ue in X)T(X[ue].value,X[ue].name)},F=()=>{s.updateFields(s.selectedFields);for(var X in s.selectedFields)T(s.selectedFields[X].value,s.selectedFields[X].name)},T=(X,ue)=>{d[ue]=X},O=t,Z=()=>{O("selectedFilters","closeEvent")},J=()=>{O("selectedFilters",d)},ee=X=>{P.value=X,f.value=!0},be=X=>{f.value=X},re=()=>{d={},i.value=!0,setTimeout(()=>{i.value=!1},1e3),O("selectedFilters","resetEvent")},fe=()=>{i.value=!0,axios.get("/service-desk/api/agent/sd-filter/"+b).then(X=>{let ue={},ye=[];X.data.data.fields.map(H=>{H.key.indexOf("custom_")!==-1?(ye.push(H),ue[H.key]=H.value):ue[H.key]=H.value_meta}),ye.length?Qe(ye):i.value=!1,d=ue,n.map(function(H){H.section.map(function(Xe){ue.hasOwnProperty(Xe.name)&&(Xe.value=ue[Xe.name])})}),b=X.data.data.id,p.value=X.data.data.name,E.value={icon_class:X.data.data.icon_class},k.value=X.data.data.departments,D.value=X.data.data.agents}).catch(X=>{console.error(X)})},ct=x(null),Qe=X=>{ct.value.getCustomFields(X),setTimeout(()=>{i.value=!1},100)};return Ce(()=>{F(),s.filterNum&&fe()}),(X,ue)=>(o(),v(Re,{"box-class":"card card-light ",title:X.lang("filter")},{customActions:y(()=>[e.showCustomFilter?(o(),v(Fy,{key:0,updateFilterFields:e.updateFields,selectedFilterFields:e.selectedFields,endPoint:e.endPoint,ref_key:"moduleTableFilter",ref:ct,filterId:te(b)},null,8,["updateFilterFields","selectedFilterFields","endPoint","filterId"])):c("",!0)]),actions:y(()=>[a("div",Ty,[a("button",{id:"filter-apply-btn",class:"btn btn-primary",type:"button",onClick:J},[Vy,g("  "+r(X.trans("apply")),1)]),e.saveFilter?(o(),l(I,{key:0},[e.filterNum?(o(),l(I,{key:0},[a("button",{id:"filter-upd",class:"btn btn-primary",type:"button",onClick:ue[0]||(ue[0]=ye=>ee("update"))},[Ly,g("  "+r(X.trans("update")),1)]),a("button",{id:"filetr-del",class:"btn btn-danger",type:"button",onClick:ue[1]||(ue[1]=ye=>ee("delete"))},[Uy,g("  "+r(X.trans("delete")),1)])],64)):(o(),l("button",{key:1,id:"filetr-save",class:"btn btn-primary",type:"button",onClick:ue[2]||(ue[2]=ye=>ee("save"))},[$y,g("  "+r(X.trans("save")),1)]))],64)):c("",!0),a("button",{id:"reset-btn",class:"btn btn-primary",type:"button",onClick:re},[Ny,g("  "+r(X.trans("reset")),1)]),e.from!=="report"?(o(),l("button",{key:1,id:"filter-cancel-btn",class:"btn btn-danger",type:"button",onClick:Z},[Ey,g("  "+r(X.trans("cancel")),1)])):c("",!0)])]),default:y(()=>[i.value?(o(),l("div",Iy,[m(zs,{"animation-duration":4e3,color:"#1d78ff",size:60})])):(o(),l("div",Ay,[(o(!0),l(I,null,$(te(n),ye=>(o(),l("div",Py,[(o(!0),l(I,null,$(ye.section,H=>(o(),l(I,null,[H.isCustom?(o(),v(My,{key:0,formField:H,allFields:e.selectedFields,onUpdated:M,classname:H.className},null,8,["formField","allFields","classname"])):(o(),l(I,{key:1},[H.type!=="date"&&H.type!=="number"&&H.type!=="text"?(o(),v(G,{key:H.name,id:H.name,name:H.name,apiEndpoint:H.url,classname:H.className,elements:H.elements,multiple:H.isMultiple,label:X.lang(H.label),value:H.value,onChange:T,strlength:"35",hint:X.trans(H.hint)},null,8,["id","name","apiEndpoint","classname","elements","multiple","label","value","hint"])):c("",!0),H.type==="number"?(o(),v(Nt,{label:X.trans(H.label),formStyle:h.value,value:H.value,key:H.name,id:H.name,name:H.name,classname:H.className,type:"text",onChange:T,min_placeholder:H.min_placeholder,max_placeholder:H.max_placeholder,required:!1},null,8,["label","formStyle","value","id","name","classname","min_placeholder","max_placeholder"])):c("",!0),H.type==="text"?(o(),v(le,{label:X.trans(H.label),value:H.value,key:H.name,id:H.name,name:H.name,onChange:T,classname:H.className,required:!1},null,8,["label","value","id","name","classname"])):c("",!0),H.type==="date"?(o(),v($t,{label:H.label,value:H.value,type:"datetime",key:H.name,id:H.name,name:H.name,onChange:T,range:H.range,required:!1,format:"MMMM DD YYYY, h:mm a",classname:H.className,clearable:!1,disabled:!1,editable:!0,currentYearDate:!1,"time-picker-options":H.timeOptions,isDateSelector:!1,numberStyle:_.value,confirm:!0},null,8,["label","value","id","name","range","classname","time-picker-options","numberStyle"])):c("",!0)],64))],64))),256))]))),256))])),f.value?(o(),v(Et,{key:2,filterName:p.value,icon:E.value,filterValues:te(d),filterId:te(b),toggleFilterPopUp:be,source:e.filterFor,filterArray:te(n),intitialDepartments:k.value,initialAgents:D.value,mode:P.value,redirectTo:e.redirectTo,deleteUrl:e.deleteUrl,closeFilter:e.closeFilter,save_endpoint:e.save_endpoint},null,8,["filterName","icon","filterValues","filterId","source","filterArray","intitialDepartments","initialAgents","mode","redirectTo","deleteUrl","closeFilter","save_endpoint"])):c("",!0)]),_:1},8,["title"]))}};const qy={name:"problem-list",description:"Problem lists table component",props:{filterIndex:{type:Boolean,default:!1}},data:()=>({columns:[],hasDataPopulated:!1,filterParams:{},visibleColumns:{},staticColumns:["actions"],apiUrl:"/service-desk/api/problem-list",reportType:"problems",filterOptions:[{section:[{name:"problem_ids",url:"/service-desk/api/dependency/problems",label:"problems",isCustom:!1},{name:"dept_ids",url:"api/dependency/departments",label:"departments",isCustom:!1},{name:"impact_ids",url:"/service-desk/api/dependency/impacts",label:"impact_type",isCustom:!1}]},{section:[{name:"problem_statuses",url:"/service-desk/api/status/list?module=1",label:"status",isCustom:!1},{name:"location_ids",url:"api/dependency/locations",label:"location",isCustom:!1},{name:"priority_ids",url:"api/dependency/priorities",label:"priority",isCustom:!1}]},{section:[{name:"assigned_ids",url:"api/dependency/agents?meta=true",label:"assigned",isCustom:!1},{name:"asset_ids",url:"/service-desk/api/asset-list?meta=true",label:"assets",isCustom:!1},{name:"ticket_ids",url:"api/dependency/tickets",label:"tickets",isCustom:!1}]},{section:[{name:"requester_ids",url:"/api/dependency/users?meta=true",label:"requester",isCustom:!1},{name:"change_ids",url:"/service-desk/api/dependency/changes",label:"changes",isCustom:!1},{name:"created_at",type:"date",label:["created_at","created_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0,isCustom:!1}]},{section:[{name:"updated_at",type:"date",label:["updated_at","updated_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0,isCustom:!1}]},{section:[]}],isShowFilter:!1,appliedFilters:{},showIcon:!1,columnData:null,problemData:null,exportData:"",loading:!0,showPagination:!0,newReportId:"",dataCount:"",requiredPayload:[],customFields:[],problemFilterId:""}),created(){window.emitter.on("onColumnUpdate",this.onColumnUpdate),window.emitter.on("updateFilter",this.updateFilter),window.emitter.on("dataCount",this.handleDataCount)},beforeMount(){const e=window.location.pathname;this.problemFilterId=W(e);const t=Ye();t&&t.hasOwnProperty("filter-by-url")?We("/service-desk/api/filter-dependencies",t,{},n=>{n&&this.applyFilter(n)},n=>{A(n)}):this.apiUrl=this.filterIndex?"/service-desk/api/problem-list?filter_id="+this.problemFilterId:"/service-desk/api/problem-list",this.filterData(),this.getProblemData()},methods:{handleDataCount(e){this.showIcon=!!e,this.dataCount=e},updateFilter(e){this.filterOptions.map(function(t){t.section.map(function(s){e.name===s.name&&(s.value=e.value)})})},getProblemData(){this.hasDataPopulated=!1,S.get("api/agent/report-config/problem-report").then(e=>{this.problemData=e.data.data,this.newReportId=e.data.data.id,this.columnData=e.data.data.sub_reports,this.hasDataPopulated=!0,this.columnData.forEach(t=>{t.columns.forEach(s=>{}),this.columns=t.columns}),this.columns.map(t=>{t.is_visible=!!t.is_visible}),this.updateVisibleColumns()}).catch(e=>{this.hasDataPopulated=!0,this.columns=[],A(e)})},onColumnUpdate(e){this.columns=e,this.updateVisibleColumns()},updateVisibleColumns(){this.visibleColumns={},this.columns.map(e=>{pe(e.is_visible)&&(this.visibleColumns[e.key]=e.label)})},updateFilterFields(e){e.forEach(t=>{t.isCustom&&t.data_type==="checkbox"&&t.value&&(t.value=Array.isArray(t.value)?t.value:t.value.split(","))}),this.customFields=e,this.filterOptions[5].section=e},filterData(){this.filterOptions.map(function(e){e.section.map(function(t){t.isCustom||(t.elements=[],t.isMultiple=!0),t.isPrepopulate=!1,t.value="",t.className="col-sm-4"})})},selectedFilters(e){return e==="closeEvent"?this.isShowFilter=!1:e==="resetEvent"?this.resetFilter():this.applyFilter(e)},resetFilter(){this.apiUrl=this.filterIndex?"/service-desk/api/problem-list?filter_id="+this.problemFilterId:"/service-desk/api/problem-list",this.filterOptions=this.filterOptions.map(function(e){return e.section.map(function(t){t.isCustom||(t.elements=[],t.isMultiple=!0),t.isPrepopulate=!1,t.value="",t.className="col-sm-4"}),e})},applyFilter(e){this.appliedFilters=e;for(var t in this.customFields)this.customFields[t].value=e[this.customFields[t].name];let s="/service-desk/api/problem-list?",d=new URLSearchParams(je(this.filterOptions,e));const i=d,h=new URLSearchParams(i),_={};for(const[f,p]of h)_[f]=p;d[d.length-1]==="&"&&(d=d.slice(0,-1)),this.apiUrl=s+d,this.exportData=this.reformatExportData(_)},toggleFilterView(){this.isShowFilter=!this.isShowFilter},reformatExportData(e){const t={};for(const s in e){const d=s.match(/([a-zA-Z_]+)\[(\d+)\]/);if(d){const[n,i,h]=d;t[i]=t[i]||[],t[i][h]=parseInt(e[s],10)}}return t},exportReport(){this.loading=!0;const e={...this.exportData,total:this.dataCount};let t={};this.filterIndex&&(t.filter_id=this.problemFilterId);const s={...this.exportData,...t,total:this.dataCount};S.post("api/agent/report-export/"+this.newReportId,this.filterIndex?s:e).then(d=>{U(d,"dataTableModal")}).catch(d=>{A(d,"dataTableModal")}).finally(()=>{this.loading=!1})},scheduleList(){this.requiredPayload=JSON.stringify(this.exportData);const e={...this.exportData,filter_id:this.problemFilterId};this.$router.push({path:"/reports/schedule/add/"+this.problemData.type+"/"+this.newReportId,query:{params:this.filterIndex?JSON.stringify(e):this.requiredPayload}})}},components:{ModuleFilter:Bt,"dynamic-datatable":Ze,"user-column-list":Ge}},Oy={class:"col-sm-12"},jy={key:0,class:"card card-light"},Ry={class:"card-header"},xy={id:"problem-list",class:"card-title"},By={class:"card-tools"},Ky=a("span",{class:"glyphicon glyphicon-plus"},null,-1),zy=a("span",{class:"glyphicon glyphicon-filter"},null,-1),Hy=[zy],Yy=a("i",{class:"fas fa-paper-plane"},null,-1),Wy=[Yy],Jy=a("i",{class:"fas fa-calendar"},null,-1),Gy=[Jy],Zy={class:"card-body",id:"problems_list"};function Qy(e,t,s,d,n,i){const h=u("alert"),_=u("router-link"),f=u("ModuleFilter"),p=u("user-column-list"),b=u("dynamic-datatable"),k=N("tooltip");return o(),l("div",Oy,[m(h,{componentName:"dataTableModal"}),e.hasDataPopulated?(o(),l("div",jy,[a("div",Ry,[a("h3",xy,r(e.lang("list_of_problems")),1),a("div",By,[w((o(),v(_,{class:"btn btn-tool",to:"/service-desk/problem/create"},{default:y(()=>[Ky]),_:1})),[[k,e.lang("problem-add")]]),w((o(),l("a",{id:"advance-filter-btn",class:"btn btn-tool",onClick:t[0]||(t[0]=(...D)=>i.toggleFilterView&&i.toggleFilterView(...D)),href:"javascript:;"},Hy)),[[k,e.lang("filter")]]),e.showIcon?w((o(),l("a",{key:0,id:"export-report-btn",class:"btn btn-tool",onClick:t[1]||(t[1]=D=>i.exportReport()),href:"javascript:;"},Wy)),[[k,e.lang("export")]]):c("",!0),e.showIcon?w((o(),l("a",{key:1,id:"schedule-report",class:"btn btn-tool",onClick:t[2]||(t[2]=D=>i.scheduleList()),href:"javascript:;"},Gy)),[[k,e.lang("schedule")]]):c("",!0)])]),a("div",Zy,[e.isShowFilter?(o(),v(f,{key:0,id:"filter-box",metaData:e.filterOptions,selectedFields:e.customFields,onSelectedFilters:i.selectedFilters,showCustomFilter:!0,updateFields:i.updateFilterFields,appliedFilters:e.appliedFilters,endPoint:"/custom-field-flattened?category=problem&type=problem",saveFilter:!0,filterFor:"problem",filterNum:e.problemFilterId,redirectTo:"/service-desk/problem",deleteUrl:"/service-desk/api/agent/sd-filter/"+e.problemFilterId,closeFilter:i.toggleFilterView,save_endpoint:"/service-desk/api/agent/sd-filter"},null,8,["metaData","selectedFields","onSelectedFilters","updateFields","appliedFilters","filterNum","deleteUrl","closeFilter"])):c("",!0),(o(!0),l(I,null,$(e.columnData,D=>(o(),l("section",{key:D},[m(p,{"table-columns":D.columns,reportId:D.id,columnId:e.newReportId},null,8,["table-columns","reportId","columnId"]),e.columns.length?(o(),v(b,{key:0,"data-url":e.apiUrl,columns:e.visibleColumns,columnsMeta:D.columns,staticColumns:e.staticColumns,show_pagination:e.showPagination,"report-type":e.reportType},null,8,["data-url","columns","columnsMeta","staticColumns","show_pagination","report-type"])):c("",!0)]))),128))])])):c("",!0)])}const _s=C(qy,[["render",Qy]]),Xy={name:"problem-form",props:{category:{type:String,required:!0},panel:{type:String,default:"agent"},showViewButton:{type:Boolean,default:!1}},data(){return{fetchFormFieldApi:"/api/form/render/",formUniqueKey:null,submitFormInProgress:!1,editId:"",selectedForm:"",formSelected:!1}},mixins:[ve],beforeMount(){if(this.mode==="edit"){const e=W(this.currentPath());this.fetchFormFieldApi="service-desk/api/edit-problem/"+e,this.editId=W(this.currentPath()),this.formSelected=!0}else this.getDefaultFormValue()},computed:{mode(){return this.currentPath().indexOf("edit")!==-1?"edit":"create"}},methods:{getDefaultFormValue(){this.showLoader=!0,S.get("/from/forms/"+this.category).then(e=>{this.selectedForm=e.data.data.data[0],this.showLoader=!1,this.updateFetchApi()}).catch(e=>{this.showLoader=!1,A(e,"faveo-form")})},updateFetchApi(){this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey),this.$store.dispatch("unsetValidationError"),this.fetchFormFieldApi="/render/form?id="+this.selectedForm.id+"&mode=render",setTimeout(()=>{this.$store.dispatch("createNewFormInstance",{formUniqueKey:this.formUniqueKey,scenario:this.scenario||this.mode}),this.formSelected=!0},1)},afterSubmit(e){window.emitter.emit("updateAgentSidebar"),this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey);let t=Je(this.category);this.$store.dispatch("createNewFormInstance",{formUniqueKey:t,scenario:this.mode}),this.formUniqueKey=t,this.mode==="create"&&setTimeout(()=>{let s=e.data.data.id;this.$router.push("/service-desk/problem/"+s+"/show")},1e3)}},components:{FormRenderer:we,Alert:ke,FaveoBox:Re,CustomLoader:Ne}},ev={class:"col-sm-12"},tv={key:0,class:"pull-right"},sv=a("span",null,[a("i",{class:"fas fa-eye"})],-1),av={key:0,class:"form-group row mt-3"},nv={class:"col-md-12"},ov=["disabled"],iv={key:0},lv=a("i",{class:"fas fa-sync"},null,-1),rv=[lv],dv={key:1},cv=a("i",{class:"fas fa-save"},null,-1),uv=[cv];function hv(e,t,s,d,n,i){const h=u("Alert"),_=u("CustomLoader"),f=u("router-link"),p=u("FormRenderer"),b=u("ValidationObserver"),k=u("FaveoBox"),D=N("tooltip");return o(),l("div",ev,[n.formUniqueKey&&n.formSelected?(o(),v(k,{key:0,title:e.lang(i.mode)},{headerMenu:y(()=>[s.showViewButton?(o(),l("span",tv,[w((o(),v(f,{to:"/service-desk/problem/"+n.editId+"/show",class:"btn btn-tool has-tooltip"},{default:y(()=>[sv]),_:1},8,["to"])),[[D,e.trans("view")]])])):c("",!0)]),default:y(()=>[m(h,{componentName:"faveo-form"}),m(h,{componentName:"form-renderer"}),e.showLoader||n.submitFormInProgress?(o(),v(_,{key:0,duration:4e3})):c("",!0),m(b,{ref:"faveoFormObserver"},{default:y(({values:P,errors:E,validate:M})=>[(o(),v(p,{key:n.formUniqueKey,fetchFormFieldApi:n.fetchFormFieldApi,formUniqueKey:n.formUniqueKey,scenario:i.mode,category:s.category,panel:s.panel,selectDependencyId:n.editId},null,8,["fetchFormFieldApi","formUniqueKey","scenario","category","panel","selectDependencyId"])),e.showLoader?c("",!0):(o(),l("div",av,[a("div",nv,[a("button",{type:"button",class:"btn btn-primary pull-right",disabled:n.submitFormInProgress,onClick:t[0]||(t[0]=F=>e.onSubmit())},[i.mode==="edit"?(o(),l("span",iv,rv)):(o(),l("span",dv,uv)),g(" "+r(i.mode==="edit"?e.trans("update"):e.trans("submit")),1)],8,ov)])]))]),_:1},512)]),_:1},8,["title"])):c("",!0)])}const ps=C(Xy,[["render",hv]]);const mv={name:"problem-description",description:"Problem description Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},description:{type:String,default:""}}},_v={class:"modal-title"},pv={id:"log_desc"},fv=["innerHTML"];function gv(e,t,s,d,n,i){const h=u("modal");return s.showModal?(o(),v(h,{key:0,showModal:s.showModal,onClose:s.onClose},{title:y(()=>[a("h4",_v,r(e.lang("description")),1)]),fields:y(()=>[a("div",pv,[a("span",{innerHTML:s.description},null,8,fv)])]),_:1},8,["showModal","onClose"])):c("",!0)}const bv=C(mv,[["render",gv],["__scopeId","data-v-55bdcb42"]]);function yv(e){const{solution_title:t,description:s}=e;var d={solution_title:[t,{"max(50)":"The title should be less than 50 characters."}],description:[s,"isRequired"]};const n=new ce(ae),{errors:i,isValid:h}=n.validate(d);return ie.dispatch("setValidationError",i),{errors:i,isValid:h}}const vv={name:"problem-planning-modal",description:"Problem Planning Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},problemId:{type:[String,Number],default:""},identifier:{type:String,default:""},updateChangeData:{type:Function}},data(){return{attachment:"",description:"",isDisabled:!1,loading:!0,selectedFile:"",attachment_delete:!1,solution_title:"",category:""}},beforeMount(){this.getInitialValues(),this.category=this.$store.getters.getProblemAssociateCategory},methods:{getInitialValues(){S.get("/service-desk/api/general-popup/"+this.problemId+"/sd_problem/"+this.identifier).then(e=>{this.loading=!1,this.general_info=e.data.data.general_info,this.general_info&&(this.description=this.general_info.description,this.attachment=this.general_info.attachment,this.solution_title=this.general_info.title)}).catch(e=>{this.loading=!1})},onFileSelected(e,t,s){this.selectedFile=e,this.attachment_delete=s,this.attachment=this.selectedFile?this.selectedFile[0]:this.attachment},onChange(e,t){this[t]=e},isValid(){const{errors:e,isValid:t}=yv(this.$data);return t},onSubmit(){if(this.isValid()){this.loading=!0,this.isDisabled=!0;var e=new FormData;e.append("identifier",this.identifier),e.append("description",this.description),this.identifier=="solution"&&e.append("title",this.solution_title),this.selectedFile&&e.append("attachment",this.selectedFile[0]?this.selectedFile[0]:""),this.attachment_delete&&e.append("attachment_delete",this.attachment_delete);const t={headers:{"Content-Type":"multipart/form-data"}};S.post("/service-desk/api/general-popup/"+this.problemId+"/sd_problem",e,t).then(s=>{U(s,"problem-view"),this.loading=!1,this.isDisabled=!1,this.onClose(),this.category,window.emitter.emit("updateProblem"+this.category)}).catch(s=>{this.loading=!1,this.isDisabled=!1,A(s,"problem-planning")})}}},components:{"text-field":le,"file-upload":He}},wv={class:"modal-title"},kv={key:0},Cv={class:"row"},Dv={class:"row"},Sv={key:1,class:"row"},Fv=["disabled"],Mv=a("i",{class:"fas fa-sync"},null,-1);function Iv(e,t,s,d,n,i){const h=u("alert"),_=u("text-field"),f=u("tiny-editor"),p=u("file-upload"),b=u("reuse-loader"),k=u("modal"),D=N("focus-first-input");return s.showModal?(o(),v(k,{key:0,showModal:s.showModal,onClose:s.onClose,modalBodyClass:n.loading?"":"problem_plan_div"},{alert:y(()=>[m(h,{componentName:"problem-planning"})]),title:y(()=>[a("h4",wv,r(e.lang(s.identifier)),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",kv,[w((o(),l("div",Cv,[s.identifier=="solution"?(o(),v(_,{key:0,label:e.lang("solution_title"),value:n.solution_title,type:"text",name:"solution_title",onChange:i.onChange,classname:"col-sm-12",required:!1},null,8,["label","value","onChange"])):c("",!0),m(f,{value:n.description,type:"text",onChange:i.onChange,name:"description",label:e.lang("description"),classname:"col-sm-12",required:!0,lang:"en",width:"100%",id:s.identifier=="solution"?"":"focus_editor"},null,8,["value","onChange","label","id"])])),[[D]]),a("div",Dv,[m(p,{label:e.lang("attachments"),value:n.attachment,name:"attachment",onChange:i.onFileSelected,classname:"col-sm-12"},null,8,["label","value","onChange"])])])),n.loading?(o(),l("div",Sv,[m(b,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=P=>i.onSubmit()),class:"btn btn-primary",disabled:n.isDisabled},[Mv,g(" "+r(e.lang("update")),1)],8,Fv)]),_:1},8,["showModal","onClose","modalBodyClass"])):c("",!0)}const ea=C(vv,[["render",Iv]]);const Av={name:"problem-assets",description:"Problem Asset Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},problemId:{type:[String,Number],default:""},updateChangeData:{type:Function}},data(){return{used_by_ids:"",asset_type_ids:"",managed_by_ids:"",org_ids:"",isDisabled:!0,containerStyle:{width:"950px"},loading:!1,size:60,apiUrl:"",assetIds:[],selectedFilters:{},componentTitle:"problemAssets",category:""}},beforeMount(){this.category=this.$store.getters.getProblemAssociateCategory},watch:{assetIds(e){this.isDisabled=!(e.length>0)}},methods:{onChange(e,t){window.emitter.emit(this.componentTitle+"uncheckCheckbox"),this[t]=e||"",this.selectedFilters[t]=e||""},onApply(){let e="/service-desk/api/asset-list?problem_id="+this.problemId+"&",t="";for(var s in this.selectedFilters)this.selectedFilters[s].id&&(t+=s+"="+this.selectedFilters[s].id+"&");t[t.length-1]==="&"&&(t=t.slice(0,-1)),this.apiUrl=e+t},assetsData(e){this.assetIds=e},onSubmit(){if(this.assetIds.length>0){this.loading=!0;const e={};e.asset_ids=this.assetIds;const t={headers:{"Content-Type":"application/json"}};S.post("/service-desk/api/problem-attach-assets/"+this.problemId,e,t).then(s=>{this.loading=!1,U(s,"problem-view"),window.emitter.emit(this.category==="activity"?"updateProblem"+this.category:this.componentTitle+"refreshData"),this.onClose()}).catch(s=>{this.loading=!1,A(s,"problem-view")})}}},components:{"asset-list-with-checkbox":Oe,"dynamic-select":G}},Pv={class:"modal-title"},Tv={class:"row"},Vv={class:"col-sm-12"},Lv=a("span",{class:"fas fa-check"},null,-1),Uv=a("br",null,null,-1),$v={class:"height-limit"},Nv={key:0,class:"row"},Ev=["disabled"],qv=a("i",{class:"fas fa-paperclip"},null,-1);function Ov(e,t,s,d,n,i){const h=u("dynamic-select"),_=u("asset-list-with-checkbox"),f=u("custom-loader"),p=u("modal");return s.showModal?(o(),v(p,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{title:y(()=>[a("h4",Pv,r(e.lang("attach_assets")),1)]),fields:y(()=>[a("div",Tv,[m(h,{label:e.lang("asset_types"),multiple:!1,name:"asset_type_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"/service-desk/api/dependency/asset_types",value:n.asset_type_ids,onChange:i.onChange,clearable:!!n.asset_type_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),m(h,{label:e.lang("used_by"),multiple:!1,name:"used_by_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"api/dependency/users?meta=true",value:n.used_by_ids,onChange:i.onChange,clearable:!!n.used_by_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),m(h,{label:e.lang("managed_by"),multiple:!1,name:"managed_by_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"api/dependency/agents?meta=true",value:n.managed_by_ids,onChange:i.onChange,clearable:!!n.managed_by_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),m(h,{label:e.lang("organizations"),multiple:!1,name:"org_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"api/dependency/organizations",value:n.org_ids,onChange:i.onChange,clearable:!!n.org_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),a("div",Vv,[a("button",{id:"apply-btn",class:"btn btn-primary round-btn float-left",type:"button",onClick:t[0]||(t[0]=b=>i.onApply())},[Lv,g("  "+r(e.lang("apply")),1)])])]),Uv,a("div",$v,[n.apiUrl?(o(),v(_,{key:0,apiUrl:n.apiUrl,tickets:i.assetsData,componentTitle:n.componentTitle},null,8,["apiUrl","tickets","componentTitle"])):c("",!0)]),n.loading===!0?(o(),l("div",Nv,[m(f,{duration:4e3})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[1]||(t[1]=b=>i.onSubmit()),class:"btn btn-primary",disabled:n.isDisabled},[qv,g(" "+r(e.lang("attach")),1)],8,Ev)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const jv=C(Av,[["render",Ov]]),Rv={name:"problem-ticket-associate",description:"Problem ticket associate Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},problemId:{type:[String,Number],default:""},associate:{type:String,default:""}},data(){return{ticket_ids:[],loading:!1,showAlert:!1,category:"",componentTitle:"ProblemTickets"}},beforeMount(){this.category=this.$store.getters.getAssociateCategory},methods:{onChange(e,t){this[t]=e},onSubmit(){this.loading=!0;const e={};var t=[];for(var s in this.ticket_ids)t.push(this.ticket_ids[s].id);e.ticket_ids=t,S.post("/service-desk/api/problem-attach-ticket/"+this.problemId,e).then(d=>{this.loading=!1,this.ticket_ids=[],this.onClose(),window.emitter.emit(this.category==="activity"?"updateProblem"+this.category:this.componentTitle+"refreshData"),U(d,"problem-view")}).catch(d=>{this.loading=!1,this.showAlert=!0,A(d,"problem-ticket")})}},components:{"dynamic-select":G}},xv={class:"modal-title"},Bv={key:0},Kv={class:"row"},zv={key:1,class:"row"},Hv=["disabled"],Yv=a("i",{class:"fas fa-paperclip"},null,-1);function Wv(e,t,s,d,n,i){const h=u("alert"),_=u("dynamic-select"),f=u("reuse-loader"),p=u("modal");return s.showModal?(o(),v(p,{key:0,showModal:s.showModal,onClose:s.onClose},vt({title:y(()=>[a("h4",xv,r(e.lang("associate_tickets")),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",Bv,[a("div",Kv,[m(_,{label:e.lang("tickets"),multiple:!0,name:"ticket_ids",prePopulate:!1,classname:"col-sm-12",apiEndpoint:"/service-desk/api/dependency/tickets_based_on_problem?supplements="+s.problemId,value:n.ticket_ids,onChange:i.onChange,required:!0},null,8,["label","apiEndpoint","value","onChange"])])])),n.loading?(o(),l("div",zv,[m(f,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=b=>i.onSubmit()),class:"btn btn-primary",disabled:!(n.ticket_ids.length>0)},[Yv,g(" "+r(e.lang("attach")),1)],8,Hv)]),_:2},[n.showAlert?{name:"alert",fn:y(()=>[m(h,{componentName:"problem-ticket"})]),key:"0"}:void 0]),1032,["showModal","onClose"])):c("",!0)}const Jv=C(Rv,[["render",Wv]]);const Gv={name:"problem-change-modal",description:"Problem Change Modal component",props:{showModal:{type:Boolean,default:!1},problemId:{type:[String,Number],default:""},onClose:{type:Function},type:{type:String,default:""},updateChangeData:{type:Function}},data(){return{isDisabled:this.type==="attach_existing_change",containerStyle:{width:this.type==="attach_existing_change"?"500px":"800px"},loading:!1,showLoader:!0,change:"",modalClass:"",category:""}},beforeMount(){this.updateLoader(),this.category=this.$store.getters.getProblemAssociateCategory},methods:{updateLoader(){this.type=="attach_new_change"&&setTimeout(()=>{this.showLoader=!1,this.modalClass="change_fields"},1e3)},onChange(e,t){this[t]=e,this.isDisabled=!e},onSubmit(){this.type==="attach_existing_change"&&(this.loading=!0,this.isDisabled=!0,S.post("/service-desk/api/problem-attach-change/"+this.problemId+"/"+this.change.id).then(e=>{U(e,"problem-view"),this.onClose(),this.updateChangeData(),this.category==="activity"&&window.emitter.emit("updateProblem"+this.category),this.loading=!1,this.isDisabled=!0}).catch(e=>{this.loading=!1,this.isDisabled=!0,A(e,"problem-view")}))},onCompleted(){this.onClose(),this.updateChangeData(),window.emitter.emit("updateProblemAssociates")}},components:{"dynamic-select":G}},Zv={class:"modal-title"},Qv={key:0},Xv={class:"row"},e1={key:1,class:"row"},t1=["disabled"],s1=a("i",{class:"fas fa-check"},null,-1);function a1(e,t,s,d,n,i){const h=u("dynamic-select"),_=u("reuse-loader"),f=u("modal");return s.showModal?(o(),v(f,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle,modalBodyClass:n.modalClass},{title:y(()=>[a("h4",Zv,r(e.lang(s.type)),1)]),fields:y(()=>[!n.loading&&s.type=="attach_existing_change"?(o(),l("div",Qv,[a("div",Xv,[m(h,{label:e.lang("change"),multiple:!1,name:"change",prePopulate:!1,classname:"col-sm-12",apiEndpoint:"/service-desk/api/dependency/changes",value:n.change,onChange:i.onChange,required:!0,clearable:!!n.change},null,8,["label","value","onChange","clearable"])])])):c("",!0),n.loading?(o(),l("div",e1,[m(_,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=p=>i.onSubmit()),class:"btn btn-primary",disabled:n.isDisabled},[s1,g(" "+r(e.lang("proceed")),1)],8,t1)]),_:1},8,["showModal","onClose","containerStyle","modalBodyClass"])):c("",!0)}const n1=C(Gv,[["render",a1]]),o1={name:"problem-detach-modal",description:"Problem Detach Modal component",props:{showModal:{type:Boolean,default:!1},assetId:{type:[String,Number],default:""},changeId:{type:[String,Number],default:""},compName:{type:String,default:""},alertCompName:{type:String,default:"problemAssociates"},problemId:{type:[String,Number],default:""},onClose:{type:Function},updateChangeData:{type:Function}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1,category:""}},beforeMount(){this.category=this.$store.getters.getProblemAssociateCategory},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0;let e=this.changeId?"/service-desk/api/problem-detach-change/"+this.problemId+"/"+this.changeId:"/service-desk/api/problem-detach-asset/"+this.problemId+"/"+this.assetId;S.delete(e).then(t=>{U(t,"problem-view"),this.changeId?this.category==="activity"?window.emitter.emit("updateProblemactivity"):this.category==="changes"&&window.emitter.emit("updateProblemTables"):window.emitter.emit(this.compName+"refreshData"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(t=>{this.loading=!1,this.isDisabled=!0,A(t,this.alertCompName)})}}},i1={class:"modal-title"},l1={key:0},r1={key:1,class:"row"},d1=["disabled"],c1=a("i",{class:"fas fa-unlink","aria-hidden":"true"},null,-1);function u1(e,t,s,d,n,i){const h=u("reuse-loader"),_=u("modal");return s.showModal?(o(),v(_,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{title:y(()=>[a("h4",i1,r(e.lang("detach")),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",l1,[a("span",null,r(e.lang("are_you_sure")),1)])),n.loading?(o(),l("div",r1,[m(h,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=f=>i.onSubmit()),class:"btn btn-danger",disabled:n.isDisabled},[c1,g(" "+r(e.lang("detach")),1)],8,d1)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const ta=C(o1,[["render",u1]]),h1={name:"problem-status-modal",description:"Problem status Modal component",props:{showModal:{type:Boolean,default:!1},problemId:{type:[String,Number],default:""},onClose:{type:Function},updateChangeData:{type:Function}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1,category:""}},beforeMount(){this.category=this.$store.getters.getProblemAssociateCategory},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,S.post("/service-desk/api/problem-close/"+this.problemId).then(e=>{U(e,"problem-view"),this.onClose(),this.updateChangeData(),window.emitter.emit(this.category==="activity"?"updateProblemactivity":""),this.loading=!1,this.isDisabled=!0}).catch(e=>{this.loading=!1,this.isDisabled=!0,A(e,"problem-view")})}}},m1={class:"modal-title"},_1={key:0},p1={key:1,class:"row"},f1=["disabled"],g1=a("i",{class:"fas fa-check"},null,-1);function b1(e,t,s,d,n,i){const h=u("reuse-loader"),_=u("modal");return s.showModal?(o(),v(_,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{title:y(()=>[a("h4",m1,r(e.lang("status")),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",_1,[a("span",null,r(e.lang("are_you_sure")),1)])),n.loading?(o(),l("div",p1,[m(h,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=f=>i.onSubmit()),class:"btn btn-primary",disabled:n.isDisabled},[g1,g(" "+r(e.lang("proceed")),1)],8,f1)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const y1=C(h1,[["render",b1]]);const v1={name:"problem-create-change-modal",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function},updateChangeData:{type:Function},problemId:{type:[String,Number],default:""}},data(){return{formUniqueKey:"",submitFormInProgress:!1,scenario:"create",panel:"agent",page:"add_id_with_form",form_id:this.problemId,category:"",fetchFormFieldApi:"/api/form/render/",selectedForm:"",formSelected:!1}},beforeMount(){this.category=this.$store.getters.getProblemAssociateCategory,this.getDefaultFormValue()},mixins:[ve],methods:{getDefaultFormValue(){this.showLoader=!0,S.get("/from/forms/changes").then(e=>{this.selectedForm=e.data.data.data[0],this.showLoader=!1,this.updateFetchApi()}).catch(e=>{this.showLoader=!1,A(e,"faveo-form")})},updateFetchApi(){this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey),this.$store.dispatch("unsetValidationError"),this.fetchFormFieldApi="/render/form?id="+this.selectedForm.id+"&mode=render",setTimeout(()=>{this.$store.dispatch("createNewFormInstance",{formUniqueKey:this.formUniqueKey,scenario:this.scenario||this.mode}),this.formSelected=!0},1)},popUpSubmit(){document.getElementById("problem-create-change-submit").click()},formSubmit(e,t){this.onSubmit()},afterSubmit(e){setTimeout(()=>{this.updateChangeData(),this.category==="activity"&&window.emitter.emit("updateProblem"+this.category),this.onClose()},1e3)}},beforeDestroy(){this.$store.dispatch("unsetAlert")},components:{FormWithCaptcha:gt,FormRenderer:we}},w1=e=>(K("data-v-f177fcb9"),e=e(),z(),e),k1={class:"prb-new-change"},C1={key:1,id:"change_modal_body"},D1=["disabled"],S1=w1(()=>a("i",{class:"fas fa-save"},null,-1));function F1(e,t,s,d,n,i){const h=u("custom-loader"),_=u("loader"),f=u("alert"),p=u("FormRenderer"),b=u("ValidationObserver"),k=u("FormWithCaptcha"),D=u("modal");return o(),l("div",k1,[n.submitFormInProgress?(o(),v(h,{key:0})):c("",!0),s.showModal?(o(),v(D,{key:1,showModal:s.showModal,onClose:s.onClose},{title:y(()=>[a("h4",null,r(e.trans("attach_new_change")),1)]),fields:y(()=>[e.showLoader?(o(),v(_,{key:0})):c("",!0),n.formUniqueKey&&n.formSelected?(o(),l("div",C1,[m(f,{componentName:"faveo-form"}),m(k,{loading:!e.showLoader,btnClass:"btn btn-primary float-right",btnName:"submit",componentName:"faveo-form",btn_id:"problem-create-change-submit",formSubmit:i.formSubmit,recaptchaContainerClass:"mt-2",disableSubmit:n.submitFormInProgress},{fields:y(()=>[m(b,{ref:"faveoFormObserver"},{default:y(({values:P,errors:E,validate:M})=>[(o(),v(p,{key:n.formUniqueKey,fetchFormFieldApi:n.fetchFormFieldApi,formUniqueKey:n.formUniqueKey,scenario:n.scenario,category:"changes",panel:n.panel},null,8,["fetchFormFieldApi","formUniqueKey","scenario","panel"]))]),_:1},512)]),_:1},8,["loading","formSubmit","disableSubmit"])])):c("",!0)]),controls:y(()=>[e.showLoader?c("",!0):(o(),l("button",{key:0,type:"submit",class:"btn btn-primary pull-right",disabled:n.submitFormInProgress,onClick:t[0]||(t[0]=P=>i.popUpSubmit())},[S1,g("  "+r(e.trans("save")),1)],8,D1))]),_:1},8,["showModal","onClose"])):c("",!0)])}const M1=C(v1,[["render",F1],["__scopeId","data-v-f177fcb9"]]);const I1={name:"problem-actions",description:"Problem actions component",props:{problem:{type:Object,default:()=>{}},updateChangeDetails:{type:Function}},data(){return{showPlanningModal:!1,showAttach:!1,showAttachTicket:!1,showChangeModal:!1,showDetachModal:!1,showProblemStatus:!1,showDeleteModal:!1,identifier:"",change_type:"",actions:"",showNewChangeModal:!1}},beforeMount(){this.getActions()},created(){window.emitter.on("updateProblemActions",this.getActions)},methods:{getActions(){this.actions="",S.get("/service-desk/api/problem-action/"+this.problem.id).then(e=>{this.actions=e.data.data.actions,window.emitter.emit("problemActionsList",this.actions)}).catch(e=>{this.actions=""})},subString(e,t=15){return oe(e,t)},planningMethod(e){this.showPlanningModal=!0,this.identifier=e},problemChange(e){this.change_type=e,this.showChangeModal=!0},onClose(){this.showPlanningModal=!1,this.showAttach=!1,this.showAttachTicket=!1,this.showChangeModal=!1,this.showDeleteModal=!1,this.showDetachModal=!1,this.showProblemStatus=!1,this.showNewChangeModal=!1,this.getActions(),this.$store.dispatch("unsetValidationError")}},components:{"problem-planning-modal":ea,"problem-assets":jv,"problem-tickets":Jv,"problem-change":n1,"problem-detach":ta,"problem-status-modal":y1,"delete-modal":De,"problem-new-change":M1}},Fe=e=>(K("data-v-81a42577"),e=e(),z(),e),A1={class:"card-tools"},P1={class:"btn-group"},T1={type:"button",class:"btn btn-tool dropdown-toggle","data-toggle":"dropdown"},V1=Fe(()=>a("i",{class:"fas fa-sync"},null,-1)),L1={class:"dropdown-menu"},U1={class:"btn-group"},$1={type:"button",class:"btn btn-tool dropdown-toggle","data-toggle":"dropdown"},N1=Fe(()=>a("i",{class:"fas fa-link"},null,-1)),E1={class:"dropdown-menu"},q1=Fe(()=>a("i",{class:"fas fa-server"},null,-1)),O1=Fe(()=>a("i",{class:"fas fa-ticket"},null,-1)),j1={class:"dropdown-item text-dark"},R1=Fe(()=>a("i",{class:"fas fa-sync"},null,-1)),x1={key:0},B1={class:"ml_10"},K1=Fe(()=>a("i",{class:"far fa-circle"},null,-1)),z1={key:1},H1={class:"ml_10"},Y1=Fe(()=>a("i",{class:"far fa-circle"},null,-1)),W1={class:"ml_10"},J1=Fe(()=>a("i",{class:"far fa-circle"},null,-1)),G1={class:"btn-group"},Z1={type:"button",class:"btn btn-tool dropdown-toggle","data-toggle":"dropdown"},Q1=Fe(()=>a("i",{class:"fa fa-cog"},null,-1)),X1={class:"dropdown-menu dropdown-menu-right"};function ew(e,t,s,d,n,i){const h=u("router-link"),_=u("reuse-loader"),f=u("problem-planning-modal"),p=u("problem-assets"),b=u("problem-tickets"),k=u("problem-change"),D=u("problem-new-change"),P=u("problem-detach"),E=u("problem-status-modal"),M=u("delete-modal"),F=N("tooltip");return o(),l("div",A1,[a("div",P1,[a("button",T1,[V1,g(" "+r(e.lang("planning")),1)]),a("div",L1,[a("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[0]||(t[0]=T=>i.planningMethod("root-cause"))},r(e.lang("root_cause")),1),a("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[1]||(t[1]=T=>i.planningMethod("impact"))},r(e.lang("impact")),1),a("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[2]||(t[2]=T=>i.planningMethod("symptoms"))},r(e.lang("symptoms")),1),a("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[3]||(t[3]=T=>i.planningMethod("solution"))},r(e.lang("solution")),1)])]),a("div",U1,[a("button",$1,[N1,g(" "+r(e.lang("associate")),1)]),a("div",E1,[a("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[4]||(t[4]=T=>n.showAttach=!0)},[q1,g(" "+r(e.lang("attach_asset")),1)]),a("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[5]||(t[5]=T=>n.showAttachTicket=!0)},[O1,g(" "+r(e.lang("attach_ticket")),1)]),a("a",j1,[R1,g(" "+r(e.lang("change")),1)]),n.actions.problem_change_detach?(o(),l("div",x1,[a("a",{href:"javascript:;",class:"dropdown-item text-dark",onClick:t[6]||(t[6]=T=>n.showDetachModal=!0)},[a("span",B1,[K1,g(" "+r(e.lang("detach"))+" ",1),w((o(),l("b",null,[g(r(i.subString(s.problem.change.subject,10)),1)])),[[F,s.problem.change.subject]])])])])):(o(),l("div",z1,[a("a",{href:"javascript:;",onClick:t[7]||(t[7]=T=>n.showNewChangeModal=!0),class:"dropdown-item text-dark"},[a("span",H1,[Y1,g(" "+r(e.lang("attach_new_change")),1)])]),a("a",{href:"javascript:;",onClick:t[8]||(t[8]=T=>i.problemChange("attach_existing_change")),class:"dropdown-item text-dark"},[a("span",W1,[J1,g(" "+r(e.lang("attach_existing_change")),1)])])]))])]),a("div",G1,[a("button",Z1,[Q1,g(" "+r(e.lang("more")),1)]),a("div",X1,[n.actions.problem_edit?(o(),v(h,{key:0,class:"dropdown-item text-dark",to:"/service-desk/problem/"+s.problem.id+"/edit"},{default:y(()=>[g(r(e.lang("edit")),1)]),_:1},8,["to"])):c("",!0),n.actions.problem_delete?(o(),l("a",{key:1,class:"dropdown-item text-dark",href:"javascript:;",onClick:t[9]||(t[9]=T=>n.showDeleteModal=!0)},r(e.lang("delete")),1)):c("",!0),n.actions.problem_close?(o(),l("a",{key:2,class:"dropdown-item text-dark",href:"javascript:;",onClick:t[10]||(t[10]=T=>n.showProblemStatus=!0)},r(e.lang("close")),1)):c("",!0)])]),a("template",null,[m(_,{"animation-duration":4e3,size:0})]),m(q,{name:"modal"},{default:y(()=>[n.showPlanningModal?(o(),v(f,{key:0,onClose:i.onClose,showModal:n.showPlanningModal,identifier:n.identifier,problemId:s.problem.id,alertCompName:"problem-view",updateChangeData:s.updateChangeDetails},null,8,["onClose","showModal","identifier","problemId","updateChangeData"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showAttach?(o(),v(p,{key:0,onClose:i.onClose,showModal:n.showAttach,problemId:s.problem.id,updateChangeData:s.updateChangeDetails},null,8,["onClose","showModal","problemId","updateChangeData"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showAttachTicket?(o(),v(b,{key:0,onClose:i.onClose,showModal:n.showAttachTicket,problemId:s.problem.id,alertCompName:"problem-view",updateChangeData:s.updateChangeDetails},null,8,["onClose","showModal","problemId","updateChangeData"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showChangeModal?(o(),v(k,{key:0,onClose:i.onClose,showModal:n.showChangeModal,problemId:s.problem.id,type:n.change_type,updateChangeData:s.updateChangeDetails},null,8,["onClose","showModal","problemId","type","updateChangeData"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showNewChangeModal?(o(),v(D,{key:0,onClose:i.onClose,showModal:n.showNewChangeModal,updateChangeData:s.updateChangeDetails,problemId:s.problem.id},null,8,["onClose","showModal","updateChangeData","problemId"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showDetachModal?(o(),v(P,{key:0,onClose:i.onClose,showModal:n.showDetachModal,changeId:s.problem.change.id,problemId:s.problem.id,alertCompName:"problem-view",updateChangeData:s.updateChangeDetails},null,8,["onClose","showModal","changeId","problemId","updateChangeData"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showProblemStatus?(o(),v(E,{key:0,onClose:i.onClose,showModal:n.showProblemStatus,problemId:s.problem.id,updateChangeData:s.updateChangeDetails},null,8,["onClose","showModal","problemId","updateChangeData"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showDeleteModal?(o(),v(M,{key:0,onClose:i.onClose,showModal:n.showDeleteModal,alertComponentName:"problem-view",deleteUrl:"/service-desk/api/problem-delete/"+s.problem.id,redirectUrl:"/service-desk/problem/list",from:"agent"},null,8,["onClose","showModal","deleteUrl"])):c("",!0)]),_:1})])}const tw=C(I1,[["render",ew],["__scopeId","data-v-81a42577"]]);const sw={name:"problem-details",description:"Problem details page",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},props:{problem:{type:Object,default:()=>{}},updateData:{type:Function}},data(){return{showDescription:!1}},computed:{icon(){var e=this.problem.attachment;if(e)switch(e.type){case"pdf":return"fas fa-file-pdf";case"xls":return"fas fa-file-excel";case"txt":case"text":return"fas fa-file-code";case"png":case"jpg":case"jpeg":case"gif":return"fas fa-file-image";default:return"fas fa-file-alt"}}},methods:{subString(e,t=15){return oe(e,t)},onClose(){this.showDescription=!1,this.$store.dispatch("unsetValidationError")},downloadFile(e){window.open(e)}},components:{"problem-actions":tw,"problem-description":bv}},Kt=e=>(K("data-v-b60c3703"),e=e(),z(),e),aw={class:"card card-light"},nw={class:"card-header"},ow={class:"card-title"},iw={class:"card-body"},lw={class:"row"},rw={class:"col-md-12"},dw={class:"callout callout-info bg-info"},cw={class:"row"},uw={class:"col-md-4"},hw={class:"col-md-4"},mw={class:"col-md-4"},_w={class:"col-md-12"},pw={class:"row"},fw={class:"col-md-6 info-row d-flex"},gw={class:"col-md-6"},bw={class:"col-md-6"},yw={class:"text-primary"},vw={class:"col-md-6 info-row d-flex"},ww={class:"col-md-6"},kw={class:"col-md-6"},Cw={class:"text-primary"},Dw={class:"col-md-6 info-row d-flex"},Sw={class:"col-md-6"},Fw={class:"col-md-6"},Mw={class:"text-primary"},Iw={key:0,class:"col-md-6 info-row d-flex"},Aw={class:"col-md-6"},Pw={class:"col-md-6"},Tw={class:"text-primary"},Vw={key:1,class:"col-md-6 info-row d-flex"},Lw={class:"col-md-6"},Uw={class:"col-md-6"},$w={class:"text-primary"},Nw={class:"col-md-6 info-row d-flex"},Ew={class:"col-md-6"},qw={class:"col-md-6"},Ow=Kt(()=>a("i",{class:"fas fa-file-code"},"  ",-1)),jw={class:"col-md-6 info-row d-flex"},Rw={class:"col-md-6"},xw={class:"col-md-6"},Bw={key:0},Kw={onClick:"return false",class:"text-primary"},zw={key:0},Hw={key:1,onClick:"return false",class:"text-primary"},Yw={key:3,class:"col-md-6 info-row d-flex"},Ww={class:"col-md-6"},Jw={class:"col-md-6"},Gw={key:0},Zw={class:"line"},Qw=["src"],Xw=["onClick"],ek=Kt(()=>a("i",{class:"fas fa-download"},null,-1)),tk=Kt(()=>a("br",null,null,-1)),sk={key:1};function ak(e,t,s,d,n,i){const h=u("problem-actions"),_=u("problem-description"),f=N("tooltip");return o(),l("div",aw,[a("div",nw,[w((o(),l("h3",ow,[g(r(i.subString(s.problem.subject,50)),1)])),[[f,s.problem.subject]]),m(h,{problem:s.problem,updateChangeDetails:s.updateData},null,8,["problem","updateChangeDetails"])]),a("div",iw,[a("div",lw,[a("div",rw,[a("div",dw,[a("div",cw,[a("div",uw,[a("b",null,r(e.lang("created_date"))+" : ",1),w((o(),l("span",null,[g(r(d.formattedTime(s.problem.created_at)),1)])),[[f,d.formattedTime(s.problem.created_at)]])]),a("div",hw,[a("b",null,r(e.lang("status"))+" : ",1),w((o(),l("span",null,[g(r(i.subString(s.problem.status_type_id.name)),1)])),[[f,s.problem.status_type_id.name]])]),a("div",mw,[a("b",null,r(e.lang("requester"))+" : ",1),w((o(),l("span",null,[g(r(s.problem.requester_id.name?i.subString(s.problem.requester_id.name):i.subString(s.problem.requester_id.email)),1)])),[[f,s.problem.requester_id.name?s.problem.requester_id.name:s.problem.requester_id.email]])])])])])]),a("div",_w,[a("div",pw,[a("div",fw,[a("div",gw,[a("label",null,r(e.lang("department")),1)]),a("div",bw,[w((o(),l("a",yw,[g(r(s.problem.department_id?i.subString(s.problem.department_id.name):"---"),1)])),[[f,s.problem.department_id?s.problem.department_id.name:"---"]])])]),a("div",vw,[a("div",ww,[a("label",null,r(e.lang("priority")),1)]),a("div",kw,[w((o(),l("a",Cw,[g(r(i.subString(s.problem.priority_id.name)),1)])),[[f,s.problem.priority_id.name]])])]),a("div",Dw,[a("div",Sw,[a("label",null,r(e.lang("impact")),1)]),a("div",Fw,[w((o(),l("a",Mw,[g(r(i.subString(s.problem.impact_id.name)),1)])),[[f,s.problem.impact_id.name]])])]),s.problem.location_id?(o(),l("div",Iw,[a("div",Aw,[a("label",null,r(e.lang("location")),1)]),a("div",Pw,[w((o(),l("a",Tw,[g(r(s.problem.location_id?i.subString(s.problem.location_id.name):"---"),1)])),[[f,s.problem.location_id?s.problem.location_id.name:"---"]])])])):c("",!0),s.problem.assigned_id?(o(),l("div",Vw,[a("div",Lw,[a("label",null,r(e.lang("assigned")),1)]),a("div",Uw,[w((o(),l("a",$w,[g(r(s.problem.assigned_id?i.subString(s.problem.assigned_id.name):"---"),1)])),[[f,s.problem.assigned_id?s.problem.assigned_id.name:"---"]])])])):c("",!0),a("div",Nw,[a("div",Ew,[a("label",null,r(e.lang("description")),1)]),a("div",qw,[a("a",{href:"javascript:;",class:"btn btn-info btn-xs",onClick:t[0]||(t[0]=p=>n.showDescription=!0)},[Ow,g(r(e.lang("show_description")),1)])])]),s.problem.custom_field_values&&s.problem.custom_field_values.length>0?(o(!0),l(I,{key:2},$(s.problem.custom_field_values,p=>(o(),l("div",jw,[a("div",Rw,[a("label",null,r(p.label),1)]),a("div",xw,[Array.isArray(p.value)?(o(),l("div",Bw,[(o(!0),l(I,null,$(p.value,(b,k)=>w((o(),l("a",Kw,[g(r(i.subString(b)),1),k!=Object.keys(p.value).length-1?(o(),l("span",zw,",")):c("",!0),g("  ")])),[[f,b]])),256))])):w((o(),l("a",Hw,[g(r(p.field_type=="date"?p.value:p?i.subString(p.value):"---"),1)])),[[f,p.field_type=="date"?p.value:p.value?p.value.replace(/\r?\n/g,"<br />"):"---"]])])]))),256)):c("",!0),s.problem.attachment.length>0?(o(),l("div",Yw,[a("div",Ww,[a("label",null,r(e.trans("attachments")),1)]),a("div",Jw,[s.problem.attachment.length>0?(o(),l("span",Gw,[(o(!0),l(I,null,$(s.problem.attachment,p=>(o(),l(I,null,[a("span",Zw,[w((o(),l("span",null,[a("img",{src:p.thumbnail_url,class:"attach_img"},null,8,Qw),g(" "+r(i.subString(p.name,15))+" "+r("("+p.size+")"),1)])),[[f,p.name]]),w((o(),l("a",{id:"download",onClick:b=>i.downloadFile(p.download_url),href:"javascript:;"},[g("  "),ek],8,Xw)),[[f,e.trans("download")]])]),tk],64))),256))])):(o(),l("span",sk,"---"))])])):c("",!0)])])]),m(q,{name:"modal"},{default:y(()=>[n.showDescription?(o(),v(_,{key:0,onClose:i.onClose,showModal:n.showDescription,description:s.problem.description},null,8,["onClose","showModal","description"])):c("",!0)]),_:1})])}const nk=C(sw,[["render",ak],["__scopeId","data-v-b60c3703"]]);const ok={name:"problem-associated-assets",description:"Problem associated assets table page",props:{category:{type:String,default:"inbox"},apiUrl:{type:String,default:""},problemId:{type:[String,Number],default:""},componentTitle:{type:String,default:""},disableLoader:{type:Boolean,default:!1}},data(){return{selectedTickets:this.tickets,columns:["name","managed_by","used_by","contract","action"],options:{},apiEndPoint:this.apiUrl,showModal:!1,assetId:"",totalCount:"",searchTerm:""}},beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},headings:{name:this.lang("name"),managed_by:this.lang("managed_by"),used_by:this.lang("used_by"),contract:this.lang("contract"),action:this.lang("action")},columnsClasses:{name:"associate-name",managed_by:"associate-manage",used_by:"associate-used",contract:"associate-contract",action:"associate-action"},texts:{filter:"",limit:""},templates:{name:function(t,s){return e.h(se,{to:"/service-desk/"+e.category+"/"+s.id+"/show"},s.name)},managed_by(t,s){var d,n;return((n=(d=s.managed_by)==null?void 0:d.full_name)==null?void 0:n.replace(/<[^>]+>/g,""))??"--"},used_by(t,s){var d,n;return((n=(d=s.used_by)==null?void 0:d.full_name)==null?void 0:n.replace(/<[^>]+>/g,""))??"--"},contract:function(t,s){return s.contract&&!Array.isArray(s.contract)?e.h(se,{to:"/service-desk/contracts/"+s.contract.id+"/show"},s.contract.name):"--"},action:function(t,s){let d=e.h("i",{class:"fas fa-unlink"});return e.h("a",{href:"javascript:;",class:"btn btn-primary",title:this.trans("detach"),onClick(){e.showModal=!0,e.assetId=s.id}},[d])}},sortable:["name"],filterable:["name"],pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return e.searchTerm=t.query.trim(),{"sort-field":t.orderBy?t.orderBy:"name","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return e.totalCount=t.data.total,{data:t.data.data.map(s=>(s.detach=!0,s.problem_id=e.problemId,s.compName=e.componentTitle,s)),count:e.totalCount}}}},methods:{onClose(){this.showModal=!1,window.emitter.emit("updateProblemActions")},handelLoader(e){this.$emit("loaderValue",e)}},watch:{totalCount(e){!this.searchTerm&&e===0&&window.emitter.emit("updateProblemTables")},searchTerm(e){this.searchTerm=e}},components:{"problem-asset-detach":ta}},ik={id:"problem_assets"};function lk(e,t,s,d,n,i){const h=u("data-table"),_=u("problem-asset-detach");return o(),l("div",ik,[m(h,{url:n.apiEndPoint,dataColumns:n.columns,option:n.options,scroll_to:"changes-associates",componentTitle:s.componentTitle,onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","componentTitle","onLoaderState","disableLoader"]),m(q,{name:"modal"},{default:y(()=>[n.showModal?(o(),v(_,{key:0,onClose:i.onClose,showModal:n.showModal,assetId:n.assetId,problemId:s.problemId,compName:s.componentTitle},null,8,["onClose","showModal","assetId","problemId","compName"])):c("",!0)]),_:1})])}const rk=C(ok,[["render",lk]]),dk={name:"problem-updates-delte-modal",description:"Problem Updates Delete Modal component",props:{showModal:{type:Boolean,default:!1},problemId:{type:[String,Number],default:""},onClose:{type:Function},identifier:{type:String,default:""}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1,category:""}},beforeMount(){this.category=this.$store.getters.getProblemAssociateCategory},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,S.delete("/service-desk/api/delete/general-popup/"+this.problemId+"/sd_problem/"+this.identifier).then(e=>{this.category,window.emitter.emit("updateProblem"+this.category),this.onClose(),U(e,"problem-view"),this.loading=!1,this.isDisabled=!0}).catch(e=>{this.loading=!1,this.isDisabled=!0,A(e,"problem-view"),this.onClose()})}}},ck={class:"modal-title"},uk={key:0},hk={key:1,class:"row"},mk=["disabled"],_k=a("i",{class:"fas fa-trash","aria-hidden":"true"},null,-1);function pk(e,t,s,d,n,i){const h=u("reuse-loader"),_=u("modal");return s.showModal?(o(),v(_,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{title:y(()=>[a("h4",ck,r(e.lang("delete")),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",uk,[a("span",null,r(e.lang("are_you_sure")),1)])),n.loading?(o(),l("div",hk,[m(h,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=f=>i.onSubmit()),class:"btn btn-danger",disabled:n.isDisabled},[_k,g(" "+r(e.lang("delete")),1)],8,mk)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const fk=C(dk,[["render",pk]]);const gk={name:"problem-planning",description:"Problem planning component",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime)}},props:{problemId:{type:[String,Number],default:""}},data(){return{problemUpdates:"",loading:!1,showProblemUpdate:!1,showUpdateDelete:!1,identifier:"",refreshPlanning:!1}},beforeMount(){this.getDetails()},created(){window.emitter.on("updateProblemdetails",()=>this.refreshPlanning=!0)},methods:{getDetails(){this.loading=!0,S.get("/service-desk/api/problem-planning/"+this.problemId).then(e=>{this.loading=!1,this.problemUpdates=e.data.data.planning_popups,this.problemUpdates.length===0&&(window.emitter.emit("updateProblemActions"),window.emitter.emit("updateProblemTables"))}).catch(e=>{this.loading=!1})},getFont(e){return e==="root-cause"?"ambulance":e==="impact"?"anchor":e==="symptoms"?"battery-empty":"thumbs-up"},getIcon(e){if(e)return e.type==="pdf"?"fas fa-file-pdf":e.type==="xls"?"fas fa-file-excel":e.type==="txt"||e.type==="text"?"fas fa-file-code":e.type==="png"||e.type==="jpg"||e.type==="jpeg"||e.type==="gif"||e.type==="PNG"||e.type==="JPG"||e.type==="JPEG"||e.type==="GIF"?"fas fa-file-image":"fas fa-file-alt"},formatBytes(e,t){if(e==0)return"0 Bytes";var s=1024,d=t||2,n=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(s));return parseFloat((e/Math.pow(s,i)).toFixed(d))+" "+n[i]},downloadFile(e,t){window.open(this.basePath()+"/service-desk/download/"+e+"/"+t+"/attachment")},updateMethod(e){this.showProblemUpdate=!0,this.identifier=e},deleteMethod(e){this.showUpdateDelete=!0,this.identifier=e},onClose(){this.showProblemUpdate=!1,this.showUpdateDelete=!1,window.emitter.emit("updateProblemActions"),this.$store.dispatch("unsetValidationError")}},watch:{loading(e){this.$emit("loaderValue",e)},refreshPlanning(e,t){e===!0&&this.getDetails(),this.refreshPlanning=!1}},components:{"problem-update-modal":ea,"problem-update-delete-modal":fk}},nt=e=>(K("data-v-90d20e7c"),e=e(),z(),e),bk={class:"prb-plan"},yk={key:0,class:"timeline"},vk={class:"time-label"},wk={class:"bg-gray"},kk={class:"pln-details"},Ck={class:"timeline-item"},Dk={class:"time float-left"},Sk={key:0,class:"solution_title"},Fk=nt(()=>a("i",{class:"far fa-clock"},null,-1)),Mk={class:"timeline-header pb-37"},Ik=["onClick"],Ak=nt(()=>a("i",{class:"fas fa-trash"},null,-1)),Pk=["onClick"],Tk=nt(()=>a("i",{class:"fas fa-edit"},null,-1)),Vk={class:"timeline-body break"},Lk=["innerHTML"],Uk={key:0,class:"timeline-footer planning_footer"},$k={class:"pln-attach"},Nk=["onClick"],Ek=nt(()=>a("i",{class:"fas fa-download"},null,-1)),qk=nt(()=>a("div",{class:"prb-icon"},[a("i",{class:"far fa-clock bg-gray"})],-1)),Ok={key:1,class:"text-center"};function jk(e,t,s,d,n,i){const h=u("problem-update-modal"),_=u("problem-update-delete-modal"),f=N("tooltip");return o(),l("div",bk,[n.problemUpdates.length>0?(o(),l("div",yk,[(o(!0),l(I,null,$(n.problemUpdates,(p,b)=>(o(),l(I,null,[a("div",vk,[a("span",wk,r(e.lang(p.key)),1)]),a("div",kk,[a("i",{class:j("fas fa-"+i.getFont(p.key)+" bg-blue")},null,2),a("div",Ck,[a("span",Dk,[p.title?(o(),l("span",Sk,r(p.title)+"   ",1)):c("",!0),Fk,g(" "+r(d.formattedTime(p.updated_at)),1)]),a("h3",Mk,[a("button",{class:"btn btn-default btn-xs btn-right ml-1",onClick:k=>i.deleteMethod(p.key)},[Ak,g(" "+r(e.lang("delete")),1)],8,Ik),a("button",{class:"btn btn-default btn-xs btn-right",onClick:k=>i.updateMethod(p.key)},[Tk,g(" "+r(e.lang("edit")),1)],8,Pk)]),a("div",Vk,[a("span",{class:"text-muted",id:"log_desc",innerHTML:p.description},null,8,Lk)]),p.attachment?(o(),l("div",Uk,[a("span",$k,[w((o(),l("span",null,[a("i",{class:j(i.getIcon(p.attachment))},null,2),g(" "+r(p.attachment.value)+" "+r("("+i.formatBytes(p.attachment.size)+")"),1)])),[[f,p.attachment.value]]),w((o(),l("a",{id:"download",onClick:k=>i.downloadFile(p.attachment.id,p.attachment.owner)},[g("  "),Ek],8,Nk)),[[f,e.lang("download")]])])])):c("",!0)])])],64))),256)),qk])):c("",!0),!n.loading&&n.problemUpdates.length===0?(o(),l("h6",Ok,r(e.lang("no_data_found")),1)):c("",!0),m(q,{name:"modal"},{default:y(()=>[n.showProblemUpdate?(o(),v(h,{key:0,onClose:i.onClose,showModal:n.showProblemUpdate,identifier:n.identifier,problemId:s.problemId,alertCompName:"problem-view"},null,8,["onClose","showModal","identifier","problemId"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showUpdateDelete?(o(),v(_,{key:0,onClose:i.onClose,showModal:n.showUpdateDelete,identifier:n.identifier,problemId:s.problemId,alertCompName:"problem-view"},null,8,["onClose","showModal","identifier","problemId"])):c("",!0)]),_:1})])}const Rk=C(gk,[["render",jk],["__scopeId","data-v-90d20e7c"]]);const xk={name:"problem-activity",description:"Problem activity page",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},props:{problemId:{type:[String,Number],default:""}},data(){return{loading:!0,apiUrl:"/service-desk/api/problem-log/"+this.problemId,activity_log:[],perPage:"10",total:0,maxSize:5,pagination:1,paramsObj:{},filtering:!1,sort_key:"desc",refreshActivity:!1}},beforeMount(){this.paramsObj.page=this.pagination,this.getValues(this.paramsObj)},created(){window.emitter.on("updateProblemactivity",()=>this.refreshActivity=!0)},watch:{pagination(e,t){this.filtering=!0;var s=document.getElementById("activity_log_div");return s.scrollIntoView({behavior:"smooth"}),this.paramsObj.page=e,this.getValues(this.paramsObj),e},loading(e){this.$emit("loaderValue",e)},filtering(e){this.$emit("loaderValue",e)},refreshActivity(e,t){e===!0&&this.getUpdateActivity(),this.refreshActivity=!1}},computed:{PerPage:function(){return this.perPage?parseInt(this.perPage):10},Records:function(){return this.total?parseInt(this.total):0}},methods:{getUpdateActivity(){this.pagination=1,this.sort_key="desc",this.perPage=10,this.total=0,this.paramsObj.page=1,this.paramsObj.limit=10,this.paramsObj["sort-order"]="desc",this.getValues(this.paramsObj)},commonFilter(){this.filtering=!0,this.pagination=1,this.paramsObj.page=1,this.getValues(this.paramsObj)},logLimit(e){this.paramsObj.limit=e,this.commonFilter()},orderBy(e){this.sort_key=e,this.paramsObj["sort-order"]=e,this.commonFilter()},getValues(e){S.get(this.apiUrl,{params:e}).then(t=>{this.loading=!1,this.filtering=!1,this.activity_log=t.data.data.problem_activity_logs.data,this.activity_log.forEach(function(s,d){s.name="<div>"+s.name+"</div>"}),this.total=t.data.data.problem_activity_logs.total,this.perPage=t.data.data.problem_activity_logs.per_page}).catch(t=>{this.loading=!1,this.filtering=!1})},checkDate(e){if(e==0)return!0;var t=this.formattedDate(this.activity_log[e-1].created_at),s=this.formattedDate(this.activity_log[e].created_at);if(t!=s)return!0},showThreadEnd(e){return e===this.activity_log.length-1}},components:{"activity-parser":xe}},Me=e=>(K("data-v-d41c3681"),e=e(),z(),e),Bk={class:"row",id:"activity_log_div"},Kk={class:"col-sm-12 mb-2"},zk={key:0,id:"select_limit"},Hk=Me(()=>a("option",{value:"10"},"10",-1)),Yk=Me(()=>a("option",{value:"25"},"25",-1)),Wk=Me(()=>a("option",{value:"50"},"50",-1)),Jk=Me(()=>a("option",{value:"100"},"100",-1)),Gk=[Hk,Yk,Wk,Jk],Zk={key:1,id:"choose_order"},Qk={id:"sort_btn",type:"button","data-toggle":"dropdown",class:"btn btn-default dropdown-toggle"},Xk={class:"dropdown-menu",style:{"z-index":"9999"}},eC=Me(()=>a("i",{class:"fas fa-sort-amount-up"},null,-1)),tC=Me(()=>a("i",{class:"fas fa-sort-amount-down"},null,-1)),sC={key:2,id:"page_div"},aC={class:"col-md-12"},nC={key:0,class:"timeline"},oC={key:0,class:"time-label"},iC={class:"bg-default border"},lC=Me(()=>a("i",{class:"far fa-dot-circle"},null,-1)),rC={class:"timeline-item"},dC={class:"time"},cC=Me(()=>a("i",{class:"far fa-clock"},null,-1)),uC={key:0,class:"timeline-header"},hC={class:"timeline-body break"},mC={key:1},_C=Me(()=>a("i",{class:"far fa-clock bg-gray"},null,-1)),pC=[_C],fC={key:1,class:"float-right",id:"page_div"},gC={key:0,class:"col-sm-12"},bC={class:"text-center"};function yC(e,t,s,d,n,i){const h=u("uib-pagination"),_=u("faveo-image-element"),f=u("router-link"),p=u("activity-parser");return o(),l("div",Bk,[a("div",Kk,[!n.loading&&n.activity_log.length>0?(o(),l("div",zk,[w(a("select",{class:"form-control cursor-pointer","onUpdate:modelValue":t[0]||(t[0]=b=>n.perPage=b),onChange:t[1]||(t[1]=b=>i.logLimit(n.perPage))},Gk,544),[[qe,n.perPage]])])):c("",!0),!n.loading&&n.activity_log.length>0?(o(),l("div",Zk,[a("button",Qk,r(e.lang("created_time"))+" - "+r(e.lang(n.sort_key)),1),a("div",Xk,[a("a",{href:"javascript:;",class:"dropdown-item",onClick:t[2]||(t[2]=b=>i.orderBy("asc"))},[eC,g(" "+r(e.lang("asc")),1)]),a("a",{href:"javascript:;",onClick:t[3]||(t[3]=b=>i.orderBy("desc")),class:"dropdown-item"},[tC,g(" "+r(e.lang("desc")),1)])])])):c("",!0),!n.loading&&n.total>10?(o(),l("div",sC,[m(h,{id:"page2",records:i.Records,modelValue:n.pagination,"onUpdate:modelValue":t[4]||(t[4]=b=>n.pagination=b),class:"pagination","boundary-links":!1,"per-page":i.PerPage,options:{chunk:n.maxSize,chunksNavigation:"scroll"}},null,8,["records","modelValue","per-page","options"])])):c("",!0)]),a("div",aC,[!n.loading&&n.activity_log.length>0?(o(),l("div",nC,[(o(!0),l(I,null,$(n.activity_log,(b,k)=>(o(),l(I,null,[i.checkDate(k)?(o(),l("div",oC,[a("span",iC,r(d.formattedDate(b.created_at)),1)])):c("",!0),a("div",null,[lC,a("div",rC,[a("span",dC,[cC,g(" "+r(d.formattedTime(b.created_at)),1)]),b.creator?(o(),l("h3",uC,[m(_,{id:"problem_img","source-url":b.creator.profile_pic,classes:["img-circle","img-bordered-sm"],"alternative-text":"User Image","img-width":25,"img-height":25},null,8,["source-url"]),m(f,{to:"/user/"+b.creator.id},{default:y(()=>[g(" "+r(b.creator.full_name),1)]),_:2},1032,["to"])])):c("",!0),a("div",hC,[m(p,{data:b.name},null,8,["data"])])])]),i.showThreadEnd(k)?(o(),l("div",mC,pC)):c("",!0)],64))),256))])):c("",!0),!n.loading&&n.total>10?(o(),l("div",fC,[m(h,{id:"page2",records:i.Records,modelValue:n.pagination,"onUpdate:modelValue":t[5]||(t[5]=b=>n.pagination=b),class:"pagination","boundary-links":!1,"per-page":i.PerPage,options:{chunk:n.maxSize,chunksNavigation:"scroll"}},null,8,["records","modelValue","per-page","options"])])):c("",!0)]),!n.filtering&&!n.loading&&n.activity_log.length===0?(o(),l("div",gC,[a("h6",bC,r(e.lang("no_data_found")),1)])):c("",!0)])}const vC=C(xk,[["render",yC],["__scopeId","data-v-d41c3681"]]);const wC={name:"problem-change-details",description:"Problem Change details page",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},props:{change:{type:[Array,Object],default:()=>[]}},methods:{subString(e,t=15){return oe(e,t)}}},kC={class:"prb-change-details"},CC={key:0,class:"row"},DC={class:"col-md-12"},SC={class:"callout callout-info bg-info"},FC={class:"row"},MC={class:"col-md-4"},IC={class:"col-md-4"},AC={class:"col-md-4"},PC={key:1,class:"col-md-12"},TC={class:"row"},VC={class:"col-md-6 info-row d-flex"},LC={class:"col-md-6"},UC={class:"col-md-6"},$C={href:"javascript:void(0)"},NC={class:"col-md-6 info-row d-flex"},EC={class:"col-md-6"},qC={class:"col-md-6"},OC={href:"javascript:void(0)"},jC={class:"col-md-6 info-row d-flex"},RC={class:"col-md-6"},xC={class:"col-md-6"},BC={href:"javascript:void(0)"},KC={class:"col-md-6 info-row d-flex"},zC={class:"col-md-6"},HC={class:"col-md-6"},YC={href:"javascript:void(0)"},WC={class:"col-md-6 info-row d-flex"},JC={class:"col-md-6"},GC={class:"col-md-6"},ZC={href:"javascript:void(0)"},QC={class:"col-md-6 info-row d-flex"},XC={class:"col-md-6"},e0={class:"col-md-6"},t0={href:"javascript:void(0)"},s0={class:"col-md-6 info-row d-flex"},a0={class:"col-md-6"},n0={class:"col-md-6"},o0={href:"javascript:void(0)"},i0={key:2,class:"row"},l0={class:"text-center"};function r0(e,t,s,d,n,i){const h=N("tooltip");return o(),l("div",kC,[Array.isArray(s.change)?c("",!0):(o(),l("div",CC,[a("div",DC,[a("div",SC,[a("div",FC,[a("div",MC,[a("b",null,r(e.lang("created_date"))+" : ",1),w((o(),l("span",null,[g(r(d.formattedTime(s.change.created_at)),1)])),[[h,d.formattedTime(s.change.created_at)]])]),a("div",IC,[a("b",null,r(e.lang("status"))+" : ",1),w((o(),l("span",null,[g(r(i.subString(s.change.status.name)),1)])),[[h,s.change.status.name]])]),a("div",AC,[a("b",null,r(e.lang("requester"))+" : ",1),w((o(),l("span",null,[g(r(s.change.requester.full_name?i.subString(s.change.requester.full_name):i.subString(s.change.requester.email)),1)])),[[h,s.change.requester.full_name?s.change.requester.full_name:s.change.requester.email]])])])])])])),Array.isArray(s.change)?(o(),l("div",i0,[a("h4",l0,r(e.lang("no_data_found")),1)])):(o(),l("div",PC,[a("div",TC,[a("div",VC,[a("div",LC,[a("label",null,r(e.lang("subject")),1)]),a("div",UC,[w((o(),l("a",$C,[g(r(i.subString(s.change.subject)),1)])),[[h,s.change.subject]])])]),a("div",NC,[a("div",EC,[a("label",null,r(e.lang("change_type")),1)]),a("div",qC,[w((o(),l("a",OC,[g(r(s.change.change_type.name),1)])),[[h,s.change.change_type.name]])])]),a("div",jC,[a("div",RC,[a("label",null,r(e.lang("impact")),1)]),a("div",xC,[w((o(),l("a",BC,[g(r(s.change.impact_type?i.subString(s.change.impact_type.name):"---"),1)])),[[h,s.change.impact_type?s.change.impact_type.name:"---"]])])]),a("div",KC,[a("div",zC,[a("label",null,r(e.lang("location")),1)]),a("div",HC,[w((o(),l("a",YC,[g(r(s.change.location?i.subString(s.change.location.title):"---"),1)])),[[h,s.change.location?s.change.location.title:"---"]])])]),a("div",WC,[a("div",JC,[a("label",null,r(e.lang("department")),1)]),a("div",GC,[w((o(),l("a",ZC,[g(r(s.change.department?i.subString(s.change.department.name):"---"),1)])),[[h,s.change.department?s.change.department.name:"---"]])])]),a("div",QC,[a("div",XC,[a("label",null,r(e.lang("team")),1)]),a("div",e0,[w((o(),l("a",t0,[g(r(s.change.team?i.subString(s.change.team.name):"---"),1)])),[[h,s.change.team?s.change.team.name:"---"]])])]),a("div",s0,[a("div",a0,[a("label",null,r(e.lang("priority")),1)]),a("div",n0,[w((o(),l("a",o0,[g(r(s.change.priority?i.subString(s.change.priority.name):"---"),1)])),[[h,s.change.priority?s.change.priority.name:"---"]])])])])]))])}const d0=C(wC,[["render",r0],["__scopeId","data-v-34ef3f0f"]]);const fs=()=>({description:"",attachments:[],inline:[],isDisabled:!0,loading:!1,selectedFile:"",showError:!1,status:"",priority:"",assign_to:"",assign:"agents",radioOptions:[{name:"agent",value:"agents"},{name:"team",value:"teams"},{name:"assign_to_me",value:"assign_to_me"}],assignChange:!1}),c0={name:"problem-bulk-action-modal",components:{DynamicSelect:G,RadioButton:Ee,AddMedia:Hs},props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},identifier:{type:String,default:""},tickets:{type:Array,required:!0},componentTitle:{type:String,required:!0},componentNameToRefresh:{type:String,default:""}},data(){return fs()},computed:{getApiParameters(){return{"supplements[ticket_id]":this.tickets,"supplements[no_email]":1}},assignLabel(){return this.lang(`problem_bulk_select_${this.assign}`)}},methods:{getAttachments(e){this.attachments=e},onChange(e,t){this[t]=e,t==="assign"&&(this.assignChange=!0,setTimeout(()=>{this.assignChange=!1},1),this.assign_to=e!="assign_to_me"?"":{id:sessionStorage.getItem("user_id")},this.isDisabled=e!="assign_to_me"),["assign_to","status","priority","description"].includes(t)&&(this.isDisabled=!e)},detectIsDisabled(){switch(this.identifier){case"change_status":return!this.status;case"change_priority":return!this.priority;case"reply":return!this.description;case"assign":return!this.assign_to}},async onSubmit(){this.loading=!0,this.isDisabled=!0;let e;switch(this.identifier){case"change_status":e={type:"status",value:this.status};break;case"change_priority":e={type:"priority",value:this.priority};break;case"assign":e={type:"assign",value:{assigneeType:this.assign,assigneeInfo:this.assign_to}};break;case"reply":e={type:"reply",value:{text:this.description,attachments:this.attachments}};break}let t={tickets:this.tickets,action:e};try{let s=await S.post("service-desk/api/problem-bulk-actions",t);Object.assign(this.$data,fs()),this.componentNameToRefresh&&(window.emitter.emit(`${this.componentNameToRefresh}refreshData`),window.emitter.emit(`${this.componentNameToRefresh}uncheckCheckbox`)),U(s,this.componentTitle)}catch(s){A(s,this.componentTitle)}finally{this.loading=!1,this.isDisabled=this.detectIsDisabled(),this.onClose()}}}},u0={class:"modal-title"},h0={key:0},m0={key:0,class:"row mr-1"},_0={key:1,class:"row"},p0={key:2,class:"row"},f0={key:3,class:"row"},g0={key:0,id:"assign_change"},b0={key:1,class:"row"},y0=["disabled"],v0=a("i",{class:"fas fa-sync"},null,-1);function w0(e,t,s,d,n,i){const h=u("add-media"),_=u("dynamic-select"),f=u("radio-button"),p=u("reuse-loader"),b=u("modal");return s.showModal?(o(),v(b,{key:0,showModal:s.showModal,onClose:s.onClose,modalBodyClass:s.identifier==="reply"?"bulk_action_modal_dimensions":""},{title:y(()=>[a("h4",u0,r(e.lang(`problem_bulk_${s.identifier}`)),1)]),fields:y(()=>[e.loading?c("",!0):(o(),l("div",h0,[s.identifier==="reply"?(o(),l("div",m0,[m(h,{attachments:e.attachments,inlineFile:e.inline,description:e.description,classname:"col-sm-12",name:"description",onAttach:i.getAttachments,onInput:i.onChange,page_name:"problem_bulk_action",id:"focus_editor"},null,8,["attachments","inlineFile","description","onAttach","onInput"])])):c("",!0),s.identifier==="change_status"?(o(),l("div",_0,[m(_,{label:e.trans("problem_bulk_select_status"),multiple:!1,name:"status",classname:"col-sm-12",apiEndpoint:"api/dependency/statuses?meta=true",value:e.status,onChange:i.onChange,required:!0},null,8,["label","value","onChange"])])):c("",!0),s.identifier==="change_priority"?(o(),l("div",p0,[m(_,{label:e.trans("problem_bulk_select_priority"),multiple:!1,name:"priority",classname:"col-sm-12",apiEndpoint:"api/dependency/priorities",value:e.priority,onChange:i.onChange,required:!0},null,8,["label","value","onChange"])])):c("",!0),s.identifier==="assign"?(o(),l("div",f0,[m(f,{name:"assign",value:e.assign,options:e.radioOptions,label:e.lang("assign_to"),onChange:i.onChange,classname:"form-group col-sm-6"},null,8,["value","options","label","onChange"]),e.assignChange?(o(),l("div",g0,[m(p,{size:30,duration:4e3,color:"#1d78ff"})])):c("",!0),!e.assignChange&&e.assign!="assign_to_me"?(o(),v(_,{key:1,label:i.assignLabel,multiple:!1,name:"assign_to",classname:"col-sm-6","api-endpoint":"api/dependency/"+e.assign,"api-parameters":i.getApiParameters,value:e.assign_to,onChange:i.onChange},null,8,["label","api-endpoint","api-parameters","value","onChange"])):c("",!0)])):c("",!0)])),e.loading?(o(),l("div",b0,[m(p,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=k=>i.onSubmit()),class:"btn btn-primary",disabled:e.isDisabled},[v0,g(" "+r(e.lang("update")),1)],8,y0)]),_:1},8,["showModal","onClose","modalBodyClass"])):c("",!0)}const k0=C(c0,[["render",w0]]),C0={name:"problem-ticket-detach-modal",description:"Problem Ticket Detach Modal component",props:{showModal:{type:Boolean,default:!1},problemId:{type:[String,Number],default:""},ticketId:{type:[String,Number],default:""},type:{type:String,default:""},onClose:{type:Function},componentTitle:{type:String,default:""}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1}},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,S.delete("/service-desk/api/problem-detach-ticket/"+this.problemId+"/"+this.ticketId).then(e=>{U(e,"problem-view"),window.emitter.emit(this.componentTitle+"refreshData"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(e=>{this.loading=!1,this.isDisabled=!1,A(e,"detach-ticket")})}}},D0={class:"modal-title"},S0={key:0},F0={key:1,class:"row"},M0=["disabled"],I0=a("i",{class:"fas fa-unlink"},null,-1);function A0(e,t,s,d,n,i){const h=u("alert"),_=u("reuse-loader"),f=u("modal");return s.showModal?(o(),v(f,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{alert:y(()=>[m(h,{componentName:"detach-ticket"})]),title:y(()=>[a("h4",D0,r(e.lang("detach")),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",S0,[a("span",null,r(e.lang("are_you_sure")),1)])),n.loading?(o(),l("div",F0,[m(_,{"animation-duration":4e3,color:"#1d78ff",size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=p=>i.onSubmit()),class:"btn btn-danger",disabled:n.isDisabled},[I0,g(" "+r(e.lang("detach")),1)],8,M0)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const P0=C(C0,[["render",A0]]);const T0={name:"problem-tickets-table",description:"Problem tickets table page",props:{problemId:{type:[String,Number],default:""},componentTitle:{type:String,default:"ProblemTickets"},disableLoader:{type:Boolean,default:!1}},data(){return{selectedTickets:this.tickets,columns:["id","ticket_number","subject","assignedTo","action"],options:{},apiEndPoint:"/service-desk/api/problem-tickets/"+this.problemId,ticketId:"",ticket_type:"",showModal:!1,ticketIds:[],bulkActions:[{name:"change_status",icon:"fas fa-exchange-alt"},{name:"change_priority",icon:"fas fa-asterisk"},{name:"assign",icon:"far fa-hand-point-right"},{name:"reply",icon:"fas fa-reply"}],action:null,showBulkActionModal:!1,componentName:"problem-associated-ticket-alert",totalCount:"",searchTerm:""}},beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},headings:{id:this.trans("id"),ticket_number:this.lang("ticket_number"),subject:this.lang("subject"),assignedTo:this.lang("assigned_to"),action:this.lang("action")},columnsClasses:{ticket_number:"associate-number",subject:"associate-subject",assignedTo:"associate-assigned",type:"associate-type",action:"associate-action"},texts:{filter:"",limit:""},templates:{subject:function(t,s){return e.h(se,{to:"/thread/"+s.id},s.subject)},ticket_number:function(t,s){return e.h(se,{to:"/thread/"+s.id},"#"+s.ticket_number)},assignedTo:function(t,s){return s.assignedTo?e.h(se,{to:"/user/"+s.assignedTo.id},s.assignedTo.full_name):s.assignedTeam?e.h("a",{href:e.basePath()+"/assign-teams/"+s.assignedTeam.id},s.assignedTeam.name):"--"},action(t,s){let d=e.h("i",{class:"fa fa-unlink"});return e.h("a",{href:"javascript:;",class:"btn btn-primary",title:this.trans("detach"),onClick(){e.onDetach(s.id,s.type)}},[d])}},sortable:["ticket_number"],filterable:["ticket_number"],pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return e.searchTerm=t.query.trim(),{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc",search_query:t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return e.totalCount=t.data.total,{data:t.data.tickets,count:e.totalCount}}}},methods:{ticketsData(e){this.ticketIds=e},performAction(e){this.action=e,this.showBulkActionModal=!0},onDetach(e,t){this.ticketId=e,this.ticket_type=t,this.showModal=!0},onClose(){this.showModal=!1,window.emitter.emit("updateProblemActions")},handelLoader(e){this.$emit("loaderValue",e)}},watch:{totalCount(e){!this.searchTerm&&e===0&&window.emitter.emit("updateProblemTables")},searchTerm(e){this.searchTerm=e}},components:{"ticket-detach-modal":P0,ProblemBulkActionModal:k0}},V0={id:"problem_tickets"},L0={key:0,class:"row bulk-actions"},U0={class:"col-sm-12"},$0={class:"btn-group float-right"},N0={type:"button",class:"btn btn-xs btn-default dropdown-toggle","data-toggle":"dropdown",id:"bulk_actions"},E0=a("i",{class:"fas fa-cog"},null,-1),q0={class:"dropdown-menu status-list dropdown-menu-right"},O0=["onClick"];function j0(e,t,s,d,n,i){const h=u("alert"),_=u("data-table"),f=u("ticket-detach-modal"),p=u("problem-bulk-action-modal");return o(),l("div",V0,[m(h,{"component-name":n.componentName},null,8,["component-name"]),m(q,{name:"fade"},{default:y(()=>[n.ticketIds.length?(o(),l("div",L0,[a("div",U0,[a("div",$0,[a("button",N0,[E0,g(" "+r(e.trans("problem_bulk_actions")),1)]),a("div",q0,[(o(!0),l(I,null,$(n.bulkActions,b=>(o(),l("a",{key:b.name,class:"dropdown-item",id:"change_status",onClick:k=>i.performAction(b.name),href:"javascript:;"},[a("i",{class:j(b.icon)},null,2),g("  "+r(e.lang(`problem_bulk_${b.name}`)),1)],8,O0))),128))])])])])):c("",!0)]),_:1}),m(_,{url:n.apiEndPoint,dataColumns:n.columns,option:n.options,scroll_to:"problem-associates",componentTitle:s.componentTitle,tickets:i.ticketsData,onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","componentTitle","tickets","onLoaderState","disableLoader"]),m(q,{name:"modal"},{default:y(()=>[n.showModal?(o(),v(f,{key:0,onClose:i.onClose,showModal:n.showModal,ticketId:n.ticketId,problemId:s.problemId,type:n.ticket_type,componentTitle:s.componentTitle},null,8,["onClose","showModal","ticketId","problemId","type","componentTitle"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[m(p,{"show-modal":n.showBulkActionModal,tickets:n.ticketIds,identifier:n.action,"component-title":n.componentName,"on-close":()=>{this.showBulkActionModal=!1},"component-name-to-refresh":s.componentTitle},null,8,["show-modal","tickets","identifier","component-title","on-close","component-name-to-refresh"])]),_:1})])}const R0=C(T0,[["render",j0]]);const x0={name:"problem-associates",description:"Problem associates page",props:{problemId:{type:[String,Number],default:""},problem:{type:Object,default:()=>{}}},data(){return{tabs:"",category:"activity",loading:!0,dynamicKeys:{details:1,assets:1,activity:1,changes:1,tickets:1}}},created(){window.emitter.on("problemActionsList",this.getActionsList),window.emitter.on("updateProblemTables",()=>this.associates("activity")),this.$store.dispatch("setProblemAssociateCategory",this.category)},methods:{getActionsList(e){this.tabs=[{id:"activity",title:"activity_log",show:!0},{id:"details",title:"planning",show:e.check_planning},{id:"assets",title:"associated_assets",show:e.associated_asset},{id:"changes",title:"associated_changes",show:e.associated_change},{id:"tickets",title:"associated_tickets",show:e.associated_ticket}]},associateMethod(e){this.loading=!0,setTimeout(()=>{this.loading=!1,this.associates(e)},3e3)},associates(e){this.category!==e&&(e!=="changes"&&(this.loading=!0),this.category=e),this.updateKey(e)},handelLoader(e){this.loading=e},updateKey(e){e!=="changes"&&(this.loading=!0),this.dynamicKeys={...this.dynamicKeys,[e]:this.dynamicKeys[e]+1}}},watch:{category(e,t){e!==t&&this.$store.dispatch("setProblemAssociateCategory",e)}},components:{"problem-associated-assets":rk,"problem-planning":Rk,"problem-activity":vC,"problem-change-details":d0,"problem-associated-tickets":R0}},B0=e=>(K("data-v-f856b6ce"),e=e(),z(),e),K0={key:0,class:"card card-light card-tabs",id:"changes-associates"},z0={class:"card-header p-0 pt-1"},H0={class:"nav nav-tabs"},Y0={key:0,class:"nav-item"},W0=["onClick"],J0={class:"nav-item ml-auto mt-04"},G0={key:0,type:"button",class:"btn btn-tool rotating","data-card-widget":"refresh"},Z0=B0(()=>a("i",{class:"fas fa-refresh"},null,-1)),Q0=[Z0],X0={class:"card-body"},eD={class:"tab-content"},tD={class:"active tab-pane",id:"activity"};function sD(e,t,s,d,n,i){const h=u("alert"),_=u("problem-planning"),f=u("problem-associated-assets"),p=u("problem-activity"),b=u("problem-change-details"),k=u("problem-associated-tickets");return n.tabs?(o(),l("div",K0,[m(h,{componentName:"problemAssociates"}),a("div",z0,[a("ul",H0,[(o(!0),l(I,null,$(n.tabs,D=>(o(),l(I,null,[D.show?(o(),l("li",Y0,[a("a",{id:"problems_tab",class:j(["nav-link",{active:n.category===D.id}]),"data-toggle":"pill",onClick:P=>i.associates(D.id)},r(e.lang(D.title)),11,W0)])):c("",!0)],64))),256)),a("li",J0,[n.loading?(o(),l("a",G0,Q0)):c("",!0)])])]),a("div",X0,[a("div",eD,[a("div",tD,[a("div",null,[n.category=="details"?(o(),v(_,{problemId:s.problemId,onLoaderValue:i.handelLoader,key:"problem_planning"+n.dynamicKeys.details},null,8,["problemId","onLoaderValue"])):c("",!0),n.category=="assets"?(o(),v(f,{componentTitle:"problemAssets",apiUrl:"/service-desk/api/asset-list?problem_ids="+s.problemId,problemId:s.problemId,category:n.category,disableLoader:"true",onLoaderValue:i.handelLoader,key:"problem_asset"+n.dynamicKeys.assets},null,8,["apiUrl","problemId","category","onLoaderValue"])):c("",!0),n.category=="activity"?(o(),v(p,{problemId:s.problemId,onLoaderValue:i.handelLoader,key:"problem_activity"+n.dynamicKeys.activity},null,8,["problemId","onLoaderValue"])):c("",!0),n.category=="changes"?(o(),v(b,{change:s.problem.change,key:"problem_change"+n.dynamicKeys.changes},null,8,["change"])):c("",!0),n.category=="tickets"?(o(),v(k,{problemId:s.problemId,componentTitle:"ProblemTickets",disableLoader:"true",onLoaderValue:i.handelLoader,key:"problem_ticket"+n.dynamicKeys.tickets},null,8,["problemId","onLoaderValue"])):c("",!0)])])])])])):c("",!0)}const aD=C(x0,[["render",sD],["__scopeId","data-v-f856b6ce"]]);const nD={name:"problem-view",description:"Problem view page",data(){return{problem:"",problem_id:"",loading:!0,counter:0}},beforeMount(){this.getValues()},created(){window.emitter.on("updateProblemAssociates",this.updateAssociates)},methods:{refreshData(){this.getValues()},updateAssociates(){this.counter+=1},getValues(){const e=window.location.pathname;this.problem_id=W(e),S.get("/service-desk/api/problem/"+this.problem_id).then(t=>{this.loading=!1,this.problem=t.data.data}).catch(t=>{this.loading=!1})}},components:{"problem-details":nk,"problem-associates":aD}},oD={class:"col-sm-12"},iD={key:1,class:"row"};function lD(e,t,s,d,n,i){const h=u("alert"),_=u("problem-details"),f=u("problem-associates"),p=u("reuse-loader");return o(),l("div",oD,[m(h,{componentName:"problem-view"}),n.loading?c("",!0):(o(),l(I,{key:0},[(o(),v(_,{problem:n.problem,key:n.problem_id,updateData:i.refreshData},null,8,["problem","updateData"])),(o(),v(f,{problemId:n.problem_id,problem:n.problem,key:"problem_associates"+n.counter},null,8,["problemId","problem"]))],64)),n.loading?(o(),l("div",iD,[m(p,{"animation-duration":4e3,size:60})])):c("",!0)])}const rD=C(nD,[["render",lD]]);const dD={name:"table-filter",description:"Table filter component",props:{metaData:{type:Array,required:!0},appliedFilters:{type:Object,default:()=>{}},from:{type:String,default:""},showCustomFilter:{type:Boolean,default:!1},updateFields:{type:Function,default:()=>{}},selectedFields:{type:Array,default:()=>[]},endPoint:{type:String,default:""},saveFilter:{type:Boolean,default:!1},filterFor:{type:String,default:""},filterNum:{type:[String,Number],default:""},redirectTo:{type:String,default:""},deleteUrl:{type:String,default:""},closeFilter:{type:Function,default:()=>{}},save_endpoint:{type:String,default:""}},data(){return{selectedFilters:this.appliedFilters,close_on_select:!this.multiple,isShowFilter:!1,componentMetaData:this.metaData,loading:!1,formStyle:{width:"49.5%"},numberStyle:{width:"20%"},showModal:!1,filterName:"",selectedFilterId:this.filterNum,departments:[],agents:[],filterMode:"",icon_class:"",icon_color:"",dashboardWidget:!1,isDefault:!1}},beforeMount(){this.updateSelectedFieldValues(),this.filterNum&&this.getFilterValue()},methods:{updatedCustomFields(e){for(var t in e)this.onChange(e[t].value,e[t].name)},updateSelectedFieldValues(){this.updateFields(this.selectedFields);for(var e in this.selectedFields)this.onChange(this.selectedFields[e].value,this.selectedFields[e].name)},onChange(e,t){this.selectedFilters[t]=e},onCancel(){this.$emit("selectedFilters","closeEvent")},onApply(){this.$emit("selectedFilters",this.selectedFilters)},onSave(e){this.$emit("selectedFilters",this.selectedFilters),this.filterMode=e,this.showModal=!0},toggleFilterPopUp(e){this.showModal=e},onReset(){this.selectedFilters={},this.loading=!0,setTimeout(()=>{this.loading=!1},1e3),this.$emit("selectedFilters","resetEvent")},getFilterValue(){this.loading=!0,axios.get("/service-desk/api/agent/sd-filter/"+this.selectedFilterId).then(e=>{this.loading=!1;let t={},s=[];this.isDefault=e.data.data.is_default,e.data.data.fields.map(d=>{d.key.indexOf("custom_")!==-1?(s.push(d),t[d.key]=d.value):t[d.key]=d.value_meta}),s.length&&this.appendCustomFieldFilter(s),this.selectedFilters=t,this.componentMetaData.map(function(d){d.section.map(function(n){t.hasOwnProperty(n.name)&&(n.value=t[n.name])})}),this.selectedFilterId=e.data.data.id,this.filterName=this.isDefault?"":e.data.data.name,this.icon_class=this.isDefault?"":{icon_class:e.data.data.icon_class},this.departments=e.data.data.departments,this.agents=e.data.data.agents,this.dashboardWidget=e.data.data.is_dashboard_widget,this.icon_color=this.isDefault?"#00C0EF":e.data.data.icon_color}).catch(e=>{})},appendCustomFieldFilter(e){this.$refs.custom_table_filter.getCustomFields(this.endPoint,e)}},components:{"dynamic-select":G,"date-time-field":$t,"number-range-field":Nt,"text-field":le,"custom-filter":Va,"save-table-filter":Et,"custom-form-fields":La}},cD={key:0,class:"card-body"},uD={class:"row"},hD={key:1,id:"table-filter"},mD={class:"row"},_D={class:"card-footer"},pD=a("span",{class:"fas fa-check"},null,-1),fD=a("span",{class:"fas fa-sync"},null,-1),gD=a("span",{class:"fas fa-trash-alt"},null,-1),bD=a("span",{class:"fas fa-save"},null,-1),yD=a("span",{class:"fas fa-undo"},null,-1),vD=a("span",{class:"fas fa-times"},null,-1);function wD(e,t,s,d,n,i){const h=u("custom-filter"),_=u("custom-loader"),f=u("custom-form-fields"),p=u("dynamic-select"),b=u("number-range-field"),k=u("text-field"),D=u("date-time-field"),P=u("save-table-filter"),E=u("faveo-box");return o(),v(E,{"box-class":"card card-light ",title:e.lang("filter")},{customActions:y(()=>[s.showCustomFilter?(o(),v(h,{key:0,updateFilterFields:s.updateFields,selectedFilterFields:s.selectedFields,endPoint:s.endPoint,ref:"custom_table_filter"},null,8,["updateFilterFields","selectedFilterFields","endPoint"])):c("",!0)]),actions:y(()=>[a("div",_D,[a("button",{id:"filter-apply-btn",class:"btn btn-primary",type:"button",onClick:t[0]||(t[0]=(...M)=>i.onApply&&i.onApply(...M))},[pD,g("  "+r(e.lang("apply")),1)]),s.saveFilter?(o(),l(I,{key:0},[s.filterNum&&!n.isDefault?(o(),l(I,{key:0},[a("button",{id:"filter-upd",class:"btn btn-primary",type:"button",onClick:t[1]||(t[1]=M=>i.onSave("update"))},[fD,g("  "+r(e.lang("update")),1)]),a("button",{id:"filetr-del",class:"btn btn-danger",type:"button",onClick:t[2]||(t[2]=M=>i.onSave("delete"))},[gD,g("  "+r(e.lang("delete")),1)])],64)):(o(),l("button",{key:1,id:"filetr-save",class:"btn btn-primary",type:"button",onClick:t[3]||(t[3]=M=>i.onSave("save"))},[bD,g("  "+r(e.lang("save")),1)]))],64)):c("",!0),a("button",{id:"reset-btn",class:"btn btn-primary",type:"button",onClick:t[4]||(t[4]=(...M)=>i.onReset&&i.onReset(...M))},[yD,g("  "+r(e.lang("reset")),1)]),s.from!=="report"?(o(),l("button",{key:1,id:"filter-cancel-btn",class:"btn btn-danger",type:"button",onClick:t[5]||(t[5]=(...M)=>i.onCancel&&i.onCancel(...M))},[vD,g("  "+r(e.lang("cancel")),1)])):c("",!0)])]),default:y(()=>[n.loading?(o(),l("div",cD,[a("div",uD,[m(_,{"animation-duration":4e3,color:"#1d78ff",size:60})])])):(o(),l("div",hD,[(o(!0),l(I,null,$(n.componentMetaData,M=>(o(),l("div",mD,[(o(!0),l(I,null,$(M.section,F=>(o(),l(I,null,[F.isCustom?(o(),v(f,{key:0,formField:F,allFields:s.selectedFields,onUpdated:i.updatedCustomFields,classname:F.className},null,8,["formField","allFields","onUpdated","classname"])):(o(),l(I,{key:1},[F.type!=="date"&&F.type!=="number"&&F.type!=="text"?(o(),v(p,{key:F.name,id:F.name,name:F.name,apiEndpoint:F.url,classname:F.className,elements:F.elements,multiple:F.isMultiple,label:e.lang(F.label),value:F.value,onChange:i.onChange,strlength:"35",hint:e.lang(F.hint)},null,8,["id","name","apiEndpoint","classname","elements","multiple","label","value","onChange","hint"])):c("",!0),F.type==="number"?(o(),v(b,{label:e.lang(F.label),formStyle:n.formStyle,value:F.value,key:F.name,id:F.name,name:F.name,classname:F.className,type:"text",onChange:i.onChange,min_placeholder:F.min_placeholder,max_placeholder:F.max_placeholder,required:!1},null,8,["label","formStyle","value","id","name","classname","onChange","min_placeholder","max_placeholder"])):c("",!0),F.type==="text"?(o(),v(k,{label:e.lang(F.label),value:F.value,key:F.name,id:F.name,name:F.name,onChange:i.onChange,classname:F.className,required:!1},null,8,["label","value","id","name","onChange","classname"])):c("",!0),F.type==="date"?(o(),v(D,{label:F.label,value:F.value,type:"datetime",key:F.name,id:F.name,name:F.name,onChange:i.onChange,range:F.range,required:!1,format:"MMMM DD YYYY, h:mm a",classname:F.className,clearable:!1,disabled:!1,editable:!0,currentYearDate:!1,"time-picker-options":F.timeOptions,isDateSelector:!1,numberStyle:n.numberStyle,confirm:!0},null,8,["label","value","id","name","onChange","range","classname","time-picker-options","numberStyle"])):c("",!0)],64))],64))),256))]))),256))])),n.showModal?(o(),v(P,{key:2,filterName:n.filterName,icon:n.icon_class,filterValues:n.selectedFilters,filterId:n.selectedFilterId,toggleFilterPopUp:i.toggleFilterPopUp,source:s.filterFor,filterArray:n.componentMetaData,intitialDepartments:n.departments,initialAgents:n.agents,mode:n.filterMode,is_default:n.isDefault,redirectTo:s.redirectTo,deleteUrl:s.deleteUrl,closeFilter:s.closeFilter,save_endpoint:s.save_endpoint,dashboardWidget:n.dashboardWidget,icon_color:n.icon_color},null,8,["filterName","icon","filterValues","filterId","toggleFilterPopUp","source","filterArray","intitialDepartments","initialAgents","mode","is_default","redirectTo","deleteUrl","closeFilter","save_endpoint","dashboardWidget","icon_color"])):c("",!0)]),_:1},8,["title"])}const Dt=C(dD,[["render",wD]]);const kD={name:"changes-list",description:"Changes lists table component",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},props:{filterIndex:{type:Boolean,default:!1}},data:()=>({columns:[],hasDataPopulated:!1,visibleColumns:{},staticColumns:["actions"],apiUrl:"/service-desk/api/change-list",filterOptions:[{section:[{name:"change_ids",url:"/service-desk/api/dependency/changes?meta=true",label:"changes",isCustom:!1},{name:"department_ids",url:"/api/dependency/departments",label:"departments",isCustom:!1},{name:"team_ids",url:"/api/dependency/teams",label:"teams",isCustom:!1}]},{section:[{name:"requester_ids",url:"/api/dependency/users?meta=true",label:"requester",isCustom:!1},{name:"status_ids",url:"/service-desk/api/status/list?module=2",label:"status",isCustom:!1},{name:"priority_ids",url:"/service-desk/api/dependency/change_priorities",label:"priority",isCustom:!1}]},{section:[{name:"change_type_ids",url:"/service-desk/api/dependency/change_types",label:"change_type",isCustom:!1},{name:"impact_ids",url:"/service-desk/api/dependency/impacts",label:"impact",isCustom:!1},{name:"location_ids",url:"/api/dependency/locations",label:"location",isCustom:!1}]},{section:[{name:"asset_ids",url:"/service-desk/api/asset-list?meta=true",label:"assets",isCustom:!1},{name:"release_ids",url:"/service-desk/api/dependency/releases",label:"releases",isCustom:!1},{name:"ticket_ids",url:"/api/dependency/tickets",label:"tickets",isCustom:!1}]},{section:[{name:"problem_ids",url:"/service-desk/api/dependency/problems",label:"problems",isCustom:!1},{name:"assignee-ids",url:"/api/dependency/agents",label:"agent"},{name:"pending_approvers",url:"/api/dependency/users",label:"pending_approvers"}]},{section:[{name:"created_at",type:"date",label:["created_at","created_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0,isCustom:!1},{name:"updated_at",type:"date",label:["updated_at","updated_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},pickers:!0,range:!0,isCustom:!1}]},{section:[]}],columnData:null,changeData:null,isShowFilter:!1,appliedFilters:{},customFields:[],changeFilterId:"",showIcon:!1,reportType:"changes",exportData:"",loading:!0,showPagination:!0,newReportId:"",dataCount:"",requiredPayload:[]}),created(){window.emitter.on("onColumnUpdate",this.onColumnUpdate),window.emitter.on("updateFilter",this.updateFilter),window.emitter.on("dataCount",this.handleDataCount)},beforeMount(){const e=window.location.pathname;this.changeFilterId=W(e);const t=Ye();t&&t.hasOwnProperty("filter-by-url")?We("/service-desk/api/filter-dependencies",t,{},n=>{n&&this.applyFilter(n)},n=>{A(n)}):this.apiUrl=this.filterIndex?"/service-desk/api/change-list?filter_id="+this.changeFilterId:"/service-desk/api/change-list",this.filterData(),this.getChangeData()},methods:{handleDataCount(e){this.showIcon=!!e,this.dataCount=e},updateFilter(e){this.filterOptions.map(function(t){t.section.map(function(s){e.name==s.name&&(s.value=e.value)})})},getChangeData(){this.hasDataPopulated=!1,S.get("api/agent/report-config/change-report").then(e=>{this.changeData=e.data.data,this.newReportId=e.data.data.id,this.columnData=e.data.data.sub_reports,this.hasDataPopulated=!0,this.columnData.forEach(t=>{t.columns.forEach(s=>{}),this.columns=t.columns}),this.columns.map(t=>{t.is_visible=!!t.is_visible}),this.updateVisibleColumns()}).catch(e=>{this.hasDataPopulated=!0,this.columns=[],A(e)})},onColumnUpdate(e){this.columns=e,this.updateVisibleColumns()},updateVisibleColumns(){this.visibleColumns={},this.columns.map(e=>{pe(e.is_visible)&&(this.visibleColumns[e.key]=e.label)})},updateFilterFields(e){e.forEach(t=>{t.isCustom&&t.type=="checkbox"&&t.value&&(t.value=Array.isArray(t.value)?t.value:t.value.split(","))}),this.customFields=e,this.filterOptions[6].section=e},filterData(){this.filterOptions.map(function(e){e.section.map(function(t){t.isCustom||(t.elements=[],t.isMultiple=!0),t.isPrepopulate=!1,t.value="",t.className="col-sm-4"})})},selectedFilters(e){return e==="closeEvent"?this.isShowFilter=!1:e==="resetEvent"?this.resetFilter():this.applyFilter(e)},resetFilter(){this.apiUrl=this.filterIndex?"/service-desk/api/change-list?filter_id="+this.changeFilterId:"/service-desk/api/change-list",this.updateFilterFields([]),window.emitter.emit("clearCustomFields"),this.filterOptions=this.filterOptions.map(function(e){return e.section.map(function(t){t.isCustom||(t.elements=[],t.isMultiple=!0),t.isPrepopulate=!1,t.value="",t.className="col-sm-4"}),e})},applyFilter(e){this.appliedFilters=e;for(var t in this.customFields)this.customFields[t].value=e[this.customFields[t].name];let s="/service-desk/api/change-list?",d=new URLSearchParams(je(this.filterOptions,e));const i=d,h=new URLSearchParams(i),_={};for(const[f,p]of h)_[f]=p;d[d.length-1]==="&"&&(d=d.slice(0,-1)),this.apiUrl=s+d,this.exportData=this.reformatExportData(_)},toggleFilterView(){this.isShowFilter=!this.isShowFilter},reformatExportData(e){const t={};for(const s in e){const d=s.match(/([a-zA-Z_]+)\[(\d+)\]/);if(d){const[n,i,h]=d;t[i]=t[i]||[],t[i][h]=parseInt(e[s],10)}}return t},exportReport(){this.loading=!0;const e={...this.exportData,total:this.dataCount};let t={};this.filterIndex&&(t.filter_id=this.changeFilterId);const s={...this.exportData,...t,total:this.dataCount};S.post("api/agent/report-export/"+this.newReportId,this.filterIndex?s:e).then(d=>{U(d,"dataTableModal")}).catch(d=>{A(d,"dataTableModal")}).finally(()=>{this.loading=!1})},scheduleList(){this.requiredPayload=JSON.stringify(this.exportData);const e={...this.exportData,filter_id:this.changeFilterId};this.$router.push({path:"/reports/schedule/add/"+this.changeData.type+"/"+this.newReportId,query:{params:this.filterIndex?JSON.stringify(e):this.requiredPayload}})}},components:{"user-column-list":Ge,"dynamic-datatable":Ze,"changes-filter":Dt,"asset-list-with-checkbox":Oe}},CD={class:"col-sm-12"},DD={key:0,class:"card card-light"},SD={class:"card-header"},FD={id:"changes-list",class:"card-title"},MD={class:"card-tools"},ID=a("span",{class:"glyphicon glyphicon-plus"},null,-1),AD=a("span",{class:"glyphicon glyphicon-filter"},null,-1),PD=[AD],TD=a("i",{class:"fas fa-paper-plane"},null,-1),VD=[TD],LD=a("i",{class:"fas fa-calendar"},null,-1),UD=[LD],$D={key:0,class:"card-body",id:"changes_list"};function ND(e,t,s,d,n,i){const h=u("alert"),_=u("router-link"),f=u("changes-filter"),p=u("user-column-list"),b=u("dynamic-datatable"),k=N("tooltip");return o(),l("div",CD,[m(h,{componentName:"dataTableModal"}),e.hasDataPopulated?(o(),l("div",DD,[a("div",SD,[a("h3",FD,r(e.lang("list_of_changes")),1),a("div",MD,[w((o(),v(_,{class:"btn btn-tool",to:"/service-desk/changes/create"},{default:y(()=>[ID]),_:1})),[[k,e.lang("create_change")]]),w((o(),l("a",{class:"btn btn-tool",href:"javascript:;",onClick:t[0]||(t[0]=(...D)=>i.toggleFilterView&&i.toggleFilterView(...D))},PD)),[[k,e.lang("filter")]]),e.showIcon?w((o(),l("a",{key:0,id:"export-report-btn",class:"btn btn-tool",onClick:t[1]||(t[1]=D=>i.exportReport()),href:"javascript:;"},VD)),[[k,e.lang("export")]]):c("",!0),e.showIcon?w((o(),l("a",{key:1,id:"schedule-report",class:"btn btn-tool",onClick:t[2]||(t[2]=D=>i.scheduleList()),href:"javascript:;"},UD)),[[k,e.lang("schedule")]]):c("",!0)])]),e.apiUrl?(o(),l("div",$D,[e.isShowFilter?(o(),v(f,{key:0,id:"filter-box",metaData:e.filterOptions,selectedFields:e.customFields,onSelectedFilters:i.selectedFilters,showCustomFilter:!0,updateFields:i.updateFilterFields,appliedFilters:e.appliedFilters,endPoint:"/custom-field-flattened?category=changes&type=changes&module=filter&filter_id="+e.changeFilterId,saveFilter:!0,filterFor:"change",filterNum:e.changeFilterId,redirectTo:"/service-desk/changes",deleteUrl:"/service-desk/api/agent/sd-filter/"+e.changeFilterId,closeFilter:i.toggleFilterView,save_endpoint:"/service-desk/api/agent/sd-filter"},null,8,["metaData","selectedFields","onSelectedFilters","updateFields","appliedFilters","endPoint","filterNum","deleteUrl","closeFilter"])):c("",!0),(o(!0),l(I,null,$(e.columnData,D=>(o(),l("section",{key:D},[m(p,{"table-columns":D.columns,reportId:D.id,columnId:e.newReportId},null,8,["table-columns","reportId","columnId"]),e.columns.length?(o(),v(b,{key:0,"data-url":e.apiUrl,columns:e.visibleColumns,columnsMeta:D.columns,staticColumns:e.staticColumns,show_pagination:e.showPagination,"report-type":e.reportType},null,8,["data-url","columns","columnsMeta","staticColumns","show_pagination","report-type"])):c("",!0)]))),128))])):c("",!0)])):c("",!0)])}const gs=C(kD,[["render",ND]]),ED={name:"change-form",props:{category:{type:String,required:!0},panel:{type:String,default:"agent"},showViewButton:{type:Boolean,default:!1}},data(){return{fetchFormFieldApi:"/api/form/render/",formUniqueKey:null,submitFormInProgress:!1,editId:"",selectedForm:"",formSelected:!1}},mixins:[ve],beforeMount(){if(this.mode==="edit"){const e=W(this.currentPath());this.fetchFormFieldApi="service-desk/api/edit-change/"+e,this.editId=W(this.currentPath()),this.formSelected=!0}else this.getDefaultFormValue()},computed:{mode(){return this.currentPath().indexOf("edit")!==-1?"edit":"create"}},methods:{getDefaultFormValue(){this.showLoader=!0,S.get("/from/forms/"+this.category).then(e=>{this.selectedForm=e.data.data.data[0],this.showLoader=!1,this.updateFetchApi()}).catch(e=>{this.showLoader=!1,A(e,"faveo-form")})},updateFetchApi(){this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey),this.$store.dispatch("unsetValidationError"),this.fetchFormFieldApi="/render/form?id="+this.selectedForm.id+"&mode=render",setTimeout(()=>{this.$store.dispatch("createNewFormInstance",{formUniqueKey:this.formUniqueKey,scenario:this.scenario||this.mode}),this.formSelected=!0},1)},afterSubmit(e){window.emitter.emit("updateAgentSidebar"),this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey);let t=Je(this.category);if(this.$store.dispatch("createNewFormInstance",{formUniqueKey:t,scenario:this.mode}),this.formUniqueKey=t,this.mode==="create"){let s=e.data.data.id;setTimeout(()=>{this.$router.push("/service-desk/changes/"+s+"/show")},1e3)}}},components:{FormRenderer:we,Alert:ke,FaveoBox:Re,CustomLoader:Ne}},qD={class:"col-sm-12"},OD={key:0,class:"pull-right"},jD=a("span",null,[a("i",{class:"fas fa-eye"})],-1),RD={key:0,class:"form-group row mt-3"},xD={class:"col-md-12"},BD=["disabled"],KD={key:0},zD=a("i",{class:"fas fa-sync"},null,-1),HD=[zD],YD={key:1},WD=a("i",{class:"fas fa-save"},null,-1),JD=[WD];function GD(e,t,s,d,n,i){const h=u("Alert"),_=u("CustomLoader"),f=u("router-link"),p=u("FormRenderer"),b=u("ValidationObserver"),k=u("FaveoBox"),D=N("tooltip");return o(),l("div",qD,[n.formUniqueKey&&n.formSelected?(o(),v(k,{key:0,title:e.lang(i.mode)},{headerMenu:y(()=>[s.showViewButton?(o(),l("span",OD,[w((o(),v(f,{to:"/service-desk/changes/"+n.editId+"/show",class:"btn btn-tool has-tooltip"},{default:y(()=>[jD]),_:1},8,["to"])),[[D,e.trans("view")]])])):c("",!0)]),default:y(()=>[m(h,{componentName:"faveo-form"}),m(h,{componentName:"form-renderer"}),e.showLoader||n.submitFormInProgress?(o(),v(_,{key:0,duration:4e3})):c("",!0),m(b,{ref:"faveoFormObserver"},{default:y(({values:P,errors:E,validate:M})=>[(o(),v(p,{key:n.formUniqueKey,fetchFormFieldApi:n.fetchFormFieldApi,formUniqueKey:n.formUniqueKey,scenario:i.mode,category:s.category,panel:s.panel,selectDependencyId:n.editId},null,8,["fetchFormFieldApi","formUniqueKey","scenario","category","panel","selectDependencyId"])),e.showLoader?c("",!0):(o(),l("div",RD,[a("div",xD,[a("button",{type:"button",class:"btn btn-primary pull-right",disabled:n.submitFormInProgress,onClick:t[0]||(t[0]=F=>e.onSubmit())},[i.mode==="edit"?(o(),l("span",KD,HD)):(o(),l("span",YD,JD)),g(" "+r(i.mode==="edit"?e.trans("update"):e.trans("submit")),1)],8,BD)])]))]),_:1},512)]),_:1},8,["title"])):c("",!0)])}const bs=C(ED,[["render",GD]]),ZD={name:"assign-ticket-modal",description:"Assign ticket Modal component",props:{showModal:{type:Boolean,default:!1},agentIds:{type:Array,default:()=>[]},tickets:{type:Array,default:()=>[]},onClose:{type:Function,default:()=>{}},deptId:{type:[String,Number],default:""},teamId:{type:[String,Number],default:""},changeID:{type:[String,Number],default:""}},data:()=>({isDisabled:!0,containerStyle:{width:"800px"},loading:!1,size:60,assign_to:"",assign:"agents",assignChange:!1,category:""}),computed:{getApiParameters(){let e={};if(e["supplements[ticket_id]"]=this.agentIds,e["supplements[no_email]"]=1,this.deptId&&(e["department_ids[]"]=this.deptId),this.teamId&&(e.team_id=this.teamId),this.tickets.length){let t=this.tickets.filter(s=>this.agentIds.includes(s.id)).map(s=>s.department.id);e.department_ids=t.filter((s,d)=>t.indexOf(s)===d)}return e}},beforeMount(){this.category=this.$store.getters.getChangeAssociateCategory},methods:{onChange(e,t){this[t]=e,t==="assign"&&(this.assignChange=!0,setTimeout(()=>{this.assignChange=!1},1)),t==="assign_to"&&(this.isDisabled=!e)},onSubmit(){this.loading=!0,this.isDisabled=!0,S.get("/service-desk/api/change/assign/"+this.assign_to.id+"/"+this.changeID).then(e=>{this.loading=!1,this.isDisabled=!0,U(e,"change-view"),window.emitter.emit("updateChangeAssociates"),this.category==="activity"&&window.emitter.emit("updateChangeActivity"),this.onClose()}).catch(e=>{this.loading=!1,this.isDisabled=!1,A(e,"change"),this.onClose()})}},components:{"dynamic-select":G,"radio-button":Ee}},QD={class:"modal-title"},XD={key:0,class:"row"},e2={key:0,id:"assign_change"},t2={key:1,class:"row"},s2=["disabled"],a2=a("i",{class:"far fa-hand-point-right"},null,-1);function n2(e,t,s,d,n,i){const h=u("reuse-loader"),_=u("dynamic-select"),f=u("modal");return s.showModal?(o(),v(f,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:e.containerStyle},{title:y(()=>[a("h4",QD,r(e.lang("assign_changes")),1)]),fields:y(()=>[e.loading?c("",!0):(o(),l("div",XD,[e.assignChange?(o(),l("div",e2,[m(h,{size:30,duration:4e3,color:"#1d78ff"})])):c("",!0),!e.assignChange&&e.assign!="assign_to_me"?(o(),v(_,{key:1,label:e.lang("whome_do_you_want_to_assign_change"),multiple:!1,name:"assign_to",classname:"col-sm-12","api-endpoint":"api/dependency/"+e.assign+"?meta=true&team_id="+s.teamId+"&department_id="+s.deptId,"api-parameters":i.getApiParameters,value:e.assign_to,onChange:i.onChange,strlength:"65"},null,8,["label","api-endpoint","api-parameters","value","onChange"])):c("",!0)])),e.loading?(o(),l("div",t2,[m(h,{"animation-duration":4e3,color:"#1d78ff",size:e.size},null,8,["size"])])):c("",!0)]),controls:y(()=>[a("button",{type:"button",onClick:t[0]||(t[0]=p=>i.onSubmit()),class:"btn btn-primary",id:"submit_btn",disabled:e.isDisabled},[a2,g(" "+r(e.lang("assign")),1)],8,s2)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const o2=C(ZD,[["render",n2]]),i2={name:"release-add-modal",description:"Release add Modal component",props:{showModal:{type:Boolean,default:!1},changeId:{type:[String,Number],default:""},onClose:{type:Function}},data(){return{isDisabled:!0,containerStyle:{width:"500px"},loading:!1,release_id:"",category:""}},beforeMount(){this.category=this.$store.getters.getChangeAssociateCategory},methods:{onChange(e,t){this[t]=e,this.isDisabled=!e},onSubmit(){this.loading=!0,this.isDisabled=!0,S.post("/service-desk/api/change/attach-release/"+this.changeId+"/"+this.release_id.id).then(e=>{U(e,"change-view"),this.onClose(),this.loading=!1,this.isDisabled=!0,window.emitter.emit("updateChangeAssociates"),window.emitter.emit("refreshChangeStatus"),this.category==="activity"&&window.emitter.emit("updateChangeActivity")}).catch(e=>{this.loading=!1,this.isDisabled=!0,A(e,"change-view")})}},components:{"dynamic-select":G}},l2={class:"modal-title"},r2={key:0},d2={class:"row"},c2={key:1,class:"row"},u2=["disabled"],h2=a("i",{class:"fas fa-check"},null,-1);function m2(e,t,s,d,n,i){const h=u("dynamic-select"),_=u("reuse-loader"),f=u("modal");return s.showModal?(o(),v(f,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{title:y(()=>[a("h4",l2,r(e.lang("release")),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",r2,[a("div",d2,[m(h,{label:e.lang("release"),multiple:!1,name:"release_id",prePopulate:!1,classname:"col-sm-12",apiEndpoint:"/service-desk/api/dependency/releases",value:n.release_id,onChange:i.onChange,required:!0,clearable:!!n.release_id},null,8,["label","value","onChange","clearable"])])])),n.loading?(o(),l("div",c2,[m(_,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=p=>i.onSubmit()),class:"btn btn-primary",disabled:n.isDisabled},[h2,g(" "+r(e.lang("proceed")),1)],8,u2)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const _2=C(i2,[["render",m2]]);function p2(e){const{subject:t,releaseType:s,status:d,priority:n,description:i}=e;var h={subject:[t,"isRequired"],releaseType:[s,"isRequired"],status:[d,"isRequired"],priority:[n,"isRequired"],description:[i,"isRequired"]};const _=new ce(ae),{errors:f,isValid:p}=_.validate(h);return ie.dispatch("setValidationError",f),{errors:f,isValid:p}}const f2={name:"release-create-edit",description:"Releease create edit page",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime)}},props:{from:{type:String,default:""},change_id:{type:[String,Number],default:""},onComplete:{type:Function},alertName:{type:String,default:"release-create-edit"},tinyMceWidth:{type:String,default:"103%"}},data(){return{title:"create_release",iconClass:"fas fa-save",btnName:"submit",hasDataPopulated:!1,loading:!1,release_id:"",subject:"",description:"",planned_date:"",planned_start_date:"",planned_end_date:"",status:"",location:"",priority:"",attach_assets:[],attachment:"",releaseType:"",show_attach_assets:!0,timeOptions:{start:"00:00",step:"00:30",end:"23:30"},selectedFile:"",attachment_delete:!1,identifier:""}},beforeMount(){this.getActions();const e=window.location.pathname;this.getValues(e)},methods:{getActions(){S.get("/service-desk/get/permissions").then(e=>{this.show_attach_assets=e.data.data.actions.attach_asset}).catch(e=>{this.show_attach_assets=!0})},getValues(e){const t=W(e);e.indexOf("edit")>=0?(this.title="edit_release",this.iconClass="fas fa-sync",this.btnName="update",this.hasDataPopulated=!1,this.getInitialValues(t)):(this.loading=!1,this.hasDataPopulated=!0)},getInitialValues(e){this.selectedFile="",this.loading=!0,S.get("/service-desk/api/release/"+e).then(t=>{this.loading=!1,this.hasDataPopulated=!0;let s=t.data.data.release;this.updateStatesWithData(s),this.releaseType=s.release_type,this.release_id=s.id,s.planned_start_date&&(this.planned_date=[new Date(s.planned_start_date),new Date(s.planned_end_date)]),this.attachment=s.attachment}).catch(t=>{this.loading=!1})},updateStatesWithData(e){const t=this,s=this.$data;Object.keys(e).map(d=>{s.hasOwnProperty(d)&&(t[d]=e[d])})},isValid(){const{errors:e,isValid:t}=p2(this.$data);return!!t},onFileSelected(e,t,s){this.selectedFile=e[0],this.attachment_delete=s},onChange(e,t){this[t]=e,e===null&&(this[t]=""),t==="planned_date"&&(this.planned_start_date=e[0]!==null?ze(e[0]).format("YYYY-MM-DD+HH:mm:ss"):"",this.planned_end_date=e[1]!==null?ze(e[1]).format("YYYY-MM-DD+HH:mm:ss"):"")},onSubmit(){if(this.isValid()){this.loading=!0;var e=new FormData;if(this.release_id!=""&&e.append("id",this.release_id),this.from&&e.append("change_id",this.change_id),e.append("subject",this.subject),e.append("identifier",this.identifier),e.append("description",this.description),e.append("status_id",this.status.id),e.append("priority_id",this.priority.id),e.append("release_type_id",this.releaseType.id),e.append("location_id",this.location?this.location.id:""),this.selectedFile&&e.append("attachment",this.selectedFile),this.attachment&&!this.attachment_delete&&!this.selectedFile&&e.append("attachment_ids[0]",this.attachment.id),this.attachment_delete&&e.append("attachment_delete",this.attachment_delete),this.planned_start_date&&e.append("planned_start_date",this.planned_start_date),this.planned_end_date&&e.append("planned_end_date",this.planned_end_date),this.attach_assets.length)for(var t in this.attach_assets)e.append("asset_ids["+t+"]",this.attach_assets[t].id);else e.append("asset_ids","");const s={headers:{"Content-Type":"multipart/form-data"}};S.post("/service-desk/api/release",e,s).then(d=>{this.loading=!1,U(d,this.alertName),window.emitter.emit("updateAgentSidebar"),this.from?this.onComplete():this.release_id?this.getInitialValues(this.release_id):setTimeout(()=>{let n=d.data.data.id;this.$router.push("/service-desk/releases/"+n+"/show")},3e3)}).catch(d=>{this.loading=!1,A(d,"release-create-edit")})}}},components:{"text-field":le,"dynamic-select":G,"file-upload":He,"date-time-field":bt}},g2={class:"col-sm-12"},b2={key:0,class:"row"},y2={key:0,class:"card-header"},v2={class:"card-title"},w2={class:"card-tools"},k2=a("i",{class:"fas fa-eye"},null,-1),C2={class:"row"},D2={class:"row release"},S2={class:"row"},F2={class:"row"},M2={class:"ml_7"},I2={class:"row"},A2={key:1,class:"card-footer"};function P2(e,t,s,d,n,i){const h=u("custom-loader"),_=u("alert"),f=u("router-link"),p=u("text-field"),b=u("date-time-field"),k=u("dynamic-select"),D=u("tiny-editor"),P=u("file-upload"),E=N("tooltip"),M=N("focus-first-input");return o(),l("div",g2,[!n.hasDataPopulated||n.loading?(o(),l("div",b2,[m(h,{duration:4e3})])):c("",!0),m(_,{componentName:"release-create-edit"}),n.hasDataPopulated?(o(),l("div",{key:1,class:j([{"card card-light ":!s.from}])},[s.from?c("",!0):(o(),l("div",y2,[a("h3",v2,r(e.lang(n.title)),1),a("div",w2,[n.release_id?w((o(),v(f,{key:0,type:"button",id:"view_release",class:"btn btn-tool",to:"/service-desk/releases/"+n.release_id+"/show"},{default:y(()=>[k2]),_:1},8,["to"])),[[E,e.lang("view")]]):c("",!0)])])),a("div",{class:j(["card-body",{"p-0":s.from}])},[w((o(),l("div",C2,[m(p,{label:e.lang("subject"),value:n.subject,type:"text",name:"subject",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold"]),m(p,{label:e.lang("identifier"),value:n.identifier,type:"text",name:"identifier",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-6",required:!1},null,8,["label","value","onChange","placehold"])])),[[M]]),a("div",D2,[m(b,{label:e.lang("select_planned_date_range"),value:n.planned_date,type:"datetime",name:"planned_date",onChange:i.onChange,place:e.lang("select_date"),range:"",required:!1,format:"MMMM DD YYYY, h:mm a",classname:"col-sm-6",clearable:!0,disabled:!1,editable:!0,currentYearDate:!1,"time-picker-options":n.timeOptions,confirm:!0},null,8,["label","value","onChange","place","time-picker-options"]),m(k,{label:e.lang("status"),multiple:!1,name:"status",prePopulate:!0,classname:"col-sm-6",apiEndpoint:"/service-desk/api/status/list?module=3",value:n.status,onChange:i.onChange,required:!0,clearable:!!n.status},null,8,["label","value","onChange","clearable"])]),a("div",S2,[m(k,{label:e.lang("priority"),multiple:!1,name:"priority",prePopulate:!0,classname:"col-sm-6",apiEndpoint:"/service-desk/api/dependency/release_priorities",value:n.priority,onChange:i.onChange,required:!0,clearable:!!n.priority},null,8,["label","value","onChange","clearable"]),m(k,{label:e.lang("release_type"),multiple:!1,name:"releaseType",prePopulate:!0,classname:"col-sm-6",apiEndpoint:"/service-desk/api/dependency/release_types",value:n.releaseType,onChange:i.onChange,required:!0,clearable:!!n.releaseType},null,8,["label","value","onChange","clearable"])]),a("div",F2,[m(k,{label:e.lang("location"),multiple:!1,name:"location",prePopulate:!0,classname:"col-sm-6",apiEndpoint:"/api/dependency/locations",value:n.location,onChange:i.onChange,clearable:!!n.location},null,8,["label","value","onChange","clearable"]),n.show_attach_assets?(o(),v(k,{key:0,label:e.lang("attach_assets"),multiple:!0,name:"attach_assets",prePopulate:!0,classname:"col-sm-6",apiEndpoint:"/service-desk/api/dependency/assets",value:n.attach_assets,onChange:i.onChange},null,8,["label","value","onChange"])):c("",!0)]),a("div",M2,[m(D,{value:n.description,type:"text",onChange:i.onChange,name:"description",label:e.lang("description"),classname:"col-sm-12",required:!0,lang:"en",width:s.tinyMceWidth},null,8,["value","onChange","label","width"])]),a("div",I2,[m(P,{label:e.lang("attachments"),value:n.attachment,formType:"service_desk",name:"attachment",onChange:i.onFileSelected,classname:"col-sm-6",id:n.release_id},null,8,["label","value","onChange","id"])])],2),s.from?c("",!0):(o(),l("div",A2,[a("button",{id:"submit_btn",class:"btn btn-primary",onClick:t[0]||(t[0]=F=>i.onSubmit())},[a("i",{class:j(n.iconClass)},null,2),g(" "+r(e.lang(n.btnName)),1)])]))],2)):c("",!0)])}const T2=C(f2,[["render",P2]]),V2={name:"release-form",props:{category:{type:String,required:!0},panel:{type:String,default:"agent"},showViewButton:{type:Boolean,default:!1},from:{type:String,default:""},change_id:{type:[String,Number],default:""},onComplete:{type:Function,default:()=>{}},alertName:{type:String,default:""}},data(){return{fetchFormFieldApi:"/api/form/render/",formUniqueKey:null,submitFormInProgress:!1,editId:"",selectedForm:"",formSelected:!1}},mixins:[ve],beforeMount(){if(this.mode==="edit"){const e=W(this.currentPath());this.fetchFormFieldApi="service-desk/api/edit-release/"+e,this.editId=W(this.currentPath()),this.formSelected=!0}else this.getDefaultFormValue();this.change_id&&this.$store.dispatch("updateFormAdditionalProperties",{change_id:this.change_id})},computed:{mode(){return this.currentPath().indexOf("edit")!==-1?"edit":"create"}},methods:{getDefaultFormValue(){this.showLoader=!0,S.get("/from/forms/"+this.category).then(e=>{this.selectedForm=e.data.data.data[0],this.showLoader=!1,this.updateFetchApi()}).catch(e=>{this.showLoader=!1,A(e,"faveo-form")})},updateFetchApi(){this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey),this.$store.dispatch("unsetValidationError"),this.fetchFormFieldApi="/render/form?id="+this.selectedForm.id+"&mode=render",setTimeout(()=>{this.$store.dispatch("createNewFormInstance",{formUniqueKey:this.formUniqueKey,scenario:this.scenario||this.mode}),this.formSelected=!0},1)},afterSubmit(e){window.emitter.emit("updateAgentSidebar"),this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey);let t=Je(this.category);this.$store.dispatch("createNewFormInstance",{formUniqueKey:t,scenario:this.mode}),this.formUniqueKey=t,this.$store.dispatch("updateFormAdditionalProperties",""),this.mode==="create"&&!this.from&&setTimeout(()=>{let s=e.data.data.id;this.$router.push("/service-desk/releases/"+s+"/show")},1e3),this.from==="modal"&&(this.onComplete(),U(e,this.alertName))}},components:{FormRenderer:we,Alert:ke,FaveoBox:Re,CustomLoader:Ne}},L2={class:"col-sm-12"},U2={key:0,class:"pull-right"},$2=a("span",null,[a("i",{class:"fas fa-eye"})],-1),N2={key:0,class:"form-group row mt-3"},E2={class:"col-md-12"},q2=["disabled"],O2={key:0},j2=a("i",{class:"fas fa-sync"},null,-1),R2=[j2],x2={key:1},B2=a("i",{class:"fas fa-save"},null,-1),K2=[B2];function z2(e,t,s,d,n,i){const h=u("Alert"),_=u("CustomLoader"),f=u("router-link"),p=u("FormRenderer"),b=u("ValidationObserver"),k=u("FaveoBox"),D=N("tooltip");return o(),l("div",L2,[n.formUniqueKey&&n.formSelected?(o(),v(k,{key:0,title:e.lang(i.mode)},{headerMenu:y(()=>[s.showViewButton?(o(),l("span",U2,[w((o(),v(f,{to:"/service-desk/releases/"+n.editId+"/show",class:"btn btn-tool has-tooltip"},{default:y(()=>[$2]),_:1},8,["to"])),[[D,e.trans("view")]])])):c("",!0)]),default:y(()=>[m(h,{componentName:"faveo-form"}),m(h,{componentName:"form-renderer"}),e.showLoader||n.submitFormInProgress?(o(),v(_,{key:0,duration:4e3})):c("",!0),m(b,{ref:"faveoFormObserver"},{default:y(({values:P,errors:E,validate:M})=>[(o(),v(p,{key:n.formUniqueKey,fetchFormFieldApi:n.fetchFormFieldApi,formUniqueKey:n.formUniqueKey,scenario:i.mode,category:s.category,panel:s.panel,selectDependencyId:n.editId},null,8,["fetchFormFieldApi","formUniqueKey","scenario","category","panel","selectDependencyId"])),!e.showLoader&&!s.from?(o(),l("div",N2,[a("div",E2,[a("button",{type:"button",class:"btn btn-primary pull-right",disabled:n.submitFormInProgress,onClick:t[0]||(t[0]=F=>e.onSubmit())},[i.mode==="edit"?(o(),l("span",O2,R2)):(o(),l("span",x2,K2)),g(" "+r(i.mode==="edit"?e.trans("update"):e.trans("submit")),1)],8,q2)])])):c("",!0)]),_:1},512)]),_:1},8,["title"])):c("",!0)])}const Vt=C(V2,[["render",z2]]);const H2={name:"release-add-modal",description:"Release add Modal component",props:{showModal:{type:Boolean,default:!1},changeId:{type:[String,Number],default:""},onClose:{type:Function}},data(){return{isDisabled:!1,containerStyle:{width:"850px"},loading:!0,modalClass:"",category:""}},beforeMount(){this.updateLoader(),this.category=this.$store.getters.getChangeAssociateCategory},methods:{updateLoader(){setTimeout(()=>{this.loading=!1,this.modalClass="release_fields"},1e3)},onSubmit(){this.$refs.releaseCreate.onSubmit()},onCompleted(){window.emitter.emit("updateChangeAssociates"),window.emitter.emit("refreshChangeStatus"),this.category==="activity"&&window.emitter.emit("updateChangeActivity"),this.onClose()}},components:{ReleaseForm:Vt,release:T2}},Y2={class:"modal-title"},W2={key:0},J2={key:1,class:"row"},G2=["disabled"],Z2=a("i",{class:"fas fa-save"},null,-1);function Q2(e,t,s,d,n,i){const h=u("ReleaseForm"),_=u("reuse-loader"),f=u("modal");return s.showModal?(o(),v(f,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle,modalBodyClass:n.modalClass},{title:y(()=>[a("h4",Y2,r(e.lang("release")),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",W2,[m(h,{category:"releases",change_id:s.changeId,onComplete:i.onCompleted,ref:"releaseCreate",panel:"agent",from:"modal",alertName:"change-view"},null,8,["change_id","onComplete"])])),n.loading?(o(),l("div",J2,[m(_,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=p=>i.onSubmit()),class:"btn btn-primary",disabled:n.isDisabled},[Z2,g(" "+r(e.lang("save")),1)],8,G2)]),_:1},8,["showModal","onClose","containerStyle","modalBodyClass"])):c("",!0)}const X2=C(H2,[["render",Q2]]),eS={name:"detach-modal",description:"Detach Modal component",props:{showModal:{type:Boolean,default:!1},assetId:{type:[String,Number],default:""},releaseId:{type:[String,Number],default:""},compName:{type:String,default:""},alertCompName:{type:String,default:"changesAssociates"},changeId:{type:[String,Number],default:""},onClose:{type:Function}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1,category:""}},beforeMount(){this.category=this.$store.getters.getChangeAssociateCategory},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0;let e=this.releaseId?"/service-desk/api/change/detach-release/"+this.changeId:"/service-desk/api/change/detach-asset/"+this.changeId+"/"+this.assetId;S.delete(e).then(t=>{U(t,"change-view"),this.releaseId?this.category==="activity"?window.emitter.emit("updateChangeActivity"):this.category==="releases"&&window.emitter.emit("updateChangeTables"):window.emitter.emit(this.compName+"refreshData"),window.emitter.emit("updateChangeAssociates"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(t=>{this.loading=!1,this.isDisabled=!0,A(t,this.alertCompName)})}}},tS={class:"modal-title"},sS={key:0},aS={key:1,class:"row"},nS=["disabled"],oS=a("i",{class:"fas fa-unlink","aria-hidden":"true"},null,-1);function iS(e,t,s,d,n,i){const h=u("reuse-loader"),_=u("modal");return s.showModal?(o(),v(_,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{title:y(()=>[a("h4",tS,r(e.lang("detach")),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",sS,[a("span",null,r(e.lang("are_you_sure")),1)])),n.loading?(o(),l("div",aS,[m(h,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=f=>i.onSubmit()),class:"btn btn-danger",disabled:n.isDisabled},[oS,g(" "+r(e.lang("detach")),1)],8,nS)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const sa=C(eS,[["render",iS]]);const lS={name:"change-description",description:"Change description Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},changeId:{type:[String,Number],default:""},identifier:{type:String,default:""}},data(){return{attachment:"",description:"",isDisabled:!1,loading:!0,selectedFile:"",attachment_delete:!1,category:""}},beforeMount(){this.getInitialValues(),this.category=this.$store.getters.getChangeAssociateCategory},methods:{getInitialValues(){S.get("/service-desk/api/general-popup/"+this.changeId+"/sd_changes/"+this.identifier).then(e=>{this.loading=!1,this.general_info=e.data.data.general_info,this.general_info&&(this.description=this.general_info.description,this.attachment=this.general_info.attachment)}).catch(e=>{this.loading=!1})},onFileSelected(e,t,s){this.selectedFile=e,this.attachment_delete=s,this.attachment=this.selectedFile?this.selectedFile[0]:this.attachment},onChange(e,t){this[t]=e},onSubmit(){if(this.description!=""){this.loading=!0,this.isDisabled=!0;var e=new FormData;e.append("identifier",this.identifier),e.append("description",this.description),this.selectedFile&&e.append("attachment",this.selectedFile[0]?this.selectedFile[0]:""),this.attachment_delete&&e.append("attachment_delete",this.attachment_delete);const t={headers:{"Content-Type":"multipart/form-data"}};S.post("/service-desk/api/general-popup/"+this.changeId+"/sd_changes",e,t).then(s=>{this.loading=!1,this.isDisabled=!1,this.onClose(),U(s,"change-view"),this.category==="activity"?window.emitter.emit("updateChangeActivity"):this.category==="details"&&window.emitter.emit("updateChangeDetails"),window.emitter.emit("updateChangeAssociates")}).catch(s=>{this.loading=!1,this.isDisabled=!1,A(s,"change-plan")})}else this.$store.dispatch("setValidationError",{description:"This field is required."})}},components:{"file-upload":He}},rS={class:"modal-title"},dS={key:0},cS={class:"row"},uS={class:"row"},hS={key:1,class:"row"},mS=["disabled"],_S=a("i",{class:"fas fa-sync"},null,-1);function pS(e,t,s,d,n,i){const h=u("alert"),_=u("tiny-editor"),f=u("file-upload"),p=u("reuse-loader"),b=u("modal");return s.showModal?(o(),v(b,{key:0,showModal:s.showModal,onClose:s.onClose,modalBodyClass:n.loading?"":"change_plan_div"},{alert:y(()=>[m(h,{componentName:"change-plan"})]),title:y(()=>[a("h4",rS,r(e.lang(s.identifier)),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",dS,[a("div",cS,[m(_,{value:n.description,type:"text",onChange:i.onChange,name:"description",label:e.lang("description"),classname:"col-sm-12",required:!0,lang:"en",width:"100%",id:"focus_editor"},null,8,["value","onChange","label"])]),a("div",uS,[m(f,{label:e.lang("attachments"),value:n.attachment,name:"attachment",onChange:i.onFileSelected,classname:"col-sm-12"},null,8,["label","value","onChange"])])])),n.loading?(o(),l("div",hS,[m(p,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=k=>i.onSubmit()),class:"btn btn-primary",disabled:n.isDisabled},[_S,g(" "+r(e.lang("update")),1)],8,mS)]),_:1},8,["showModal","onClose","modalBodyClass"])):c("",!0)}const aa=C(lS,[["render",pS]]),fS={name:"change-duration-modal",description:"Release add Modal component",props:{showModal:{type:Boolean,default:!1},changeId:{type:[String,Number],default:""},onClose:{type:Function},duration:{type:[String,Number],default:null}},data(){return{loading:!1,isDisabled:!1,containerStyle:{width:"500px"},formStyle:{width:"35%"},total_activity_duration:this.duration,category:""}},beforeMount(){this.category=this.$store.getters.getChangeAssociateCategory},methods:{onChange(e,t){this[t]=e},onSubmit(){this.loading=!0,this.isDisabled=!0;const e={};e.total_activity_duration=this.total_activity_duration,S.patch("/service-desk/api/update-activity-duration/"+this.changeId,e).then(t=>{U(t,"change-view"),this.onClose(),this.loading=!1,this.isDisabled=!0,window.emitter.emit("updateChangeAssociates"),this.category==="activity"&&window.emitter.emit("updateChangeActivity")}).catch(t=>{this.loading=!1,this.isDisabled=!1,A(t,"change-duration")})}},components:{"time-field":Ra}},gS={class:"modal-title"},bS={key:0,class:"row"},yS={key:1,class:"row"},vS=["disabled"],wS=a("i",{class:"fas fa-check"},null,-1);function kS(e,t,s,d,n,i){const h=u("alert"),_=u("time-field"),f=u("reuse-loader"),p=u("modal"),b=N("focus-first-input");return s.showModal?(o(),v(p,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{alert:y(()=>[m(h,{componentName:"change-duration"})]),title:y(()=>[a("h4",gS,r(e.lang("update_activity_duration")),1)]),fields:y(()=>[n.loading?c("",!0):w((o(),l("div",bS,[m(_,{label:e.lang("total_activity_duration"),value:n.total_activity_duration,formStyle:n.formStyle,type:"number",name:"total_activity_duration",onChange:i.onChange,classname:"col-md-12",required:!0},null,8,["label","value","formStyle","onChange"])])),[[b]]),n.loading?(o(),l("div",yS,[m(f,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=k=>i.onSubmit()),class:"btn btn-primary",disabled:n.isDisabled},[wS,g(" "+r(e.lang("update")),1)],8,vS)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const CS=C(fS,[["render",kS]]),DS={name:"change-ticket-associate",description:"Change ticket associate Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},changeId:{type:[String,Number],default:""},associate:{type:String,default:""}},data(){return{ticket_ids:[],loading:!1,category:""}},beforeMount(){this.category=this.$store.getters.getChangeAssociateCategory},methods:{onChange(e,t){this[t]=e},onSubmit(){this.loading=!0;const e={};e.change_id=this.changeId;var t=[];for(var s in this.ticket_ids)t.push(this.ticket_ids[s].id);e.ticket_ids=t,e.type=this.associate,S.post("/service-desk/api/attach-ticket/change",e).then(d=>{window.emitter.emit("updateChangeAssociates"),this.category==="activity"?window.emitter.emit("updateChangeActivity"):this.category==="tickets"&&window.emitter.emit("ChangeTicketsrefreshData"),this.loading=!1,this.ticket_ids=[],this.onClose(),U(d,"change-view")}).catch(d=>{this.loading=!1,A(d,"change-ticket")})}},components:{"dynamic-select":G}},SS={class:"modal-title"},FS={key:0},MS={class:"row"},IS={key:1,class:"row"},AS=["disabled"],PS=a("i",{class:"fas fa-paperclip"},null,-1);function TS(e,t,s,d,n,i){const h=u("alert"),_=u("dynamic-select"),f=u("reuse-loader"),p=u("modal");return s.showModal?(o(),v(p,{key:0,showModal:s.showModal,onClose:s.onClose},{alert:y(()=>[m(h,{componentName:"change-ticket"})]),title:y(()=>[a("h4",SS,r(s.associate==="initiating"?e.lang("associate_an_initiating_ticket"):e.lang("associate_a_causing_ticket")),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",FS,[a("div",MS,[m(_,{label:e.lang("tickets"),multiple:!0,name:"ticket_ids",prePopulate:!1,classname:"col-sm-12",apiEndpoint:"/service-desk/api/dependency/tickets_based_on_change?change_id="+s.changeId,value:n.ticket_ids,onChange:i.onChange,required:!0},null,8,["label","apiEndpoint","value","onChange"])])])),n.loading?(o(),l("div",IS,[m(f,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=b=>i.onSubmit()),class:"btn btn-primary",disabled:!(n.ticket_ids.length>0)},[PS,g(" "+r(e.lang("attach")),1)],8,AS)]),_:1},8,["showModal","onClose"])):c("",!0)}const VS=C(DS,[["render",TS]]),LS={name:"cab-add-modal",description:"Cab add Modal component",props:{showModal:{type:Boolean,default:!1},changeId:{type:[String,Number],default:""},onClose:{type:Function}},data(){return{isDisabled:!0,containerStyle:{width:"500px"},loading:!1,cab_id:"",category:""}},beforeMount(){this.category=this.$store.getters.getChangeAssociateCategory},methods:{onChange(e,t){this[t]=e,this.isDisabled=!e},onSubmit(){this.loading=!0,this.isDisabled=!0;const e={};e.change_id=this.changeId,e.workflow_id=this.cab_id.id,S.post("/service-desk/api/apply-cab-approval",e).then(t=>{this.category==="activity"?window.emitter.emit("updateChangeActivity"):this.category==="cabs"&&window.emitter.emit("updateChangeCabs"),window.emitter.emit("refreshChangeStatus"),window.emitter.emit("updateChangeAssociates"),U(t,"change-view"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(t=>{this.loading=!1,this.isDisabled=!0,A(t,"change-view")})}},components:{"dynamic-select":G}},US={class:"modal-title"},$S={key:0},NS={class:"row"},ES={key:1,class:"row"},qS=["disabled"],OS=a("i",{class:"fas fa-check"},null,-1);function jS(e,t,s,d,n,i){const h=u("dynamic-select"),_=u("reuse-loader"),f=u("modal");return s.showModal?(o(),v(f,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{title:y(()=>[a("h4",US,r(e.lang("apply_cab")),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",$S,[a("div",NS,[m(h,{label:e.lang("cab"),multiple:!1,name:"cab_id",prePopulate:!1,classname:"col-sm-12",apiEndpoint:"/service-desk/api/dependency/cabs",value:n.cab_id,onChange:i.onChange,required:!0,clearable:!!n.cab_id},null,8,["label","value","onChange","clearable"])])])),n.loading?(o(),l("div",ES,[m(_,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=p=>i.onSubmit()),class:"btn btn-primary",disabled:n.isDisabled},[OS,g(" "+r(e.lang("proceed")),1)],8,qS)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const RS=C(LS,[["render",jS]]);const xS={name:"change-assets",description:"Chnage asset Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},changeId:{type:[String,Number],default:""}},data(){return{used_by_ids:"",asset_type_ids:"",managed_by_ids:"",org_ids:"",isDisabled:!0,containerStyle:{width:"950px"},loading:!1,size:60,apiUrl:"",assetIds:[],selectedFilters:{},componentTitle:"changeAssets",category:""}},beforeMount(){this.category=this.$store.getters.getChangeAssociateCategory},watch:{assetIds(e){this.isDisabled=!(e.length>0)}},methods:{onChange(e,t){window.emitter.emit(this.componentTitle+"uncheckCheckbox"),this[t]=e||"",this.selectedFilters[t]=e||""},onApply(){let e="/service-desk/api/asset-list?change_id="+this.changeId+"&",t="";for(var s in this.selectedFilters)this.selectedFilters[s].id&&(t+=s+"="+this.selectedFilters[s].id+"&");t[t.length-1]==="&"&&(t=t.slice(0,-1)),this.apiUrl=e+t},assetsData(e){this.assetIds=e},onSubmit(){if(this.assetIds.length>0){this.loading=!0;const e={};e.asset_ids=this.assetIds;const t={headers:{"Content-Type":"application/json"}};S.post("/service-desk/api/change/attach-assets/"+this.changeId,e,t).then(s=>{this.loading=!1,U(s,"change-view"),this.onClose(),window.emitter.emit("updateChangeAssociates"),this.category==="activity"?window.emitter.emit("updateChangeActivity"):this.category==="assets"&&window.emitter.emit(this.componentTitle+"refreshData")}).catch(s=>{this.loading=!1,A(s,"change-view")})}}},components:{"asset-list-with-checkbox":Oe,"dynamic-select":G}},zt=e=>(K("data-v-008f019c"),e=e(),z(),e),BS={class:"modal-title"},KS={class:"row"},zS={class:"col-sm-12"},HS=zt(()=>a("span",{class:"fas fa-check"},null,-1)),YS=zt(()=>a("br",null,null,-1)),WS={class:"height-limit"},JS={key:0,class:"row"},GS=["disabled"],ZS=zt(()=>a("i",{class:"fas fa-paperclip"},null,-1));function QS(e,t,s,d,n,i){const h=u("dynamic-select"),_=u("asset-list-with-checkbox"),f=u("custom-loader"),p=u("modal");return s.showModal?(o(),v(p,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{title:y(()=>[a("h4",BS,r(e.lang("attach_assets")),1)]),fields:y(()=>[a("div",KS,[m(h,{label:e.lang("asset_types"),multiple:!1,name:"asset_type_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"/service-desk/api/dependency/asset_types",value:n.asset_type_ids,onChange:i.onChange,clearable:!!n.asset_type_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),m(h,{label:e.lang("used_by"),multiple:!1,name:"used_by_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"api/dependency/users?meta=true",value:n.used_by_ids,onChange:i.onChange,clearable:!!n.used_by_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),m(h,{label:e.lang("managed_by"),multiple:!1,name:"managed_by_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"api/dependency/agents?meta=true",value:n.managed_by_ids,onChange:i.onChange,clearable:!!n.managed_by_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),m(h,{label:e.lang("organizations"),multiple:!1,name:"org_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"api/dependency/organizations",value:n.org_ids,onChange:i.onChange,clearable:!!n.org_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),a("div",zS,[a("button",{id:"apply-btn",class:"btn btn-primary round-btn float-left",type:"button",onClick:t[0]||(t[0]=b=>i.onApply())},[HS,g("  "+r(e.lang("apply")),1)])])]),YS,a("div",WS,[n.apiUrl?(o(),v(_,{key:0,apiUrl:n.apiUrl,tickets:i.assetsData,componentTitle:n.componentTitle},null,8,["apiUrl","tickets","componentTitle"])):c("",!0)]),n.loading===!0?(o(),l("div",JS,[m(f,{duration:4e3})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[1]||(t[1]=b=>i.onSubmit()),class:"btn btn-primary",disabled:n.isDisabled},[ZS,g(" "+r(e.lang("attach")),1)],8,GS)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const XS=C(xS,[["render",QS],["__scopeId","data-v-008f019c"]]);const eF={name:"change-actions",props:{actions:{type:[String,Object],default:""},changeId:{type:[String,Number],default:""},teamId:{type:[String,Number],default:""},deptId:{type:[String,Number],default:""},updateChangeDetails:{type:Function},change:{type:Object,default:()=>{}}},computed:{showAttachTaskButton(){return!!this.actions.attach_task},taskExists(){return this.actions.associated_tasks},taskData(){return{entity_id:this.change.id,entity_type:"change",alertName:"change-view"}},updatePrintAPI(){return this.basePath()+"/service-desk/api/change-print/"+this.change.id+"?page="+this.printParams.page+"&limit="+this.printParams.limit+"&category="+this.printParams.category}},data(){return{showAssignModal:!1,showDeleteModal:!1,showReleaseCreate:!1,showReleaseExists:!1,showReleaseDetach:!1,showPlanningModal:!1,showApplyCab:!1,showAttach:!1,identifier:"",showAssociateModal:!1,associate:"",showChangeDurationModal:!1,printParams:{page:1,limit:10,category:"discussions"},discussionCount:0,change_status:"",statusList:"",loading:!1,category:""}},created(){window.emitter.on("chang-activity-params",this.updatePrintParams)},beforeMount(){S.get("/service-desk/api/change-print/"+this.change.id+"?getCount=true").then(e=>{this.discussionCount=e.data.data.discussionCount}).catch(e=>{A(e,"change-view")})},methods:{getStatus(e){this.showStatusModal=!0,this.change_status=e},getStatusList(){this.loading=!0,S.get("/service-desk/api/status/list?module=2").then(e=>{this.loading=!1,this.statusList=e.data.data.data}).catch(e=>{this.loading=!1}),this.category=this.$store.getters.getChangeAssociateCategory},updatePrintParams(e){e&&(Sa.isString(e)?this.printParams.category=e:(this.printParams.page=e.page?e.page:1,this.printParams.limit=e.limit?e.limit:10))},taskViewAction(){this.taskExists&&window.emitter.emit("showChangeTaskAssociates")},statusChangeNow(e){S.post("/service-desk/api/change-status/"+this.changeId+"/"+e).then(t=>{window.emitter.emit("refreshChangeStatus"),window.emitter.emit("updateChangeAssociates"),this.category==="activity"&&window.emitter.emit("updateChangeActivity"),U(t,"change-view")}).catch(t=>{A(t,"change-view")})},changeActionDivMounted(){let e=[];e.alertName="change-view",e.entity_id=this.id,e.entity_type="change",window.emitter.emit("change-action-div-mounted",e)},attachNewTask(){this.showAttachNewTaskModal=!0},subString(e,t=15){return oe(e,t)},planningMethod(e){this.showPlanningModal=!0,this.identifier=e},associateMethod(e){this.showAssociateModal=!0,this.associate=e},onClose(){this.showAssignModal=!1,this.showDeleteModal=!1,this.showReleaseCreate=!1,this.showReleaseExists=!1,this.showReleaseDetach=!1,this.showPlanningModal=!1,this.showApplyCab=!1,this.showAttach=!1,this.showAssociateModal=!1,this.showChangeDurationModal=!1,this.showAttachNewTaskModal=!1,this.showAttachExistingTaskModal=!1,this.$store.dispatch("unsetValidationError")},changePrint(){if(this.discussionCount<50&&this.printParams.category==="discussions"){window.open(this.updatePrintAPI);return}S.get(this.updatePrintAPI).then(e=>{U(e,"change-view")}).catch(e=>{A(e,"change-view")})}},components:{"assign-change-modal":o2,"delete-modal":De,"release-add-modal":_2,"release-create-modal":X2,"change-release-detach":sa,"change-update-modal":aa,"change-duration-modal":CS,"change-associate-modal":VS,"cab-add-modal":RS,"change-assets":XS,TaskActionButtons:Ka}},Ie=e=>(K("data-v-aacb3081"),e=e(),z(),e),tF={class:"card-tools"},sF={class:"btn-group"},aF=["disabled"],nF=Ie(()=>a("i",{class:"fas fa-sync"},null,-1)),oF={class:"dropdown-menu"},iF={class:"btn-group"},lF=["disabled"],rF=Ie(()=>a("i",{class:"fas fa-ticket"},null,-1)),dF={class:"dropdown-menu"},cF=["disabled"],uF=Ie(()=>a("i",{class:"glyphicon glyphicon-plus"},null,-1)),hF=["disabled"],mF=Ie(()=>a("i",{class:"fas fa-server"},null,-1)),_F={class:"btn-group"},pF=["disabled"],fF=Ie(()=>a("i",{class:"fas fa-link"},null,-1)),gF={class:"dropdown-menu dropdown-menu-right"},bF={key:0,class:"btn-group"},yF=Ie(()=>a("i",{class:"far fa-hand-point-right"},null,-1)),vF={type:"button",class:"btn btn-tool"},wF=Ie(()=>a("i",{class:"fa fa-print","aria-hidden":"true"},null,-1)),kF={class:"btn-group"},CF=["disabled"],DF=Ie(()=>a("i",{class:"fas fa-exchange-alt"},null,-1)),SF={class:"dropdown-menu status-list dropdown-menu-right"},FF={key:0,class:"row"},MF=["onClick"],IF=["id"],AF={key:1,class:"dropdown-item",href:"javascript:;"},PF={class:"btn-group"},TF=["disabled"],VF=Ie(()=>a("i",{class:"fas fa-cog"},null,-1)),LF={class:"dropdown-menu dropdown-menu-right"};function UF(e,t,s,d,n,i){const h=u("TaskActionButtons"),_=u("reuse-loader"),f=u("router-link"),p=u("delete-modal"),b=u("assign-change-modal"),k=u("release-create-modal"),D=u("release-add-modal"),P=u("cab-add-modal"),E=u("change-release-detach"),M=u("change-update-modal"),F=u("change-associate-modal"),T=u("change-assets"),O=u("change-duration-modal"),Z=N("tooltip");return o(),l("div",tF,[a("div",sF,[w((o(),l("span",null,[a("button",{type:"button",class:"btn btn-tool dropdown-toggle","data-toggle":"dropdown",disabled:!s.actions.change_details_edit_permission},[nF,g(" "+r(e.lang("planning")),1)],8,aF),a("div",oF,[a("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[0]||(t[0]=J=>i.planningMethod("reason"))},r(e.lang("reason_for_change")),1),a("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[1]||(t[1]=J=>i.planningMethod("impact"))},r(e.lang("impact")),1),a("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[2]||(t[2]=J=>i.planningMethod("rollout-plan"))},r(e.lang("rollout_plan")),1),a("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[3]||(t[3]=J=>i.planningMethod("backout-plan"))},r(e.lang("backout_plan")),1)])])),[[Z,s.actions.change_details_edit_permission?"":e.trans("can_not_update_change")]])]),a("div",iF,[w((o(),l("span",null,[a("button",{type:"button",class:"btn btn-tool dropdown-toggle","data-toggle":"dropdown",disabled:!s.actions.change_details_edit_permission},[rF,g(" "+r(e.lang("associate")),1)],8,lF),a("div",dF,[a("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[4]||(t[4]=J=>i.associateMethod("initiating"))},r(e.lang("tickets_initiating_this_change")),1),a("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[5]||(t[5]=J=>i.associateMethod("initiated"))},r(e.lang("tickets_caused_due_to_this_change")),1)])])),[[Z,s.actions.change_details_edit_permission?"":e.trans("can_not_update_change")]])]),w((o(),l("span",null,[s.actions.allowed_enforce_cab?(o(),l("button",{key:0,class:"btn btn-tool",onClick:t[6]||(t[6]=J=>n.showApplyCab=!0),disabled:!s.actions.change_details_edit_permission},[uF,g(" "+r(e.lang("apply_cab")),1)],8,cF)):c("",!0)])),[[Z,s.actions.change_details_edit_permission?"":e.trans("can_not_update_change")]]),w((o(),l("span",null,[a("button",{class:"btn btn-tool",onClick:t[7]||(t[7]=J=>n.showAttach=!0),disabled:!s.actions.change_details_edit_permission},[mF,g(" "+r(e.lang("attach_asset")),1)],8,hF)])),[[Z,s.actions.change_details_edit_permission?"":e.trans("can_not_update_change")]]),a("div",_F,[w((o(),l("span",null,[s.actions.change_release_detach||s.actions.change_release_attach?(o(),l("button",{key:0,type:"button",class:"btn btn-tool dropdown-toggle","data-toggle":"dropdown",disabled:!s.actions.change_details_edit_permission},[fF,g(" "+r(e.lang("release")),1)],8,pF)):c("",!0),a("div",gF,[s.actions.change_release_detach?(o(),l(I,{key:0},[s.change.attach_releases.length>0?(o(),l("a",{key:0,class:"dropdown-item text-dark",href:"javascript:;",onClick:t[8]||(t[8]=J=>n.showReleaseDetach=!0)},[g(r(e.lang("detach"))+" ",1),w((o(),l("b",null,[g(r(i.subString(s.change.attach_releases[0].subject,10)),1)])),[[Z,s.change.attach_releases[0].subject]])])):c("",!0)],64)):c("",!0),s.actions.change_release_attach?(o(),l(I,{key:1},[a("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[9]||(t[9]=J=>n.showReleaseCreate=!0)},r(e.lang("new_release")),1),a("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[10]||(t[10]=J=>n.showReleaseExists=!0)},r(e.lang("existing_release")),1)],64)):c("",!0)])])),[[Z,s.actions.change_details_edit_permission?"":e.trans("can_not_update_change")]])]),i.showAttachTaskButton?(o(),l("div",bF,[m(h,{data:i.taskData,"show-button-border":0,"requires-json-parse":0,"view-button-action":i.taskViewAction,"show-view-button":i.taskExists},null,8,["data","view-button-action","show-view-button"])])):c("",!0),a("button",{type:"button",class:"btn btn-tool",onClick:t[11]||(t[11]=J=>n.showAssignModal=!0)},[yF,g(" "+r(e.trans("assign")),1)]),a("button",vF,[a("a",{class:"text-dark",href:"javascript:;",onClick:t[12]||(t[12]=(...J)=>i.changePrint&&i.changePrint(...J))},[wF,g(" "+r(e.trans("print")),1)])]),a("div",kF,[s.actions.change_edit?w((o(),l("button",{key:0,disabled:!s.actions.change_details_edit_permission,type:"button",class:"btn btn-tool dropdown-toggle","data-toggle":"dropdown",onClick:t[13]||(t[13]=J=>i.getStatusList()),id:"status"},[DF,g(" "+r(e.trans("change_status")),1)],8,CF)),[[Z,s.actions.change_details_edit_permission?"":e.trans("can_not_update_change")]]):c("",!0),a("div",SF,[n.loading?(o(),l("div",FF,[m(_,{"animation-duration":4e3,color:"#1d78ff",size:20})])):c("",!0),n.loading?c("",!0):(o(),l(I,{key:1},[n.statusList&&n.statusList.length>0?(o(!0),l(I,{key:0},$(n.statusList,J=>(o(),l("div",{class:"dropdown-item change-status",id:"change_status",onClick:ee=>(i.statusChangeNow(J.id),i.getStatus(J)),href:"javascript:;"},[a("i",{class:j(J.icon_class),style:Ue({color:J.icon_color})},null,6),a("a",{id:J.id,href:"javascript:;"}," "+r(J.name),9,IF)],8,MF))),256)):c("",!0),n.statusList&&n.statusList.length===0?(o(),l("a",AF,r(e.trans("no-records")),1)):c("",!0)],64))])]),a("div",PF,[w((o(),l("span",null,[a("button",{type:"button",class:"btn btn-tool dropdown-toggle","data-toggle":"dropdown",disabled:!s.actions.change_details_edit_permission},[VF,g(" "+r(e.lang("more")),1)],8,TF),a("div",LF,[s.actions.change_edit?(o(),v(f,{key:0,class:"dropdown-item text-dark",to:"/service-desk/changes/"+s.change.id+"/edit"},{default:y(()=>[g(r(e.lang("edit")),1)]),_:1},8,["to"])):c("",!0),s.actions.change_delete?(o(),l("a",{key:1,class:"dropdown-item text-dark",href:"javascript:;",onClick:t[14]||(t[14]=J=>n.showDeleteModal=!0)},r(e.lang("delete")),1)):c("",!0),a("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[15]||(t[15]=J=>n.showChangeDurationModal=!0)},r(e.lang("update_activity_duration")),1)])])),[[Z,s.actions.change_details_edit_permission?"":e.trans("can_not_update_change")]])]),m(q,{name:"modal"},{default:y(()=>[n.showDeleteModal?(o(),v(p,{key:0,onClose:i.onClose,showModal:n.showDeleteModal,alertComponentName:"change-view",deleteUrl:"/service-desk/api/change/"+s.change.id,redirectUrl:"/service-desk/changes/list",from:"agent"},null,8,["onClose","showModal","deleteUrl"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showAssignModal?(o(),v(b,{key:0,onClose:i.onClose,showModal:n.showAssignModal,changeID:s.change.id,teamId:s.change.team?s.change.team.id:"",deptId:s.change.department?s.change.department.id:""},null,8,["onClose","showModal","changeID","teamId","deptId"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showReleaseCreate?(o(),v(k,{key:0,onClose:i.onClose,showModal:n.showReleaseCreate,changeId:s.change.id},null,8,["onClose","showModal","changeId"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showReleaseExists?(o(),v(D,{key:0,onClose:i.onClose,showModal:n.showReleaseExists,changeId:s.change.id},null,8,["onClose","showModal","changeId"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showApplyCab?(o(),v(P,{key:0,onClose:i.onClose,showModal:n.showApplyCab,changeId:s.change.id},null,8,["onClose","showModal","changeId"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showReleaseDetach?(o(),v(E,{key:0,onClose:i.onClose,showModal:n.showReleaseDetach,releaseId:s.change.attach_releases[0].id,changeId:s.change.id,alertCompName:"change-view",updateChangeData:s.updateChangeDetails},null,8,["onClose","showModal","releaseId","changeId","updateChangeData"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showPlanningModal?(o(),v(M,{key:0,onClose:i.onClose,showModal:n.showPlanningModal,identifier:n.identifier,changeId:s.change.id,alertCompName:"change-view"},null,8,["onClose","showModal","identifier","changeId"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showAssociateModal?(o(),v(F,{key:0,onClose:i.onClose,showModal:n.showAssociateModal,associate:n.associate,changeId:s.change.id,alertCompName:"change-view"},null,8,["onClose","showModal","associate","changeId"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showAttach?(o(),v(T,{key:0,onClose:i.onClose,showModal:n.showAttach,changeId:s.change.id},null,8,["onClose","showModal","changeId"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showChangeDurationModal?(o(),v(O,{key:0,onClose:i.onClose,showModal:n.showChangeDurationModal,changeId:s.change.id,alertCompName:"change-view",duration:s.change.total_activity_duration},null,8,["onClose","showModal","changeId","duration"])):c("",!0)]),_:1})])}const $F=C(eF,[["render",UF],["__scopeId","data-v-aacb3081"]]);const NF={name:"change-description",description:"Change description Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},description:{type:String,default:""}}},EF={class:"modal-title"},qF={id:"log_desc"},OF=["innerHTML"];function jF(e,t,s,d,n,i){const h=u("modal");return s.showModal?(o(),v(h,{key:0,showModal:s.showModal,onClose:s.onClose},{title:y(()=>[a("h4",EF,r(e.lang("description")),1)]),fields:y(()=>[a("div",qF,[a("span",{innerHTML:s.description},null,8,OF)])]),_:1},8,["showModal","onClose"])):c("",!0)}const RF=C(NF,[["render",jF],["__scopeId","data-v-cce247be"]]);const xF={name:"change-details",description:"Change details page",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},props:{change:{type:Object,default:()=>{}},actions:{type:[Object,String],default:()=>{}},updateData:{type:Function}},data(){return{showDescription:!1}},methods:{checkValues(e,t=100){return e?e.name?oe(e.name,t):oe(e,t):"---"},subString(e,t=20){return oe(e,t)},onClose(){this.showDescription=!1,this.$store.dispatch("unsetValidationError")},downloadFile(e){window.open(e)}},components:{"change-actions":$F,"change-description":RF}},St=e=>(K("data-v-5227c41b"),e=e(),z(),e),BF={class:"change-details"},KF={class:"card card-light"},zF={class:"card-header"},HF={class:"card-title"},YF={class:"card-body"},WF={class:"row"},JF={class:"col-md-12"},GF={class:"callout callout-info bg-info"},ZF={class:"row"},QF={class:"col-md-4"},XF={class:"col-md-4"},eM={class:"col-md-4"},tM={class:"col-md-12"},sM={class:"row"},aM={key:0,class:"col-md-6 info-row d-flex"},nM={class:"col-md-6"},oM={class:"col-md-6"},iM={key:1,class:"col-md-6 info-row d-flex"},lM={class:"col-md-6"},rM={class:"col-md-6"},dM={class:"text-primary"},cM={key:2,class:"col-md-6 info-row d-flex"},uM={class:"col-md-6"},hM={class:"col-md-6"},mM={class:"text-primary"},_M={key:3,class:"col-md-6 info-row d-flex"},pM={class:"col-md-6"},fM={class:"col-md-6"},gM={class:"text-primary"},bM={key:4,class:"col-md-6 info-row d-flex"},yM={class:"col-md-6"},vM={class:"col-md-6"},wM={class:"text-primary"},kM={key:5,class:"col-md-6 info-row d-flex"},CM={class:"col-md-6"},DM={class:"col-md-6"},SM={class:"text-primary"},FM={key:6,class:"col-md-6 info-row d-flex"},MM={class:"col-md-6"},IM={class:"col-md-6"},AM={class:"text-primary"},PM={key:7,class:"col-md-6 info-row d-flex"},TM={class:"col-md-6"},VM={class:"col-md-6"},LM={class:"text-primary"},UM={key:8,class:"col-md-6 info-row d-flex"},$M={class:"col-md-6"},NM={class:"col-md-6"},EM={class:"text-primary"},qM={class:"col-md-6 info-row d-flex"},OM={class:"col-md-6"},jM={class:"col-md-6"},RM=St(()=>a("i",{class:"fas fa-file-code"},"  ",-1)),xM={class:"col-md-6 info-row d-flex"},BM={class:"col-md-6"},KM={class:"col-md-6"},zM={key:0},HM={onClick:"return false",class:"text-primary"},YM={key:0},WM={key:1,onClick:"return false",class:"text-primary"},JM={key:10,class:"col-md-6 info-row d-flex"},GM={class:"col-md-6"},ZM={class:"col-md-6"},QM={key:0},XM={class:"line"},eI=["src"],tI=["onClick"],sI=St(()=>a("i",{class:"fas fa-download"},null,-1)),aI=St(()=>a("br",null,null,-1)),nI={key:1},oI=St(()=>a("hr",null,null,-1)),iI={key:0,class:"card card-secondary"},lI={class:"card-header"},rI={class:"card-title"},dI={class:"card-body"},cI={class:"col-md-12 asset_row"},uI={class:"row"},hI={class:"col-md-6 info-row d-flex"},mI={class:"col-md-6"},_I={class:"col-md-6"},pI={key:0},fI={onClick:"return false",class:"text-primary"},gI={key:0},bI={key:1,onClick:"return false",class:"text-primary"};function yI(e,t,s,d,n,i){const h=u("change-actions"),_=u("router-link"),f=u("change-description"),p=N("tooltip");return o(),l("div",BF,[a("div",KF,[a("div",zF,[w((o(),l("h3",HF,[g(r(i.subString(s.change.subject,50)),1)])),[[p,s.change.subject]]),m(h,{changeId:s.change.id,change:s.change,actions:s.actions,updateChangeDetails:s.updateData},null,8,["changeId","change","actions","updateChangeDetails"])]),a("div",YF,[a("div",WF,[a("div",JF,[a("div",GF,[a("div",ZF,[a("div",QF,[a("b",null,r(e.trans("requester"))+" : ",1),w((o(),l("span",null,[g(r(s.change.requester.full_name?s.change.requester.full_name:s.change.requester.meta_name),1)])),[[p,s.change.requester.full_name]])]),a("div",XF,[a("b",null,r(e.trans("status"))+" : ",1),w((o(),l("span",null,[g(r(i.subString(s.change.status.name)),1)])),[[p,s.change.status.name]])]),a("div",eM,[a("b",null,r(e.trans("change_type"))+" : ",1),w((o(),l("span",null,[g(r(i.subString(s.change.change_type.name)),1)])),[[p,s.change.change_type.name]])])])])])]),a("div",tM,[a("div",sM,[s.change.agent?(o(),l("div",aM,[a("div",nM,[a("label",null,r(e.trans("agent")),1)]),a("div",oM,[w((o(),v(_,{class:"text-primary",to:"/user/"+s.change.agent.id},{default:y(()=>[g(r(i.subString(s.change.agent.full_name,15)),1)]),_:1},8,["to"])),[[p,s.change.agent.full_name]])])])):c("",!0),s.change.department?(o(),l("div",iM,[a("div",lM,[a("label",null,r(e.trans("department")),1)]),a("div",rM,[w((o(),l("a",dM,[g(r(i.checkValues(s.change.department,15)),1)])),[[p,i.checkValues(s.change.department)]])])])):c("",!0),s.change.impact_type?(o(),l("div",cM,[a("div",uM,[a("label",null,r(e.trans("impact_type")),1)]),a("div",hM,[w((o(),l("a",mM,[g(r(i.checkValues(s.change.impact_type,15)),1)])),[[p,i.checkValues(s.change.impact_type)]])])])):c("",!0),s.change.location?(o(),l("div",_M,[a("div",pM,[a("label",null,r(e.trans("location")),1)]),a("div",fM,[w((o(),l("a",gM,[g(r(i.checkValues(s.change.location,15)),1)])),[[p,i.checkValues(s.change.location)]])])])):c("",!0),s.change.priority?(o(),l("div",bM,[a("div",yM,[a("label",null,r(e.trans("priority")),1)]),a("div",vM,[w((o(),l("a",wM,[g(r(i.checkValues(s.change.priority,15)),1)])),[[p,i.checkValues(s.change.priority)]])])])):c("",!0),s.change.team?(o(),l("div",kM,[a("div",CM,[a("label",null,r(e.trans("team")),1)]),a("div",DM,[w((o(),l("a",SM,[g(r(i.checkValues(s.change.team,15)),1)])),[[p,i.checkValues(s.change.team)]])])])):c("",!0),s.change.change_raised_on?(o(),l("div",FM,[a("div",MM,[a("label",null,r(e.trans("change_raised_on")),1)]),a("div",IM,[w((o(),l("a",AM,[g(r(d.formattedTime(s.change.change_raised_on)),1)])),[[p,i.checkValues(d.formattedTime(s.change.change_raised_on))]])])])):c("",!0),s.change.change_closed_on?(o(),l("div",PM,[a("div",TM,[a("label",null,r(e.trans("change_closed_on")),1)]),a("div",VM,[w((o(),l("a",LM,[g(r(d.formattedTime(s.change.change_closed_on)),1)])),[[p,i.checkValues(d.formattedTime(s.change.change_closed_on))]])])])):c("",!0),s.change.total_activity_duration?(o(),l("div",UM,[a("div",$M,[a("label",null,r(e.trans("total_activity_duration")),1)]),a("div",NM,[w((o(),l("a",EM,[a("b",null,r(Math.floor(s.change.total_activity_duration/60)),1),g(" "+r(e.trans("hours"))+" ",1),a("b",null,r(s.change.total_activity_duration%60),1),g(" "+r(e.trans("mins")),1)])),[[p,Math.floor(s.change.total_activity_duration/60)+" "+e.trans("hours")+" "+s.change.total_activity_duration%60+" "+e.trans("mins")]])])])):c("",!0),a("div",qM,[a("div",OM,[a("label",null,r(e.trans("description")),1)]),a("div",jM,[a("a",{href:"javascript:;",class:"btn btn-info btn-xs",onClick:t[0]||(t[0]=b=>n.showDescription=!0)},[RM,g(r(e.trans("show_description")),1)])])]),s.change.custom_field_values&&s.change.custom_field_values.length>0?(o(!0),l(I,{key:9},$(s.change.custom_field_values,b=>(o(),l("div",xM,[a("div",BM,[a("label",null,r(b.label),1)]),a("div",KM,[Array.isArray(b.value)?(o(),l("div",zM,[(o(!0),l(I,null,$(b.value,(k,D)=>w((o(),l("a",HM,[g(r(i.subString(k)),1),D!=Object.keys(b.value).length-1?(o(),l("span",YM,",")):c("",!0),g("  ")])),[[p,k]])),256))])):w((o(),l("a",WM,[g(r(b.field_type=="date"?b.value:b?i.subString(b.value):"---"),1)])),[[p,b.field_type=="date"?b.value:b.value?b.value.replace(/\r?\n/g,"<br />"):"---"]])])]))),256)):c("",!0),s.change.attachments.length>0?(o(),l("div",JM,[a("div",GM,[a("label",null,r(e.trans("attachments")),1)]),a("div",ZM,[s.change.attachments.length>0?(o(),l("span",QM,[(o(!0),l(I,null,$(s.change.attachments,b=>(o(),l(I,null,[a("span",XM,[w((o(),l("span",null,[a("img",{src:b.thumbnail_url,class:"attach_img"},null,8,eI),g(" "+r(i.subString(b.name,15))+" "+r("("+b.size+")"),1)])),[[p,b.name]]),w((o(),l("a",{id:"download",onClick:k=>i.downloadFile(b.download_url),href:"javascript:;"},[g("  "),sI],8,tI)),[[p,e.trans("download")]])]),aI],64))),256))])):(o(),l("span",nI,"---"))])])):c("",!0)])]),oI,s.change.custom_field_values_for_change_type&&s.change.custom_field_values_for_change_type.length>0?(o(),l("div",iI,[a("div",lI,[a("h3",rI,r(s.change.change_type.name+" "+e.trans("properties")),1)]),a("div",dI,[a("div",cI,[a("div",uI,[(o(!0),l(I,null,$(s.change.custom_field_values_for_change_type,b=>(o(),l("div",hI,[a("div",mI,[a("label",null,r(b.label),1)]),a("div",_I,[Array.isArray(b.value)?(o(),l("div",pI,[(o(!0),l(I,null,$(b.value,(k,D)=>w((o(),l("a",fI,[g(r(i.subString(k)),1),D!=Object.keys(b.value).length-1?(o(),l("span",gI,",")):c("",!0),g("  ")])),[[p,k]])),256))])):w((o(),l("a",bI,[g(r(b.field_type=="date"?b.value:i.subString(b.value)),1)])),[[p,(b.field_type=="date",b.value)]])])]))),256))])])])])):c("",!0)]),m(q,{name:"modal"},{default:y(()=>[n.showDescription?(o(),v(f,{key:0,onClose:i.onClose,showModal:n.showDescription,description:s.change.description},null,8,["onClose","showModal","description"])):c("",!0)]),_:1})])])}const vI=C(xF,[["render",yI],["__scopeId","data-v-5227c41b"]]),wI={name:"detach-ticket-modal",description:"Detach Ticket Modal component",props:{showModal:{type:Boolean,default:!1},changeId:{type:[String,Number],default:""},taskId:{type:[String,Number],default:""},onClose:{type:Function}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1}},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,S.delete("/service-desk/api/detach-task/change",{params:{task_id:this.taskId,change_id:this.changeId}}).then(e=>{U(e,"change-view"),window.emitter.emit("updateChangeAssociates"),window.emitter.emit("changeTaskrefreshData"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(e=>{this.loading=!1,this.isDisabled=!1,A(e,"detach-ticket")})}}},kI={class:"modal-title"},CI={key:0},DI={key:1,class:"row"},SI=["disabled"],FI=a("i",{class:"fas fa-unlink"},null,-1);function MI(e,t,s,d,n,i){const h=u("alert"),_=u("reuse-loader"),f=u("modal");return s.showModal?(o(),v(f,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{alert:y(()=>[m(h,{componentName:"detach-task"})]),title:y(()=>[a("h4",kI,r(e.trans("sd_change_task_detach")),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",CI,[a("span",null,r(e.trans("sd_change_task_detach_confirm")),1)])),n.loading?(o(),l("div",DI,[m(_,{"animation-duration":4e3,color:"#1d78ff",size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=p=>i.onSubmit()),class:"btn btn-danger",disabled:n.isDisabled},[FI,g(" "+r(e.trans("sd_change_task_detach")),1)],8,SI)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const II=C(wI,[["render",MI]]);const AI={name:"ChangeTasks",description:"List of tasks linked with Change",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},components:{TaskDetachModal:II},props:{changeId:{type:[String,Number],default:""},componentTitle:{type:String,default:""},disableLoader:{type:Boolean,default:!1}},data(){return{selectedTickets:this.tickets,columns:["task_name","task_start_date","task_end_date","users","closed_by","teams","action"],options:{},apiEndPoint:"/service-desk/api/attached-task/change?change_id="+this.changeId,taskId:"",showModal:!1,totalCount:""}},beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},headings:{task_name:this.lang("task_name"),task_status:this.lang("status"),users:this.lang("Agent(s)"),closed_by:this.lang("closed_by"),teams:this.lang("Team(s)"),task_end_date:this.lang("task_end_date"),task_start_date:this.lang("task_start_date"),action:this.lang("action")},columnsClasses:{task_name:"change-task-columns",task_status:"change-task-columns",task_end_date:"change-task-columns",task_start_date:"task_dates",closed_by:"change-task-columns",users:"change-task-columns",teams:"change-task-columns",action:"change-task-columns"},texts:{filter:"",limit:""},templates:{task_name:(t,s)=>e.h(Na,{data:s}),users:(t,s,d,n)=>e.h(rs,{data:s,index:d,column:n}),teams:(t,s,d,n)=>e.h(rs,{data:s,index:d,column:n}),task_end_date(t,s){return e.formattedTime(s.task_end_date)},task_start_date(t,s){return e.formattedTime(s.task_start_date)},closed_by:function(t,s){return e.h(s.closed_by?se:"span",{to:s.closed_by?"/user/"+s.closed_by.id:"#"},s.closed_by?s.closed_by.full_name:"--")},action(t,s){let d=e.h("i",{class:"fas fa-unlink"});return e.h("a",{class:"btn btn-primary",title:this.trans("detach"),href:"javascript:;",onClick(){e.onDetach(s.id)}},[d])}},sortable:["task_name"],filterable:["task_name"],pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc",search_query:t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return e.totalCount=t.total,{data:t.data.map(s=>(s.listElementObj={key:"assignees",redirectUrl:["agents","assigned_to_me"].includes(s.assign_to)?"/user/":"/assign-teams"},s)),count:e.totalCount}}}},methods:{onDetach(e){this.taskId=e,this.showModal=!0},onClose(){this.showModal=!1},handelLoader(e){this.$emit("loaderValue",e)}},watch:{totalCount(e){e===0&&window.emitter.emit("updateChangeTables")}}},PI={id:"change_associated_tasks"};function TI(e,t,s,d,n,i){const h=u("data-table"),_=u("task-detach-modal");return o(),l("div",PI,[m(h,{url:n.apiEndPoint,dataColumns:n.columns,option:n.options,scroll_to:"changes-associates",componentTitle:s.componentTitle,onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","componentTitle","onLoaderState","disableLoader"]),m(q,{name:"modal"},{default:y(()=>[n.showModal?(o(),v(_,{key:0,onClose:i.onClose,showModal:n.showModal,"task-id":n.taskId,changeId:s.changeId},null,8,["onClose","showModal","task-id","changeId"])):c("",!0)]),_:1})])}const VI=C(AI,[["render",TI]]);const LI={name:"TaskCommentModal",components:{AddMedia:Hs},props:{showModal:{type:Boolean,default:!1},onClose:{type:Function},alertComponentName:{type:String,required:!0},modalTitle:{type:String,default:"sd_add_comment"},changeId:{type:[String,Number],required:!0},parentComment:{type:[String,Number],required:!1},commentText:{type:String,default:""},commentForEdit:{type:[String,Number],default:""},attachmentsForEdit:{type:Array,default:()=>[]}},data(){return{containerStyle:{width:"700px"},loading:!1,attachments:[...this.attachmentsForEdit],inline:[],comment:this.commentText}},computed:{isDisabled(){return!this.comment}},methods:{async onSubmit(){this.loading=!0;let e="service-desk/api/add-change-comment",t="POST",s={change_id:this.changeId,type:"change",comment:this.comment,parent_id:this.parentComment||null,attachments:this.attachments};this.commentForEdit&&(e="service-desk/api/update-change-comment",t="PUT",s.comment_id=this.commentForEdit);try{let d=await S.request({method:t,url:e,data:s});this.$store.dispatch("unsetValidationError"),U(d,this.alertComponentName),this.onClose(),window.emitter.emit("reloadChangeComments")}catch(d){A(d,this.alertComponentName)}finally{this.loading=!1}},getAttachments(e){this.attachments=e},onChange(e,t){this[t]=e}}},UI={class:"modal-title"},$I={key:0},NI={key:1,class:"row"},EI=a("i",{class:"fas fa-sync"},null,-1);function qI(e,t,s,d,n,i){const h=u("add-media"),_=u("reuse-loader"),f=u("modal");return s.showModal?(o(),v(f,{key:0,showModal:s.showModal,onClose:s.onClose,modalBodyClass:"modal__dimensions"},{title:y(()=>[a("h4",UI,r(e.trans(s.modalTitle)),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",$I,[m(h,{attachments:n.attachments,inlineFile:n.inline,description:n.comment,classname:"col-sm-12",name:"comment",onAttach:i.getAttachments,onInput:i.onChange,page_name:"task_comment","label-name":"task_comment",id:"focus_editor",style:{width:"97%"}},null,8,["attachments","inlineFile","description","onAttach","onInput"])])),n.loading?(o(),l("div",NI,[m(_,{"animation-duration":4e3,color:"#1d78ff",size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=p=>i.onSubmit()),class:"btn btn-primary"},[EI,g("  "+r(e.trans("update")),1)])]),_:1},8,["showModal","onClose"])):c("",!0)}const OI=C(LI,[["render",qI]]);const jI={name:"Change Discussion",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},props:{changeId:{type:[String,Number],required:!0},maximized:{type:Boolean,default:!1}},components:{ThreadBody:xa,ChangeCommentModal:OI,ChangeCommentDetachModal:Ea},data(){return{inboxThreads:[],page:1,next_cursor:"initialCursor",showLoader:!1,showModal:!1,parentComment:"",commentText:"",modalKey:Math.floor(Math.random()*1e6),loading:!1,commentForEdit:"",showDeleteModal:!1,attachments:[]}},computed:{detachParams(){return{change_id:this.changeId,type:"change",comment_id:this.commentForEdit}}},beforeMount(){this.getThreads()},created(){window.emitter.on("updateTimelineThreads",this.updateLogs),window.emitter.on("threadReply",e=>{this.modalKey++,this.parentComment=e.id,this.commentText=e.content,this.showModal=!0}),window.emitter.on("threadEdit",e=>{this.modalKey++,this.parentComment="",this.commentText=e.originalText,this.commentForEdit=e.id,this.attachments=e.attach,this.showModal=!0}),window.emitter.on("threadDelete",e=>{this.commentForEdit=e.id,this.showDeleteModal=!0})},watch:{showLoader(e,t){return this.showLoader=e,this.$emit("loaderValue",e),e},loading(e){this.$emit("loaderValue",e)}},methods:{updateLogs(){this.showLoader=!0,this.page=1,this.getThreads(void 0,!0)},async getThreads(e,t=!1){this.next_cursor==="initialCursor"?this.loading=!0:this.showLoader=!0;try{let{data:s}=await S.get(`service-desk/api/get-change-comments?change_id=${this.changeId} & type=change & cursor= ${this.next_cursor}`);if(this.next_cursor!==null){const d=s.data;for(let n in d)this.inboxThreads.push(d[n]);this.next_cursor=s.next_cursor,e&&e.loaded()}else e&&e.complete()}catch(s){A(s,"change-discussion"),this.inboxThreads=[]}finally{this.showLoader=!1,this.loading=!1}},showAddCommentModal(){this.parentComment="",this.commentText="",this.commentForEdit="",this.modalKey++,this.showModal=!0},checkDate(e){if(e==0)return!0;var t=this.formattedDate(this.inboxThreads[e-1].created_at),s=this.formattedDate(this.inboxThreads[e].created_at);if(t!=s)return!0},showThreadEnd(e){return e===this.inboxThreads.length-1},onClose(){this.showModal=!1,this.commentForEdit=""}}},ot=e=>(K("data-v-1ff7cc46"),e=e(),z(),e),RI={class:"change-discussion"},xI={id:"change_discussions"},BI={class:"row mb-3"},KI={class:"col-sm-2",style:{display:"flex","flex-direction":"row"}},zI=ot(()=>a("i",{class:"glyphicon glyphicon-plus"},null,-1)),HI=ot(()=>a("div",{class:"col-sm-10"},null,-1)),YI={class:"card"},WI={class:"card-body"},JI={key:0,class:"timeline timeline-inverse"},GI={key:0,class:"time-label"},ZI={class:"bg-default border"},QI={key:1},XI=ot(()=>a("i",{class:"fas fa-history bg-gray"},null,-1)),eA=[XI],tA=ot(()=>a("span",null,null,-1)),sA=ot(()=>a("span",null,null,-1)),aA={key:1,style:{display:"flex","align-items":"center","justify-content":"center","flex-direction":"column"}},nA={class:"text-center text-muted"};function oA(e,t,s,d,n,i){const h=u("alert"),_=u("change-comment-modal"),f=u("change-comment-detach-modal"),p=u("thread-body"),b=u("infinite-loading");return o(),l("div",RI,[m(h,{componentName:"change-discussion"}),a("div",xI,[a("div",BI,[a("div",KI,[a("button",{class:"btn btn-default",onClick:t[0]||(t[0]=mt((...k)=>i.showAddCommentModal&&i.showAddCommentModal(...k),["prevent"]))},[zI,g(" "+r(e.trans("sd_add_comment")),1)])]),HI,m(q,{name:"modal"},{default:y(()=>[(o(),v(_,{changeId:s.changeId,"alert-component-name":"change-discussion","comment-text":n.commentText,"on-close":i.onClose,"show-modal":n.showModal,"parent-comment":n.parentComment,key:n.modalKey,"comment-for-edit":n.commentForEdit,"attachments-for-edit":n.attachments},null,8,["changeId","comment-text","on-close","show-modal","parent-comment","comment-for-edit","attachments-for-edit"]))]),_:1}),m(q,{name:"modal"},{default:y(()=>[m(f,{"detach-url":"service-desk/api/delete-change-comment","detach-params":i.detachParams,"alert-component-name":"change-discussion","show-modal":n.showDeleteModal,"on-close":()=>this.showDeleteModal=!1,"event-to-fire-after-success":"reloadChangeComments","detach-type":"sd_comment","detach-icon-class":"fas fa-trash","detach-action":"delete"},null,8,["detach-params","show-modal","on-close"])]),_:1})]),a("div",YI,[a("div",WI,[a("div",{class:j({"scrollable-thread":!s.maximized}),id:"thread_scroll"},[n.inboxThreads.length>0?(o(),l("div",JI,[(o(!0),l(I,null,$(n.inboxThreads,(k,D)=>(o(),l(I,{key:"thread"+D},[i.checkDate(D)?(o(),l("div",GI,[a("span",ZI,r(d.formattedDate(k.created_at)),1)])):c("",!0),m(p,{thread:k,index:D,max:s.maximized},null,8,["thread","index","max"]),i.showThreadEnd(D)?(o(),l("div",QI,eA)):c("",!0)],64))),128)),m(b,{onInfinite:i.getThreads,ref:"infiniteLoading"},{spinner:y(()=>[tA]),complete:y(()=>[sA]),_:1},8,["onInfinite"])])):(o(),l("div",aA,[a("h2",nA,r(e.trans("change-no-discussions")),1),a("button",{class:"btn btn-default mt-3",onClick:t[1]||(t[1]=mt((...k)=>i.showAddCommentModal&&i.showAddCommentModal(...k),["prevent"]))},r(e.trans("change-start-discussion")),1)]))],2)])])])])}const iA=C(jI,[["render",oA],["__scopeId","data-v-1ff7cc46"]]),lA={name:"change-associates-actions",description:"Contains detach button which can be used as a component as whole. It is built basically for displaying deatch button in a datable.",props:{data:{type:Object,required:!0}},data(){return{showModal:!1}},methods:{onClose(){this.showModal=!1,this.$store.dispatch("unsetValidationError")}},components:{"change-asset-detach":sa}},rA={class:"btn-group"},dA=["title"],cA=a("i",{class:"fas fa-unlink"},null,-1),uA=[cA],hA={key:1},mA=a("button",{class:"btn btn-primary btn-sm",disabled:!0},[a("i",{class:"fas fa-unlink"})],-1),_A=[mA];function pA(e,t,s,d,n,i){const h=u("change-asset-detach"),_=N("tooltip");return o(),l("div",rA,[s.data.detach?(o(),l(I,{key:0},[s.data.is_updatable?(o(),l("a",{key:0,id:"detach-button",onClick:t[0]||(t[0]=()=>n.showModal=!0),href:"javascript:;"},[a("span",{title:e.trans("detach"),class:"btn btn-primary btn-sm",id:"detach_btn"},uA,8,dA)])):w((o(),l("span",hA,_A)),[[_,e.trans("can_not_update_change")]])],64)):c("",!0),m(q,{name:"modal"},{default:y(()=>[n.showModal?(o(),v(h,{key:0,onClose:i.onClose,showModal:n.showModal,assetId:s.data.id,changeId:s.data.change_id,compName:s.data.compName},null,8,["onClose","showModal","assetId","changeId","compName"])):c("",!0)]),_:1})])}const fA=C(lA,[["render",pA]]);const gA={name:"changes-associates-table",description:"Changes associates table page",props:{category:{type:String,default:"inbox"},apiUrl:{type:String,default:""},changeId:{type:[String,Number],default:""},componentTitle:{type:String,default:""},actions:{type:[Object,String],default:()=>{}},disableLoader:{type:Boolean,default:!1}},data(){return{selectedTickets:this.tickets,columns:["name","managed_by","used_by","contract","action"],options:{},apiEndPoint:this.apiUrl,totalCount:""}},beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},headings:{name:this.lang("name"),managed_by:this.lang("managed_by"),used_by:this.lang("used_by"),contract:this.lang("contract"),action:this.lang("action")},columnsClasses:{name:"associate-name",managed_by:"associate-manage",used_by:"associate-used",contract:"associate-contract",action:"associate-action"},texts:{filter:"",limit:""},templates:{name:function(t,s){return e.h(se,{to:"/service-desk/"+e.category+"/"+s.id+"/show"},s.name)},managed_by(t,s){var d,n;return((n=(d=s.managed_by)==null?void 0:d.full_name)==null?void 0:n.replace(/<[^>]+>/g,""))??"--"},used_by(t,s){var d,n;return((n=(d=s.used_by)==null?void 0:d.full_name)==null?void 0:n.replace(/<[^>]+>/g,""))??"--"},contract:function(t,s){return s.contract&&!Array.isArray(s.contract)?e.h(se,{to:"/service-desk/contracts/"+s.contract.id+"/show"},s.contract.name):"--"},action:(t,s)=>e.h(fA,{data:s})},sortable:["name"],filterable:["name"],pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"name","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return e.totalCount=t.data.total,{data:t.data.data.map(s=>(s.detach=!0,s.change_id=e.changeId,s.compName=e.componentTitle,s.is_updatable=e.actions.change_details_edit_permission,s)),count:e.totalCount}}}},methods:{handelLoader(e){this.$emit("loaderValue",e)}},watch:{totalCount(e){e===0&&(window.emitter.emit("updateChangeTables"),window.emitter.emit("updateChangeAssociates"))}}},bA={id:"change_associated_assets"};function yA(e,t,s,d,n,i){const h=u("data-table");return o(),l("div",bA,[m(h,{url:n.apiEndPoint,dataColumns:n.columns,option:n.options,scroll_to:"changes-associates",componentTitle:s.componentTitle,onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","componentTitle","onLoaderState","disableLoader"])])}const vA=C(gA,[["render",yA]]);const wA={name:"change-activity",description:"Changes activity page",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},data(){return{loading:!0,apiUrl:"",activity_log:[],perPage:"10",total:0,maxSize:5,pagination:1,paramsObj:{},filtering:!1,sort_key:"desc",changeId:"",refreshActivity:!1}},created(){window.emitter.on("updateChangeActivity",()=>this.refreshActivity=!0)},beforeMount(){this.changeId=W(window.location.pathname),this.apiUrl="/service-desk/api/change-log/"+this.changeId,this.paramsObj.page=this.pagination,this.getValues(this.paramsObj)},watch:{pagination(e,t){this.filtering=!0;var s=document.getElementById("activity_log_div");return s.scrollIntoView({behavior:"smooth"}),this.paramsObj.page=e,this.getValues(this.paramsObj),e},loading(e){this.$emit("loaderValue",e)},filtering(e){this.$emit("loaderValue",e)},refreshActivity(e,t){e===!0&&this.getUpdateActivity(),this.refreshActivity=!1}},computed:{PerPage:function(){return this.perPage?parseInt(this.perPage):10},Records:function(){return this.total?parseInt(this.total):0}},methods:{getUpdateActivity(){this.pagination=1,this.sort_key="desc",this.perPage=10,this.total=0,this.paramsObj.page=1,this.paramsObj.limit=10,this.paramsObj["sort-order"]="desc",this.getValues(this.paramsObj)},commonFilter(){this.filtering=!0,this.pagination=1,this.paramsObj.page=1,this.getValues(this.paramsObj)},logLimit(e){this.paramsObj.limit=e,this.commonFilter()},orderBy(e){this.sort_key=e,this.paramsObj["sort-order"]=e,this.commonFilter()},getValues(e){window.emitter.emit("chang-activity-params",e),S.get(this.apiUrl,{params:e}).then(t=>{this.loading=!1,this.filtering=!1,this.activity_log=t.data.data.change_activity_logs.data,this.activity_log.forEach(function(s,d){s.name="<div>"+s.name+"</div>"}),this.total=t.data.data.change_activity_logs.total,this.perPage=t.data.data.change_activity_logs.per_page}).catch(t=>{this.loading=!1,this.filtering=!1})},checkDate(e){if(e==0)return!0;var t=this.formattedDate(this.activity_log[e-1].created_at),s=this.formattedDate(this.activity_log[e].created_at);if(t!=s)return!0},showThreadEnd(e){return e===this.activity_log.length-1}},components:{"activity-parser":xe}},Ae=e=>(K("data-v-73edee2d"),e=e(),z(),e),kA={class:"row",id:"activity_log_div"},CA={class:"col-sm-12 mb-2"},DA={key:0,id:"select_limit"},SA=Ae(()=>a("option",{value:"10"},"10",-1)),FA=Ae(()=>a("option",{value:"25"},"25",-1)),MA=Ae(()=>a("option",{value:"50"},"50",-1)),IA=Ae(()=>a("option",{value:"100"},"100",-1)),AA=[SA,FA,MA,IA],PA={key:1,id:"choose_order"},TA={id:"sort_btn",type:"button","data-toggle":"dropdown",class:"btn btn-default dropdown-toggle"},VA={class:"dropdown-menu",style:{"z-index":"9999"}},LA=Ae(()=>a("i",{class:"fas fa-sort-amount-up"},null,-1)),UA=Ae(()=>a("i",{class:"fas fa-sort-amount-down"},null,-1)),$A={key:2,id:"page_div"},NA={class:"col-md-12"},EA={key:0,class:"timeline"},qA={key:0,class:"time-label"},OA={class:"bg-default border"},jA=Ae(()=>a("i",{class:"far fa-dot-circle"},null,-1)),RA={class:"timeline-item"},xA={class:"time"},BA=Ae(()=>a("i",{class:"far fa-clock"},null,-1)),KA={key:0,class:"timeline-header"},zA={class:"timeline-body break"},HA={key:1},YA=Ae(()=>a("i",{class:"far fa-clock bg-gray"},null,-1)),WA=[YA],JA={key:1,class:"float-right",id:"page_div"},GA={key:0,class:"col-sm-12"},ZA={class:"text-center"};function QA(e,t,s,d,n,i){const h=u("uib-pagination"),_=u("faveo-image-element"),f=u("router-link"),p=u("activity-parser");return o(),l("div",kA,[a("div",CA,[!n.loading&&n.activity_log.length>0?(o(),l("div",DA,[w(a("select",{class:"form-control cursor-pointer","onUpdate:modelValue":t[0]||(t[0]=b=>n.perPage=b),onChange:t[1]||(t[1]=b=>i.logLimit(n.perPage))},AA,544),[[qe,n.perPage]])])):c("",!0),!n.loading&&n.activity_log.length>0?(o(),l("div",PA,[a("button",TA,r(e.lang("created_time"))+" - "+r(e.lang(n.sort_key)),1),a("div",VA,[a("a",{href:"javascript:;",class:"dropdown-item",onClick:t[2]||(t[2]=b=>i.orderBy("asc"))},[LA,g(" "+r(e.lang("asc")),1)]),a("a",{href:"javascript:;",onClick:t[3]||(t[3]=b=>i.orderBy("desc")),class:"dropdown-item"},[UA,g(" "+r(e.lang("desc")),1)])])])):c("",!0),!n.loading&&n.total>10?(o(),l("div",$A,[m(h,{id:"page2",records:i.Records,modelValue:n.pagination,"onUpdate:modelValue":t[4]||(t[4]=b=>n.pagination=b),class:"pagination","boundary-links":!1,"per-page":i.PerPage,options:{chunk:n.maxSize,chunksNavigation:"scroll"}},null,8,["records","modelValue","per-page","options"])])):c("",!0)]),a("div",NA,[!n.loading&&n.activity_log.length>0?(o(),l("div",EA,[(o(!0),l(I,null,$(n.activity_log,(b,k)=>(o(),l(I,null,[i.checkDate(k)?(o(),l("div",qA,[a("span",OA,r(d.formattedDate(b.created_at)),1)])):c("",!0),a("div",null,[jA,a("div",RA,[a("span",xA,[BA,g(" "+r(d.formattedTime(b.created_at)),1)]),b.creator?(o(),l("h3",KA,[m(_,{id:"change_img","source-url":b.creator.profile_pic,classes:["img-circle","img-bordered-sm"],"alternative-text":"User Image","img-width":25,"img-height":25},null,8,["source-url"]),m(f,{to:"/user/"+b.creator.id},{default:y(()=>[g(" "+r(b.creator.full_name),1)]),_:2},1032,["to"])])):c("",!0),a("div",zA,[m(p,{data:b.name},null,8,["data"])])])]),i.showThreadEnd(k)?(o(),l("div",HA,WA)):c("",!0)],64))),256))])):c("",!0),!n.loading&&n.total>10?(o(),l("div",JA,[m(h,{id:"page2",records:i.Records,modelValue:n.pagination,"onUpdate:modelValue":t[5]||(t[5]=b=>n.pagination=b),class:"pagination","boundary-links":!1,"per-page":i.PerPage,options:{chunk:n.maxSize,chunksNavigation:"scroll"}},null,8,["records","modelValue","per-page","options"])])):c("",!0)]),!n.filtering&&!n.loading&&n.activity_log.length===0?(o(),l("div",GA,[a("h6",ZA,r(e.lang("no_data_found")),1)])):c("",!0)])}const XA=C(wA,[["render",QA],["__scopeId","data-v-73edee2d"]]),e6={name:"change-updates-delte-modal",description:"Change Updates Delete Modal component",props:{showModal:{type:Boolean,default:!1},changeId:{type:[String,Number],default:""},onClose:{type:Function},identifier:{type:String,default:""}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1}},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,S.delete("/service-desk/api/delete/general-popup/"+this.changeId+"/sd_changes/"+this.identifier).then(e=>{U(e,"change-view"),window.emitter.emit("updateChangeDetails"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(e=>{this.loading=!1,this.isDisabled=!0,A(e,"change-view"),this.onClose()})}}},t6={class:"modal-title"},s6={key:0},a6={key:1,class:"row"},n6=["disabled"],o6=a("i",{class:"fas fa-sync","aria-hidden":"true"},null,-1);function i6(e,t,s,d,n,i){const h=u("reuse-loader"),_=u("modal");return s.showModal?(o(),v(_,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{title:y(()=>[a("h4",t6,r(e.lang("delete")),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",s6,[a("span",null,r(e.lang("are_you_sure")),1)])),n.loading?(o(),l("div",a6,[m(h,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=f=>i.onSubmit()),class:"btn btn-danger",disabled:n.isDisabled},[o6,g(" "+r(e.lang("delete")),1)],8,n6)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const l6=C(e6,[["render",i6]]);const r6={name:"change-updates",description:"Changes updates component",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime)}},props:{changeId:{type:[String,Number],default:""},actions:{type:[Object,String],default:()=>{}}},data(){return{changeUpdates:"",loading:!1,showChangeUpdate:!1,showUpdateDelete:!1,identifier:"",refreshPlanning:!1}},beforeMount(){this.getDetails()},created(){window.emitter.on("updateChangeDetails",()=>this.refreshPlanning=!0)},methods:{getDetails(){this.loading=!0,S.get("/service-desk/api/change-planning/"+this.changeId).then(e=>{this.loading=!1,this.changeUpdates=e.data.data.planning_popups,this.changeUpdates.length===0&&window.emitter.emit("updateChangeTables")}).catch(e=>{this.loading=!1})},getFont(e){return e==="reason"?"ambulance":e==="impact"?"anchor":e==="rollout-plan"?"battery-empty":"thumbs-up"},getIcon(e){if(e)return e.type==="pdf"?"fas fa-file-pdf":e.type==="xls"?"fas fa-file-excel":e.type==="txt"||e.type==="text"?"fas fa-file-code":e.type==="png"||e.type==="jpg"||e.type==="jpeg"||e.type==="gif"||e.type==="PNG"||e.type==="JPG"||e.type==="JPEG"||e.type==="GIF"?"fas fa-file-image":"fas fa-file-alt"},formatBytes(e,t){if(e==0)return"0 Bytes";var s=1024,d=t||2,n=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(s));return parseFloat((e/Math.pow(s,i)).toFixed(d))+" "+n[i]},downloadFile(e,t){window.open(this.basePath()+"/service-desk/download/"+e+"/"+t+"/attachment")},updateMethod(e){this.showChangeUpdate=!0,this.identifier=e},deleteMethod(e){this.showUpdateDelete=!0,this.identifier=e},onClose(){this.showChangeUpdate=!1,this.showUpdateDelete=!1,this.$store.dispatch("unsetValidationError"),window.emitter.emit("updateChangeAssociates")}},watch:{loading(e){this.$emit("loaderValue",e)},refreshPlanning(e,t){e===!0&&this.getDetails(),this.refreshPlanning=!1}},components:{"change-update-modal":aa,"change-update-delete-modal":l6}},it=e=>(K("data-v-06508539"),e=e(),z(),e),d6={class:"chnage-details-tab"},c6={key:0,class:"timeline"},u6={class:"time-label"},h6={class:"bg-gray"},m6={class:"change-key"},_6={class:"timeline-item"},p6={class:"time float-left"},f6=it(()=>a("i",{class:"far fa-clock"},null,-1)),g6={class:"timeline-header pb-37"},b6={class:"btn-right"},y6=["onClick","disabled"],v6=it(()=>a("i",{class:"fas fa-trash"},null,-1)),w6={class:"btn-right"},k6=["onClick","disabled"],C6=it(()=>a("i",{class:"fas fa-edit"},null,-1)),D6={class:"timeline-body break"},S6=["innerHTML"],F6={key:0,class:"timeline-footer planning_footer"},M6=["onClick"],I6=it(()=>a("i",{class:"fas fa-download"},null,-1)),A6=it(()=>a("div",null,[a("i",{class:"far fa-clock bg-gray"})],-1)),P6={key:1,class:"text-center"};function T6(e,t,s,d,n,i){const h=u("change-update-modal"),_=u("change-update-delete-modal"),f=N("tooltip");return o(),l("div",d6,[n.changeUpdates.length>0?(o(),l("div",c6,[(o(!0),l(I,null,$(n.changeUpdates,(p,b)=>(o(),l(I,null,[a("div",u6,[a("span",h6,r(e.lang(p.key)),1)]),a("div",m6,[a("i",{class:j("fas fa-"+i.getFont(p.key)+" bg-blue")},null,2),a("div",_6,[a("span",p6,[f6,g(" "+r(d.formattedTime(p.updated_at)),1)]),a("h3",g6,[w((o(),l("span",b6,[a("button",{class:"btn btn-default btn-xs ml-1",onClick:k=>i.deleteMethod(p.key),disabled:!s.actions.change_details_edit_permission},[v6,g(" "+r(e.lang("delete")),1)],8,y6)])),[[f,s.actions.change_details_edit_permission?"":e.trans("can_not_update_change")]]),w((o(),l("span",w6,[a("button",{class:"btn btn-default btn-xs",onClick:k=>i.updateMethod(p.key),disabled:!s.actions.change_details_edit_permission},[C6,g(" "+r(e.lang("edit")),1)],8,k6)])),[[f,s.actions.change_details_edit_permission?"":e.trans("can_not_update_change")]])]),a("div",D6,[a("span",{class:"text-muted",id:"log_desc",innerHTML:p.description},null,8,S6)]),p.attachment?(o(),l("div",F6,[a("span",null,[w((o(),l("span",null,[a("i",{class:j(i.getIcon(p.attachment))},null,2),g(" "+r(p.attachment.value)+" "+r("("+i.formatBytes(p.attachment.size)+")"),1)])),[[f,p.attachment.value]]),w((o(),l("a",{id:"download",onClick:k=>i.downloadFile(p.attachment.id,p.attachment.owner)},[g("  "),I6],8,M6)),[[f,e.lang("download")]])])])):c("",!0)])])],64))),256)),A6])):c("",!0),!n.loading&&n.changeUpdates.length===0?(o(),l("h6",P6,r(e.lang("no_data_found")),1)):c("",!0),m(q,{name:"modal"},{default:y(()=>[n.showChangeUpdate?(o(),v(h,{key:0,onClose:i.onClose,showModal:n.showChangeUpdate,identifier:n.identifier,changeId:s.changeId,alertCompName:"change-view"},null,8,["onClose","showModal","identifier","changeId"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showUpdateDelete?(o(),v(_,{key:0,onClose:i.onClose,showModal:n.showUpdateDelete,identifier:n.identifier,changeId:s.changeId,alertCompName:"change-view"},null,8,["onClose","showModal","identifier","changeId"])):c("",!0)]),_:1})])}const V6=C(r6,[["render",T6],["__scopeId","data-v-06508539"]]);const L6={name:"change-release",description:"Release description page",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},props:{release:{type:Array,default:()=>[]}},methods:{subString(e,t=15){return oe(e,t)}}},U6={class:"change-relase"},$6={key:0,class:"row"},N6={class:"col-md-12"},E6={class:"callout callout-info bg-info"},q6={class:"row"},O6={class:"col-md-4"},j6={class:"col-md-4"},R6={class:"col-md-4"},x6={key:1,class:"col-md-12"},B6={class:"row"},K6={class:"col-md-6 info-row d-flex"},z6={class:"col-md-6"},H6={class:"col-md-6"},Y6={href:"javascript:void(0)"},W6={class:"col-md-6 info-row d-flex"},J6={class:"col-md-6"},G6={class:"col-md-6"},Z6={href:"javascript:void(0)"},Q6={class:"col-md-6 info-row d-flex"},X6={class:"col-md-6"},e8={class:"col-md-6"},t8={href:"javascript:void(0)"},s8={class:"col-md-6 info-row d-flex"},a8={class:"col-md-6"},n8={class:"col-md-6"},o8={href:"javascript:;"},i8={class:"col-md-6 info-row d-flex"},l8={class:"col-md-6"},r8={class:"col-md-6"},d8={href:"javascript:void(0)"},c8={key:2},u8={class:"text-center"};function h8(e,t,s,d,n,i){const h=N("tooltip");return o(),l("div",U6,[s.release.length>0?(o(),l("div",$6,[a("div",N6,[a("div",E6,[a("div",q6,[a("div",O6,[a("b",null,r(e.lang("created_date"))+" : ",1),w((o(),l("span",null,[g(r(d.formattedTime(s.release[0].created_at)),1)])),[[h,d.formattedTime(s.release[0].created_at)]])]),a("div",j6,[a("b",null,r(e.lang("planed_start_date"))+" : ",1),w((o(),l("span",null,[g(r(s.release[0].planned_start_date&&s.release[0].planned_start_date!=="--"&&s.release[0].planned_start_date!=="0000-00-00 00:00:00"?d.formattedTime(s.release[0].planned_start_date):"--"),1)])),[[h,s.release[0].planned_start_date&&s.release[0].planned_start_date!=="--"&&s.release[0].planned_start_date!=="0000-00-00 00:00:00"?d.formattedTime(s.release[0].planned_start_date):"--"]])]),a("div",R6,[a("b",null,r(e.lang("planed_end_date"))+" : ",1),w((o(),l("span",null,[g(r(s.release[0].planned_end_date&&s.release[0].planned_end_date!=="--"&&s.release[0].planned_end_date!=="0000-00-00 00:00:00"?d.formattedTime(s.release[0].planned_end_date):"---"),1)])),[[h,s.release[0].planned_end_date&&s.release[0].planned_end_date!=="--"&&s.release[0].planned_end_date!=="0000-00-00 00:00:00"?d.formattedTime(s.release[0].planned_end_date):"---"]])])])])])])):c("",!0),s.release.length>0?(o(),l("div",x6,[a("div",B6,[a("div",K6,[a("div",z6,[a("label",null,r(e.lang("subject")),1)]),a("div",H6,[w((o(),l("a",Y6,[g(r(i.subString(s.release[0].subject)),1)])),[[h,s.release[0].subject]])])]),a("div",W6,[a("div",J6,[a("label",null,r(e.lang("status")),1)]),a("div",G6,[w((o(),l("a",Z6,[g(r(i.subString(s.release[0].status.name)),1)])),[[h,s.release[0].status.name]])])]),a("div",Q6,[a("div",X6,[a("label",null,r(e.lang("priority")),1)]),a("div",e8,[w((o(),l("a",t8,[g(r(i.subString(s.release[0].priority.name)),1)])),[[h,s.release[0].priority.name]])])]),a("div",s8,[a("div",a8,[a("label",null,r(e.lang("location")),1)]),a("div",n8,[w((o(),l("a",o8,[g(r(s.release[0].location?i.subString(s.release[0].location.name):"---"),1)])),[[h,s.release[0].location?s.release[0].location.name:"---"]])])]),a("div",i8,[a("div",l8,[a("label",null,r(e.lang("release_type")),1)]),a("div",r8,[w((o(),l("a",d8,[g(r(i.subString(s.release[0].release_type.name)),1)])),[[h,s.release[0].release_type.name]])])])])])):(o(),l("div",c8,[a("h6",u8,r(e.lang("no_data_found")),1)]))])}const m8=C(L6,[["render",h8],["__scopeId","data-v-f3670e52"]]);const _8={name:"change-cab",description:"Change cab details component",props:{changeId:{type:[Number,String],required:!0},actions:{type:Object,default:()=>{}}},data(){return{loading:!1,cabData:[],comment:"",showModal:!1,action:"",showAddRemoveModal:!1,add_approver:"",approver_comment:"",addRemoveLevelId:"",containerStyle:{width:"600px"},modalLoad:!1,addRemoveType:"",endPoint:"",removeCab:this.actions.remove_cab,showCab:!1}},beforeMount(){this.getDataFromServer()},created(){window.emitter.on("updateChangeCabs",this.getDataFromServer)},methods:{clearComment(){this.comment=""},closeAddModal(){this.showAddRemoveModal=!1,this.approver_comment="",this.$store.dispatch("unsetValidationError"),this.$store.dispatch("unsetAlert")},isAddRemoveValid(){const{errors:e,isValid:t}=Ba(this.$data);return t},onAddRemoveConfirm(){if(this.isAddRemoveValid()){this.endPoint=this.addRemoveType==="add"?"add-approver":"remove-approver",this.modalLoad=!0;let e={};e.action=this.addRemoveType,e.approver_id=this.addRemoveType==="add"?this.add_approver.id:this.add_approver,e.change_id=this.changeId,e.level_id=this.addRemoveLevelId,e.comment=this.approver_comment,S.post("/service-desk/api/cab/"+this.endPoint,e).then(t=>{this.modalLoad=!1,U(t,"change-view"),window.emitter.emit("refreshChangeStatus"),this.addRemoveType,this.getDataFromServer(),window.emitter.emit("updateChangeAssociates"),this.showAddRemoveModal=!1,this.addRemoveType="",this.addRemoveLevelId="",this.add_approver=""}).catch(t=>{this.modalLoad=!1,A(t,"add_remove_approver")})}},addRemoveApprover(e,t,s=""){this.addRemoveType=e,this.addRemoveLevelId=t,this.add_approver=s,this.showAddRemoveModal=!0},resumeReminder(e){this.loading=!0,S.get("/service-desk/api/resume-auto-reminder/"+e).then(t=>{this.getDataFromServer(),U(t,"change-view")}).catch(t=>{this.loading=!1,A(t,"change-view")})},stopReminder(e){this.loading=!0,S.get("/service-desk/api/stop-auto-reminder/"+e).then(t=>{this.getDataFromServer(),U(t,"change-view")}).catch(t=>{this.loading=!1,A(t,"change-view")})},sendReminder(e,t="",s=""){this.loading=!0;let d={};d.type=e,d.change_id=this.changeId,e==="level"&&(d.level_id=t),e==="approver"&&(d.id=s,d.level_id=t),S.post("/service-desk/api/send-reminder",d).then(n=>{this.getDataFromServer(),U(n,"change-view")}).catch(n=>{this.loading=!1,A(n,"change-view")})},closeModal(){this.clearComment(),this.showModal=!1,this.$store.dispatch("unsetValidationError")},subString(e,t=15){return oe(e,t)},getDataFromServer(){this.loading=!0,Promise.all([S.get("/service-desk/api/change-approval-status/"+this.changeId),S.get("/service-desk/api/change-action/"+this.changeId)]).then(([e,t])=>{this.cabData=e.data.data,this.showCab=!0,t.data&&t.data.data&&t.data.data.actions&&t.data.data.actions.remove_cab?this.removeCab=t.data.data.actions.remove_cab:this.removeCab=!1,this.loading=!1}).catch(e=>{this.loading=!1,A(e)})},isValid(){const{errors:e,isValid:t}=Ws(this.$data);return!!t},onChange(e,t){this[t]=e},onCabAction(e){this.showModal=!0,this.action=e},getIconStyle(e,t="icon"){switch(e){case"PENDING":return t=="icon"?"glyphicon glyphicon-time text-warning":"#eee";case"APPROVED":return t=="icon"?"glyphicon glyphicon-check text-success":"#cbe0d3";case"DENIED":return t=="icon"?"glyphicon glyphicon-exclamation-sign text-danger":"#f6ddd8";default:return null}},getOpacity(e){return e==1?1:.5},onCabActionConfirm(){this.action!=="remove"?this.isValid()&&(this.loading=!0,S.post("/service-desk/api/approval-action-without-hash/"+this.changeId,{action_type:this.action,comment:this.comment}).then(e=>{this.loading=!1,U(e,"change-view"),window.emitter.emit("updateChangeAssociates"),window.emitter.emit("refreshChangeStatus"),this.getDataFromServer(),setTimeout(()=>{this.initialActions()},2e3)}).catch(e=>{this.loading=!1,A(e,"change-view")})):(this.loading=!0,S.delete("/service-desk/api/remove-cab-approval/"+this.changeId).then(e=>{this.loading=!1,U(e,"change-view"),window.emitter.emit("updateChangeAssociates"),window.emitter.emit("refreshChangeStatus"),this.cabData.length===1?window.emitter.emit("updateChangeTables"):this.getDataFromServer(),setTimeout(()=>{this.initialActions()},2e3)}).catch(e=>{this.loading=!1,this.showModal=!1,A(e,"change-view"),this.removeCab=!1,S.get("/service-desk/api/change-approval-status/"+this.changeId).then(t=>{this.cabData=t.data.data})}))},initialActions(){this.showModal=!1,this.action="",this.comment=""}},computed:{modalTitle(){return this.action=="approve"?"approve_cab":this.action=="remove"?"remove_cab":"deny_cab"},modalQuestion(){let e=`${ae("are_you_sure_you_want_to")} ${this.action}?`;return this.action=="remove"?e:`${e} ${ae("mention_a_reason")}`}},watch:{loading(e){this.$emit("loaderValue",e)}},components:{"dynamic-select":G,"text-field":le}},me=e=>(K("data-v-70594a3c"),e=e(),z(),e),p8={class:"change-cab-details"},f8={key:0},g8=["id"],b8={class:"card-title cab_title"},y8={class:"card-tools cab-tools"},v8=["onClick"],w8=me(()=>a("i",{class:"fas fa-play"},null,-1)),k8=[w8],C8=["onClick"],D8=me(()=>a("i",{class:"fas fa-stop"},null,-1)),S8=[D8],F8={class:"levels"},M8=["id"],I8={class:"card-title cab_title"},A8={class:"card-tools cab-tools"},P8=["onClick"],T8=me(()=>a("i",{class:"fas fa-paper-plane"},null,-1)),V8=[T8],L8={key:1,class:"btn btn-tool not-cursor"},U8=me(()=>a("i",{class:"fas fa-paper-plane"},null,-1)),$8=[U8],N8=["onClick"],E8=me(()=>a("i",{class:"glyphicon glyphicon-plus"},null,-1)),q8=[E8],O8={key:3,class:"btn btn-tool not-cursor"},j8=me(()=>a("i",{class:"glyphicon glyphicon-plus"},null,-1)),R8=[j8],x8={class:"card-body"},B8=["id"],K8={class:"list-group list-group-unbordered"},z8={id:"highlight",class:"list-group-item border-0 p-2p pl-2 pr-2 rounded"},H8={class:"approver-name"},Y8={class:"float-right"},W8=["onClick"],J8=me(()=>a("i",{class:"fas fa-paper-plane"},null,-1)),G8=[J8],Z8={key:1,class:"text-dark mr-3 not-cursor"},Q8=me(()=>a("i",{class:"fas fa-paper-plane"},null,-1)),X8=[Q8],e3=["onClick"],t3=me(()=>a("i",{class:"fas fa-times"},null,-1)),s3=[t3],a3={key:3,class:"text-danger mr-3 not-cursor"},n3=me(()=>a("i",{class:"fas fa-times"},null,-1)),o3=[n3],i3=["id"],l3={class:"list-group list-group-unbordered"},r3={id:"highlight",class:"list-group-item border-0 p-2p pl-2 pr-2 rounded"},d3={class:"approver-name"},c3={class:"float-right"},u3=["onClick"],h3=me(()=>a("i",{class:"fas fa-paper-plane"},null,-1)),m3=[h3],_3={key:1,class:"text-dark mr-3 not-cursor"},p3=me(()=>a("i",{class:"fas fa-paper-plane"},null,-1)),f3=[p3],g3=["onClick"],b3=me(()=>a("i",{class:"fas fa-times"},null,-1)),y3=[b3],v3={key:3,class:"text-danger mr-3 not-cursor"},w3=me(()=>a("i",{class:"fas fa-times"},null,-1)),k3=[w3],C3={key:1},D3=me(()=>a("span",{class:"glyphicon glyphicon-ok"},null,-1)),S3=me(()=>a("span",{class:"glyphicon glyphicon-remove"},null,-1)),F3=me(()=>a("span",{class:"glyphicon glyphicon-trash"},null,-1)),M3={class:"modal-title"},I3={key:1,class:"row"},A3=me(()=>a("i",{class:"fas fa-check","aria-hidden":"true"},null,-1)),P3={class:"modal-title"},T3={key:1},V3={class:"row"},L3=me(()=>a("i",{class:"glyphicon glyphicon-ok","aria-hidden":"true"},null,-1)),U3={key:1,class:"text-center"};function $3(e,t,s,d,n,i){const h=u("alert"),_=u("reuse-loader"),f=u("dynamic-select"),p=u("text-field"),b=u("modal"),k=N("tooltip"),D=N("focus-first-input");return o(),l("div",p8,[n.cabData.length>0?(o(),l(I,{key:0},[n.showCab?(o(),l("div",f8,[(o(!0),l(I,null,$(n.cabData,(P,E)=>(o(),l("div",{class:"card",id:"cab-element-"+E,style:Ue({"border-color":i.getIconStyle(P.status,"color")})},[a("div",{class:"card-header cab_header",style:Ue({"background-color":i.getIconStyle(P.status,"color")})},[w((o(),l("h3",b8,[g(r(P.name),1)])),[[k,P.name]]),a("div",y8,[P.status=="PENDING"?(o(),l(I,{key:0},[P.send_auto_reminders?c("",!0):w((o(),l("button",{key:0,class:"btn btn-tool",onClick:M=>i.resumeReminder(P.id)},k8,8,v8)),[[k,e.trans("resume_reminder")]]),P.send_auto_reminders?w((o(),l("button",{key:1,class:"btn btn-tool",onClick:M=>i.stopReminder(P.id)},S8,8,C8)),[[k,e.trans("stop_reminder")]]):c("",!0)],64)):c("",!0),w(a("button",{class:j(["btn btn-tool",[i.getIconStyle(P.status)]])},null,2),[[k,P.status]])])],4),a("div",F8,[(o(!0),l(I,null,$(P.approval_levels,(M,F)=>(o(),l("div",{class:"card-body cab-level",id:"cab-level-"+F,style:Ue({opacity:i.getOpacity(M.is_active)})},[a("div",{class:"card margin-0 height-100-percent",style:Ue({"border-color":i.getIconStyle(M.status,"color")})},[a("div",{class:"card-header cab_header",style:Ue({"background-color":i.getIconStyle(M.status,"color")})},[w((o(),l("h3",I8,[g(r(i.subString(M.name,25)),1)])),[[k,M.name]]),a("div",A8,[M.status=="PENDING"?(o(),l(I,{key:0},[M.is_active?w((o(),l("button",{key:0,class:"btn btn-tool",onClick:T=>i.sendReminder("level",M.id)},V8,8,P8)),[[k,e.trans("send_reminder")]]):w((o(),l("button",L8,$8)),[[k,e.trans("cant_send_reminder_level")]]),M.is_active?w((o(),l("button",{key:2,class:"btn btn-tool",onClick:T=>i.addRemoveApprover("add",M.id)},q8,8,N8)),[[k,e.trans("add_approver")]]):c("",!0),M.is_active?c("",!0):w((o(),l("button",O8,R8)),[[k,e.trans("you_cant_add_approver")]])],64)):c("",!0),w(a("button",{class:j(["btn btn-tool",[i.getIconStyle(M.status)]])},null,2),[[k,M.status]])])],4),a("div",x8,[(o(!0),l(I,null,$(M.approve_users,(T,O)=>(o(),l("div",{id:"level-user-"+O},[a("ul",K8,[a("li",z8,[w((o(),l("span",H8,[g(r(i.subString(T.name,25)),1)])),[[k,T.name]]),a("span",Y8,[T.status=="PENDING"?(o(),l(I,{key:0},[M.is_active?w((o(),l("a",{key:0,href:"javascript:;",class:"text-dark mr-3",onClick:Z=>i.sendReminder("approver",M.id,T.id)},G8,8,W8)),[[k,e.trans("send_reminder")]]):w((o(),l("a",Z8,X8)),[[k,e.trans("cant_send_reminder_approver")]]),M.is_active?w((o(),l("a",{key:2,class:"text-danger mr-3",href:"javascript:;",onClick:Z=>i.addRemoveApprover("remove",M.id,T.id)},s3,8,e3)),[[k,e.trans("remove_approver")]]):c("",!0),M.is_active?c("",!0):w((o(),l("a",a3,o3)),[[k,e.trans("you_cant_remove_approver")]])],64)):c("",!0),w(a("span",{class:j(["approver-status",i.getIconStyle(T.status)])},null,2),[[k,T.status]])])])])],8,B8))),256)),(o(!0),l(I,null,$(M.approve_user_types,(T,O)=>(o(),l("div",{id:"level-user-type-"+O},[a("ul",l3,[a("li",r3,[w((o(),l("span",d3,[g(r(i.subString(e.lang(T.name),25)),1)])),[[k,e.lang(T.name)]]),a("span",c3,[T.status=="PENDING"?(o(),l(I,{key:0},[M.is_active?w((o(),l("a",{key:0,href:"javascript:;",class:"text-dark mr-3",onClick:Z=>i.sendReminder("approver",M.id,T.id)},m3,8,u3)),[[k,e.trans("send_reminder")]]):w((o(),l("a",_3,f3)),[[k,e.trans("cant_send_reminder_approver_type")]]),M.is_active?w((o(),l("a",{key:2,class:"text-danger mr-3",href:"javascript:;",onClick:Z=>i.addRemoveApprover("remove",M.id,T.id)},y3,8,g3)),[[k,e.trans("remove_approver_type")]]):c("",!0),M.is_active?c("",!0):w((o(),l("a",v3,k3)),[[k,e.trans("you_cant_remove_approver_type")]])],64)):c("",!0),w(a("span",{class:j(["approver-status",i.getIconStyle(T.status)])},null,2),[[k,T.status]])])])])],8,i3))),256))])],4)],12,M8))),256))])],12,g8))),256))])):c("",!0),n.showCab?(o(),l("div",C3,[s.actions.allowed_cab_action?(o(),l(I,{key:0},[a("button",{class:"btn btn-success",id:"approve-button",onClick:t[0]||(t[0]=P=>i.onCabAction("approve")),name:"button"},[D3,g(" "+r(e.lang("approve")),1)]),a("button",{class:"btn btn-danger",id:"deny-button",onClick:t[1]||(t[1]=P=>i.onCabAction("deny")),name:"button"},[S3,g(" "+r(e.lang("deny")),1)])],64)):c("",!0),n.removeCab?(o(),l("button",{key:1,class:"btn btn-danger",id:"remove-button",onClick:t[2]||(t[2]=P=>i.onCabAction("remove")),name:"button"},[F3,g(" "+r(e.lang("remove")),1)])):c("",!0)])):c("",!0),n.showAddRemoveModal?(o(),v(b,{key:2,showModal:!0,onClose:i.closeAddModal,containerStyle:n.containerStyle},{title:y(()=>[a("h4",M3,r(n.addRemoveType==="add"?e.lang("add_approver"):e.lang("remove_approver")),1)]),alert:y(()=>[m(h,{componentName:"add_remove_approver"})]),fields:y(()=>[n.modalLoad?(o(),v(_,{key:0})):(o(),l("div",I3,[n.addRemoveType==="add"?(o(),v(f,{key:0,label:e.lang("approver"),value:n.add_approver,onChange:i.onChange,name:"add_approver",apiEndpoint:"/api/dependency/users?meta=true",multiple:!1,classname:"col-md-12",strlength:"50",required:!0},null,8,["label","value","onChange"])):c("",!0),m(p,{id:"textarea",label:e.lang("reason"),value:n.approver_comment,autofocus:n.addRemoveType!="add",type:"textarea",name:"approver_comment",onChange:i.onChange,classname:"col-sm-12",required:!0},null,8,["label","value","autofocus","onChange"])]))]),controls:y(()=>[a("button",{type:"button",onClick:t[3]||(t[3]=P=>i.onAddRemoveConfirm()),class:"btn btn-primary"},[A3,g(" "+r(e.lang("proceed")),1)])]),_:1},8,["onClose","containerStyle"])):c("",!0),n.showModal?(o(),v(b,{key:3,showModal:!0,onClose:i.closeModal},{title:y(()=>[a("h4",P3,r(e.lang(i.modalTitle)),1)]),alert:y(()=>[m(h)]),fields:y(()=>[n.loading?(o(),v(_,{key:0})):c("",!0),n.loading?c("",!0):(o(),l("span",T3,r(e.lang(i.modalQuestion)),1)),w((o(),l("div",V3,[!n.loading&&n.action!=="remove"?(o(),v(p,{key:0,id:"textarea",label:e.lang("comment"),value:n.comment,type:"textarea",name:"comment",onChange:i.onChange,classname:"col-sm-12",required:n.action!=="approve"},null,8,["label","value","onChange","required"])):c("",!0)])),[[D]])]),controls:y(()=>[a("button",{id:"cab-action-confirm",type:"button",onClick:t[4]||(t[4]=P=>i.onCabActionConfirm()),class:"btn btn-primary"},[L3,g(" "+r(e.lang("confirm")),1)])]),_:1},8,["onClose"])):c("",!0)],64)):c("",!0),!n.loading&&n.cabData.length===0?(o(),l("h6",U3,r(e.lang("no_data_found")),1)):c("",!0)])}const N3=C(_8,[["render",$3],["__scopeId","data-v-70594a3c"]]),E3={name:"detach-ticket-modal",description:"Detach Ticket Modal component",props:{showModal:{type:Boolean,default:!1},changeId:{type:[String,Number],default:""},ticketId:{type:[String,Number],default:""},type:{type:String,default:""},onClose:{type:Function},componentTitle:{type:String,default:""}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1}},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,S.delete("/service-desk/api/detach-ticket/change",{params:{ticket_id:this.ticketId,change_id:this.changeId,type:this.type}}).then(e=>{U(e,"change-view"),window.emitter.emit("updateChangeAssociates"),window.emitter.emit(this.componentTitle+"refreshData"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(e=>{this.loading=!1,this.isDisabled=!1,A(e,"detach-ticket")})}}},q3={class:"modal-title"},O3={key:0},j3={key:1,class:"row"},R3=["disabled"],x3=a("i",{class:"fas fa-unlink"},null,-1);function B3(e,t,s,d,n,i){const h=u("alert"),_=u("reuse-loader"),f=u("modal");return s.showModal?(o(),v(f,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{alert:y(()=>[m(h,{componentName:"detach-ticket"})]),title:y(()=>[a("h4",q3,r(e.lang("detach")),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",O3,[a("span",null,r(e.lang("are_you_sure")),1)])),n.loading?(o(),l("div",j3,[m(_,{"animation-duration":4e3,color:"#1d78ff",size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=p=>i.onSubmit()),class:"btn btn-danger",disabled:n.isDisabled},[x3,g(" "+r(e.lang("detach")),1)],8,R3)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const K3=C(E3,[["render",B3]]);const z3={name:"changes-tickets-table",description:"Changes tickets table page",props:{changeId:{type:[String,Number],default:""},componentTitle:{type:String,default:"ChangeTickets"},actions:{type:[Object,String],default:()=>{}},disableLoader:{type:Boolean,default:!1}},data(){return{selectedTickets:this.tickets,columns:["ticket_number","subject","assigned","type","action"],options:{},apiEndPoint:"/service-desk/api/attached-ticket/change?change_id="+this.changeId,ticketId:"",ticket_type:"",showModal:!1,totalCount:""}},beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},headings:{ticket_number:this.lang("ticket_number"),subject:this.lang("subject"),assigned:this.lang("assigned_to"),type:this.lang("type"),action:this.lang("action")},columnsClasses:{ticket_number:"associate-number",subject:"associate-subject",assigned:"associate-assigned",type:"associate-type",action:"associate-action"},texts:{filter:"",limit:""},templates:{subject:function(t,s){return e.h(se,{to:"/thread/"+s.id},s.subject)},ticket_number:function(t,s){return e.h(se,{to:"/thread/"+s.id},"#"+s.ticket_number)},assigned(t,s){return s.assigned?s.assigned.full_name:"--"},action(t,s){let d=e.h("i",{class:"fas fa-unlink"});return e.h("button",{class:"btn btn-primary",title:e.actions.change_details_edit_permission?this.trans("detach"):"Can Not Update Change Details Until Cab is Approved",disabled:!e.actions.change_details_edit_permission,onClick(){e.onDetach(s.id,s.type)}},[d])}},sortable:["ticket_number"],filterable:["ticket_number"],pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc",search_query:t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return e.totalCount=t.data.total,{data:t.data.tickets,count:e.totalCount}}}},methods:{onDetach(e,t){this.ticketId=e,this.ticket_type=t,this.showModal=!0},onClose(){this.showModal=!1},handelLoader(e){this.$emit("loaderValue",e)}},watch:{totalCount(e){e===0&&(window.emitter.emit("updateChangeTables"),window.emitter.emit("updateChangeAssociates"))}},components:{"ticket-detach-modal":K3}},H3={id:"change_associated_tickets"};function Y3(e,t,s,d,n,i){const h=u("data-table"),_=u("ticket-detach-modal");return o(),l("div",H3,[m(h,{url:n.apiEndPoint,dataColumns:n.columns,option:n.options,scroll_to:"changes-associates",componentTitle:s.componentTitle,onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","componentTitle","onLoaderState","disableLoader"]),m(q,{name:"modal"},{default:y(()=>[n.showModal?(o(),v(_,{key:0,onClose:i.onClose,showModal:n.showModal,ticketId:n.ticketId,changeId:s.changeId,type:n.ticket_type,componentTitle:s.componentTitle},null,8,["onClose","showModal","ticketId","changeId","type","componentTitle"])):c("",!0)]),_:1})])}const W3=C(z3,[["render",Y3]]);const J3={name:"change-associates",description:"Change associates page",props:{change:{type:Object,default:()=>{}},changeId:{type:[String,Number],default:""}},data(){return{actions:"",tabs:[],category:"discussions",changeCommentThreadKey:Math.floor(Math.random()*1e6),loading:!0,showAssociates:!1,dynamicKeys:{discussions:1,activity:1,details:1,assets:1,releases:1,cabs:1,tickets:1,tasks:1}}},created(){window.emitter.on("updateChangeAssociates",this.updateAssociates),window.emitter.on("showChangeTaskAssociates",()=>this.category="tasks"),window.emitter.on("reloadChangeComments",()=>this.changeCommentThreadKey++),window.emitter.on("updateChangeTables",()=>this.associates("activity")),this.$store.dispatch("setChangeAssociateCategory",this.category)},beforeMount(){this.getActions()},methods:{getActions(e=""){this.loading=!0,S.get("/service-desk/api/change-action/"+this.changeId+"?time="+e).then(t=>{this.actions=t.data.data.actions,this.$emit("handelAction",this.actions),this.tabs=[{id:"discussions",title:"sd-plugin-discussions",show:!0},{id:"activity",title:"activity_log",show:!0},{id:"details",title:"planning",show:this.actions.planning},{id:"assets",title:"associated_assets",show:this.actions.associated_assets},{id:"releases",title:"associated_releases",show:this.actions.associated_releases},{id:"cabs",title:"associated_cabs",show:this.actions.associated_cabs},{id:"tickets",title:"associated_tickets",show:this.actions.associated_tickets},{id:"tasks",title:"sd_change_associated_tasks",show:this.actions.associated_tasks}],this.showAssociates=!0,this.loading=!1}).catch(t=>{this.loading=!1,this.actions=""})},updateAssociates(){setTimeout(()=>{this.getActions(Date.now())},500)},associates(e){this.category!==e&&(e!=="releases"&&(this.loading=!0),window.emitter.emit("chang-activity-params",e),this.category=e),this.updateKey(e)},handelLoader(e){this.loading=e},updateKey(e){e!=="releases"&&(this.loading=!0),this.dynamicKeys={...this.dynamicKeys,[e]:this.dynamicKeys[e]+1}}},watch:{category(e,t){e!==t&&this.$store.dispatch("setChangeAssociateCategory",e)}},components:{"change-associates-table":vA,"change-activity":XA,"change-details-tab":V6,"change-release":m8,"change-cab":N3,"change-tickets":W3,ChangeTasks:VI,ChangeDiscussion:iA}},G3=e=>(K("data-v-65ace047"),e=e(),z(),e),Z3={key:0,id:"changes-associates",class:"card card-light card-tabs"},Q3={class:"card-header p-0 pt-1"},X3={class:"nav nav-tabs"},e4={key:0,class:"nav-item"},t4=["onClick"],s4={class:"nav-item ml-auto mt-04"},a4={key:0,type:"button",class:"btn btn-tool rotating","data-card-widget":"refresh"},n4=G3(()=>a("i",{class:"fas fa-refresh"},null,-1)),o4=[n4],i4={class:"card-body"},l4={class:"tab-content"},r4={class:"active tab-pane",id:"activity"};function d4(e,t,s,d,n,i){const h=u("alert"),_=u("change-discussion"),f=u("change-activity"),p=u("change-release"),b=u("change-cab"),k=u("change-associates-table"),D=u("change-details-tab"),P=u("change-tickets"),E=u("change-tasks");return n.showAssociates?(o(),l("div",Z3,[m(h,{componentName:"changesAssociates"}),a("div",Q3,[a("ul",X3,[(o(!0),l(I,null,$(n.tabs,M=>(o(),l(I,null,[M.show?(o(),l("li",e4,[a("a",{id:"change_tab",class:j(["nav-link",{active:n.category===M.id}]),"data-toggle":"pill",onClick:F=>i.associates(M.id)},r(e.trans(M.title)),11,t4)])):c("",!0)],64))),256)),a("li",s4,[n.loading?(o(),l("a",a4,o4)):c("",!0)])])]),a("div",i4,[a("div",l4,[a("div",r4,[a("div",null,[n.category==="discussions"?(o(),v(_,{changeId:s.changeId,key:n.changeCommentThreadKey,onLoaderValue:i.handelLoader},null,8,["changeId","onLoaderValue"])):c("",!0),n.category==="activity"?(o(),v(f,{changeId:s.changeId,onLoaderValue:i.handelLoader,key:"change_activity"+n.dynamicKeys.activity},null,8,["changeId","onLoaderValue"])):c("",!0),n.category==="releases"?(o(),v(p,{release:s.change.attach_releases,key:"change_releases"+n.dynamicKeys.releases},null,8,["release"])):c("",!0),n.category==="cabs"?(o(),v(b,{changeId:s.changeId,actions:n.actions,onLoaderValue:i.handelLoader,key:"change_cabs"+n.dynamicKeys.cabs},null,8,["changeId","actions","onLoaderValue"])):c("",!0),n.category==="assets"?(o(),v(k,{componentTitle:"changeAssets",apiUrl:"/service-desk/api/asset-list?change_ids="+s.changeId,changeId:s.changeId,category:n.category,actions:n.actions,onLoaderValue:i.handelLoader,disableLoader:"true",key:"change_asset"+n.dynamicKeys.assets},null,8,["apiUrl","changeId","category","actions","onLoaderValue"])):c("",!0),n.category==="details"?(o(),v(D,{changeId:s.changeId,actions:n.actions,onLoaderValue:i.handelLoader,key:"change_details"+n.dynamicKeys.details},null,8,["changeId","actions","onLoaderValue"])):c("",!0),n.category==="tickets"?(o(),v(P,{changeId:s.changeId,componentTitle:"ChangeTickets",actions:n.actions,onLoaderValue:i.handelLoader,disableLoader:"true",key:"change_tickets"+n.dynamicKeys.tickets},null,8,["changeId","actions","onLoaderValue"])):c("",!0),n.category==="tasks"?(o(),v(E,{changeId:s.changeId,componentTitle:"changeTask",actions:n.actions,onLoaderValue:i.handelLoader,disableLoader:"true",key:"change_task"+n.dynamicKeys.tasks},null,8,["changeId","actions","onLoaderValue"])):c("",!0)])])])])])):c("",!0)}const c4=C(J3,[["render",d4],["__scopeId","data-v-65ace047"]]),u4={name:"change-view",description:"Change view page",data(){return{change:"",change_id:"",loading:!0,actions:"",counter:0,refreshData:!1,updateViewStatus:!1}},beforeMount(){this.getValues()},watch:{refreshData(e,t){e===!0&&this.getValues(),this.refreshData=!1},updateViewStatus(e,t){e===!0&&this.updateView(),this.updateViewStatus=!1}},created(){window.emitter.on("updateChangeView",()=>this.updateViewStatus=!0),window.emitter.on("refreshChangeStatus",()=>this.refreshData=!0)},methods:{updateView(){this.loading=!0,setTimeout(()=>{this.getValues()},500)},getValues(e,t=""){const s=window.location.pathname;this.change_id=W(s),S.get("/service-desk/api/change/"+this.change_id+"?time="+t).then(d=>{this.change=d.data.data.change,this.loading=!1}).catch(d=>{this.loading=!1,A(d,"change-view")})},updateActions(e){this.actions=e}},components:{"change-details":vI,"change-associates":c4}},h4={class:"col-sm-12"},m4={key:0};function _4(e,t,s,d,n,i){const h=u("alert"),_=u("reuse-loader"),f=u("change-details"),p=u("change-associates");return o(),l("div",h4,[m(h,{componentName:"change-view"}),n.loading?(o(),l("div",m4,[m(_,{"animation-duration":4e3,size:60})])):c("",!0),n.loading?c("",!0):(o(),l(I,{key:1},[m(f,{change:n.change,updateData:n.refreshData,actions:n.actions},null,8,["change","updateData","actions"]),m(p,{changeId:n.change_id,change:n.change,onHandelAction:i.updateActions},null,8,["changeId","change","onHandelAction"])],64))])}const p4=C(u4,[["render",_4]]);const f4={name:"contracts-list",description:"Contracts lists table component",props:{filterIndex:{type:Boolean,default:!1}},setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},data:()=>({columns:[],options:{},hasDataPopulated:!1,visibleColumns:{},staticColumns:["actions"],apiUrl:"/service-desk/api/contract-list",reportType:"contracts",filterOptions:[{section:[{name:"contract_ids",url:"/service-desk/api/dependency/contracts",label:"contracts"},{name:"contract_type_ids",url:"/service-desk/api/dependency/contract_types",label:"contract_type"},{name:"approver_ids",url:"/api/dependency/agents?meta=true",label:"approver"}]},{section:[{name:"vendor_ids",url:"/service-desk/api/dependency/vendors",label:"vendors"},{name:"license_type_ids",url:"/service-desk/api/dependency/license_types",label:"license_type"},{name:"contract_statuses",url:"/service-desk/api/status/list?module=5",label:"status"}]},{section:[{name:"renewal_status_ids",url:"/service-desk/api/dependency/contract_renewal_statuses",label:"renewal_status"},{name:"owner_ids",url:"/api/dependency/agents",label:"owner"},{name:"asset_ids",url:"/service-desk/api/dependency/assets",label:"assets"}]},{section:[{name:"notify_agent_ids",url:"/api/dependency/agents?meta=true",label:"notify_agents"},{name:"cost",label:"cost",type:"number"},{name:"notify_in_days",label:"notify_before",type:"number"}]},{section:[{name:"contract_start_date",type:"date",label:["contract_start_date","contract_start_date_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0},{name:"contract_end_date",type:"date",label:["contract_end_date","contract_end_date_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0},{name:"created_at",type:"date",label:["created_at","created_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0}]},{section:[{name:"updated_at",type:"date",label:["updated_at","updated_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0}]},{section:[]}],isShowFilter:!1,showIcon:!1,appliedFilters:{},columnData:null,contractData:null,exportData:"",loading:!0,showPagination:!0,newReportId:"",dataCount:"",requiredPayload:[],customFields:[],contractFilterId:""}),created(){window.emitter.on("onColumnUpdate",this.onColumnUpdate),window.emitter.on("updateFilter",this.updateFilter),window.emitter.on("dataCount",this.handleDataCount),window.emitter.on("responseData",this.handleData)},beforeMount(){this.contractFilterId=W(window.location.pathname);const e=Ye();e&&e.hasOwnProperty("filter-by-url")?We("/service-desk/api/filter-dependencies",e,{},d=>{d&&this.applyFilter(d)},d=>{A(d)}):this.apiUrl=this.filterIndex?"/service-desk/api/contract-list?filter_id="+this.contractFilterId:"/service-desk/api/contract-list",this.filterData(),this.getContractData()},methods:{handleData(e){this.setPlaceholders(e)},handleDataCount(e){this.showIcon=!!e,this.dataCount=e},updateFilter(e){this.filterOptions.map(function(t){t.section.map(function(s){e.name===s.name&&(s.value=e.value)})})},getContractData(){this.hasDataPopulated=!1,S.get("api/agent/report-config/contract-report").then(e=>{this.contractData=e.data.data,this.newReportId=e.data.data.id,this.columnData=e.data.data.sub_reports,this.hasDataPopulated=!0,this.columnData.forEach(t=>{t.columns.forEach(s=>{}),this.columns=t.columns}),this.columns.map(t=>{t.is_visible=!!t.is_visible}),this.updateVisibleColumns()}).catch(e=>{this.hasDataPopulated=!0,this.columns=[],A(e)})},onColumnUpdate(e){this.columns=e,this.updateVisibleColumns()},updateVisibleColumns(){this.visibleColumns={},this.columns.map(e=>{pe(e.is_visible)&&(this.visibleColumns[e.key]=e.label)})},updateFilterFields(e){e.forEach(t=>{t.isCustom&&t.data_type==="checkbox"&&t.value&&(t.value=Array.isArray(t.value)?t.value:t.value.split(","))}),this.customFields=e,this.filterOptions[6].section=e},filterData(){this.filterOptions.map(function(e){e.section.map(function(t){t.isCustom||(t.elements=[],t.isMultiple=!0),t.isPrepopulate=!1,t.value="",t.className="col-sm-4"})})},setPlaceholders(e){this.filterOptions.map(function(t){t.section.map(function(s){s.name=="cost"&&(s.min_placeholder=e.data.minimum_cost,s.max_placeholder=e.data.maximum_cost),s.name=="notify_in_days"&&(s.min_placeholder=e.data.minimum_notify_before,s.max_placeholder=e.data.maximum_notify_before)})})},selectedFilters(e){return e==="closeEvent"?this.isShowFilter=!1:e==="resetEvent"?this.resetFilter():this.applyFilter(e)},resetFilter(){this.apiUrl=this.filterIndex?"/service-desk/api/contract-list?filter_id="+this.contractFilterId:"/service-desk/api/contract-list",this.filterOptions=this.filterOptions.map(function(e){return e.section.map(function(t){t.isCustom||(t.elements=[],t.isMultiple=!0),t.isPrepopulate=!1,t.value="",t.className="col-sm-4"}),e})},applyFilter(e){this.appliedFilters=e;for(var t in this.customFields)this.customFields[t].value=e[this.customFields[t].name];let s="/service-desk/api/contract-list?",d=new URLSearchParams(je(this.filterOptions,e));const i=d,h=new URLSearchParams(i),_={};for(const[f,p]of h)_[f]=p;d[d.length-1]==="&"&&(d=d.slice(0,-1)),this.apiUrl=s+d,this.exportData=this.reformatExportData(_)},toggleFilterView(){this.isShowFilter=!this.isShowFilter},reformatExportData(e){const t={};for(const s in e){const d=s.match(/([a-zA-Z_]+)\[(\d+)\]/);if(d){const[n,i,h]=d;t[i]=t[i]||[],t[i][h]=parseInt(e[s],10)}}return t},exportReport(){this.loading=!0;const e={...this.exportData,total:this.dataCount};let t={};this.filterIndex&&(t.filter_id=this.contractFilterId);const s={...this.exportData,...t,total:this.dataCount};S.post("api/agent/report-export/"+this.newReportId,this.filterIndex?s:e).then(d=>{U(d,"dataTableModal")}).catch(d=>{A(d,"dataTableModal")}).finally(()=>{this.loading=!1})},scheduleList(){this.requiredPayload=JSON.stringify(this.exportData);const e={...this.exportData,filter_id:this.contractFilterId};this.$router.push({path:"/reports/schedule/add/"+this.contractData.type+"/"+this.newReportId,query:{params:this.filterIndex?JSON.stringify(e):this.requiredPayload}})}},components:{ModuleFilter:Bt,"user-column-list":Ge,"dynamic-datatable":Ze,"contracts-filter":Dt}},g4={class:"col-sm-12"},b4={key:0,class:"card card-light"},y4={class:"card-header"},v4={id:"contracts-list",class:"card-title"},w4={class:"card-tools"},k4=a("i",{class:"glyphicon glyphicon-plus"},null,-1),C4=a("i",{class:"glyphicon glyphicon-filter"},null,-1),D4=[C4],S4=a("i",{class:"fas fa-paper-plane"},null,-1),F4=[S4],M4=a("i",{class:"fas fa-calendar"},null,-1),I4=[M4],A4={class:"card-body",id:"contracts_list"};function P4(e,t,s,d,n,i){const h=u("alert"),_=u("router-link"),f=u("ModuleFilter"),p=u("user-column-list"),b=u("dynamic-datatable"),k=N("tooltip");return o(),l("div",g4,[m(h,{componentName:"dataTableModal"}),e.hasDataPopulated?(o(),l("div",b4,[a("div",y4,[a("h3",v4,r(e.lang("list_of_contracts")),1),a("div",w4,[w((o(),v(_,{class:"btn btn-tool",to:"/service-desk/contracts/create"},{default:y(()=>[k4]),_:1})),[[k,e.lang("create_contract")]]),w((o(),l("a",{class:"btn btn-tool",onClick:t[0]||(t[0]=(...D)=>i.toggleFilterView&&i.toggleFilterView(...D))},D4)),[[k,e.lang("filter")]]),e.showIcon?w((o(),l("a",{key:0,id:"export-report-btn",class:"btn btn-tool",onClick:t[1]||(t[1]=D=>i.exportReport()),href:"javascript:;"},F4)),[[k,e.lang("export")]]):c("",!0),e.showIcon?w((o(),l("a",{key:1,id:"schedule-report",class:"btn btn-tool",onClick:t[2]||(t[2]=D=>i.scheduleList()),href:"javascript:;"},I4)),[[k,e.lang("schedule")]]):c("",!0)])]),a("div",A4,[e.isShowFilter?(o(),v(f,{key:0,id:"filter-box",metaData:e.filterOptions,selectedFields:e.customFields,onSelectedFilters:i.selectedFilters,showCustomFilter:!0,updateFields:i.updateFilterFields,appliedFilters:e.appliedFilters,endPoint:"/custom-field-flattened?category=contract&type=contract",saveFilter:!0,filterFor:"contract",filterNum:e.contractFilterId,redirectTo:"/service-desk/contracts",deleteUrl:"/service-desk/api/agent/sd-filter/"+e.contractFilterId,closeFilter:i.toggleFilterView,save_endpoint:"/service-desk/api/agent/sd-filter"},null,8,["metaData","selectedFields","onSelectedFilters","updateFields","appliedFilters","filterNum","deleteUrl","closeFilter"])):c("",!0),(o(!0),l(I,null,$(e.columnData,D=>(o(),l("section",{key:D},[m(p,{"table-columns":D.columns,reportId:D.id,columnId:e.newReportId},null,8,["table-columns","reportId","columnId"]),e.columns.length?(o(),v(b,{key:0,"data-url":e.apiUrl,columns:e.visibleColumns,columnsMeta:D.columns,staticColumns:e.staticColumns,"report-type":e.reportType,show_pagination:e.showPagination},null,8,["data-url","columns","columnsMeta","staticColumns","report-type","show_pagination"])):c("",!0)]))),128))])])):c("",!0)])}const ys=C(f4,[["render",P4]]),T4={name:"contract-form",props:{category:{type:String,required:!0},panel:{type:String,default:"agent"},showViewButton:{type:Boolean,default:!1}},data(){return{fetchFormFieldApi:"/api/form/render/",formUniqueKey:null,submitFormInProgress:!1,editId:"",selectedForm:"",formSelected:!1}},mixins:[ve],beforeMount(){if(this.mode==="edit"){const e=W(this.currentPath());this.fetchFormFieldApi="service-desk/api/edit-contract/"+e,this.editId=W(this.currentPath()),this.formSelected=!0}else this.getDefaultFormValue()},computed:{mode(){return this.currentPath().indexOf("edit")!==-1?"edit":"create"}},methods:{getDefaultFormValue(){this.showLoader=!0,S.get("/from/forms/"+this.category).then(e=>{this.selectedForm=e.data.data.data[0],this.showLoader=!1,this.updateFetchApi()}).catch(e=>{this.showLoader=!1,A(e,"faveo-form")})},updateFetchApi(){this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey),this.$store.dispatch("unsetValidationError"),this.fetchFormFieldApi="/render/form?id="+this.selectedForm.id+"&mode=render",setTimeout(()=>{this.$store.dispatch("createNewFormInstance",{formUniqueKey:this.formUniqueKey,scenario:this.scenario||this.mode}),this.formSelected=!0},1)},afterSubmit(e){window.emitter.emit("updateAgentSidebar"),this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey);let t=Je(this.category);this.$store.dispatch("createNewFormInstance",{formUniqueKey:t,scenario:this.mode}),this.formUniqueKey=t,this.mode==="create"&&setTimeout(()=>{let s=e.data.data.id;this.$router.push("/service-desk/contracts/"+s+"/show")},1e3)}},components:{FormRenderer:we,Alert:ke,FaveoBox:Re,CustomLoader:Ne}},V4={class:"col-sm-12"},L4={key:0,class:"pull-right"},U4=a("span",null,[a("i",{class:"fas fa-eye"})],-1),$4={key:0,class:"form-group row mt-3"},N4={class:"col-md-12"},E4=["disabled"],q4={key:0},O4=a("i",{class:"fas fa-sync"},null,-1),j4=[O4],R4={key:1},x4=a("i",{class:"fas fa-save"},null,-1),B4=[x4];function K4(e,t,s,d,n,i){const h=u("Alert"),_=u("CustomLoader"),f=u("router-link"),p=u("FormRenderer"),b=u("ValidationObserver"),k=u("FaveoBox"),D=N("tooltip");return o(),l("div",V4,[n.formUniqueKey&&n.formSelected?(o(),v(k,{key:0,title:e.lang(i.mode)},{headerMenu:y(()=>[s.showViewButton?(o(),l("span",L4,[w((o(),v(f,{to:"/service-desk/contracts/"+n.editId+"/show",class:"btn btn-tool has-tooltip"},{default:y(()=>[U4]),_:1},8,["to"])),[[D,e.trans("view")]])])):c("",!0)]),default:y(()=>[m(h,{componentName:"faveo-form"}),m(h,{componentName:"form-renderer"}),e.showLoader||n.submitFormInProgress?(o(),v(_,{key:0,duration:4e3})):c("",!0),m(b,{ref:"faveoFormObserver"},{default:y(({values:P,errors:E,validate:M})=>[(o(),v(p,{key:n.formUniqueKey,fetchFormFieldApi:n.fetchFormFieldApi,formUniqueKey:n.formUniqueKey,scenario:i.mode,category:s.category,panel:s.panel,selectDependencyId:n.editId},null,8,["fetchFormFieldApi","formUniqueKey","scenario","category","panel","selectDependencyId"])),e.showLoader?c("",!0):(o(),l("div",$4,[a("div",N4,[a("button",{type:"button",class:"btn btn-primary pull-right",disabled:n.submitFormInProgress,onClick:t[0]||(t[0]=F=>e.onSubmit())},[i.mode==="edit"?(o(),l("span",q4,j4)):(o(),l("span",R4,B4)),g(" "+r(i.mode==="edit"?e.trans("update"):e.trans("submit")),1)],8,E4)])]))]),_:1},512)]),_:1},8,["title"])):c("",!0)])}const vs=C(T4,[["render",K4]]);function z4(e){const{contract_end_date:t,approver:s,cost:d}=e;var n={contract_end_date:[t,"isRequired"],approver:[s,"isRequired"],cost:[d,"isRequired"]};const i=new ce(ae),{errors:h,isValid:_}=i.validate(n);return ie.dispatch("setValidationError",h),{errors:h,isValid:_}}const H4={name:"time-field",description:"time field component along with error block",props:{label:{type:String,required:!0},hint:{type:String,default:""},value:{required:!0},name:{type:String,required:!0},type:{type:String,default:"text"},onChange:{type:Function,Required:!0},classname:{type:String,default:""},required:{type:Boolean,default:!1},labelStyle:{type:Object},formStyle:{type:Object},max:{type:[String,Number],default:""},placeholder:{type:String,default:""},from:{type:String,default:""}},data(){return{changedValue:this.value,currencyValue:this.value}},created(){window.emitter.on("removeVal",this.initialState)},mounted(){this.changedValue=this.value,this.currencyValue=this.value,this.focusOut()},watch:{value(e){this.changedValue=e,this.currencyValue=e}},methods:{focusOut:function(){this.currencyValue=parseFloat(this.changedValue.replace(/[^\d\.]/g,"")),isNaN(this.currencyValue)&&(this.currencyValue=0),this.changedValue=new Intl.NumberFormat().format(this.changedValue),this.changedValue=this.changedValue==0?"":this.changedValue},focusIn:function(){this.changedValue=this.currencyValue.toString(),this.changedValue=this.changedValue==0?"":this.changedValue},checkValue(e){let t=e.keyCode?e.keyCode:e.which;(t<48||t>57)&&(t!==46||this.changedValue.indexOf(".")!=-1)&&e.preventDefault(),this.changedValue!=null&&this.changedValue.indexOf(".")>-1&&e.target.selectionStart>this.changedValue.indexOf(".")&&this.changedValue.split(".")[1].length>1&&e.preventDefault()},onPaste(e){e=e||window.event,e.clipboardData.getData("Text").match(/[^\d]/)&&e.preventDefault()},initialState(){this.changedValue=0,this.changedValue=this.changedValue==0?"":this.changedValue}},components:{"form-field-template":Es}},Y4={class:"inline"},W4=["type","placeholder"];function J4(e,t,s,d,n,i){const h=u("form-field-template");return o(),v(h,{label:s.label,labelStyle:s.labelStyle,name:s.name,classname:s.classname,hint:s.hint,required:s.required},{default:y(()=>[a("span",Y4,[w(a("input",{class:"form-control",style:Ue(s.formStyle),type:s.type,id:"number","onUpdate:modelValue":t[0]||(t[0]=_=>n.changedValue=_),onInput:t[1]||(t[1]=_=>s.onChange(n.changedValue,s.name)),onKeypress:t[2]||(t[2]=(..._)=>i.checkValue&&i.checkValue(..._)),onPaste:t[3]||(t[3]=(..._)=>i.onPaste&&i.onPaste(..._)),min:"1",onBlur:t[4]||(t[4]=(..._)=>i.focusOut&&i.focusOut(..._)),onFocus:t[5]||(t[5]=(..._)=>i.focusIn&&i.focusIn(..._)),placeholder:s.placeholder},null,44,W4),[[Fa,n.changedValue]])])]),_:1},8,["label","labelStyle","name","classname","hint","required"])}const G4=C(H4,[["render",J4],["__scopeId","data-v-90c96973"]]),Z4={name:"contract-extend-modal",description:"Contract Extend Modal component",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime)}},props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},contract:{type:Object,default:()=>{}},updateData:{type:Function,default:()=>{}},type:{type:String,default:""}},data(){return{isDisabled:!1,loading:!1,contract_start_date:"",contract_end_date:"",timeOptions:{start:"00:00",step:"00:30",end:"23:30"},approver:"",cost:"",containerStyle:{width:"800px"},dateDisabled:!1,category:""}},beforeMount(){this.dateDisabled=this.type=="extend",this.dateDisabled&&(this.contract_start_date=this.formattedTime(this.contract.contract_end_date)),this.category=this.$store.getters.getContractAssociateCategory},methods:{onChange(e,t){this[t]=e,t==="cost"&&(this.cost=e==0?"":e)},isValid(){const{errors:e,isValid:t}=z4(this.$data);return t},onSubmit(){if(this.isValid()){this.loading=!0,this.isDisabled=!0;var e=new FormData;e.append("cost",this.cost),e.append("approver_id",this.approver.id),e.append("contract_start_date",ze(this.contract_start_date).format("YYYY-MM-DD HH:mm:ss")),e.append("contract_end_date",ze(this.contract_end_date).format("YYYY-MM-DD HH:mm:ss"));const t={headers:{"Content-Type":"multipart/form-data"}};S.post("/service-desk/api/contract-"+this.type+"/"+this.contract.id,e,t).then(s=>{window.emitter.emit("updateContractAssociates"),this.category==="activity"?window.emitter.emit("updateContractActivity"):this.category==="history"&&window.emitter.emit("updateContractHistory"),this.loading=!1,this.isDisabled=!1,U(s,"contract-view"),this.updateData(),this.onClose()}).catch(s=>{this.loading=!1,this.isDisabled=!1,A(s,"contract-view"),this.onClose()})}}},components:{"date-time-field":bt,"dynamic-select":G,"currency-field":G4}},Q4={class:"modal-title"},X4={key:0},eP={class:"row"},tP={class:"row"},sP={key:1,class:"row"},aP=["disabled"];function nP(e,t,s,d,n,i){const h=u("date-time-field"),_=u("dynamic-select"),f=u("currency-field"),p=u("reuse-loader"),b=u("modal");return s.showModal?(o(),v(b,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{title:y(()=>[a("h4",Q4,r(e.trans(s.type)),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",X4,[a("div",eP,[m(h,{label:e.trans("contract_start_date"),value:n.contract_start_date,type:"datetime",name:"contract_start_date",onChange:i.onChange,required:!0,format:"MMMM DD YYYY, h:mm a",classname:"col-sm-6",clearable:!0,disabled:n.dateDisabled,editable:!0,currentYearDate:!1,"time-picker-options":n.timeOptions},null,8,["label","value","onChange","disabled","time-picker-options"]),m(h,{label:e.trans("contract_end_date"),value:n.contract_end_date,type:"datetime",name:"contract_end_date",onChange:i.onChange,required:!0,format:"MMMM DD YYYY, h:mm a",classname:"col-sm-6",clearable:!0,disabled:!1,editable:!0,currentYearDate:!1,"time-picker-options":n.timeOptions,notBefore:n.contract_start_date},null,8,["label","value","onChange","time-picker-options","notBefore"])]),a("div",tP,[m(_,{label:e.trans("approver"),multiple:!1,name:"approver",prePopulate:!1,classname:"col-sm-6",apiEndpoint:"/api/dependency/users?meta=true",value:n.approver,onChange:i.onChange,required:!0,clearable:!!n.approver,strlength:18},null,8,["label","value","onChange","clearable"]),m(f,{label:e.trans("cost"),value:n.cost,name:"cost",classname:"col-sm-6",onChange:i.onChange,type:"text",required:!0},null,8,["label","value","onChange"])])])),n.loading?(o(),l("div",sP,[m(p,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=k=>i.onSubmit()),class:"btn btn-primary",disabled:n.isDisabled},[a("i",{class:j(s.type=="extend"?"fas fa-expand":"fas fa-sync")},null,2),g(" "+r(e.trans(s.type)),1)],8,aP)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const oP=C(Z4,[["render",nP]]);const iP={name:"contract-assets-modal",description:"Contract Asset Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},contractId:{type:[String,Number],default:""}},data(){return{used_by_ids:"",asset_type_ids:"",managed_by_ids:"",org_ids:"",isDisabled:!0,containerStyle:{width:"950px"},loading:!1,size:60,apiUrl:"",assetIds:[],selectedFilters:{},componentTitle:"contractAssets",category:""}},beforeMount(){this.category=this.$store.getters.getContractAssociateCategory},watch:{assetIds(e){this.isDisabled=!(e.length>0)}},methods:{onChange(e,t){window.emitter.emit(this.componentTitle+"uncheckCheckbox"),this[t]=e||"",this.selectedFilters[t]=e||""},onApply(){let e="/service-desk/api/asset-list?contract_id="+this.contractId+"&",t="";for(var s in this.selectedFilters)this.selectedFilters[s].id&&(t+=s+"="+this.selectedFilters[s].id+"&");t[t.length-1]==="&"&&(t=t.slice(0,-1)),this.apiUrl=e+t},assetsData(e){this.assetIds=e},onSubmit(){if(this.assetIds.length>0){this.loading=!0;const e={};e.asset_ids=this.assetIds;const t={headers:{"Content-Type":"application/json"}};S.post("/service-desk/api/contract-attach-asset?contract_id="+this.contractId,e,t).then(s=>{this.loading=!1,U(s,"contract-view"),window.emitter.emit("updateContractAssociates"),this.category==="activity"?window.emitter.emit("updateContractActivity"):this.category==="assets"&&window.emitter.emit(this.componentTitle+"refreshData"),setTimeout(()=>{window.emitter.emit("updateContractTabs")},500),this.onClose()}).catch(s=>{this.loading=!1,A(s,"contract-view"),this.onClose()})}}},components:{"asset-list-with-checkbox":Oe,"dynamic-select":G}},Ht=e=>(K("data-v-73c4cb2d"),e=e(),z(),e),lP={class:"row"},rP={class:"col-sm-12"},dP=Ht(()=>a("span",{class:"fa fa-check"},null,-1)),cP=Ht(()=>a("br",null,null,-1)),uP={class:"height-limit"},hP={key:0,class:"row"},mP=["disabled"],_P=Ht(()=>a("i",{class:"fas fa-paperclip"},null,-1));function pP(e,t,s,d,n,i){const h=u("dynamic-select"),_=u("asset-list-with-checkbox"),f=u("custom-loader"),p=u("modal");return s.showModal?(o(),v(p,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{title:y(()=>[a("h4",null,r(e.trans("attach_assets")),1)]),fields:y(()=>[a("div",lP,[m(h,{label:e.trans("asset_types"),multiple:!1,name:"asset_type_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"/service-desk/api/dependency/asset_types",value:n.asset_type_ids,onChange:i.onChange,clearable:!!n.asset_type_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),m(h,{label:e.trans("used_by"),multiple:!1,name:"used_by_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"api/dependency/users?meta=true",value:n.used_by_ids,onChange:i.onChange,clearable:!!n.used_by_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),m(h,{label:e.trans("managed_by"),multiple:!1,name:"managed_by_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"api/dependency/agents?meta=true",value:n.managed_by_ids,onChange:i.onChange,clearable:!!n.managed_by_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),m(h,{label:e.trans("organizations"),multiple:!1,name:"org_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"api/dependency/organizations",value:n.org_ids,onChange:i.onChange,clearable:!!n.org_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),a("div",rP,[a("button",{id:"apply-btn",class:"btn btn-primary round-btn float-left",type:"button",onClick:t[0]||(t[0]=b=>i.onApply())},[dP,g("  "+r(e.trans("apply")),1)])])]),cP,a("div",uP,[n.apiUrl?(o(),v(_,{key:0,apiUrl:n.apiUrl,tickets:i.assetsData,componentTitle:n.componentTitle},null,8,["apiUrl","tickets","componentTitle"])):c("",!0)]),n.loading===!0?(o(),l("div",hP,[m(f,{duration:4e3})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[1]||(t[1]=b=>i.onSubmit()),class:"btn btn-primary",disabled:n.isDisabled},[_P,g(" "+r(e.trans("attach")),1)],8,mP)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const fP=C(iP,[["render",pP],["__scopeId","data-v-73c4cb2d"]]),gP={name:"contract-approve",description:"Contract Approve Modal component",props:{showModal:{type:Boolean,default:!1},contractId:{type:[String,Number],default:""},type:{type:String,default:""},onClose:{type:Function},updateData:{type:Function,default:()=>{}}},data(){return{isDisabled:!1,containerStyle:{width:"700px"},loading:!1,reason:"",category:""}},beforeMount(){this.isDisabled=this.type=="reject",this.category=this.$store.getters.getContractAssociateCategory},computed:{btnClass(){return this.type=="approve"?"btn btn-success":"btn btn-danger"},iconClass(){return this.type=="approve"?"fas fa-check":this.type=="reject"?"fas fa-unlink":"fas fa-ban"}},methods:{onChange(e,t){this[t]=e,this.isDisabled=!e},onSubmit(){this.loading=!0,this.isDisabled=!0;const e={};this.type=="reject"&&(e.purpose_of_rejection=this.reason),this.type=="approve"&&(e.purpose_of_approval=this.reason),S.post("/service-desk/api/contract-"+this.type+"/"+this.contractId,e).then(t=>{U(t,"contract-view"),this.afterAction()}).catch(t=>{A(t,"contract-view"),this.afterAction()})},afterAction(){window.emitter.emit("updateContractAssociates"),window.emitter.emit("updateContractActions"),this.category==="activity"?window.emitter.emit("updateContractActivity"):this.category==="history"&&window.emitter.emit("updateContractHistory"),this.updateData(),this.onClose(),this.loading=!1,this.isDisabled=!0}}},bP={class:"modal-title"},yP={key:0},vP={key:0,class:"col-sm-12"},wP={key:1},kP={key:1,class:"row"},CP=["disabled"];function DP(e,t,s,d,n,i){const h=u("tiny-editor"),_=u("reuse-loader"),f=u("modal");return s.showModal?(o(),v(f,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{title:y(()=>[a("h4",bP,r(e.trans(s.type)),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",yP,[s.type=="reject"||s.type=="approve"?(o(),l("div",vP,[m(h,{value:n.reason,type:"text",onChange:i.onChange,name:"reason",label:s.type=="approve"?e.trans("reason_approve"):e.trans("reason_rejection"),classname:"width55",required:s.type!="approve",lang:"en",id:"focus_editor"},null,8,["value","onChange","label","required"])])):c("",!0),s.type=="terminate"?(o(),l("span",wP,r(e.trans("terminate_description")),1)):c("",!0)])),n.loading?(o(),l("div",kP,[m(_,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=p=>i.onSubmit()),class:j(i.btnClass),disabled:n.isDisabled},[a("i",{class:j(i.iconClass),"aria-hidden":"true"},null,2),g(" "+r(e.trans(s.type)),1)],10,CP)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const SP=C(gP,[["render",DP]]);function FP(e){const{notify_to:t,notifyBefore:s}=e;var d={notify_to:[t,"isRequired"],notifyBefore:[s,"isRequired"]};const n=new ce(ae),{errors:i,isValid:h}=n.validate(d);return ie.dispatch("setValidationError",i),{errors:i,isValid:h}}const MP={name:"contract-reminder-modal",description:"Contract Reminder Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},contract:{type:Object,default:()=>{}},updateData:{type:Function,default:()=>{}}},data(){return{isDisabled:!1,loading:!1,notify_to:this.contract.notify_to?this.contract.notify_to:"",notifyBefore:this.contract.notify_before?this.contract.notify_before:"",containerStyle:{width:"800px"},category:""}},beforeMount(){this.category=this.$store.getters.getContractAssociateCategory},methods:{onChange(e,t){this[t]=e},isValid(){const{errors:e,isValid:t}=FP(this.$data);return t},onSubmit(){if(this.isValid()){this.loading=!0,this.isDisabled=!0;var e=new FormData;if(this.notifyBefore&&e.append("notify_before",this.notifyBefore),this.notify_to!=""&&this.notify_to.length>0)for(var t in this.notify_to)this.notify_to[t].id&&typeof this.notify_to[t].id=="number"?e.append("notify_agent_ids["+t+"]",this.notify_to[t].id):e.append("email_ids["+t+"]",this.notify_to[t].name);const s={headers:{"Content-Type":"multipart/form-data"}};S.post("/service-desk/api/contract-expiry-reminder/"+this.contract.id,e,s).then(d=>{this.loading=!1,this.isDisabled=!1,U(d,"contract-view"),window.emitter.emit("updateContractAssociates"),this.category==="activity"?window.emitter.emit("updateContractActivity"):this.category==="history"&&window.emitter.emit("updateContractHistory"),this.updateData(),this.onClose()}).catch(d=>{this.loading=!1,this.isDisabled=!1,A(d,"contract-view")})}}},components:{"number-field":yt,"dynamic-select":G}},IP={class:"modal-title"},AP={key:0,class:"row"},PP={key:1,class:"row"},TP=["disabled"],VP=a("i",{class:"fas fa-save"},null,-1);function LP(e,t,s,d,n,i){const h=u("number-field"),_=u("dynamic-select"),f=u("reuse-loader"),p=u("modal"),b=N("focus-first-input");return s.showModal?(o(),v(p,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{title:y(()=>[a("h4",IP,r(e.trans("contract_expiry_reminder")),1)]),fields:y(()=>[n.loading?c("",!0):w((o(),l("div",AP,[m(h,{label:e.lang("notify_before"),value:n.notifyBefore,name:"notifyBefore",classname:"col-sm-6",onChange:i.onChange,type:"number",required:!0,hint:e.lang("notify_in_days")},null,8,["label","value","onChange","hint"]),m(_,{label:e.lang("notify_to"),multiple:!0,name:"notify_to",prePopulate:!1,classname:"col-sm-6",apiEndpoint:"/api/dependency/users?meta=true",value:n.notify_to,onChange:i.onChange,required:!0,taggable:!0,hint:e.lang("notify_to_contracts"),strlength:18},null,8,["label","value","onChange","hint"])])),[[b]]),n.loading?(o(),l("div",PP,[m(f,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=k=>i.onSubmit()),class:"btn btn-primary",disabled:n.isDisabled},[VP,g(" "+r(e.trans("save")),1)],8,TP)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const UP=C(MP,[["render",LP]]),$P={name:"contract-actions",description:"Contract actions component",props:{contract:{type:Object,default:()=>{}},updateContractDetails:{type:Function,default:()=>{}}},data(){return{actions:"",showUpdateModal:!1,showAssetModal:!1,showCommonModal:!1,actionType:"",showReminder:!1,showDeleteModal:!1,refreshAction:!1}},beforeMount(){this.getActions()},created(){window.emitter.on("updateContractActions",()=>this.refreshAction=!0)},methods:{getActions(){S.get("/service-desk/api/contract-action/"+this.contract.id).then(e=>{this.actions=e.data.data.actions,window.emitter.emit("updateContractTableActions",this.actions)}).catch(e=>{this.actions=""})},extendAndRenew(e){this.actionType=e,this.showUpdateModal=!0},onClose(){this.showUpdateModal=!1,this.showAssetModal=!1,this.showCommonModal=!1,this.showReminder=!1,this.showDeleteModal=!1,this.$store.dispatch("unsetValidationError")},commonMethod(e){this.showCommonModal=!0,this.actionType=e}},watch:{refreshAction(e,t){e===!0&&this.getActions(),this.refreshAction=!1}},components:{"delete-modal":De,"contract-update-modal":oP,"contract-assets":fP,"contract-action-modal":SP,"contract-reminder-modal":UP}},NP={key:0,class:"card-tools"},EP=a("i",{class:"fas fa-server"},null,-1),qP=a("i",{class:"fas fa-server"},null,-1),OP=a("i",{class:"fas fa-edit"},null,-1),jP=a("i",{class:"fas fa-check"},null,-1),RP=a("i",{class:"fas fa-ban"},null,-1),xP=a("i",{class:"fas fa-sync"},null,-1),BP=a("i",{class:"fas fa-expand"},null,-1),KP=a("i",{class:"fas fa-times"},null,-1),zP=a("i",{class:"fas fa-trash"},null,-1);function HP(e,t,s,d,n,i){const h=u("router-link"),_=u("contract-update-modal"),f=u("contract-reminder-modal"),p=u("contract-assets"),b=u("contract-action-modal"),k=u("delete-modal");return n.actions?(o(),l("div",NP,[n.actions.contract_expiry_reminder?(o(),l("button",{key:0,class:"btn btn-tool",onClick:t[0]||(t[0]=D=>n.showReminder=!0)},[EP,g(" "+r(e.trans("contract_expiry_reminder")),1)])):c("",!0),n.actions.contract_asset_attach?(o(),l("button",{key:1,class:"btn btn-tool",onClick:t[1]||(t[1]=D=>n.showAssetModal=!0)},[qP,g(" "+r(e.trans("attach_asset")),1)])):c("",!0),n.actions.contract_edit?(o(),v(h,{key:2,class:"btn btn-tool",to:"/service-desk/contracts/"+s.contract.id+"/edit"},{default:y(()=>[OP,g(" "+r(e.trans("edit")),1)]),_:1},8,["to"])):c("",!0),n.actions.contract_approve?(o(),l("button",{key:3,class:"btn btn-tool",onClick:t[2]||(t[2]=D=>i.commonMethod("approve"))},[jP,g(" "+r(e.trans("approve")),1)])):c("",!0),n.actions.contract_approve?(o(),l("button",{key:4,class:"btn btn-tool",onClick:t[3]||(t[3]=D=>i.commonMethod("reject"))},[RP,g(" "+r(e.trans("reject")),1)])):c("",!0),n.actions.contract_renew?(o(),l("button",{key:5,class:"btn btn-tool",onClick:t[4]||(t[4]=D=>i.extendAndRenew("renew"))},[xP,g(" "+r(e.trans("renew")),1)])):c("",!0),n.actions.contract_extend?(o(),l("button",{key:6,class:"btn btn-tool",onClick:t[5]||(t[5]=D=>i.extendAndRenew("extend"))},[BP,g(" "+r(e.trans("extend")),1)])):c("",!0),n.actions.contract_terminate?(o(),l("button",{key:7,class:"btn btn-tool",onClick:t[6]||(t[6]=D=>i.commonMethod("terminate"))},[KP,g(" "+r(e.trans("terminate")),1)])):c("",!0),n.actions.contract_delete?(o(),l("button",{key:8,class:"btn btn-tool",onClick:t[7]||(t[7]=D=>n.showDeleteModal=!0)},[zP,g(" "+r(e.trans("delete")),1)])):c("",!0),m(q,{name:"modal"},{default:y(()=>[n.showUpdateModal?(o(),v(_,{key:0,onClose:i.onClose,showModal:n.showUpdateModal,contract:s.contract,updateData:s.updateContractDetails,type:n.actionType},null,8,["onClose","showModal","contract","updateData","type"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showReminder?(o(),v(f,{key:0,onClose:i.onClose,showModal:n.showReminder,contract:s.contract,updateData:s.updateContractDetails},null,8,["onClose","showModal","contract","updateData"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showAssetModal?(o(),v(p,{key:0,onClose:i.onClose,showModal:n.showAssetModal,contractId:s.contract.id},null,8,["onClose","showModal","contractId"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showCommonModal?(o(),v(b,{key:0,onClose:i.onClose,showModal:n.showCommonModal,contractId:s.contract.id,type:n.actionType,updateData:s.updateContractDetails},null,8,["onClose","showModal","contractId","type","updateData"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showDeleteModal?(o(),v(k,{key:0,onClose:i.onClose,showModal:n.showDeleteModal,alertComponentName:"contract-view",deleteUrl:"/service-desk/api/contract/"+s.contract.id,redirectUrl:"/service-desk/contracts/list",from:"agent"},null,8,["onClose","showModal","deleteUrl"])):c("",!0)]),_:1})])):c("",!0)}const YP=C($P,[["render",HP]]);const WP={name:"contract-description",description:"Contract description Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},description:{type:String,default:""}}},JP={class:"modal-title"},GP={id:"log_desc"},ZP=["innerHTML"];function QP(e,t,s,d,n,i){const h=u("modal");return s.showModal?(o(),v(h,{key:0,showModal:s.showModal,onClose:s.onClose},{title:y(()=>[a("h4",JP,r(e.trans("description")),1)]),fields:y(()=>[a("div",GP,[a("span",{innerHTML:s.description},null,8,ZP)])]),_:1},8,["showModal","onClose"])):c("",!0)}const XP=C(WP,[["render",QP],["__scopeId","data-v-f85bfeda"]]);const eT={name:"contract-details",description:"Contract details page",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},props:{contract:{type:Object,default:()=>{}},updateData:{type:Function}},data(){return{showDescription:!1}},methods:{subString(e,t=15){return oe(e,t)},onClose(){this.showDescription=!1,this.$store.dispatch("unsetValidationError")},downloadFile(e){window.open(e)}},components:{"contract-actions":YP,"contract-description":XP}},Yt=e=>(K("data-v-2d5d7b1f"),e=e(),z(),e),tT={class:"card card-light"},sT={class:"card-header"},aT={class:"card-title"},nT={class:"card-body"},oT={class:"row"},iT={class:"col-md-12"},lT={class:"callout callout-info bg-info"},rT={class:"row"},dT={class:"col-md-4"},cT={class:"col-md-4"},uT={class:"col-md-4"},hT={class:"col-md-12"},mT={class:"row"},_T={class:"col-md-6 info-row d-flex"},pT={class:"col-md-6"},fT={class:"col-md-6"},gT={class:"text-primary"},bT={class:"col-md-6 info-row d-flex"},yT={class:"col-md-6"},vT={class:"col-md-6"},wT={class:"text-primary"},kT={class:"col-md-6 info-row d-flex"},CT={class:"col-md-6"},DT={class:"col-md-6"},ST={class:"text-primary"},FT={class:"col-md-6 info-row d-flex"},MT={class:"col-md-6"},IT={class:"col-md-6"},AT={class:"text-primary"},PT={class:"col-md-6 info-row d-flex"},TT={class:"col-md-6"},VT={class:"col-md-6"},LT={class:"text-primary"},UT={class:"col-md-6 info-row d-flex"},$T={class:"col-md-6"},NT={class:"col-md-6"},ET={class:"text-primary"},qT={class:"col-md-6 info-row d-flex"},OT={class:"col-md-6"},jT={class:"col-md-6"},RT={class:"text-primary"},xT={class:"col-md-6 info-row d-flex"},BT={class:"col-md-6"},KT={class:"col-md-6"},zT={class:"text-primary"},HT={class:"col-md-6 info-row d-flex"},YT={class:"col-md-6"},WT={class:"col-md-6"},JT={class:"text-primary"},GT={class:"col-md-6 info-row d-flex"},ZT={class:"col-md-6"},QT={class:"col-md-6"},XT={class:"text-primary"},e5={class:"col-md-6 info-row d-flex"},t5={class:"col-md-6"},s5={class:"col-md-6"},a5={class:"text-primary"},n5={class:"col-md-6 info-row d-flex"},o5={class:"col-md-6"},i5={class:"col-md-6"},l5={class:"text-primary"},r5={key:0},d5={class:"col-md-6 info-row d-flex"},c5={class:"col-md-6"},u5={class:"col-md-6"},h5=Yt(()=>a("i",{class:"fas fa-file-code"},"  ",-1)),m5={class:"col-md-6 info-row d-flex"},_5={class:"col-md-6"},p5={class:"col-md-6"},f5={key:0},g5={onClick:"return false",class:"text-primary"},b5={key:0},y5={key:1,onClick:"return false",class:"text-primary"},v5={key:1,class:"col-md-6 info-row d-flex"},w5={class:"col-md-6"},k5={class:"col-md-6"},C5={key:0},D5={class:"line"},S5=["src"],F5=["onClick"],M5=Yt(()=>a("i",{class:"fas fa-download"},null,-1)),I5=Yt(()=>a("br",null,null,-1)),A5={key:1};function P5(e,t,s,d,n,i){const h=u("contract-actions"),_=u("contract-description"),f=N("tooltip");return o(),l("div",tT,[a("div",sT,[w((o(),l("h3",aT,[g(r(i.subString(s.contract.name,50)),1)])),[[f,s.contract.name]]),m(h,{contract:s.contract,updateContractDetails:s.updateData},null,8,["contract","updateContractDetails"])]),a("div",nT,[a("div",oT,[a("div",iT,[a("div",lT,[a("div",rT,[a("div",dT,[a("b",null,r(e.trans("start_date"))+" : ",1),w((o(),l("span",null,[g(r(d.formattedTime(s.contract.contract_start_date)),1)])),[[f,d.formattedTime(s.contract.contract_start_date)]])]),a("div",cT,[a("b",null,r(e.trans("expiry_date"))+" : ",1),w((o(),l("span",null,[g(r(d.formattedTime(s.contract.contract_end_date)),1)])),[[f,d.formattedTime(s.contract.contract_end_date)]])]),a("div",uT,[a("b",null,r(e.trans("contract_type"))+" : ",1),w((o(),l("span",null,[g(r(s.contract.contractType?i.subString(s.contract.contractType.name,20):"---"),1)])),[[f,s.contract.contractType?s.contract.contractType.name:"---"]])])])])])]),a("div",hT,[a("div",mT,[a("div",_T,[a("div",pT,[a("label",null,r(e.trans("vendor")),1)]),a("div",fT,[w((o(),l("a",gT,[g(r(s.contract.vendor?i.subString(s.contract.vendor.name):"---"),1)])),[[f,s.contract.vendor?s.contract.vendor.name:"---"]])])]),a("div",bT,[a("div",yT,[a("label",null,r(e.trans("contract_status")),1)]),a("div",vT,[w((o(),l("a",wT,[g(r(i.subString(s.contract.status.name)),1)])),[[f,s.contract.status.name]])])]),a("div",kT,[a("div",CT,[a("label",null,r(e.trans("license_type")),1)]),a("div",DT,[w((o(),l("a",ST,[g(r(s.contract.licence?i.subString(s.contract.licence.name):"---"),1)])),[[f,s.contract.licence?s.contract.licence.name:"---"]])])]),a("div",FT,[a("div",MT,[a("label",null,r(e.trans("cost")),1)]),a("div",IT,[w((o(),l("a",AT,[g(r(i.subString(new Intl.NumberFormat().format(s.contract.cost))),1)])),[[f,new Intl.NumberFormat().format(s.contract.cost).toString()]])])]),a("div",PT,[a("div",TT,[a("label",null,r(e.trans("identifier")),1)]),a("div",VT,[w((o(),l("a",LT,[g(r(s.contract.identifier?i.subString(s.contract.identifier):"---"),1)])),[[f,s.contract.identifier?s.contract.identifier:"---"]])])]),a("div",UT,[a("div",$T,[a("label",null,r(e.trans("contract_creator")),1)]),a("div",NT,[w((o(),l("a",ET,[g(r(s.contract.owner?i.subString(s.contract.owner.name):"---"),1)])),[[f,s.contract.owner?s.contract.owner.name:"---"]])])]),a("div",qT,[a("div",OT,[a("label",null,r(e.trans("approver")),1)]),a("div",jT,[w((o(),l("a",RT,[g(r(s.contract.approver?i.subString(s.contract.approver.name):"---"),1)])),[[f,s.contract.approver?s.contract.approver.name:"---"]])])]),a("div",xT,[a("div",BT,[a("label",null,r(e.trans("license_count")),1)]),a("div",KT,[w((o(),l("a",zT,[g(r(s.contract.licensce_count?i.subString(s.contract.licensce_count):"---"),1)])),[[f,s.contract.licensce_count?s.contract.licensce_count.toString():"---"]])])]),a("div",HT,[a("div",YT,[a("label",null,r(e.trans("user")),1)]),a("div",WT,[w((o(),l("a",JT,[g(r(s.contract.user.length>0?i.subString(s.contract.user[0].name):"---"),1)])),[[f,s.contract.user.length>0?s.contract.user[0].name:"---"]])])]),a("div",GT,[a("div",ZT,[a("label",null,r(e.trans("organization")),1)]),a("div",QT,[w((o(),l("a",XT,[g(r(s.contract.organization.length>0?i.subString(s.contract.organization[0].name):"---"),1)])),[[f,s.contract.organization.length>0?s.contract.organization[0].name:"---"]])])]),a("div",e5,[a("div",t5,[a("label",null,r(e.trans("notify_before")),1)]),a("div",s5,[w((o(),l("a",a5,[g(r(s.contract.notify_before?i.subString(s.contract.notify_before):"---"),1)])),[[f,s.contract.notify_before?s.contract.notify_before.toString():"---"]])])]),a("div",n5,[a("div",o5,[a("label",null,r(e.trans("notify_to")),1)]),a("div",i5,[s.contract.notify_to.length>0?(o(!0),l(I,{key:0},$(s.contract.notify_to,(p,b)=>w((o(),l("a",l5,[g(r(p.name?p.name:p.email),1),b!=Object.keys(s.contract.notify_to).length-1?(o(),l("span",r5,", ")):c("",!0)])),[[f,p.name?p.name:p.email]])),256)):(o(),l(I,{key:1},[g(" --- ")],64))])]),a("div",d5,[a("div",c5,[a("label",null,r(e.trans("description")),1)]),a("div",u5,[a("a",{href:"javascript:;",class:"btn btn-info btn-xs",onClick:t[0]||(t[0]=p=>n.showDescription=!0)},[h5,g(r(e.trans("show_description")),1)])])]),s.contract.custom_field_values&&s.contract.custom_field_values.length>0?(o(!0),l(I,{key:0},$(s.contract.custom_field_values,p=>(o(),l("div",m5,[a("div",_5,[a("label",null,r(p.label),1)]),a("div",p5,[Array.isArray(p.value)?(o(),l("div",f5,[(o(!0),l(I,null,$(p.value,(b,k)=>w((o(),l("a",g5,[g(r(i.subString(b)),1),k!=Object.keys(p.value).length-1?(o(),l("span",b5,",")):c("",!0),g("  ")])),[[f,b]])),256))])):w((o(),l("a",y5,[g(r(p.field_type=="date"?p.value:p?i.subString(p.value):"---"),1)])),[[f,p.field_type=="date"?p.value:p.value?p.value.replace(/\r?\n/g,"<br />"):"---"]])])]))),256)):c("",!0),s.contract.attachment.length>0?(o(),l("div",v5,[a("div",w5,[a("label",null,r(e.trans("attachments")),1)]),a("div",k5,[s.contract.attachment.length>0?(o(),l("span",C5,[(o(!0),l(I,null,$(s.contract.attachment,p=>(o(),l(I,null,[a("span",D5,[w((o(),l("span",null,[a("img",{src:p.thumbnail_url,class:"attach_img"},null,8,S5),g(" "+r(i.subString(p.name,15))+" "+r("("+p.size+")"),1)])),[[f,p.name]]),w((o(),l("a",{id:"download",onClick:b=>i.downloadFile(p.download_url),href:"javascript:;"},[g("  "),M5],8,F5)),[[f,e.trans("download")]])]),I5],64))),256))])):(o(),l("span",A5,"---"))])])):c("",!0)])])]),m(q,{name:"modal"},{default:y(()=>[n.showDescription?(o(),v(_,{key:0,onClose:i.onClose,showModal:n.showDescription,description:s.contract.description},null,8,["onClose","showModal","description"])):c("",!0)]),_:1})])}const T5=C(eT,[["render",P5],["__scopeId","data-v-2d5d7b1f"]]);const V5={name:"contract-activity",description:"Contract activity page",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},props:{contractId:{type:[String,Number],default:""}},data(){return{loading:!0,apiUrl:"/service-desk/api/contract-log/"+this.contractId,activity_log:[],perPage:"10",total:0,maxSize:5,pagination:1,paramsObj:{},filtering:!1,sort_key:"desc",refreshActivity:!1}},created(){window.emitter.on("updateContractActivity",()=>this.refreshActivity=!0)},beforeMount(){this.paramsObj.page=this.pagination,this.getValues(this.paramsObj)},watch:{pagination(e,t){this.filtering=!0;var s=document.getElementById("activity_log_div");return s.scrollIntoView({behavior:"smooth"}),this.paramsObj.page=e,this.getValues(this.paramsObj),e},loading(e){this.$emit("loaderValue",e)},filtering(e){this.$emit("loaderValue",e)},refreshActivity(e,t){e===!0&&this.getUpdateActivity(),this.refreshActivity=!1}},computed:{PerPage:function(){return this.perPage?parseInt(this.perPage):10},Records:function(){return this.total?parseInt(this.total):0}},methods:{getUpdateActivity(){this.pagination=1,this.sort_key="desc",this.perPage=10,this.total=0,this.paramsObj.page=1,this.paramsObj.limit=10,this.paramsObj["sort-order"]="desc",this.getValues(this.paramsObj)},commonFilter(){this.filtering=!0,this.pagination=1,this.paramsObj.page=1,this.getValues(this.paramsObj)},logLimit(e){this.paramsObj.limit=e,this.commonFilter()},orderBy(e){this.sort_key=e,this.paramsObj["sort-order"]=e,this.commonFilter()},getValues(e){S.get(this.apiUrl,{params:e}).then(t=>{this.loading=!1,this.filtering=!1,this.activity_log=t.data.data.contract_activity_logs.data,this.activity_log.forEach(function(s,d){s.name="<div>"+s.name+"</div>"}),this.total=t.data.data.contract_activity_logs.total,this.perPage=t.data.data.contract_activity_logs.per_page}).catch(t=>{this.loading=!1,this.filtering=!1})},checkDate(e){if(e==0)return!0;var t=this.formattedDate(this.activity_log[e-1].created_at),s=this.formattedDate(this.activity_log[e].created_at);if(t!=s)return!0},showThreadEnd(e){return e===this.activity_log.length-1}},components:{"activity-parser":xe}},Pe=e=>(K("data-v-1e2aa942"),e=e(),z(),e),L5={class:"row",id:"activity_log_div"},U5={class:"col-sm-12 mb-2"},$5={key:0,id:"select_limit"},N5=Pe(()=>a("option",{value:"10"},"10",-1)),E5=Pe(()=>a("option",{value:"25"},"25",-1)),q5=Pe(()=>a("option",{value:"50"},"50",-1)),O5=Pe(()=>a("option",{value:"100"},"100",-1)),j5=[N5,E5,q5,O5],R5={key:1,id:"choose_order"},x5={id:"sort_btn",type:"button","data-toggle":"dropdown",class:"btn btn-default dropdown-toggle"},B5={class:"dropdown-menu",style:{"z-index":"9999"}},K5=Pe(()=>a("i",{class:"fas fa-sort-amount-up"},null,-1)),z5=Pe(()=>a("i",{class:"fas fa-sort-amount-down"},null,-1)),H5={key:2,id:"page_div"},Y5={class:"col-md-12"},W5={key:0,class:"timeline"},J5={key:0,class:"time-label"},G5={class:"bg-default border"},Z5={class:"contrat-activity-timeline"},Q5=Pe(()=>a("i",{class:"far fa-dot-circle"},null,-1)),X5={class:"timeline-item"},eV={class:"time"},tV=Pe(()=>a("i",{class:"far fa-clock"},null,-1)),sV={key:0,class:"timeline-header"},aV={class:"timeline-body break"},nV={key:1},oV=Pe(()=>a("i",{class:"far fa-clock bg-gray"},null,-1)),iV=[oV],lV={key:1,class:"float-right",id:"page_div"},rV={key:0,class:"col-sm-12"},dV={class:"text-center"};function cV(e,t,s,d,n,i){const h=u("uib-pagination"),_=u("faveo-image-element"),f=u("router-link"),p=u("activity-parser");return o(),l("div",L5,[a("div",U5,[!n.loading&&n.activity_log.length>0?(o(),l("div",$5,[w(a("select",{class:"form-control cursor-pointer","onUpdate:modelValue":t[0]||(t[0]=b=>n.perPage=b),onChange:t[1]||(t[1]=b=>i.logLimit(n.perPage))},j5,544),[[qe,n.perPage]])])):c("",!0),!n.loading&&n.activity_log.length>0?(o(),l("div",R5,[a("button",x5,r(e.lang("created_time"))+" - "+r(e.lang(n.sort_key)),1),a("div",B5,[a("a",{href:"javascript:;",class:"dropdown-item",onClick:t[2]||(t[2]=b=>i.orderBy("asc"))},[K5,g(" "+r(e.lang("asc")),1)]),a("a",{href:"javascript:;",onClick:t[3]||(t[3]=b=>i.orderBy("desc")),class:"dropdown-item"},[z5,g(" "+r(e.lang("desc")),1)])])])):c("",!0),!n.loading&&n.total>10?(o(),l("div",H5,[m(h,{id:"page2",records:i.Records,modelValue:n.pagination,"onUpdate:modelValue":t[4]||(t[4]=b=>n.pagination=b),class:"pagination","boundary-links":!1,"per-page":i.PerPage,options:{chunk:n.maxSize,chunksNavigation:"scroll"}},null,8,["records","modelValue","per-page","options"])])):c("",!0)]),a("div",Y5,[!n.loading&&n.activity_log.length>0?(o(),l("div",W5,[(o(!0),l(I,null,$(n.activity_log,(b,k)=>(o(),l(I,null,[i.checkDate(k)?(o(),l("div",J5,[a("span",G5,r(d.formattedDate(b.created_at)),1)])):c("",!0),a("div",Z5,[Q5,a("div",X5,[a("span",eV,[tV,g(" "+r(d.formattedTime(b.created_at)),1)]),b.creator?(o(),l("h3",sV,[m(_,{id:"contract_img","source-url":b.creator.profile_pic,classes:["img-circle","img-bordered-sm"],"alternative-text":"User Image","img-width":25,"img-height":25},null,8,["source-url"]),m(f,{to:"/user/"+b.creator.id},{default:y(()=>[g(" "+r(b.creator.full_name),1)]),_:2},1032,["to"])])):c("",!0),a("div",aV,[m(p,{data:b.name},null,8,["data"])])])]),i.showThreadEnd(k)?(o(),l("div",nV,iV)):c("",!0)],64))),256))])):c("",!0),!n.loading&&n.total>10?(o(),l("div",lV,[m(h,{id:"page2",records:i.Records,modelValue:n.pagination,"onUpdate:modelValue":t[5]||(t[5]=b=>n.pagination=b),class:"pagination","boundary-links":!1,"per-page":i.PerPage,options:{chunk:n.maxSize,chunksNavigation:"scroll"}},null,8,["records","modelValue","per-page","options"])])):c("",!0)]),!n.filtering&&!n.loading&&n.activity_log.length===0?(o(),l("div",rV,[a("h6",dV,r(e.lang("no_data_found")),1)])):c("",!0)])}const uV=C(V5,[["render",cV],["__scopeId","data-v-1e2aa942"]]);const hV={name:"contract-history",description:"Contract history page",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},props:{contractId:{type:[String,Number],default:""}},data(){return{loading:!0,apiUrl:"/service-desk/api/contract-threads/"+this.contractId,history:"",refreshHistory:!1}},created(){window.emitter.on("updateContractHistory",()=>this.refreshHistory=!0)},beforeMount(){this.getValues()},methods:{subString(e,t=15){return oe(e,t)},getValues(){S.get(this.apiUrl).then(e=>{this.loading=!1,this.history=e.data.data.contract_threads}).catch(e=>{this.loading=!1})},checkDate(e){if(e==0)return!0;{let t=this.formattedDate(this.history[e-1].created_at),s=this.formattedDate(this.history[e].created_at);if(t!=s)return!0}},showThreadEnd(e){return e===this.history.length-1}},watch:{loading(e){this.$emit("loaderValue",e)},refreshHistory(e,t){e===!0&&this.getValues(),this.refreshHistory=!1}}},Ft=e=>(K("data-v-95d588a7"),e=e(),z(),e),mV={class:"row"},_V={class:"col-md-12"},pV={key:0,class:"timeline"},fV={key:0,class:"time-label"},gV={class:"bg-default border"},bV={class:"history-timeline"},yV=Ft(()=>a("i",{class:"far fa-dot-circle"},null,-1)),vV={class:"timeline-item"},wV={class:"time"},kV=Ft(()=>a("i",{class:"far fa-clock"},null,-1)),CV=Ft(()=>a("h3",{class:"timeline-header pb-12 border-0 text-white"},".",-1)),DV={class:"timeline-body"},SV={class:"col-md-12"},FV={class:"row"},MV={class:"col-md-6 info-row d-flex"},IV={class:"col-md-6"},AV={class:"col-md-6"},PV={class:"col-md-6 info-row d-flex"},TV={class:"col-md-6"},VV={class:"col-md-6"},LV={class:"col-md-6 info-row d-flex"},UV={class:"col-md-6"},$V={class:"col-md-6"},NV={class:"col-md-6 info-row d-flex"},EV={class:"col-md-6"},qV={class:"col-md-6"},OV={class:"col-md-6 info-row d-flex"},jV={class:"col-md-6"},RV={class:"col-md-6"},xV={class:"col-md-6 info-row d-flex"},BV={key:0,class:"badge badge-success log_type"},KV={key:1,class:"badge badge-success"},zV={key:2,class:"badge badge-danger"},HV={key:1},YV=Ft(()=>a("i",{class:"far fa-clock bg-gray"},null,-1)),WV=[YV],JV={key:0,class:"text-center"};function GV(e,t,s,d,n,i){const h=N("tooltip");return o(),l("div",mV,[a("div",_V,[!n.loading&&n.history.length>0?(o(),l("div",pV,[(o(!0),l(I,null,$(n.history,(_,f)=>(o(),l(I,null,[i.checkDate(f)?(o(),l("div",fV,[a("span",gV,r(d.formattedDate(_.created_at)),1)])):c("",!0),a("div",bV,[yV,a("div",vV,[a("span",wV,[kV,g(" "+r(d.formattedTime(_.created_at)),1)]),CV,a("div",DV,[a("div",SV,[a("div",FV,[a("div",MV,[a("div",IV,[a("label",null,r(e.trans("contract_start_date")),1)]),a("div",AV,[w((o(),l("a",null,[g(r(d.formattedTime(_.contract_start_date)),1)])),[[h,d.formattedTime(_.contract_start_date)]])])]),a("div",PV,[a("div",TV,[a("label",null,r(e.trans("contract_end_date")),1)]),a("div",VV,[w((o(),l("a",null,[g(r(d.formattedTime(_.contract_end_date)),1)])),[[h,d.formattedTime(_.contract_end_date)]])])]),a("div",LV,[a("div",UV,[a("label",null,r(e.trans("created_by")),1)]),a("div",$V,[w((o(),l("a",null,[g(r(i.subString(_.owner?_.owner.name:"---")),1)])),[[h,_.owner?_.owner.name:"---"]])])]),a("div",NV,[a("div",EV,[a("label",null,r(e.trans("approver")),1)]),a("div",qV,[w((o(),l("a",null,[g(r(i.subString(_.approver?_.approver.name:"---")),1)])),[[h,_.approver?_.approver.name:"---"]])])]),a("div",OV,[a("div",jV,[a("label",null,r(e.trans("cost")),1)]),a("div",RV,[w((o(),l("a",null,[g(r(i.subString(new Intl.NumberFormat().format(_.cost))),1)])),[[h,new Intl.NumberFormat().format(_.cost).toString()]])])]),a("div",xV,[_.type?(o(),l("span",BV,r(_.type),1)):c("",!0),_.current?(o(),l("span",KV,r(e.trans("current")),1)):c("",!0),_.expired?(o(),l("span",zV,r(e.trans("expired")),1)):c("",!0)])])])])])]),i.showThreadEnd(f)?(o(),l("div",HV,WV)):c("",!0)],64))),256))])):c("",!0)]),!n.loading&&n.history.length===0?(o(),l("h6",JV,r(e.trans("no_data_found")),1)):c("",!0)])}const ZV=C(hV,[["render",GV],["__scopeId","data-v-95d588a7"]]),QV={name:"contract-asset-detach",description:"Contract Asset Detach Modal component",props:{showModal:{type:Boolean,default:!1},assetId:{type:[String,Number],default:""},compName:{type:String,default:""},alertCompName:{type:String,default:"contractAssociates"},contractId:{type:[String,Number],default:""},onClose:{type:Function}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1}},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,S.delete("/service-desk/api/contract-detach-asset/"+this.contractId+"/"+this.assetId).then(e=>{U(e,this.alertCompName),window.emitter.emit("updateContractAssociates"),window.emitter.emit(this.compName+"refreshData"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(e=>{this.onClose(),this.loading=!1,this.isDisabled=!0,A(e,this.alertCompName)})}}},XV={class:"modal-title"},eL={key:0},tL={key:1,class:"row"},sL=["disabled"],aL=a("i",{class:"fas fa-unlink","aria-hidden":"true"},null,-1);function nL(e,t,s,d,n,i){const h=u("reuse-loader"),_=u("modal");return s.showModal?(o(),v(_,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{title:y(()=>[a("h4",XV,r(e.trans("detach")),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",eL,[a("span",null,r(e.trans("are_you_sure")),1)])),n.loading?(o(),l("div",tL,[m(h,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=f=>i.onSubmit()),class:"btn btn-danger",disabled:n.isDisabled},[aL,g(" "+r(e.trans("detach")),1)],8,sL)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const oL=C(QV,[["render",nL]]);const iL={name:"contract-assets",description:"Contract assets component",props:{actions:{type:[String,Object],default:""},category:{type:String,default:"inbox"},apiUrl:{type:String,default:""},contractId:{type:[String,Number],default:""},componentTitle:{type:String,default:""},disableLoader:{type:Boolean,default:!1}},data(){return{selectedTickets:this.tickets,columns:this.actions.contract_asset_detach?["name","managed_by","used_by","action"]:["name","managed_by","used_by"],options:{},apiEndPoint:this.apiUrl,showModal:!1,assetId:"",totalCount:""}},beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},headings:{name:this.lang("name"),managed_by:this.lang("managed_by"),used_by:this.lang("used_by"),action:this.lang("action")},columnsClasses:{name:"associate-name",managed_by:"associate-manage",used_by:"associate-used",action:"associate-action"},texts:{filter:"",limit:""},templates:{name:function(t,s){return e.h(se,{to:"/service-desk/"+e.category+"/"+s.id+"/show"},s.name)},managed_by(t,s){var d,n;return((n=(d=s.managed_by)==null?void 0:d.full_name)==null?void 0:n.replace(/<[^>]+>/g,""))??"--"},used_by(t,s){var d,n;return((n=(d=s.used_by)==null?void 0:d.full_name)==null?void 0:n.replace(/<[^>]+>/g,""))??"--"},action:function(t,s){let d=e.h("i",{class:"fa fa-unlink"});return e.h("a",{href:"javascript:;",class:"btn btn-primary",title:this.trans("detach"),onClick(){e.showModal=!0,e.assetId=s.id}},[d])}},sortable:["name"],filterable:["name"],pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"name","sort-order":t.ascending?"desc":"asc","search-query":t.query,page:t.page,limit:t.limit}},responseAdapter({data:t}){return e.totalCount=t.data.total,{data:t.data.data.map(s=>(s.detach=!0,s.contract_id=e.contractId,s.compName=e.componentTitle,s)),count:e.totalCount}}}},methods:{onClose(){this.showModal=!1},handelLoader(e){this.$emit("loaderValue",e)}},watch:{totalCount(e){e===0&&(window.emitter.emit("updateContractTabs"),window.emitter.emit("updateContractAssetTable"))}},components:{"contract-asset-detach":oL}},lL={id:"contract_associated_assets"};function rL(e,t,s,d,n,i){const h=u("data-table"),_=u("contract-asset-detach");return o(),l("div",lL,[m(h,{url:n.apiEndPoint,dataColumns:n.columns,option:n.options,scroll_to:"changes-associates",componentTitle:s.componentTitle,onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","componentTitle","onLoaderState","disableLoader"]),m(q,{name:"modal"},{default:y(()=>[n.showModal?(o(),v(_,{key:0,onClose:i.onClose,showModal:n.showModal,assetId:n.assetId,contractId:s.contractId,compName:s.componentTitle},null,8,["onClose","showModal","assetId","contractId","compName"])):c("",!0)]),_:1})])}const dL=C(iL,[["render",rL]]);const cL={name:"contract-associates",description:"Contract associates page",props:{contract:{type:Object,default:()=>{}}},data(){return{tabs:"",category:"activity",loading:!0,actions:"",dynamicKeys:{activity:1,history:1,assets:1}}},created(){window.emitter.on("updateContractTableActions",this.getActions),window.emitter.on("updateContractTabs",this.refreshTabs),window.emitter.on("updateContractAssetTable",()=>this.associates("activity")),this.$store.dispatch("setContractAssociateCategory",this.category)},beforeMount(){this.getTabs()},methods:{getActions(e){this.actions=e},refreshTabs(){setTimeout(()=>{this.getTabs()},1e3)},getTabs(){this.tabs=[{id:"activity",title:"activity_log",show:!0},{id:"history",title:"contract_history",show:!0},{id:"assets",title:"associated_assets",show:this.contract.attach_assets.length>0}]},associates(e){this.category!==e&&(this.loading=!0,this.category=e),this.updateKey(e)},handelLoader(e){this.loading=e},updateKey(e){e!=="changes"&&(this.loading=!0),this.dynamicKeys={...this.dynamicKeys,[e]:this.dynamicKeys[e]+1}}},watch:{category(e,t){e!==t&&this.$store.dispatch("setContractAssociateCategory",e)}},components:{"contract-activity":uV,"contract-history":ZV,"contract-associated-assets":dL}},uL=e=>(K("data-v-942e25e7"),e=e(),z(),e),hL={class:"contract-associates"},mL={key:0,id:"contract-associates",class:"card card-light card-tabs"},_L={class:"card-header p-0 pt-1"},pL={class:"nav nav-tabs"},fL=["onClick"],gL={class:"nav-item ml-auto mt-04"},bL={key:0,type:"button",class:"btn btn-tool rotating","data-card-widget":"refresh"},yL=uL(()=>a("i",{class:"fas fa-refresh"},null,-1)),vL=[yL],wL={class:"card-body"},kL={class:"tab-content"},CL={class:"active tab-pane",id:"activity"};function DL(e,t,s,d,n,i){const h=u("contract-history"),_=u("contract-associated-assets"),f=u("contract-activity");return o(),l("div",hL,[n.tabs?(o(),l("div",mL,[a("div",_L,[a("ul",pL,[(o(!0),l(I,null,$(n.tabs,p=>(o(),l(I,null,[p.show?(o(),l("li",{key:0,class:j([{active:n.category===p.id},"nav-item"])},[a("a",{id:"contract_tab",class:j(["nav-link",{active:n.category===p.id}]),"data-toggle":"pill",onClick:b=>i.associates(p.id)},r(e.trans(p.title)),11,fL)],2)):c("",!0)],64))),256)),a("li",gL,[n.loading?(o(),l("a",bL,vL)):c("",!0)])])]),a("div",wL,[a("div",kL,[a("div",CL,[n.category=="history"?(o(),v(h,{contractId:s.contract.id,onLoaderValue:i.handelLoader,key:"contract_history"+n.dynamicKeys.history},null,8,["contractId","onLoaderValue"])):c("",!0),n.category=="assets"?(o(),v(_,{componentTitle:"contractAssets",actions:n.actions,apiUrl:"/service-desk/api/asset-list?contract_ids="+s.contract.id,contractId:s.contract.id,category:n.category,onLoaderValue:i.handelLoader,disableLoader:"rue",key:"contract_asset"+n.dynamicKeys.assets},null,8,["actions","apiUrl","contractId","category","onLoaderValue"])):c("",!0),n.category=="activity"?(o(),v(f,{contractId:s.contract.id,onLoaderValue:i.handelLoader,key:"contract_activity"+n.dynamicKeys.activity},null,8,["contractId","onLoaderValue"])):c("",!0)])])])])):c("",!0)])}const SL=C(cL,[["render",DL],["__scopeId","data-v-942e25e7"]]),FL={name:"contract-view",description:"Contract view page",data(){return{contract:"",contract_id:"",loading:!0,counter:0,refreshView:!1}},beforeMount(){this.getValues()},created(){window.emitter.on("updateContractAssociates",()=>this.refreshView=!0)},methods:{updateAssociates(){this.loading=!0,this.getValues(!0,Date.now())},getValues(e,t=""){const s=window.location.pathname;this.contract_id=W(s),S.get("/service-desk/api/contract/"+this.contract_id+"?time="+t).then(d=>{this.loading=!1,this.contract=d.data.data.contract}).catch(d=>{this.loading=!1,A(d)})}},watch:{refreshView(e,t){e===!0&&this.getValues(),this.refreshView=!1}},components:{"contract-details":T5,"contract-associates":SL}},ML={class:"col-sm-12"},IL={key:1,class:"row"};function AL(e,t,s,d,n,i){const h=u("alert"),_=u("contract-details"),f=u("contract-associates"),p=u("reuse-loader");return o(),l("div",ML,[m(h,{componentName:"contract-view"}),m(h,{componentName:"contractAssociates"}),!n.loading&&n.contract?(o(),l(I,{key:0},[(o(),v(_,{contract:n.contract,key:"contract_actions"+n.counter,updateData:i.getValues},null,8,["contract","updateData"])),(o(),v(f,{contract:n.contract,key:"contract_associates"+n.counter},null,8,["contract"]))],64)):c("",!0),n.loading?(o(),l("div",IL,[m(p,{"animation-duration":4e3,size:60})])):c("",!0)])}const PL=C(FL,[["render",AL]]);const TL={name:"releases-list",description:"Releases lists table component",props:{filterIndex:{type:Boolean,default:!1}},setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},data:()=>({columns:[],hasDataPopulated:!1,visibleColumns:{},staticColumns:["actions"],reportType:"releases",apiUrl:"/service-desk/api/release-list",filterOptions:[{section:[{name:"release_ids",url:"/service-desk/api/dependency/releases",label:"releases"},{name:"release_statuses",url:"/service-desk/api/status/list?module=3",label:"status"},{name:"location_ids",url:"/api/dependency/locations",label:"location"}]},{section:[{name:"priority_ids",url:"/service-desk/api/dependency/release_priorities",label:"priority"},{name:"release_type_ids",url:"/service-desk/api/dependency/release_types",label:"release_type"},{name:"asset_ids",url:"/service-desk/api/dependency/assets",label:"assets"}]},{section:[{name:"change_ids",url:"/service-desk/api/dependency/changes",label:"changes"},{name:"planned_start_date",type:"date",label:["planned_start_date","planned_start_date_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0},{name:"planned_end_date",type:"date",label:["planned_end_date","planned_end_date_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0}]},{section:[{name:"created_at",type:"date",label:["created_at","created_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0},{name:"updated_at",type:"date",label:["updated_at","updated_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0}]},{section:[]}],isShowFilter:!1,appliedFilters:{},showIcon:!1,columnData:null,releaseData:null,exportData:"",loading:!0,showPagination:!0,newReportId:"",dataCount:"",requiredPayload:[],customFields:[],releaseFilterId:""}),created(){window.emitter.on("onColumnUpdate",this.onColumnUpdate),window.emitter.on("updateFilter",this.updateFilter),window.emitter.on("dataCount",this.handleDataCount)},beforeMount(){this.releaseFilterId=W(window.location.pathname);const e=Ye();e&&e.hasOwnProperty("filter-by-url")?We("/service-desk/api/filter-dependencies",e,{},d=>{d&&this.applyFilter(d)},d=>{A(d)}):this.apiUrl=this.filterIndex?"/service-desk/api/release-list?filter_id="+this.releaseFilterId:"/service-desk/api/release-list",this.filterData(),this.getReleaseData()},methods:{handleDataCount(e){this.showIcon=!!e,this.dataCount=e},updateFilter(e){this.filterOptions.map(function(t){t.section.map(function(s){e.name===s.name&&(s.value=e.value)})})},getReleaseData(){this.hasDataPopulated=!1,S.get("api/agent/report-config/release-report").then(e=>{this.releaseData=e.data.data,this.newReportId=e.data.data.id,this.columnData=e.data.data.sub_reports,this.hasDataPopulated=!0,this.columnData.forEach(t=>{t.columns.forEach(s=>{}),this.columns=t.columns}),this.columns.map(t=>{t.is_visible=!!t.is_visible}),this.updateVisibleColumns()}).catch(e=>{this.hasDataPopulated=!0,this.columns=[],A(e)})},onColumnUpdate(e){this.columns=e,this.updateVisibleColumns()},updateVisibleColumns(){this.visibleColumns={},this.columns.map(e=>{pe(e.is_visible)&&(this.visibleColumns[e.key]=e.label)})},updateFilterFields(e){e.forEach(t=>{t.isCustom&&t.data_type==="checkbox"&&t.value&&(t.value=Array.isArray(t.value)?t.value:t.value.split(","))}),this.customFields=e,this.filterOptions[4].section=e},filterData(){this.filterOptions.map(function(e){e.section.map(function(t){t.isCustom||(t.elements=[],t.isMultiple=!0),t.isPrepopulate=!1,t.value="",t.className="col-sm-4"})})},selectedFilters(e){return e==="closeEvent"?this.isShowFilter=!1:e==="resetEvent"?this.resetFilter():this.applyFilter(e)},resetFilter(){this.apiUrl=this.filterIndex?"/service-desk/api/release-list?filter_id="+this.releaseFilterId:"/service-desk/api/release-list",this.filterOptions=this.filterOptions.map(function(e){return e.section.map(function(t){t.isCustom||(t.elements=[],t.isMultiple=!0),t.isPrepopulate=!1,t.value="",t.className="col-sm-4"}),e})},applyFilter(e){this.appliedFilters=e;for(var t in this.customFields)this.customFields[t].value=e[this.customFields[t].name];let s="/service-desk/api/release-list?",d=new URLSearchParams(je(this.filterOptions,e));const i=d,h=new URLSearchParams(i),_={};for(const[f,p]of h)_[f]=p;d[d.length-1]==="&"&&(d=d.slice(0,-1)),this.apiUrl=s+d,this.exportData=this.reformatExportData(_)},toggleFilterView(){this.isShowFilter=!this.isShowFilter},reformatExportData(e){const t={};for(const s in e){const d=s.match(/([a-zA-Z_]+)\[(\d+)\]/);if(d){const[n,i,h]=d;t[i]=t[i]||[],t[i][h]=parseInt(e[s],10)}}return t},exportReport(){this.loading=!0;const e={...this.exportData,total:this.dataCount};let t={};this.filterIndex&&(t.filter_id=this.releaseFilterId);const s={...this.exportData,...t,total:this.dataCount};S.post("api/agent/report-export/"+this.newReportId,this.filterIndex?s:e).then(d=>{U(d,"dataTableModal")}).catch(d=>{A(d,"dataTableModal")}).finally(()=>{this.loading=!1})},scheduleList(){this.requiredPayload=JSON.stringify(this.exportData);const e={...this.exportData,filter_id:this.releaseFilterId};this.$router.push({path:"/reports/schedule/add/"+this.releaseData.type+"/"+this.newReportId,query:{params:this.filterIndex?JSON.stringify(e):this.requiredPayload}})}},components:{ModuleFilter:Bt,"dynamic-datatable":Ze,"user-column-list":Ge,"releases-filter":Dt}},VL={class:"col-sm-12"},LL={key:0,class:"card card-light"},UL={class:"card-header"},$L={id:"releases-list",class:"card-title"},NL={class:"card-tools"},EL=a("i",{class:"glyphicon glyphicon-plus"},null,-1),qL=a("i",{class:"glyphicon glyphicon-filter"},null,-1),OL=[qL],jL=a("i",{class:"fas fa-paper-plane"},null,-1),RL=[jL],xL=a("i",{class:"fas fa-calendar"},null,-1),BL=[xL],KL={class:"card-body",id:"releases_list"};function zL(e,t,s,d,n,i){const h=u("alert"),_=u("router-link"),f=u("ModuleFilter"),p=u("user-column-list"),b=u("dynamic-datatable"),k=N("tooltip");return o(),l("div",VL,[m(h,{componentName:"dataTableModal"}),e.hasDataPopulated?(o(),l("div",LL,[a("div",UL,[a("h3",$L,r(e.lang("list_of_releases")),1),a("div",NL,[w((o(),v(_,{class:"btn btn-tool",to:"/service-desk/releases/create"},{default:y(()=>[EL]),_:1})),[[k,e.lang("create_release")]]),w((o(),l("a",{class:"btn btn-tool",onClick:t[0]||(t[0]=(...D)=>i.toggleFilterView&&i.toggleFilterView(...D)),href:"javascript:;"},OL)),[[k,e.lang("filter")]]),e.showIcon?w((o(),l("a",{key:0,id:"export-report-btn",class:"btn btn-tool",onClick:t[1]||(t[1]=D=>i.exportReport()),href:"javascript:;"},RL)),[[k,e.lang("export")]]):c("",!0),e.showIcon?w((o(),l("a",{key:1,id:"schedule-report",class:"btn btn-tool",onClick:t[2]||(t[2]=D=>i.scheduleList()),href:"javascript:;"},BL)),[[k,e.lang("schedule")]]):c("",!0)])]),a("div",KL,[e.isShowFilter?(o(),v(f,{key:0,id:"filter-box",metaData:e.filterOptions,selectedFields:e.customFields,onSelectedFilters:i.selectedFilters,showCustomFilter:!0,updateFields:i.updateFilterFields,appliedFilters:e.appliedFilters,endPoint:"/custom-field-flattened?category=release&type=release",saveFilter:!0,filterFor:"release",filterNum:e.releaseFilterId,redirectTo:"/service-desk/releases",deleteUrl:"/service-desk/api/agent/sd-filter/"+e.releaseFilterId,closeFilter:i.toggleFilterView,save_endpoint:"/service-desk/api/agent/sd-filter"},null,8,["metaData","selectedFields","onSelectedFilters","updateFields","appliedFilters","filterNum","deleteUrl","closeFilter"])):c("",!0),(o(!0),l(I,null,$(e.columnData,D=>(o(),l("section",{key:D},[m(p,{"table-columns":D.columns,reportId:D.id,columnId:e.newReportId},null,8,["table-columns","reportId","columnId"]),e.columns.length?(o(),v(b,{key:0,"data-url":e.apiUrl,columns:e.visibleColumns,columnsMeta:D.columns,staticColumns:e.staticColumns,"report-type":e.reportType,show_pagination:e.showPagination},null,8,["data-url","columns","columnsMeta","staticColumns","report-type","show_pagination"])):c("",!0)]))),128))])])):c("",!0)])}const ws=C(TL,[["render",zL]]);const HL={name:"release-planning",description:"Release Planning Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},releaseId:{type:[String,Number],default:""},identifier:{type:String,default:""}},data(){return{attachment:"",description:"",isDisabled:!1,loading:!0,selectedFile:"",attachment_delete:!1,category:""}},beforeMount(){this.getInitialValues(),this.category=this.$store.getters.getReleaseAssociateCategory},methods:{getInitialValues(){S.get("/service-desk/api/general-popup/"+this.releaseId+"/sd_releases/"+this.identifier).then(e=>{this.loading=!1,this.general_info=e.data.data.general_info,this.general_info&&(this.description=this.general_info.description,this.attachment=this.general_info.attachment)}).catch(e=>{this.loading=!1})},onFileSelected(e,t,s){this.selectedFile=e,this.attachment_delete=s,this.attachment=this.selectedFile?this.selectedFile[0]:this.attachment},onChange(e,t){this[t]=e},onSubmit(){if(this.description!=""){this.loading=!0,this.isDisabled=!0;var e=new FormData;e.append("identifier",this.identifier),e.append("description",this.description),this.selectedFile&&e.append("attachment",this.selectedFile[0]?this.selectedFile[0]:""),this.attachment_delete&&e.append("attachment_delete",this.attachment_delete);const t={headers:{"Content-Type":"multipart/form-data"}};S.post("/service-desk/api/general-popup/"+this.releaseId+"/sd_releases",e,t).then(s=>{this.loading=!1,this.isDisabled=!1,window.emitter.emit("updateReleaseAssociates"),this.category==="activity"?window.emitter.emit("updateReleaseActivity"):this.category==="planning"&&window.emitter.emit("updateReleasePlanning"),this.onClose(),U(s,"release-view")}).catch(s=>{this.loading=!1,this.isDisabled=!1,A(s,"release-plan")})}else this.$store.dispatch("setValidationError",{description:"This field is required."})}},components:{"file-upload":He}},YL={class:"modal-title"},WL={key:0},JL={class:"row"},GL={class:"file-upload"},ZL={key:1,class:"row"},QL=["disabled"],XL=a("i",{class:"fas fa-sync"},null,-1);function eU(e,t,s,d,n,i){const h=u("alert"),_=u("tiny-editor"),f=u("file-upload"),p=u("reuse-loader"),b=u("modal");return s.showModal?(o(),v(b,{key:0,showModal:s.showModal,modalBodyClass:n.loading?"":"release_plan_div",onClose:s.onClose},{title:y(()=>[a("h4",YL,r(e.trans(s.identifier)),1)]),alert:y(()=>[m(h,{componentName:"release-plan"})]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",WL,[a("div",JL,[m(_,{value:n.description,type:"text",onChange:i.onChange,name:"description",label:e.trans("description"),classname:"col-sm-12",required:!0,lang:"en",width:"100%",id:"focus_editor"},null,8,["value","onChange","label"])]),a("div",GL,[m(f,{label:e.trans("attachments"),value:n.attachment,name:"attachment",onChange:i.onFileSelected,classname:"col-sm-12"},null,8,["label","value","onChange"])])])),n.loading?(o(),l("div",ZL,[m(p,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=k=>i.onSubmit()),class:"btn btn-primary",disabled:n.isDisabled},[XL,g(" "+r(e.trans("update")),1)],8,QL)]),_:1},8,["showModal","modalBodyClass","onClose"])):c("",!0)}const na=C(HL,[["render",eU]]);const tU={name:"release-assets",description:"Release asset Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},releaseId:{type:[String,Number],default:""}},data(){return{used_by_ids:"",asset_type_ids:"",managed_by_ids:"",org_ids:"",isDisabled:!0,containerStyle:{width:"950px"},loading:!1,size:60,apiUrl:"",assetIds:[],selectedFilters:{},componentTitle:"releaseAssets",category:""}},beforeMount(){this.category=this.$store.getters.getReleaseAssociateCategory},watch:{assetIds(e){this.isDisabled=!(e.length>0)}},methods:{onChange(e,t){window.emitter.emit(this.componentTitle+"uncheckCheckbox"),this[t]=e||"",this.selectedFilters[t]=e||""},onApply(){let e="/service-desk/api/asset-list?release_id="+this.releaseId+"&",t="";for(var s in this.selectedFilters)this.selectedFilters[s].id&&(t+=s+"="+this.selectedFilters[s].id+"&");t[t.length-1]==="&"&&(t=t.slice(0,-1)),this.apiUrl=e+t},assetsData(e){this.assetIds=e},onSubmit(){if(this.assetIds.length>0){this.loading=!0;const e={};e.asset_ids=this.assetIds;const t={headers:{"Content-Type":"application/json"}};S.post("/service-desk/api/release/attach-assets/"+this.releaseId,e,t).then(s=>{window.emitter.emit("updateReleaseAssociates"),window.emitter.emit("updateReleaseView"),this.category==="activity"?window.emitter.emit("updateReleaseActivity"):this.category==="assets"&&window.emitter.emit(this.componentTitle+"refreshData"),this.loading=!1,U(s,"release-view"),this.onClose()}).catch(s=>{this.loading=!1,A(s,"release-view")})}}},components:{"asset-list-with-checkbox":Oe,"dynamic-select":G}},Wt=e=>(K("data-v-a0e91d2c"),e=e(),z(),e),sU={class:"modal-title"},aU={class:"row"},nU={class:"col-sm-12"},oU=Wt(()=>a("span",{class:"fas fa-check"},null,-1)),iU=Wt(()=>a("br",null,null,-1)),lU={class:"height-limit"},rU={key:0,class:"row"},dU=["disabled"],cU=Wt(()=>a("i",{class:"fas fa-paperclip"},null,-1));function uU(e,t,s,d,n,i){const h=u("dynamic-select"),_=u("asset-list-with-checkbox"),f=u("custom-loader"),p=u("modal");return s.showModal?(o(),v(p,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{title:y(()=>[a("h4",sU,r(e.trans("attach_assets")),1)]),fields:y(()=>[a("div",aU,[m(h,{label:e.trans("asset_types"),multiple:!1,name:"asset_type_ids",classname:"col-sm-3",apiEndpoint:"/service-desk/api/dependency/asset_types",value:n.asset_type_ids,onChange:i.onChange,clearable:!!n.asset_type_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),m(h,{label:e.trans("used_by"),multiple:!1,name:"used_by_ids",classname:"col-sm-3",apiEndpoint:"api/dependency/users?meta=true",value:n.used_by_ids,onChange:i.onChange,clearable:!!n.used_by_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),m(h,{label:e.trans("managed_by"),multiple:!1,name:"managed_by_ids",classname:"col-sm-3",apiEndpoint:"api/dependency/agents?meta=true",value:n.managed_by_ids,onChange:i.onChange,clearable:!!n.managed_by_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),m(h,{label:e.trans("organizations"),multiple:!1,name:"org_ids",classname:"col-sm-3",apiEndpoint:"api/dependency/organizations",value:n.org_ids,onChange:i.onChange,clearable:!!n.org_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),a("div",nU,[a("button",{id:"apply-btn",class:"btn btn-primary round-btn float-left",type:"button",onClick:t[0]||(t[0]=b=>i.onApply())},[oU,g("  "+r(e.trans("apply")),1)])])]),iU,a("div",lU,[n.apiUrl?(o(),v(_,{key:0,apiUrl:n.apiUrl,tickets:i.assetsData,componentTitle:n.componentTitle},null,8,["apiUrl","tickets","componentTitle"])):c("",!0)]),n.loading===!0?(o(),l("div",rU,[m(f,{duration:4e3})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[1]||(t[1]=b=>i.onSubmit()),class:"btn btn-primary",disabled:n.isDisabled},[cU,g(" "+r(e.trans("attach")),1)],8,dU)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const hU=C(tU,[["render",uU],["__scopeId","data-v-a0e91d2c"]]),mU={name:"release-associate-change",description:"Release Change Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},releaseId:{type:[String,Number],default:""},updateReleaseData:{type:Function,default:()=>{}}},data(){return{change:[],loading:!1,category:""}},beforeMount(){this.category=this.$store.getters.getReleaseAssociateCategory},methods:{onChange(e,t){this[t]=e},onSubmit(){this.loading=!0;const e={};var t=[];for(var s in this.change)t.push(this.change[s].id);e.change_ids=t,S.post("/service-desk/api/release/attach-change/"+this.releaseId,e).then(d=>{window.emitter.emit("updateReleaseAssociates"),window.emitter.emit("updateReleaseView"),this.category==="activity"?window.emitter.emit(""):this.category==="changes"&&window.emitter.emit("releaseChangerefreshData"),this.loading=!1,this.onClose(),U(d,"release-view"),this.updateReleaseData()}).catch(d=>{this.loading=!1,this.onClose(),A(d,"release-view")})}},components:{"dynamic-select":G}},_U={class:"modal-title"},pU={key:0},fU={class:"row"},gU={key:1,class:"row"},bU=["disabled"],yU=a("i",{class:"fas fa-paperclip"},null,-1);function vU(e,t,s,d,n,i){const h=u("dynamic-select"),_=u("reuse-loader"),f=u("modal");return s.showModal?(o(),v(f,{key:0,showModal:s.showModal,onClose:s.onClose},{title:y(()=>[a("h4",_U,r(e.trans("attach_change")),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",pU,[a("div",fU,[m(h,{label:e.trans("change"),multiple:!0,name:"change",prePopulate:!1,classname:"col-sm-12",apiEndpoint:"/service-desk/api/dependency/changes?supplements[relation_name]=attachReleases&supplements[attribute_name]=release_id&supplements[attribute_value]="+s.releaseId,value:n.change,onChange:i.onChange,required:!0},null,8,["label","apiEndpoint","value","onChange"])])])),n.loading?(o(),l("div",gU,[m(_,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=p=>i.onSubmit()),class:"btn btn-primary",disabled:!(n.change.length>0)},[yU,g(" "+r(e.trans("attach")),1)],8,bU)]),_:1},8,["showModal","onClose"])):c("",!0)}const wU=C(mU,[["render",vU]]),kU={name:"release-status-modal",description:"Release status Modal component",props:{showModal:{type:Boolean,default:!1},releaseId:{type:[String,Number],default:""},updateReleaseData:{type:Function},onClose:{type:Function}},data:()=>({isDisabled:!1,containerStyle:{width:"500px"},loading:!1,category:""}),beforeMount(){this.category=this.$store.getters.getReleaseAssociateCategory},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,S.post("/service-desk/api/complete-release/"+this.releaseId).then(e=>{window.emitter.emit("updateReleaseAssociates"),this.category==="activity"&&window.emitter.emit("updateReleaseActivity"),this.loading=!1,this.onClose(),U(e,"release-view"),this.updateReleaseData()}).catch(e=>{this.loading=!1,this.onClose(),A(e,"release-view")})}}},CU={class:"modal-title"},DU={key:0},SU={key:1,class:"row"},FU=["disabled"],MU=a("i",{class:"fas fa-check","aria-hidden":"true"},null,-1);function IU(e,t,s,d,n,i){const h=u("reuse-loader"),_=u("modal");return s.showModal?(o(),v(_,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:e.containerStyle},{title:y(()=>[a("h4",CU,r(e.trans("status")),1)]),fields:y(()=>[e.loading?c("",!0):(o(),l("div",DU,[a("span",null,r(e.trans("are_you_sure")),1)])),e.loading?(o(),l("div",SU,[m(h,{"animation-duration":4e3,color:"#1d78ff",size:60})])):c("",!0)]),controls:y(()=>[a("button",{id:"submit_btn",type:"button",onClick:t[0]||(t[0]=(...f)=>i.onSubmit&&i.onSubmit(...f)),class:"btn btn-primary",disabled:e.isDisabled},[MU,g(" "+r(e.trans("proceed")),1)],8,FU)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const AU=C(kU,[["render",IU]]),PU={name:"release-actions",props:{actions:{type:[String,Object],default:""},releaseId:{type:[String,Number],default:""},updateReleaseDetails:{type:Function}},data(){return{showPlanningModal:!1,showAttach:!1,showChangeModal:!1,showReleaseStatus:!1,showDeleteModal:!1,identifier:""}},methods:{subString(e,t=15){return oe(e,t)},planningMethod(e){this.showPlanningModal=!0,this.identifier=e},onClose(){this.showPlanningModal=!1,this.showAttach=!1,this.showChangeModal=!1,this.showDeleteModal=!1,this.showReleaseStatus=!1,this.$store.dispatch("unsetValidationError")}},components:{"release-planning-modal":na,"release-assets":hU,"release-change":wU,"release-status-modal":AU,"delete-modal":De}},TU={class:"card-tools"},VU={class:"btn-group"},LU={type:"button",class:"btn btn-tool dropdown-toggle","data-toggle":"dropdown"},UU=a("i",{class:"fas fa-sync"},null,-1),$U={class:"dropdown-menu"},NU={class:"btn-group"},EU={key:0,type:"button",class:"btn btn-tool dropdown-toggle","data-toggle":"dropdown"},qU=a("i",{class:"fas fa-link"},null,-1),OU={class:"dropdown-menu"},jU=a("i",{class:"fas fa-server"},null,-1),RU=a("i",{class:"fas fa-sync"},null,-1),xU={class:"btn-group"},BU={key:0,type:"button",class:"btn btn-tool dropdown-toggle","data-toggle":"dropdown"},KU=a("i",{class:"fas fa-cog"},null,-1),zU={class:"dropdown-menu dropdown-menu-right"};function HU(e,t,s,d,n,i){const h=u("router-link"),_=u("release-planning-modal"),f=u("release-assets"),p=u("release-change"),b=u("release-status-modal"),k=u("delete-modal");return o(),l("div",TU,[a("div",VU,[a("button",LU,[UU,g(" "+r(e.trans("planning")),1)]),a("div",$U,[a("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[0]||(t[0]=D=>i.planningMethod("build-plan"))},r(e.trans("build-plan")),1),a("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[1]||(t[1]=D=>i.planningMethod("test-plan"))},r(e.trans("test-plan")),1)])]),a("div",NU,[s.actions.release_asset_attach||s.actions.release_change_attach?(o(),l("button",EU,[qU,g(" "+r(e.trans("associate")),1)])):c("",!0),a("div",OU,[s.actions.release_asset_attach?(o(),l("a",{key:0,class:"dropdown-item text-dark",href:"javascript:;",onClick:t[2]||(t[2]=D=>n.showAttach=!0)},[jU,g(" "+r(e.trans("attach_asset")),1)])):c("",!0),s.actions.release_change_attach?(o(),l("a",{key:1,class:"dropdown-item text-dark",href:"javascript:;",onClick:t[3]||(t[3]=D=>n.showChangeModal=!0)},[RU,g(" "+r(e.trans("attach_change")),1)])):c("",!0)])]),a("div",xU,[s.actions.release_edit||s.actions.release_delete||s.actions.release_completed?(o(),l("button",BU,[KU,g(" "+r(e.trans("more")),1)])):c("",!0),a("div",zU,[s.actions.release_edit?(o(),v(h,{key:0,class:"dropdown-item text-dark",to:"/service-desk/releases/"+s.releaseId+"/edit"},{default:y(()=>[g(r(e.trans("edit")),1)]),_:1},8,["to"])):c("",!0),s.actions.release_delete?(o(),l("a",{key:1,class:"dropdown-item text-dark",href:"javascript:;",onClick:t[4]||(t[4]=D=>n.showDeleteModal=!0)},r(e.trans("delete")),1)):c("",!0),s.actions.release_completed?(o(),l("a",{key:2,class:"dropdown-item text-dark",href:"javascript:;",onClick:t[5]||(t[5]=D=>n.showReleaseStatus=!0)},r(e.trans("mark_completed")),1)):c("",!0)])]),m(q,{name:"modal"},{default:y(()=>[n.showPlanningModal?(o(),v(_,{key:0,onClose:i.onClose,showModal:n.showPlanningModal,identifier:n.identifier,releaseId:s.releaseId,alertCompName:"release-view"},null,8,["onClose","showModal","identifier","releaseId"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showAttach?(o(),v(f,{key:0,onClose:i.onClose,showModal:n.showAttach,releaseId:s.releaseId},null,8,["onClose","showModal","releaseId"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showChangeModal?(o(),v(p,{key:0,onClose:i.onClose,showModal:n.showChangeModal,releaseId:s.releaseId,updateReleaseData:s.updateReleaseDetails},null,8,["onClose","showModal","releaseId","updateReleaseData"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showReleaseStatus?(o(),v(b,{key:0,onClose:i.onClose,showModal:n.showReleaseStatus,releaseId:s.releaseId,updateReleaseData:s.updateReleaseDetails},null,8,["onClose","showModal","releaseId","updateReleaseData"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showDeleteModal?(o(),v(k,{key:0,onClose:i.onClose,showModal:n.showDeleteModal,alertComponentName:"release-view",deleteUrl:"/service-desk/api/release/"+s.releaseId,redirectUrl:"/service-desk/releases/list",from:"agent"},null,8,["onClose","showModal","deleteUrl"])):c("",!0)]),_:1})])}const YU=C(PU,[["render",HU]]);const WU={name:"release-description",description:"Release description Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},description:{type:String,default:""}}},JU={class:"modal-title"},GU={id:"log_desc"},ZU=["innerHTML"];function QU(e,t,s,d,n,i){const h=u("modal");return s.showModal?(o(),v(h,{key:0,showModal:s.showModal,onClose:s.onClose},{title:y(()=>[a("h4",JU,r(e.trans("description")),1)]),fields:y(()=>[a("div",GU,[a("span",{innerHTML:s.description},null,8,ZU)])]),_:1},8,["showModal","onClose"])):c("",!0)}const XU=C(WU,[["render",QU],["__scopeId","data-v-28af5032"]]);const e$={name:"release-details",description:"Release details page",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},props:{release:{type:Object,default:()=>{}},actions:{type:[Object,String],default:()=>{}},updateData:{type:Function}},data(){return{showDescription:!1}},methods:{checkValues(e,t=100){return e?e.name?oe(e.name,t):oe(e,t):"---"},subString(e,t=15){return oe(e,t)},onClose(){this.showDescription=!1,this.$store.dispatch("unsetValidationError")},downloadFile(e){window.open(e)}},components:{"release-actions":YU,"release-description":XU}},Jt=e=>(K("data-v-d6d512e2"),e=e(),z(),e),t$={class:"release-details"},s$={class:"card card-light"},a$={class:"card-header"},n$={class:"card-title"},o$={class:"card-body"},i$={class:"row"},l$={class:"col-md-12"},r$={class:"callout callout-info bg-info"},d$={class:"row"},c$={class:"col-md-4"},u$={class:"col-md-4"},h$={class:"col-md-4"},m$={class:"col-md-12"},_$={class:"row"},p$={class:"col-md-6 info-row d-flex"},f$={class:"col-md-6"},g$={class:"col-md-6"},b$={key:0,class:"text-primary"},y$={key:1},v$={class:"col-md-6 info-row d-flex"},w$={class:"col-md-6"},k$={class:"col-md-6"},C$={key:0,class:"text-primary"},D$={key:1},S$={class:"col-md-6 info-row d-flex"},F$={class:"col-md-6"},M$={class:"col-md-6"},I$={class:"text-primary"},A$={class:"col-md-6 info-row d-flex"},P$={class:"col-md-6"},T$={class:"col-md-6"},V$={class:"text-primary"},L$={class:"col-md-6 info-row d-flex"},U$={class:"col-md-6"},$$={class:"col-md-6"},N$={class:"text-primary"},E$={class:"col-md-6 info-row d-flex"},q$={class:"col-md-6"},O$={class:"col-md-6"},j$=Jt(()=>a("i",{class:"fas fa-file-code"},"  ",-1)),R$={class:"col-md-6 info-row d-flex"},x$={class:"col-md-6"},B$={class:"col-md-6"},K$={key:0},z$={onClick:"return false",class:"text-primary"},H$={key:0},Y$={key:1,onClick:"return false",class:"text-primary"},W$={key:1,class:"col-md-6 info-row d-flex"},J$={class:"col-md-6"},G$={class:"col-md-6"},Z$={key:0},Q$={class:"line"},X$=["src"],eN=["onClick"],tN=Jt(()=>a("i",{class:"fas fa-download"},null,-1)),sN=Jt(()=>a("br",null,null,-1)),aN={key:1};function nN(e,t,s,d,n,i){const h=u("release-actions"),_=u("release-description"),f=N("tooltip");return o(),l("div",t$,[a("div",s$,[a("div",a$,[w((o(),l("h3",n$,[g(r(i.subString(s.release.subject,50)),1)])),[[f,s.release.subject]]),m(h,{releaseId:s.release.id,actions:s.actions,updateReleaseDetails:s.updateData},null,8,["releaseId","actions","updateReleaseDetails"])]),a("div",o$,[a("div",i$,[a("div",l$,[a("div",r$,[a("div",d$,[a("div",c$,[a("b",null,r(e.lang("created_date"))+" : ",1),w((o(),l("span",null,[g(r(d.formattedTime(s.release.created_at)),1)])),[[f,d.formattedTime(s.release.created_at)]])]),a("div",u$,[a("b",null,r(e.lang("status"))+" : ",1),w((o(),l("span",null,[g(r(i.subString(s.release.status.name)),1)])),[[f,s.release.status.name]])]),a("div",h$,[a("b",null,r(e.lang("release_type"))+" : ",1),w((o(),l("span",null,[g(r(i.subString(s.release.release_type.name)),1)])),[[f,s.release.release_type.name]])])])])])]),a("div",m$,[a("div",_$,[a("div",p$,[a("div",f$,[a("label",null,r(e.lang("planned_start_date")),1)]),a("div",g$,[s.release.planned_start_date&&s.release.planned_start_date!="--"&&s.release.planned_start_date!="0000-00-00 00:00:00"?w((o(),l("a",b$,[g(r(d.formattedTime(s.release.planned_start_date)),1)])),[[f,d.formattedTime(s.release.planned_start_date)]]):(o(),l("a",y$,"---"))])]),a("div",v$,[a("div",w$,[a("label",null,r(e.lang("planned_end_date")),1)]),a("div",k$,[s.release.planned_end_date&&s.release.planned_end_date!="--"&&s.release.planned_end_date!="0000-00-00 00:00:00"?w((o(),l("a",C$,[g(r(d.formattedTime(s.release.planned_end_date)),1)])),[[f,d.formattedTime(s.release.planned_end_date)]]):(o(),l("a",D$,"---"))])]),a("div",S$,[a("div",F$,[a("label",null,r(e.lang("priority")),1)]),a("div",M$,[w((o(),l("a",I$,[g(r(i.subString(s.release.priority.name)),1)])),[[f,s.release.priority.name]])])]),a("div",A$,[a("div",P$,[a("label",null,r(e.lang("identifier")),1)]),a("div",T$,[w((o(),l("a",V$,[g(r(i.checkValues(s.release.identifier,15)),1)])),[[f,i.checkValues(s.release.identifier)]])])]),a("div",L$,[a("div",U$,[a("label",null,r(e.lang("location")),1)]),a("div",$$,[w((o(),l("a",N$,[g(r(i.checkValues(s.release.location,15)),1)])),[[f,i.checkValues(s.release.location)]])])]),a("div",E$,[a("div",q$,[a("label",null,r(e.lang("description")),1)]),a("div",O$,[a("a",{href:"javascript:;",class:"btn btn-info btn-xs",onClick:t[0]||(t[0]=p=>n.showDescription=!0)},[j$,g(r(e.lang("show_description")),1)])])]),s.release.custom_field_values&&s.release.custom_field_values.length>0?(o(!0),l(I,{key:0},$(s.release.custom_field_values,p=>(o(),l("div",R$,[a("div",x$,[a("label",null,r(p.label),1)]),a("div",B$,[Array.isArray(p.value)?(o(),l("div",K$,[(o(!0),l(I,null,$(p.value,(b,k)=>w((o(),l("a",z$,[g(r(i.subString(b)),1),k!=Object.keys(p.value).length-1?(o(),l("span",H$,",")):c("",!0),g("  ")])),[[f,b]])),256))])):w((o(),l("a",Y$,[g(r(p.field_type=="date"?p.value:p?i.subString(p.value):"---"),1)])),[[f,p.field_type=="date"?p.value:p.value?p.value.replace(/\r?\n/g,"<br />"):"---"]])])]))),256)):c("",!0),s.release.attachment.length>0?(o(),l("div",W$,[a("div",J$,[a("label",null,r(e.trans("attachments")),1)]),a("div",G$,[s.release.attachment.length>0?(o(),l("span",Z$,[(o(!0),l(I,null,$(s.release.attachment,p=>(o(),l(I,null,[a("span",Q$,[w((o(),l("span",null,[a("img",{src:p.thumbnail_url,class:"attach_img"},null,8,X$),g(" "+r(i.subString(p.name,15))+" "+r("("+p.size+")"),1)])),[[f,p.name]]),w((o(),l("a",{id:"download",onClick:b=>i.downloadFile(p.download_url),href:"javascript:;"},[g("  "),tN],8,eN)),[[f,e.trans("download")]])]),sN],64))),256))])):(o(),l("span",aN,"---"))])])):c("",!0)])])]),m(q,{name:"modal"},{default:y(()=>[n.showDescription?(o(),v(_,{key:0,onClose:i.onClose,showModal:n.showDescription,description:s.release.description},null,8,["onClose","showModal","description"])):c("",!0)]),_:1})])])}const oN=C(e$,[["render",nN],["__scopeId","data-v-d6d512e2"]]);const iN={name:"release-activity",description:"Release activity page",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},props:{releaseId:{type:[String,Number],default:""}},data(){return{loading:!0,apiUrl:"/service-desk/api/release-activitylog/"+this.releaseId,activity_log:[],perPage:"10",total:0,maxSize:5,pagination:1,paramsObj:{},filtering:!1,sort_key:"desc",refreshActivity:!1}},beforeMount(){this.paramsObj.page=this.pagination,this.getValues(this.paramsObj)},created(){window.emitter.on("updateReleaseActivity",()=>this.refreshActivity=!0)},watch:{pagination(e,t){this.filtering=!0;var s=document.getElementById("activity_log_div");return s.scrollIntoView({behavior:"smooth"}),this.paramsObj.page=e,this.getValues(this.paramsObj),e},loading(e){this.$emit("loaderValue",e)},filtering(e){this.$emit("loaderValue",e)},refreshActivity(e,t){e===!0&&this.getUpdateActivity(),this.refreshActivity=!1}},computed:{PerPage:function(){return this.perPage?parseInt(this.perPage):10},Records:function(){return this.total?parseInt(this.total):0}},methods:{getUpdateActivity(){this.pagination=1,this.sort_key="desc",this.perPage=10,this.total=0,this.paramsObj.page=1,this.paramsObj.limit=10,this.paramsObj["sort-order"]="desc",this.getValues(this.paramsObj)},commonFilter(){this.filtering=!0,this.pagination=1,this.paramsObj.page=1,this.getValues(this.paramsObj)},logLimit(e){this.paramsObj.limit=e,this.commonFilter()},orderBy(e){this.sort_key=e,this.paramsObj["sort-order"]=e,this.commonFilter()},getValues(e){S.get(this.apiUrl,{params:e}).then(t=>{this.loading=!1,this.filtering=!1,this.activity_log=t.data.data.release_activity_logs.data,this.activity_log.forEach(function(s,d){s.name="<div>"+s.name+"</div>"}),this.total=t.data.data.release_activity_logs.total,this.perPage=t.data.data.release_activity_logs.per_page}).catch(t=>{this.loading=!1,this.filtering=!1})},checkDate(e){let t="",s="";return e&&(t=this.formattedDate(this.activity_log[e-1].created_at),s=this.formattedDate(this.activity_log[e].created_at)),!e||t!=s},showThreadEnd(e){return e===this.activity_log.length-1}},components:{"activity-parser":xe}},Te=e=>(K("data-v-e44696a6"),e=e(),z(),e),lN={class:"row",id:"activity_log_div"},rN={class:"col-sm-12 mb-2"},dN={key:0,id:"select_limit"},cN=Te(()=>a("option",{value:"10"},"10",-1)),uN=Te(()=>a("option",{value:"25"},"25",-1)),hN=Te(()=>a("option",{value:"50"},"50",-1)),mN=Te(()=>a("option",{value:"100"},"100",-1)),_N=[cN,uN,hN,mN],pN={key:1,id:"choose_order"},fN={id:"sort_btn",type:"button","data-toggle":"dropdown",class:"btn btn-default dropdown-toggle"},gN={class:"dropdown-menu",style:{"z-index":"9999"}},bN=Te(()=>a("i",{class:"fas fa-sort-amount-up"},null,-1)),yN=Te(()=>a("i",{class:"fas fa-sort-amount-down"},null,-1)),vN={key:2,id:"page_div"},wN={class:"col-md-12"},kN={key:0,class:"timeline"},CN={key:0,class:"time-label"},DN={class:"bg-default border"},SN={class:"release-activity"},FN=Te(()=>a("i",{class:"far fa-dot-circle"},null,-1)),MN={class:"timeline-item"},IN={class:"time"},AN=Te(()=>a("i",{class:"far fa-clock"},null,-1)),PN={key:0,class:"timeline-header"},TN={class:"timeline-body break"},VN={key:1},LN=Te(()=>a("i",{class:"far fa-clock bg-gray"},null,-1)),UN=[LN],$N={key:1,class:"float-right",id:"page_div"},NN={key:0,class:"col-sm-12"},EN={class:"text-center"};function qN(e,t,s,d,n,i){const h=u("uib-pagination"),_=u("faveo-image-element"),f=u("router-link"),p=u("activity-parser");return o(),l("div",lN,[a("div",rN,[!n.loading&&n.activity_log.length>0?(o(),l("div",dN,[w(a("select",{class:"form-control cursor-pointer","onUpdate:modelValue":t[0]||(t[0]=b=>n.perPage=b),onChange:t[1]||(t[1]=b=>i.logLimit(n.perPage))},_N,544),[[qe,n.perPage]])])):c("",!0),!n.loading&&n.activity_log.length>0?(o(),l("div",pN,[a("button",fN,r(e.lang("created_time"))+" - "+r(e.lang(n.sort_key)),1),a("div",gN,[a("a",{href:"javascript:;",class:"dropdown-item",onClick:t[2]||(t[2]=b=>i.orderBy("asc"))},[bN,g(" "+r(e.lang("asc")),1)]),a("a",{href:"javascript:;",onClick:t[3]||(t[3]=b=>i.orderBy("desc")),class:"dropdown-item"},[yN,g(" "+r(e.lang("desc")),1)])])])):c("",!0),!n.loading&&n.total>10?(o(),l("div",vN,[m(h,{id:"page2",records:i.Records,modelValue:n.pagination,"onUpdate:modelValue":t[4]||(t[4]=b=>n.pagination=b),class:"pagination","boundary-links":!1,"per-page":i.PerPage,options:{chunk:n.maxSize,chunksNavigation:"scroll"}},null,8,["records","modelValue","per-page","options"])])):c("",!0)]),a("div",wN,[!n.loading&&n.activity_log.length>0?(o(),l("div",kN,[(o(!0),l(I,null,$(n.activity_log,(b,k)=>(o(),l(I,null,[i.checkDate(k)?(o(),l("div",CN,[a("span",DN,r(d.formattedDate(b.created_at)),1)])):c("",!0),a("div",SN,[FN,a("div",MN,[a("span",IN,[AN,g(" "+r(d.formattedTime(b.created_at)),1)]),b.creator?(o(),l("h3",PN,[m(_,{id:"change_img","source-url":b.creator.profile_pic,classes:["img-circle","img-bordered-sm"],"alternative-text":"User Image","img-width":25,"img-height":25},null,8,["source-url"]),m(f,{to:"/user/"+b.creator.id},{default:y(()=>[g(" "+r(b.creator.full_name),1)]),_:2},1032,["to"])])):c("",!0),a("div",TN,[m(p,{data:b.name},null,8,["data"])])])]),i.showThreadEnd(k)?(o(),l("div",VN,UN)):c("",!0)],64))),256))])):c("",!0),!n.loading&&n.total>10?(o(),l("div",$N,[m(h,{id:"page2",records:i.Records,modelValue:n.pagination,"onUpdate:modelValue":t[5]||(t[5]=b=>n.pagination=b),class:"pagination","boundary-links":!1,"per-page":i.PerPage,options:{chunk:n.maxSize,chunksNavigation:"scroll"}},null,8,["records","modelValue","per-page","options"])])):c("",!0)]),!n.filtering&&!n.loading&&n.activity_log.length===0?(o(),l("div",NN,[a("h6",EN,r(e.lang("no_data_found")),1)])):c("",!0)])}const ON=C(iN,[["render",qN],["__scopeId","data-v-e44696a6"]]),jN={name:"release-planning-delete-modal",description:"Problem Planning Delete Modal component",props:{showModal:{type:Boolean,default:!1},releaseId:{type:[String,Number],default:""},onClose:{type:Function},identifier:{type:String,default:""}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1}},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,S.delete("/service-desk/api/delete/general-popup/"+this.releaseId+"/sd_releases/"+this.identifier).then(e=>{window.emitter.emit("updateReleaseAssociates"),window.emitter.emit("updateReleasePlanning"),this.onClose(),U(e,"release-view"),this.loading=!1,this.isDisabled=!0}).catch(e=>{this.loading=!1,this.isDisabled=!0,A(e,"release-view"),this.onClose()})}}},RN={class:"modal-title"},xN={key:0},BN={key:1,class:"row"},KN=["disabled"],zN=a("i",{class:"fas fa-trash","aria-hidden":"true"},null,-1);function HN(e,t,s,d,n,i){const h=u("reuse-loader"),_=u("modal");return s.showModal?(o(),v(_,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{title:y(()=>[a("h4",RN,r(e.trans("delete")),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",xN,[a("span",null,r(e.trans("are_you_sure")),1)])),n.loading?(o(),l("div",BN,[m(h,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=f=>i.onSubmit()),class:"btn btn-danger",disabled:n.isDisabled},[zN,g(" "+r(e.trans("delete")),1)],8,KN)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const YN=C(jN,[["render",HN]]);const WN={name:"release-planning",description:"Release planning component",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime)}},props:{releaseId:{type:[String,Number],default:""}},data(){return{releaseUpdates:"",loading:!1,showReleaseUpdate:!1,showUpdateDelete:!1,identifier:"",refreshPlanning:!1}},beforeMount(){this.getDetails()},created(){window.emitter.on("updateReleasePlanning",()=>this.refreshPlanning=!0)},methods:{getDetails(){this.loading=!0,S.get("/service-desk/api/release-planning/"+this.releaseId).then(e=>{this.loading=!1,this.releaseUpdates=e.data.data.planning_popups,this.releaseUpdates.length===0&&window.emitter.emit("updateReleaseTables")}).catch(e=>{this.loading=!1})},getFont(e){return e==="build-plan"?"cubes":"adjust"},downloadFile(e,t){window.open(this.basePath()+"/service-desk/download/"+e+"/"+t+"/attachment")},updateMethod(e){this.showReleaseUpdate=!0,this.identifier=e},deleteMethod(e){this.showUpdateDelete=!0,this.identifier=e},onClose(){this.showReleaseUpdate=!1,this.showUpdateDelete=!1,this.$store.dispatch("unsetValidationError")}},watch:{loading(e){this.$emit("loaderValue",e)},refreshPlanning(e,t){e===!0&&this.getDetails(),this.refreshPlanning=!1}},components:{"release-update-modal":na,"release-planning-delete":YN}},lt=e=>(K("data-v-03ab1ba7"),e=e(),z(),e),JN={class:"box-body"},GN={key:0,class:"timeline"},ZN={class:"time-label"},QN={class:"bg-gray"},XN={class:"release-plan-timeline"},eE={class:"timeline-item"},tE={class:"time float-left"},sE=lt(()=>a("i",{class:"far fa-clock"},null,-1)),aE={class:"timeline-header pb-37"},nE=["onClick"],oE=lt(()=>a("i",{class:"fas fa-trash"},null,-1)),iE=["onClick"],lE=lt(()=>a("i",{class:"fas fa-edit"},null,-1)),rE={class:"timeline-body break"},dE=["innerHTML"],cE={key:0,class:"timeline-footer planning_footer"},uE={key:0},hE=["src"],mE=["onClick"],_E=lt(()=>a("i",{class:"fa fa-download"},null,-1)),pE=lt(()=>a("div",null,[a("i",{class:"far fa-clock bg-gray"})],-1)),fE={key:1,class:"text-center"};function gE(e,t,s,d,n,i){const h=u("release-update-modal"),_=u("release-planning-delete"),f=N("tooltip");return o(),l("div",JN,[n.releaseUpdates.length>0?(o(),l("div",GN,[(o(!0),l(I,null,$(n.releaseUpdates,(p,b)=>(o(),l(I,null,[a("div",ZN,[a("span",QN,r(e.trans(p.key)),1)]),a("div",XN,[a("i",{class:j("fas fa-"+i.getFont(p.key)+" bg-blue")},null,2),a("div",eE,[a("span",tE,[sE,g(" "+r(d.formattedTime(p.updated_at)),1)]),a("h3",aE,[a("button",{class:"btn btn-default btn-xs btn-right ml-1",onClick:k=>i.deleteMethod(p.key)},[oE,g(" "+r(e.trans("delete")),1)],8,nE),a("button",{class:"btn btn-default btn-xs btn-right",onClick:k=>i.updateMethod(p.key)},[lE,g(" "+r(e.trans("edit")),1)],8,iE)]),a("div",rE,[a("span",{class:"text-muted",id:"log_desc",innerHTML:p.description},null,8,dE)]),p.attachment?(o(),l("div",cE,[p.attachment?(o(),l("span",uE,[w((o(),l("span",null,[a("img",{src:p.attachment.icon_url,class:"attach_img"},null,8,hE),g(" "+r(p.attachment.value)+" "+r("("+p.attachment.size+")"),1)])),[[f,p.attachment.value]]),w((o(),l("a",{id:"download",onClick:k=>i.downloadFile(p.attachment.id,p.attachment.owner)},[g("  "),_E],8,mE)),[[f,e.trans("download")]])])):c("",!0)])):c("",!0)])])],64))),256)),pE])):c("",!0),!n.loading&&n.releaseUpdates.length===0?(o(),l("h6",fE,r(e.trans("no_data_found")),1)):c("",!0),m(q,{name:"modal"},{default:y(()=>[n.showReleaseUpdate?(o(),v(h,{key:0,onClose:i.onClose,showModal:n.showReleaseUpdate,identifier:n.identifier,releaseId:s.releaseId,alertCompName:"release-view"},null,8,["onClose","showModal","identifier","releaseId"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showUpdateDelete?(o(),v(_,{key:0,onClose:i.onClose,showModal:n.showUpdateDelete,identifier:n.identifier,releaseId:s.releaseId,alertCompName:"release-view"},null,8,["onClose","showModal","identifier","releaseId"])):c("",!0)]),_:1})])}const bE=C(WN,[["render",gE],["__scopeId","data-v-03ab1ba7"]]),yE={name:"problem-ticket-detach-modal",description:"Problem Ticket Detach Modal component",props:{showModal:{type:Boolean,default:!1},releaseId:{type:[String,Number],default:""},category:{type:String,default:""},fieldId:{type:[String,Number],default:""},onClose:{type:Function},compName:{type:String,default:""}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1}},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,S.delete("/service-desk/api/release/detach-"+this.category+"/"+this.releaseId+"/"+this.fieldId).then(e=>{U(e,"release-view"),window.emitter.emit(this.compName+"refreshData"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(e=>{this.loading=!1,this.isDisabled=!1,A(e,"release-view")})}}},vE={class:"modal-title"},wE={key:0},kE={key:1,class:"row"},CE=["disabled"],DE=a("i",{class:"fas fa-unlink"},null,-1);function SE(e,t,s,d,n,i){const h=u("reuse-loader"),_=u("modal");return s.showModal?(o(),v(_,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{title:y(()=>[a("h4",vE,r(e.trans("detach")),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",wE,[a("span",null,r(e.trans("are_you_sure")),1)])),n.loading?(o(),l("div",kE,[m(h,{"animation-duration":4e3,color:"#1d78ff",size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=f=>i.onSubmit()),class:"btn btn-danger",disabled:n.isDisabled},[DE,g(" "+r(e.trans("detach")),1)],8,CE)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const oa=C(yE,[["render",SE]]);const FE={name:"release-associated-assets",description:"Release associated assets table page",props:{actions:{type:[String,Object],default:""},category:{type:String,default:""},apiUrl:{type:String,default:""},releaseId:{type:[String,Number],default:""},componentTitle:{type:String,default:""},disableLoader:{type:Boolean,default:!1}},data(){return{columns:this.actions.release_asset_detach?["name","managed_by","used_by","contract","action"]:["name","managed_by","used_by","contract"],options:{},apiEndPoint:this.apiUrl,showModal:!1,fieldId:"",totalCount:""}},beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},headings:{name:this.lang("name"),managed_by:this.lang("managed_by"),used_by:this.lang("used_by"),contract:this.lang("contract"),action:this.lang("action")},columnsClasses:{name:"associate-name",managed_by:"associate-manage",used_by:"associate-used",contract:"associate-contract",action:"associate-action"},texts:{filter:"",limit:""},templates:{name:function(t,s){return e.h(se,{to:"/service-desk/"+e.category+"/"+s.id+"/show"},s.name)},managed_by(t,s){var d,n;return((n=(d=s.managed_by)==null?void 0:d.full_name)==null?void 0:n.replace(/<[^>]+>/g,""))??"--"},used_by(t,s){var d,n;return((n=(d=s.used_by)==null?void 0:d.full_name)==null?void 0:n.replace(/<[^>]+>/g,""))??"--"},contract:function(t,s){return s.contract&&!Array.isArray(s.contract)?e.h(se,{to:"/service-desk/contracts/"+s.contract.id+"/show"},s.contract.name):"--"},action:function(t,s){let d=e.h("i",{class:"fas fa-unlink"});return e.h("a",{href:"javascript:;",class:"btn btn-primary",title:this.trans("detach"),onClick(){e.showModal=!0,e.fieldId=s.id}},[d])}},sortable:["name"],filterable:["name"],pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"name","sort-order":t.ascending?"desc":"asc","search-query":t.query,page:t.page,limit:t.limit}},responseAdapter({data:t}){return e.totalCount=t.data.total,{data:t.data.data.map(s=>(s.detach=!0,s.release_id=e.releaseId,s.compName=e.componentTitle,s)),count:e.totalCount}}}},methods:{onClose(){this.showModal=!1},handelLoader(e){this.$emit("loaderValue",e)}},watch:{totalCount(e){e===0&&(window.emitter.emit("updateReleaseView"),window.emitter.emit("updateReleaseTables"),window.emitter.emit("updateReleaseAssociates"))}},components:{"release-asset-detach":oa}},ME={id:"problem_associated_assets"};function IE(e,t,s,d,n,i){const h=u("data-table"),_=u("release-asset-detach");return o(),l("div",ME,[m(h,{url:n.apiEndPoint,dataColumns:n.columns,option:n.options,scroll_to:"release-associates",componentTitle:s.componentTitle,onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","componentTitle","onLoaderState","disableLoader"]),m(q,{name:"modal"},{default:y(()=>[n.showModal?(o(),v(_,{key:0,onClose:i.onClose,showModal:n.showModal,fieldId:n.fieldId,releaseId:s.releaseId,compName:s.componentTitle,category:"asset"},null,8,["onClose","showModal","fieldId","releaseId","compName"])):c("",!0)]),_:1})])}const AE=C(FE,[["render",IE]]);const PE={name:"release-associated-changes",description:"Release associated changes table page",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},props:{actions:{type:[String,Object],default:""},apiUrl:{type:String,default:""},releaseId:{type:[String,Number],default:""},componentTitle:{type:String,default:""},disableLoader:{type:Boolean,default:!1}},data(){return{columns:this.actions.release_change_detach?["identifier","subject","requester","status","priority","department","created_at","action"]:["identifier","subject","requester","status","priority","department","created_at"],options:{},apiEndPoint:this.apiUrl,showModal:!1,fieldId:"",totalCount:""}},beforeMount(){const e=this;this.options={headings:{identifier:this.lang("identifier"),subject:this.lang("subject"),requester:this.lang("requester"),status:this.lang("status"),priority:this.lang("priority"),department:this.lang("department"),created_at:this.lang("created"),action:this.lang("action")},columnsClasses:{identifier:"change-identifier",subject:"change-subject",requester:"change-requester",status:"change-status",priority:"change-priority",department:"change-department",created_at:"change-created",action:"change-action"},sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},texts:{filter:"",limit:""},templates:{requester:function(t,s){var d,n;return s.requester?e.h(se,{to:"/user/"+s.requester.id},((n=(d=s.requester)==null?void 0:d.full_name)==null?void 0:n.replace(/<[^>]+>/g,""))??s.requester.email):"---"},status:function(t,s){return s.status?e.h("span",{},[e.h("i",{class:s.status.icon_class,style:{color:s.status.icon_color,marginRight:"5px"}})],s.status.name):"---"},priority(t,s){return s.priority?s.priority.name:"---"},department:function(t,s){var d,n;return s.department?e.h("a",{href:e.basePath()+"/department/"+s.department.id,target:"_blank"},(n=(d=s.department)==null?void 0:d.name)==null?void 0:n.replace(/<[^>]+>/g,"")):"---"},created_at(t,s){return e.formattedTime(s.created_at)},action:function(t,s){let d=e.h("i",{class:"fas fa-unlink"});return e.h("a",{href:"javascript:;",class:"btn btn-primary",title:this.trans("detach"),onClick(){e.showModal=!0,e.fieldId=s.id}},[d])}},sortable:["identifier","subject","created_at"],filterable:["identifier","subject","requester","status","priority","department"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query,page:t.page,limit:t.limit}},responseAdapter({data:t}){return e.totalCount=t.data.total,{data:t.data.changes,count:e.totalCount}}}},methods:{onClose(){this.showModal=!1},handelLoader(e){this.$emit("loaderValue",e)}},watch:{totalCount(e){e===0&&(window.emitter.emit("updateReleaseView"),window.emitter.emit("updateReleaseTables"),window.emitter.emit("updateReleaseAssociates"))}},components:{"release-change-detach":oa}},TE={id:"changes_list"};function VE(e,t,s,d,n,i){const h=u("data-table"),_=u("release-change-detach");return o(),l("div",TE,[m(h,{url:n.apiEndPoint,dataColumns:n.columns,option:n.options,scroll_to:"release-associates",componentTitle:s.componentTitle,onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","componentTitle","onLoaderState","disableLoader"]),m(q,{name:"modal"},{default:y(()=>[n.showModal?(o(),v(_,{key:0,onClose:i.onClose,showModal:n.showModal,fieldId:n.fieldId,releaseId:s.releaseId,compName:s.componentTitle,category:"change"},null,8,["onClose","showModal","fieldId","releaseId","compName"])):c("",!0)]),_:1})])}const LE=C(PE,[["render",VE]]);const UE={name:"release-associates",description:"Release associates page",props:{release:{type:Object,default:()=>{}}},data(){return{tabs:[],category:"activity",loading:!0,actions:"",showAssociates:!1,dynamicKeys:{planning:1,assets:1,activity:1,changes:1}}},beforeMount(){this.getActions()},created(){window.emitter.on("updateReleaseAssociates",this.updateAssociates),window.emitter.on("updateReleaseTables",()=>this.associates("activity")),this.$store.dispatch("setReleaseAssociateCategory",this.category)},methods:{associates(e){this.category!==e&&(this.loading=!0,this.category=e),this.updateKey(e)},updateAssociates(){setTimeout(()=>{this.getActions(Date.now())},500)},getActions(e=""){S.get("/service-desk/api/release-action/"+this.release.id+"?time="+e).then(t=>{this.actions=t.data.data.actions,this.$emit("handelAction",this.actions),this.tabs=[{id:"activity",title:"activity_log",show:!0},{id:"planning",title:"planning",show:this.actions.check_planning},{id:"assets",title:"associated_assets",show:this.release.attach_assets.length>0},{id:"changes",title:"associated_changes",show:this.release.attach_changes.length>0}],this.showAssociates=!0,this.loading=!1}).catch(t=>{this.loading=!1,this.actions=""})},handelLoader(e){this.loading=e},updateKey(e){this.dynamicKeys={...this.dynamicKeys,[e]:this.dynamicKeys[e]+1}}},watch:{category(e,t){e!==t&&this.$store.dispatch("setReleaseAssociateCategory",e)}},components:{"release-activity":ON,"release-planning":bE,"release-associated-assets":AE,"release-associated-changes":LE}},$E=e=>(K("data-v-7315c9d8"),e=e(),z(),e),NE={key:0,id:"release-associates",class:"card card-light card-tabs"},EE={class:"card-header p-0 pt-1"},qE={class:"nav nav-tabs"},OE={key:0,class:"nav-item"},jE=["onClick"],RE={class:"nav-item ml-auto mt-04"},xE={key:0,type:"button",class:"btn btn-tool rotating","data-card-widget":"refresh"},BE=$E(()=>a("i",{class:"fas fa-refresh"},null,-1)),KE=[BE],zE={class:"card-body"},HE={class:"tab-content"},YE={class:"active tab-pane",id:"activity"};function WE(e,t,s,d,n,i){const h=u("alert"),_=u("release-planning"),f=u("release-associated-assets"),p=u("release-associated-changes"),b=u("release-activity");return n.showAssociates?(o(),l("div",NE,[m(h,{componentName:"releaseAssociates"}),a("div",EE,[a("ul",qE,[(o(!0),l(I,null,$(n.tabs,k=>(o(),l(I,null,[k.show?(o(),l("li",OE,[a("a",{id:"release_tab",class:j(["nav-link",{active:n.category===k.id}]),"data-toggle":"pill",onClick:D=>i.associates(k.id)},r(e.trans(k.title)),11,jE)])):c("",!0)],64))),256)),a("li",RE,[n.loading?(o(),l("a",xE,KE)):c("",!0)])])]),a("div",zE,[a("div",HE,[a("div",YE,[n.category=="planning"?(o(),v(_,{releaseId:s.release.id,onLoaderValue:i.handelLoader,key:"release_planning"+n.dynamicKeys.planning},null,8,["releaseId","onLoaderValue"])):c("",!0),n.category=="assets"?(o(),v(f,{componentTitle:"releaseAssets",actions:n.actions,apiUrl:"/service-desk/api/asset-list?release_ids="+s.release.id,releaseId:s.release.id,category:n.category,disableLoader:"true",onLoaderValue:i.handelLoader,key:"release_asset"+n.dynamicKeys.assets},null,8,["actions","apiUrl","releaseId","category","onLoaderValue"])):c("",!0),n.category=="changes"?(o(),v(p,{releaseId:s.release.id,actions:n.actions,apiUrl:"/service-desk/api/change-list?release_ids="+s.release.id,disableLoader:"true",onLoaderValue:i.handelLoader,key:"release_change"+n.dynamicKeys.changes,componentTitle:"releaseChange"},null,8,["releaseId","actions","apiUrl","onLoaderValue"])):c("",!0),n.category=="activity"?(o(),v(b,{releaseId:s.release.id,onLoaderValue:i.handelLoader,key:"release_activity"+n.dynamicKeys.activity},null,8,["releaseId","onLoaderValue"])):c("",!0)])])])])):c("",!0)}const JE=C(UE,[["render",WE],["__scopeId","data-v-7315c9d8"]]),GE={name:"release-view",description:"Release view page",data(){return{release:"",release_id:"",loading:!0,actions:"",counter:0,refreshView:!1}},beforeMount(){this.getValues()},created(){window.emitter.on("updateReleaseView",()=>this.refreshView=!0)},methods:{refreshData(){this.getValues()},getValues(e,t=""){const s=window.location.pathname;this.release_id=W(s),S.get("/service-desk/api/release/"+this.release_id+"?time="+t).then(d=>{this.release=d.data.data.release,this.loading=!1}).catch(d=>{this.loading=!1,A(d,"release-view")})},updateActions(e){this.actions=e}},watch:{refreshView(e){e==!0&&this.refreshData(),this.refreshView=!1}},components:{"release-details":oN,"release-associates":JE}},ZE={key:0};function QE(e,t,s,d,n,i){const h=u("alert"),_=u("reuse-loader"),f=u("release-details"),p=u("release-associates");return o(),l("div",{class:"col-sm-12",key:n.counter},[m(h,{componentName:"release-view"}),n.loading?(o(),l("div",ZE,[m(_,{"animation-duration":4e3,size:60})])):c("",!0),n.loading?c("",!0):(o(),l(I,{key:1},[m(f,{release:n.release,updateData:i.refreshData,actions:n.actions},null,8,["release","updateData","actions"]),m(p,{releaseId:n.release_id,release:n.release,onHandelAction:i.updateActions},null,8,["releaseId","release","onHandelAction"])],64))])}const XE=C(GE,[["render",QE]]);const eq={name:"software-license-list",description:"Softwarelicense lists table component",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},props:{filterIndex:{type:Boolean,default:!1}},data:()=>({columns:[],hasDataPopulated:!1,visibleColumns:{},staticColumns:["actions"],apiUrl:"/service-desk/api/software-license-list",filterOptions:[{section:[{name:"software_licenses_ids",url:"service-desk/api/dependency/softwarelicense",label:"software/license",isCustom:!1},{name:"license_type",url:"/service-desk/api/dependency/license_types",label:"license_type",isCustom:!1},{name:"depreciation_ids",url:"/service-desk/api/dependency/depreciation",label:"depreciation",isCustom:!1}]},{section:[{name:"vendor_ids",url:"/service-desk/api/dependency/vendors",label:"vendor",isCustom:!1},{name:"manufacturer_ids",url:"/service-desk/api/dependency/manufacturer",label:"manufacturer",isCustom:!1},{name:"org_ids",url:"/api/dependency/organizations",label:"organization",isCustom:!1}]},{section:[{name:"asset_ids",url:"service-desk/api/dependency/assets",label:"assets",isCustom:!1},{name:"used_by_ids",url:"api/dependency/users?meta=true",label:"users",isCustom:!1},{name:"created_at",type:"date",label:["created_at","created_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},range:!0,isCustom:!1}]},{section:[{name:"updated_at",type:"date",label:["updated_at","updated_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},pickers:!0,range:!0,isCustom:!1}]},{section:[]}],columnData:null,licenseData:null,isShowFilter:!1,appliedFilters:{},customFields:[],licenseFilterId:"",showIcon:!1,reportType:"license",exportData:"",loading:!0,showPagination:!0,newReportId:"",dataCount:"",requiredPayload:[]}),created(){window.emitter.on("onColumnUpdate",this.onColumnUpdate),window.emitter.on("updateFilter",this.updateFilter),window.emitter.on("dataCount",this.handleDataCount)},beforeMount(){const e=window.location.pathname;this.licenseFilterId=W(e);const t=Ye();t&&t.hasOwnProperty("filter-by-url")?We("/service-desk/api/filter-dependencies",t,{},n=>{n&&this.applyFilter(n)},n=>{A(n)}):this.apiUrl=this.filterIndex?"service-desk/api/software-license-list?filter_id="+this.licenseFilterId:"service-desk/api/software-license-list",this.filterData(),this.getLicenseData()},methods:{handleDataCount(e){this.showIcon=!!e,this.dataCount=e},updateFilter(e){this.filterOptions.map(function(t){t.section.map(function(s){e.name==s.name&&(s.value=e.value)})})},getLicenseData(){this.hasDataPopulated=!1,S.get("api/agent/report-config/software-license-report").then(e=>{this.licenseData=e.data.data,this.newReportId=e.data.data.id,this.columnData=e.data.data.sub_reports,this.hasDataPopulated=!0,this.columnData.forEach(t=>{t.columns.forEach(s=>{}),this.columns=t.columns}),this.columns.map(t=>{t.is_visible=!!t.is_visible}),this.updateVisibleColumns()}).catch(e=>{this.hasDataPopulated=!0,this.columns=[],A(e)})},onColumnUpdate(e){this.columns=e,this.updateVisibleColumns()},updateVisibleColumns(){this.visibleColumns={},this.columns.map(e=>{pe(e.is_visible)&&(this.visibleColumns[e.key]=e.label)})},updateFilterFields(e){e.forEach(t=>{t.isCustom&&t.type=="checkbox"&&t.value&&(t.value=Array.isArray(t.value)?t.value:t.value.split(","))}),this.customFields=e,this.filterOptions[4].section=e},filterData(){this.filterOptions.map(function(e){e.section.map(function(t){t.isCustom||(t.elements=[],t.isMultiple=!0),t.isPrepopulate=!1,t.value="",t.className="col-sm-4"})})},selectedFilters(e){switch(e){case"closeEvent":this.isShowFilter=!1;break;case"resetEvent":this.resetFilter();break;default:this.applyFilter(e)}},resetFilter(){this.apiUrl=this.filterIndex?"service-desk/api/software-license-list?filter_id="+this.licenseFilterId:"service-desk/api/software-license-list",this.updateFilterFields([]),window.emitter.emit("clearCustomFields"),this.filterOptions=this.filterOptions.map(function(e){return e.section.map(function(t){t.isCustom||(t.elements=[],t.isMultiple=!0),t.isPrepopulate=!1,t.value="",t.className="col-sm-4"}),e})},applyFilter(e){this.appliedFilters=e;for(const _ of this.customFields)_.value=e[_.name];let t="service-desk/api/software-license-list?",s=new URLSearchParams(je(this.filterOptions,e));const n=s,i=new URLSearchParams(n),h={};for(const[_,f]of i)h[_]=f;s.toString().endsWith("&")&&(s=s.toString().slice(0,-1)),this.apiUrl=t+s,this.exportData=this.reformatExportData(h)},toggleFilterView(){this.isShowFilter=!this.isShowFilter},reformatExportData(e){const t={};for(const s in e){const d=s.match(/([a-zA-Z_]+)\[(\d+)\]/);if(d){const[n,i,h]=d;t[i]=t[i]||[],t[i][h]=parseInt(e[s],10)}}return t},exportReport(){this.loading=!0;let e={};this.filterIndex&&(e.filter_id=this.licenseFilterId);const t={...this.exportData,total:this.dataCount},s={...this.exportData,...e,total:this.dataCount};S.post("api/agent/report-export/"+this.newReportId,this.filterIndex?s:t).then(d=>{U(d,"dataTableModal")}).catch(d=>{A(d,"dataTableModal")}).finally(()=>{this.loading=!1})},scheduleList(){this.requiredPayload=JSON.stringify(this.exportData);const e={...this.exportData,filter_id:this.licenseFilterId};this.$router.push({path:"/reports/schedule/add/"+this.licenseData.type+"/"+this.newReportId,query:{params:this.filterIndex?JSON.stringify(e):this.requiredPayload}})}},components:{"dynamic-datatable":Ze,"user-column-list":Ge,"software-license-filter":Dt}},tq={class:"col-sm-12"},sq={key:0,class:"card card-light"},aq={class:"card-header"},nq={id:"software-license-list",class:"card-title"},oq={class:"card-tools"},iq=a("span",{class:"glyphicon glyphicon-plus"},null,-1),lq=a("span",{class:"glyphicon glyphicon-filter"},null,-1),rq=[lq],dq=a("i",{class:"fas fa-paper-plane"},null,-1),cq=[dq],uq=a("i",{class:"fas fa-calendar"},null,-1),hq=[uq],mq={class:"card-body",id:"software-license-list"};function _q(e,t,s,d,n,i){const h=u("alert"),_=u("router-link"),f=u("software-license-filter"),p=u("user-column-list"),b=u("dynamic-datatable"),k=N("tooltip");return o(),l("div",tq,[m(h,{componentName:"dataTableModal"}),e.hasDataPopulated?(o(),l("div",sq,[a("div",aq,[a("h3",nq,r(e.lang("list_of_software_license")),1),a("div",oq,[w((o(),v(_,{class:"btn btn-tool",to:"/service-desk/software/license/create"},{default:y(()=>[iq]),_:1})),[[k,e.lang("create_software_license")]]),w((o(),l("a",{class:"btn btn-tool",href:"javascript:;",onClick:t[0]||(t[0]=(...D)=>i.toggleFilterView&&i.toggleFilterView(...D))},rq)),[[k,e.lang("filter")]]),e.showIcon?w((o(),l("a",{key:0,id:"export-report-btn",class:"btn btn-tool",onClick:t[1]||(t[1]=D=>i.exportReport()),href:"javascript:;"},cq)),[[k,e.lang("export")]]):c("",!0),e.showIcon?w((o(),l("a",{key:1,id:"schedule-report",class:"btn btn-tool",onClick:t[2]||(t[2]=D=>i.scheduleList()),href:"javascript:;"},hq)),[[k,e.lang("schedule")]]):c("",!0)])]),a("div",mq,[e.isShowFilter?(o(),v(f,{key:0,id:"filter-box",metaData:e.filterOptions,selectedFields:e.customFields,onSelectedFilters:i.selectedFilters,showCustomFilter:!0,updateFields:i.updateFilterFields,appliedFilters:e.appliedFilters,endPoint:"/custom-field-flattened?category=license&type=license&module=filter&filter_id="+e.licenseFilterId,filterFor:"license",closeFilter:i.toggleFilterView,filterNum:e.licenseFilterId,saveFilter:!0,deleteUrl:"/service-desk/api/agent/sd-filter/"+e.licenseFilterId,redirectTo:"/service-desk/software/license/list",save_endpoint:"/service-desk/api/agent/sd-filter"},null,8,["metaData","selectedFields","onSelectedFilters","updateFields","appliedFilters","endPoint","closeFilter","filterNum","deleteUrl"])):c("",!0),(o(!0),l(I,null,$(e.columnData,D=>(o(),l("section",{key:D},[m(p,{"table-columns":D.columns,reportId:D.id,columnId:e.newReportId},null,8,["table-columns","reportId","columnId"]),e.columns.length?(o(),v(b,{key:0,"data-url":e.apiUrl,columns:e.visibleColumns,columnsMeta:D.columns,staticColumns:e.staticColumns,show_pagination:e.showPagination},null,8,["data-url","columns","columnsMeta","staticColumns","show_pagination"])):c("",!0)]))),128))])])):c("",!0)])}const ks=C(eq,[["render",_q]]);const pq={name:"software-license-activity",description:"Software License activity page",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},props:{licenseId:{type:[String,Number],default:""}},data(){return{loading:!0,apiUrl:"/service-desk/api/software-license-log/"+this.licenseId,activity_log:[],perPage:"10",total:0,maxSize:5,pagination:1,paramsObj:{},filtering:!1,sort_key:"desc",refreshActivity:!1}},created(){window.emitter.on("updateLicenseLogs",()=>this.refreshActivity=!0)},beforeMount(){this.paramsObj.page=this.pagination,this.getValues(this.paramsObj)},watch:{pagination(e,t){this.filtering=!0;var s=document.getElementById("activity_log_div");return s.scrollIntoView({behavior:"smooth"}),this.paramsObj.page=e,this.getValues(this.paramsObj),e},filtering(e){this.$emit("loaderValue",e)},loading(e){this.$emit("loaderValue",e)},refreshActivity(e){e===!0&&this.getUpdateActivity(),this.refreshActivity=!1}},computed:{PerPage:function(){return this.perPage?parseInt(this.perPage):10},Records:function(){return this.total?parseInt(this.total):0}},methods:{getUpdateActivity(){this.pagination=1,this.sort_key="desc",this.perPage=10,this.total=0,this.paramsObj.page=1,this.paramsObj.limit=10,this.paramsObj["sort-order"]="desc",this.getValues(this.paramsObj)},commonFilter(){this.filtering=!0,this.pagination=1,this.paramsObj.page=1,this.getValues(this.paramsObj)},logLimit(e){this.paramsObj.limit=e,this.commonFilter()},orderBy(e){this.sort_key=e,this.paramsObj["sort-order"]=e,this.commonFilter()},getValues(e){S.get(this.apiUrl,{params:e}).then(t=>{this.loading=!1,this.filtering=!1,this.activity_log=t.data.data.SoftwareLicense_activity_logs.data,this.activity_log.forEach(function(s,d){s.name="<div>"+s.name+"</div>"}),this.total=t.data.data.SoftwareLicense_activity_logs.total,this.perPage=t.data.data.SoftwareLicense_activity_logs.per_page}).catch(t=>{this.loading=!1,this.filtering=!1})},checkDate(e){if(e==0)return!0;var t=this.formattedDate(this.activity_log[e-1].created_at),s=this.formattedDate(this.activity_log[e].created_at);if(t!=s)return!0},showThreadEnd(e){return e===this.activity_log.length-1}},components:{"activity-parser":xe}},Ve=e=>(K("data-v-04977b7e"),e=e(),z(),e),fq={class:"row",id:"activity_log_div"},gq={class:"col-sm-12 mb-2"},bq={key:0,id:"select_limit"},yq=Ve(()=>a("option",{value:"10"},"10",-1)),vq=Ve(()=>a("option",{value:"25"},"25",-1)),wq=Ve(()=>a("option",{value:"50"},"50",-1)),kq=Ve(()=>a("option",{value:"100"},"100",-1)),Cq=[yq,vq,wq,kq],Dq={key:1,id:"choose_order"},Sq={id:"sort_btn",type:"button","data-toggle":"dropdown",class:"btn btn-default dropdown-toggle"},Fq={class:"dropdown-menu",style:{"z-index":"9999"}},Mq=Ve(()=>a("i",{class:"fas fa-sort-amount-up"},null,-1)),Iq=Ve(()=>a("i",{class:"fas fa-sort-amount-down"},null,-1)),Aq={key:2,id:"page_div"},Pq={class:"col-md-12"},Tq={key:0,class:"timeline"},Vq={key:0,class:"time-label"},Lq={class:"bg-default border"},Uq=Ve(()=>a("i",{class:"far fa-dot-circle"},null,-1)),$q={class:"timeline-item"},Nq={class:"time"},Eq=Ve(()=>a("i",{class:"far fa-clock"},null,-1)),qq={key:0,class:"timeline-header"},Oq={class:"timeline-body break"},jq={key:1},Rq=Ve(()=>a("i",{class:"far fa-clock bg-gray"},null,-1)),xq=[Rq],Bq={key:1,class:"float-right",id:"page_div"},Kq={key:0,class:"col-sm-12"},zq={class:"text-center"};function Hq(e,t,s,d,n,i){const h=u("uib-pagination"),_=u("faveo-image-element"),f=u("router-link"),p=u("activity-parser");return o(),l("div",fq,[a("div",gq,[!n.loading&&n.activity_log.length>0?(o(),l("div",bq,[w(a("select",{class:"form-control cursor-pointer","onUpdate:modelValue":t[0]||(t[0]=b=>n.perPage=b),onChange:t[1]||(t[1]=b=>i.logLimit(n.perPage))},Cq,544),[[qe,n.perPage]])])):c("",!0),!n.loading&&n.activity_log.length>0?(o(),l("div",Dq,[a("button",Sq,r(e.lang("created_time"))+" - "+r(e.lang(n.sort_key)),1),a("div",Fq,[a("a",{href:"javascript:;",class:"dropdown-item",onClick:t[2]||(t[2]=b=>i.orderBy("asc"))},[Mq,g(" "+r(e.lang("asc")),1)]),a("a",{href:"javascript:;",onClick:t[3]||(t[3]=b=>i.orderBy("desc")),class:"dropdown-item"},[Iq,g(" "+r(e.lang("desc")),1)])])])):c("",!0),!n.loading&&n.total>10?(o(),l("div",Aq,[m(h,{id:"page2",records:i.Records,modelValue:n.pagination,"onUpdate:modelValue":t[4]||(t[4]=b=>n.pagination=b),class:"pagination","boundary-links":!1,"per-page":i.PerPage,options:{chunk:n.maxSize,chunksNavigation:"scroll"}},null,8,["records","modelValue","per-page","options"])])):c("",!0)]),a("div",Pq,[!n.loading&&n.activity_log.length>0?(o(),l("div",Tq,[(o(!0),l(I,null,$(n.activity_log,(b,k)=>(o(),l(I,null,[i.checkDate(k)?(o(),l("div",Vq,[a("span",Lq,r(d.formattedDate(b.created_at)),1)])):c("",!0),a("div",null,[Uq,a("div",$q,[a("span",Nq,[Eq,g(" "+r(d.formattedTime(b.created_at)),1)]),b.creator?(o(),l("h3",qq,[m(_,{id:"license_img","source-url":b.creator.profile_pic,classes:["img-circle","img-bordered-sm"],"alternative-text":"User Image","img-width":25,"img-height":25},null,8,["source-url"]),m(f,{to:"/user/"+b.creator.id},{default:y(()=>[g(" "+r(b.creator.full_name),1)]),_:2},1032,["to"])])):c("",!0),a("div",Oq,[m(p,{data:b.name},null,8,["data"])])])]),i.showThreadEnd(k)?(o(),l("div",jq,xq)):c("",!0)],64))),256))])):c("",!0),!n.loading&&n.total>10?(o(),l("div",Bq,[m(h,{id:"page2",records:i.Records,modelValue:n.pagination,"onUpdate:modelValue":t[5]||(t[5]=b=>n.pagination=b),class:"pagination","boundary-links":!1,"per-page":i.PerPage,options:{chunk:n.maxSize,chunksNavigation:"scroll"}},null,8,["records","modelValue","per-page","options"])])):c("",!0)]),!n.filtering&&!n.loading&&n.activity_log.length===0?(o(),l("div",Kq,[a("h6",zq,r(e.lang("no_data_found")),1)])):c("",!0)])}const Yq=C(pq,[["render",Hq],["__scopeId","data-v-04977b7e"]]),Wq={name:"asset-associate-detach",description:"Asset Associate Detach Modal component",props:{showModal:{type:Boolean,default:!1},licenseId:{type:[String,Number],default:""},associateId:{type:[String,Number],default:""},category:{type:String,default:""},onClose:{type:Function},compName:{type:String,default:""}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1}},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0;const e={type:this.category,type_ids:this.associateId};S.delete("service-desk/api/detach-software-license-services/"+this.licenseId,{data:e}).then(t=>{U(t,"software-license-view"),window.emitter.emit(this.compName+"refreshData"),window.emitter.emit("updateLicenseView"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(t=>{this.loading=!1,this.isDisabled=!1,this.onClose(),A(t,"software-license-view")})}}},Jq={class:"modal-title"},Gq={key:0},Zq={key:1,class:"row"},Qq=["disabled"],Xq=a("i",{class:"fas fa-unlink"},null,-1);function eO(e,t,s,d,n,i){const h=u("reuse-loader"),_=u("modal");return s.showModal?(o(),v(_,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{title:y(()=>[a("h4",Jq,r(e.trans("check_in")),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",Gq,[a("span",null,r(e.trans("are_you_sure")),1)])),n.loading?(o(),l("div",Zq,[m(h,{"animation-duration":4e3,color:"#1d78ff",size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=f=>i.onSubmit()),class:"btn btn-danger",disabled:n.isDisabled},[Xq,g(" "+r(e.trans("check_in")),1)],8,Qq)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const tO=C(Wq,[["render",eO]]);const sO={name:"software-license-associate-asset-table",description:"Software License associates asset table page",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime)}},props:{licenseId:{type:[String,Number],default:""},componentTitle:{type:String,default:""},columns:{type:Array,default:()=>[]},sortable:{type:Array,default:()=>[]},filterable:{type:Array,default:()=>[]},disableLoader:{type:Boolean,default:!1}},data(){return{options:{},showModal:!1,associateId:"",category:"",details:""}},computed:{apiEndPoint(){return"/service-desk/api/software-license-assets/"+this.licenseId}},beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},headings:{users:this.trans("users"),assets:this.trans("assets"),location:this.trans("location"),action:this.trans("action")},texts:{filter:"",limit:""},templates:{assets:function(t,s){return s.name?e.h(se,{to:"/service-desk/assets/"+s.id+"/show"},s.name):"---"},users:function(t,s){return s.meta_name?e.h(se,{to:"/user/"+s.id},s.meta_name?s.meta_name:s.full_name):s.used_by?e.h(se,{to:"/user/"+s.used_by.id},s.used_by.meta_name?s.used_by.meta_name:s.used_by.full_name):"---"},location:function(t,s){return s.location?s.location.title?s.location.title:s.location:"---"},action(t,s){let d=e.h("i",{class:"fa fa-unlink"}),n=e.h("span",e.trans("check_in"));const i=e.details.reassignable==="No"?"btn btn-danger disabled":"btn btn-danger";return e.h("a",{class:i,title:"Checkin",href:"javascript:;",onClick(){e.onDetach(s.id,s.name)}},[d,n])}},sortable:e.sortable,filterable:e.filterable,pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query,page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.results.data,count:t.data.total}}}},created(){window.emitter.on("fetchedData",this.handleData)},methods:{onDetach(e,t){t?this.category="sd_assets":this.category="users",this.associateId=e,this.showModal=!0},onClose(){this.showModal=!1},handleData(e){this.details=e},handelLoader(e){this.$emit("loaderValue",e)}},components:{"software-license-associate-detach":tO}},aO={id:"license_associates"};function nO(e,t,s,d,n,i){const h=u("data-table"),_=u("software-license-associate-detach");return o(),l("div",aO,[m(h,{url:i.apiEndPoint,dataColumns:s.columns,option:n.options,scroll_to:"license-associates",componentTitle:s.componentTitle,onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","componentTitle","onLoaderState","disableLoader"]),m(q,{name:"modal"},{default:y(()=>[n.showModal?(o(),v(_,{key:0,onClose:i.onClose,showModal:n.showModal,associateId:n.associateId,licenseId:s.licenseId,category:n.category,compName:s.componentTitle},null,8,["onClose","showModal","associateId","licenseId","category","compName"])):c("",!0)]),_:1})])}const oO=C(sO,[["render",nO]]);const iO={name:"software-license-associates",description:"Softwarelicense associates page",props:{licenseId:{type:[String,Number],default:""}},data(){return{tabs:[{id:"assets",title:"checked_out_seats",show:!0},{id:"activity",title:"activity_log",show:!0}],category:"assets",loading:!0,dynamicKeys:{activity:1,assets:1}}},created(){window.emitter.on("updatelicenseAssociates",this.updateAssociates),this.$store.dispatch("setLicenseAssociateCategory",this.category)},computed:{columns(){return["users","assets","location","action"]},filterable(){return["users","assets","location"]},sortable(){return["users","assets","location"]}},methods:{associates(e){this.category!==e&&(this.loading=!0,this.category=e),this.updateKey(e)},updateAssociates(e){this.associates(e)},handelLoader(e){this.loading=e},updateKey(e){this.dynamicKeys={...this.dynamicKeys,[e]:this.dynamicKeys[e]+1}}},watch:{category(e,t){e!==t&&this.$store.dispatch("setLicenseAssociateCategory",e)}},components:{"software-license-associate-asset-table":oO,"software-license-activity":Yq}},lO=e=>(K("data-v-0d9bc871"),e=e(),z(),e),rO={key:0,class:"card card-light card-tabs",id:"license-associates"},dO={class:"card-header p-0 pt-1"},cO={class:"nav nav-tabs"},uO={key:0,class:"nav-item"},hO=["onClick"],mO={class:"nav-item ml-auto mt-04"},_O={key:0,type:"button",class:"btn btn-tool rotating","data-card-widget":"refresh"},pO=lO(()=>a("i",{class:"fas fa-refresh"},null,-1)),fO=[pO],gO={class:"card-body"},bO={class:"tab-content"},yO={class:"active tab-pane",id:"activity"};function vO(e,t,s,d,n,i){const h=u("alert"),_=u("software-license-activity"),f=u("software-license-associate-asset-table");return n.tabs?(o(),l("div",rO,[m(h,{componentName:"software-license-associates"}),a("div",dO,[a("ul",cO,[(o(!0),l(I,null,$(n.tabs,p=>(o(),l(I,null,[p.show?(o(),l("li",uO,[a("a",{id:"license_tab",class:j(["nav-link",{active:n.category===p.id}]),"data-toggle":"pill",onClick:b=>i.associates(p.id)},r(e.trans(p.title)),11,hO)])):c("",!0)],64))),256)),a("li",mO,[n.loading?(o(),l("a",_O,fO)):c("",!0)])])]),a("div",gO,[a("div",bO,[a("div",yO,[n.category==="activity"?(o(),v(_,{licenseId:s.licenseId,onLoaderValue:i.handelLoader,key:"license_activity"+n.dynamicKeys.activity},null,8,["licenseId","onLoaderValue"])):c("",!0),n.category==="assets"?(o(),v(f,{columns:i.columns,"license-id":s.licenseId,sortable:i.sortable,filterable:i.filterable,"component-title":"SoftwareLicense "+n.category,onLoaderValue:i.handelLoader,disableLoader:"true",key:"license_asset"+n.dynamicKeys.assets},null,8,["columns","license-id","sortable","filterable","component-title","onLoaderValue"])):c("",!0)])])])])):c("",!0)}const wO=C(iO,[["render",vO],["__scopeId","data-v-0d9bc871"]]);const kO={name:"software-license-associate-modal",description:"Software License Associates Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},licenseId:{type:[String,Number],default:""},associate:{type:String,default:""}},data(){return{associated:[],loading:!1,availableSeats:"",showAlert:!1,category:""}},mounted(){this.availableSeats=this.licenseId.seats-this.licenseId.used_seats},created(){this.category=this.$store.getters.getLicenseAssociateCategory},computed:{endPoint(){if(this.associate==="user")return"/api/dependency/users?supplements[relation_name]=softwarelicense&supplements[attribute_name]=software_license_id&supplements[attribute_value]="+this.licenseId.id;if(this.associate==="assets")return"/service-desk/api/dependency/assets?supplements[relation_name]=softwarelicense&supplements[attribute_name]=software_license_id&supplements[attribute_value]="+this.licenseId.id}},methods:{onChange(e,t){this[t]=e},validateAttach(){this.associated.length<=this.availableSeats?(this.onSubmit(),this.showAlert=!1):this.showAlert=!0},onSubmit(){this.loading=!0;let e={},t=[];for(let s in this.associated)t.push(this.associated[s].id);this.associate==="assets"?e.type="sd_assets":e.type="users",e.type_ids=t,S.post("/service-desk/api/attach-software-license-services/"+this.licenseId.id,e).then(s=>{this.loading=!1,U(s,"software-license-associate-modal"),setTimeout(()=>{this.onClose(),window.emitter.emit("updateLicenseView"),this.category==="activity"?window.emitter.emit("updateLicenseLogs"):window.emitter.emit("SoftwareLicense assetsrefreshData")},4e3)}).catch(s=>{this.loading=!1,A(s,"software-license-associate-modal")})}},components:{"dynamic-select":G}},CO=e=>(K("data-v-2391a9e7"),e=e(),z(),e),DO={class:"modal-title"},SO={key:0},FO={class:"row"},MO={key:0,class:"seats ml-3"},IO={key:1,class:"row"},AO=["disabled"],PO=CO(()=>a("i",{class:"fas fa-paperclip"},null,-1));function TO(e,t,s,d,n,i){const h=u("alert"),_=u("dynamic-select"),f=u("reuse-loader"),p=u("modal");return s.showModal?(o(),v(p,{key:0,showModal:s.showModal,onClose:s.onClose},{title:y(()=>[a("h4",DO,r(e.trans("check_out_to")+" "+s.associate),1)]),fields:y(()=>[m(h,{componentName:"software-license-associate-modal"}),n.loading?c("",!0):(o(),l("div",SO,[a("div",FO,[m(_,{label:s.associate==="assets"?e.trans(s.associate):"User",hint:e.trans("available_seats")+n.availableSeats,multiple:!0,name:"associated",prePopulate:!1,classname:"col-sm-12",apiEndpoint:i.endPoint,value:n.associated,onChange:i.onChange,required:!0},null,8,["label","hint","apiEndpoint","value","onChange"]),n.showAlert?(o(),l("p",MO,r(e.trans("available_seats_alert:")+this.availableSeats),1)):c("",!0)])])),n.loading?(o(),l("div",IO,[m(f,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=b=>i.validateAttach()),class:"btn btn-primary",disabled:!(n.associated.length>0)},[PO,g(" "+r(e.trans("checkout")),1)],8,AO)]),_:1},8,["showModal","onClose"])):c("",!0)}const VO=C(kO,[["render",TO],["__scopeId","data-v-2391a9e7"]]);const LO={name:"software-license-actions",description:"Software License actions component",props:{license:{type:Object,default:()=>{}}},data(){return{showDeleteModal:!1,showAssociateModal:!1,associate:"",actions:""}},beforeMount(){this.getActions()},methods:{getActions(){this.actions="",S.get("/service-desk/api/software-license-action/"+this.license.id).then(e=>{this.actions=e.data.data.softwareLicense_actions}).catch(e=>{this.actions=""})},associateMethod(e){this.showAssociateModal=!0,this.associate=e},onClose(){this.showDeleteModal=!1,this.showAssociateModal=!1}},components:{"delete-modal":De,"software-license-associate-modal":VO}},rt=e=>(K("data-v-d933c1cb"),e=e(),z(),e),UO={class:"card-tools"},$O={key:0,class:"btn-group"},NO={type:"button",class:"btn btn-tool dropdown-toggle","data-toggle":"dropdown"},EO=rt(()=>a("i",{class:"fas fa-link"},null,-1)),qO={class:"dropdown-menu checkout-container"},OO=rt(()=>a("i",{class:"far fa-circle"},null,-1)),jO=rt(()=>a("i",{class:"far fa-circle"},null,-1)),RO=rt(()=>a("span",{class:"fas fa-edit"},null,-1)),xO=rt(()=>a("span",{class:"fas fa-trash"},null,-1)),BO=[xO];function KO(e,t,s,d,n,i){const h=u("router-link"),_=u("delete-modal"),f=u("software-license-associate-modal"),p=N("tooltip");return o(),l("div",UO,[s.license.used_seats!==s.license.seats?(o(),l("div",$O,[a("button",NO,[EO,g(" "+r(e.trans("checkout")),1)]),a("div",qO,[a("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[0]||(t[0]=b=>i.associateMethod("assets"))},[OO,g(" "+r(e.trans("checkout_to_asset")),1)]),a("a",{class:"dropdown-item text-dark",href:"javascript:;",onClick:t[1]||(t[1]=b=>i.associateMethod("user"))},[jO,g(" "+r(e.trans("checkout_to_user")),1)])])])):c("",!0),n.actions.edit_softwareLicense?w((o(),v(h,{key:1,class:"btn btn-tool",to:"/service-desk/software/license/"+s.license.id+"/edit"},{default:y(()=>[RO]),_:1},8,["to"])),[[p,e.lang("edit")]]):c("",!0),n.actions.delete_softwareLicense?w((o(),l("button",{key:2,class:"btn btn-tool",onClick:t[2]||(t[2]=b=>n.showDeleteModal=!0),href:"javascript:;"},BO)),[[p,e.lang("delete")]]):c("",!0),m(q,{name:"modal"},{default:y(()=>[n.showDeleteModal?(o(),v(_,{key:0,onClose:i.onClose,showModal:n.showDeleteModal,alertComponentName:"software-license-view",deleteUrl:"/service-desk/api/software-license-delete/"+s.license.id,redirectUrl:"/service-desk/software/license/list",from:"agent"},null,8,["onClose","showModal","deleteUrl"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showAssociateModal?(o(),v(f,{key:0,onClose:i.onClose,showModal:n.showAssociateModal,licenseId:s.license,associate:n.associate},null,8,["onClose","showModal","licenseId","associate"])):c("",!0)]),_:1})])}const zO=C(LO,[["render",KO],["__scopeId","data-v-d933c1cb"]]);const HO={name:"SoftwareLicenseDetails",description:"software license details Component",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime)}},props:{licenseId:{type:[String,Number],required:!0}},data(){return{licenseData:"",loading:!0,showDescription:!1,showDeleteModal:!1,refreshLicense:!1}},created(){window.emitter.on("updateLicenseView",()=>this.refreshLicense=!0)},beforeMount(){this.getData()},methods:{getData(){S.get("service-desk/api/software-license/"+this.licenseId).then(e=>{this.loading=!1,window.emitter.emit("fetchedData",e.data.data),this.licenseData=e.data.data}).catch(e=>{this.loading=!1})},subString(e,t=15){return oe(e,t)},onClose(){this.showDeleteModal=!1,this.showDescription=!1}},watch:{refreshLicense(e,t){e===!0&&this.getData(),this.refreshLicense=!1}},components:{"software-license-actions":zO,"delete-modal":De,"asset-description":Zs}},Mt=e=>(K("data-v-dec13976"),e=e(),z(),e),YO={class:"card card-light"},WO={class:"card-header"},JO={class:"card-title"},GO={class:"card-body"},ZO={class:"row"},QO={class:"col-md-12"},XO={class:"callout callout-info bg-info"},e7={class:"row"},t7={class:"col-md-4"},s7={class:"col-md-4"},a7={class:"col-md-4"},n7={class:"col-md-12"},o7={class:"row"},i7={class:"col-md-6 info-row d-flex"},l7={class:"col-md-6"},r7={class:"col-md-6"},d7={class:"text-primary"},c7={class:"col-md-6 info-row d-flex"},u7={class:"col-md-6"},h7={class:"col-md-6"},m7={class:"text-primary"},_7={class:"col-md-6 info-row d-flex"},p7={class:"col-md-6"},f7={class:"col-md-6"},g7={class:"text-primary"},b7={class:"col-md-6 info-row d-flex"},y7={class:"col-md-6"},v7={class:"col-md-6"},w7={class:"text-primary"},k7={class:"col-md-6 info-row d-flex"},C7={class:"col-md-6"},D7={class:"col-md-6"},S7={class:"text-primary"},F7={class:"col-md-6 info-row d-flex"},M7={class:"col-md-6"},I7={class:"col-md-6"},A7={class:"text-primary"},P7={class:"col-md-6 info-row d-flex"},T7={class:"col-md-6"},V7={class:"col-md-6"},L7={class:"text-primary"},U7={class:"col-md-6 info-row d-flex"},$7={class:"col-md-6"},N7={class:"col-md-6"},E7={class:"text-primary"},q7={class:"col-md-6 info-row d-flex"},O7={class:"col-md-6"},j7={class:"col-md-6"},R7={class:"text-primary"},x7={class:"col-md-6 info-row d-flex"},B7={class:"col-md-6"},K7={class:"col-md-6"},z7={class:"text-primary"},H7={class:"col-md-6 info-row d-flex"},Y7={class:"col-md-6"},W7={class:"col-md-6"},J7={class:"text-primary"},G7={class:"col-md-6 info-row d-flex"},Z7={class:"col-md-6"},Q7={class:"col-md-6"},X7={class:"text-primary"},ej={class:"col-md-6 info-row d-flex"},tj={class:"col-md-6"},sj={class:"col-md-6"},aj={class:"text-primary"},nj={class:"col-md-6 info-row d-flex"},oj={class:"col-md-6"},ij={class:"col-md-6"},lj={class:"text-primary"},rj={class:"col-md-6 info-row d-flex"},dj={class:"col-md-6"},cj={class:"col-md-6"},uj={class:"text-primary"},hj={class:"col-md-6 info-row d-flex"},mj={class:"col-md-6"},_j={class:"col-md-6"},pj={class:"text-primary"},fj={class:"col-md-6 info-row d-flex"},gj={class:"col-md-6"},bj={class:"col-md-6"},yj={class:"text-primary"},vj={class:"col-md-6 info-row d-flex"},wj={class:"col-md-6"},kj={class:"col-md-6"},Cj={class:"text-primary"},Dj={class:"col-md-6 info-row d-flex"},Sj={class:"col-md-6"},Fj={class:"col-md-6"},Mj=Mt(()=>a("i",{class:"fas fa-file-code"},"  ",-1)),Ij={class:"col-md-6 info-row d-flex"},Aj={class:"col-md-6"},Pj={class:"col-md-6"},Tj={key:0},Vj={onClick:"return false",class:"text-primary"},Lj={key:0},Uj={key:1,onClick:"return false",class:"text-primary"},$j={class:"col-md-6 info-row d-flex"},Nj={class:"col-md-6"},Ej={class:"col-md-6"},qj={key:0},Oj={class:"line"},jj=["src"],Rj=["href"],xj=Mt(()=>a("i",{class:"fas fa-download"},null,-1)),Bj=Mt(()=>a("br",null,null,-1)),Kj={key:1},zj=Mt(()=>a("hr",null,null,-1)),Hj={key:0,class:"card card-secondary"},Yj={class:"card-header"},Wj={class:"card-title"},Jj={class:"card-body"},Gj={class:"col-md-12 asset_row"},Zj={class:"row"},Qj={class:"col-md-6 info-row d-flex"},Xj={class:"col-md-6"},eR={class:"col-md-6"},tR={key:0},sR={onClick:"return false",class:"text-primary"},aR={key:0},nR={key:1,onClick:"return false",class:"text-primary"},oR={key:1,class:"card-body",id:"loader_margin"};function iR(e,t,s,d,n,i){const h=u("software-license-actions"),_=u("asset-description"),f=u("reuse-loader"),p=N("tooltip");return o(),l("div",YO,[!n.loading&&n.licenseData?(o(),l(I,{key:0},[a("div",WO,[w((o(),l("h3",JO,[g(r(i.subString(n.licenseData.name,50))+"("+r(n.licenseData.used_seats+"/"+n.licenseData.seats)+")",1)])),[[p,n.licenseData.name]]),m(h,{license:n.licenseData},null,8,["license"])]),a("div",GO,[a("div",ZO,[a("div",QO,[a("div",XO,[a("div",e7,[a("div",t7,[a("b",null,r(e.trans("created_date"))+" : ",1),w((o(),l("span",null,[g(r(d.formattedTime(n.licenseData.created_at)),1)])),[[p,d.formattedTime(n.licenseData.created_at)]])]),a("div",s7,[a("b",null,r(e.trans("purchase_order_number"))+" : ",1),w((o(),l("span",null,[g(r(n.licenseData.purchase_order_number?i.subString(n.licenseData.purchase_order_number):"---"),1)])),[[p,n.licenseData.purchase_order_number?n.licenseData.purchase_order_number:"---"]])]),a("div",a7,[a("b",null,r(e.trans("updated_at"))+" : ",1),w((o(),l("span",null,[g(r(d.formattedTime(n.licenseData.updated_at)),1)])),[[p,d.formattedTime(n.licenseData.updated_at)]])])])])])]),a("div",n7,[a("div",o7,[a("div",i7,[a("div",l7,[a("label",null,r(e.trans("licensed_to_email")),1)]),a("div",r7,[w((o(),l("a",d7,[g(r(n.licenseData.licensed_to_email?i.subString(n.licenseData.licensed_to_email):"---"),1)])),[[p,n.licenseData.licensed_to_email?n.licenseData.licensed_to_email:"---"]])])]),a("div",c7,[a("div",u7,[a("label",null,r(e.trans("license_key")),1)]),a("div",h7,[w((o(),l("a",m7,[g(r(n.licenseData.license_key?n.licenseData.license_key:"---"),1)])),[[p,n.licenseData.license_key?n.licenseData.license_key:"---"]])])]),a("div",_7,[a("div",p7,[a("label",null,r(e.trans("seats")),1)]),a("div",f7,[w((o(),l("a",g7,[g(r(n.licenseData.used_seats+"/"+n.licenseData.seats),1)])),[[p,n.licenseData.used_seats+"/"+n.licenseData.seats]])])]),a("div",b7,[a("div",y7,[a("label",null,r(e.trans("reassignable")),1)]),a("div",v7,[w((o(),l("a",w7,[g(r(n.licenseData.reassignable==="Yes"?"Yes":"No"),1)])),[[p,n.licenseData.reassignable==="Yes"?"Yes":"No"]])])]),a("div",k7,[a("div",C7,[a("label",null,r(e.trans("organization")),1)]),a("div",D7,[w((o(),l("a",S7,[g(r(n.licenseData.organization?i.subString(n.licenseData.organization.name):"---"),1)])),[[p,n.licenseData.organization?n.licenseData.organization.name:"---"]])])]),a("div",F7,[a("div",M7,[a("label",null,r(e.trans("manufacturers")),1)]),a("div",I7,[w((o(),l("a",A7,[g(r(n.licenseData.manufacturer?i.subString(n.licenseData.manufacturer.name):"---"),1)])),[[p,n.licenseData.manufacturer?n.licenseData.manufacturer.name:"---"]])])]),a("div",P7,[a("div",T7,[a("label",null,r(e.trans("vendor")),1)]),a("div",V7,[w((o(),l("a",L7,[g(r(n.licenseData.vendor?i.subString(n.licenseData.vendor.name):"---"),1)])),[[p,n.licenseData.vendor?n.licenseData.vendor.name:"---"]])])]),a("div",U7,[a("div",$7,[a("label",null,r(e.trans("depreciation")),1)]),a("div",N7,[w((o(),l("a",E7,[g(r(n.licenseData.depreciation?i.subString(n.licenseData.depreciation.name):"---"),1)])),[[p,n.licenseData.depreciation?n.licenseData.depreciation.name:"---"]])])]),a("div",q7,[a("div",O7,[a("label",null,r(e.trans("purchase_cost")),1)]),a("div",j7,[w((o(),l("a",R7,[g(r(n.licenseData.purchase_cost?n.licenseData.purchase_cost+" "+(n.licenseData.currency?n.licenseData.currency:""):0),1)])),[[p,n.licenseData.purchase_cost?n.licenseData.purchase_cost+" "+(n.licenseData.currency?n.licenseData.currency:""):0]])])]),a("div",x7,[a("div",B7,[a("label",null,r(e.trans("maintenance_cost")),1)]),a("div",K7,[w((o(),l("a",z7,[g(r(n.licenseData.maintenance_cost?n.licenseData.maintenance_cost+" "+(n.licenseData.currency?n.licenseData.currency:""):0),1)])),[[p,n.licenseData.maintenance_cost?n.licenseData.maintenance_cost+" "+(n.licenseData.currency?n.licenseData.currency:""):0]])])]),a("div",H7,[a("div",Y7,[a("label",null,r(e.trans("book_value")),1)]),a("div",W7,[w((o(),l("a",J7,[g(r(n.licenseData.book_value?n.licenseData.book_value+" "+n.licenseData.currency:"---"),1)])),[[p,n.licenseData.book_value?n.licenseData.book_value+" "+n.licenseData.currency:"---"]])])]),a("div",G7,[a("div",Z7,[a("label",null,r(e.trans("salvage")),1)]),a("div",Q7,[w((o(),l("a",X7,[g(r(n.licenseData.salvage?n.licenseData.salvage+" "+(n.licenseData.currency?n.licenseData.currency:""):0),1)])),[[p,n.licenseData.salvage?n.licenseData.salvage+" "+(n.licenseData.currency?n.licenseData.currency:""):0]])])]),a("div",ej,[a("div",tj,[a("label",null,r(e.trans("purchase_order_number")),1)]),a("div",sj,[w((o(),l("a",aj,[g(r(n.licenseData.purchase_order_number?n.licenseData.purchase_order_number:"---"),1)])),[[p,n.licenseData.purchase_order_number?n.licenseData.purchase_order_number:"---"]])])]),a("div",nj,[a("div",oj,[a("label",null,r(e.trans("version")),1)]),a("div",ij,[w((o(),l("a",lj,[g(r(n.licenseData.version?n.licenseData.version:"---"),1)])),[[p,n.licenseData.version?n.licenseData.version:"---"]])])]),a("div",rj,[a("div",dj,[a("label",null,r(e.trans("purchase_date")),1)]),a("div",cj,[w((o(),l("a",uj,[g(r(n.licenseData.purchase_date?n.licenseData.purchase_date:"---"),1)])),[[p,n.licenseData.purchase_date?n.licenseData.purchase_date:"---"]])])]),a("div",hj,[a("div",mj,[a("label",null,r(e.trans("renewal_date")),1)]),a("div",_j,[w((o(),l("a",pj,[g(r(n.licenseData.renewal_date?n.licenseData.renewal_date:"---"),1)])),[[p,n.licenseData.renewal_date?n.licenseData.renewal_date:"---"]])])]),a("div",fj,[a("div",gj,[a("label",null,r(e.trans("expiration_date")),1)]),a("div",bj,[w((o(),l("a",yj,[g(r(n.licenseData.expiration_date?n.licenseData.expiration_date:"---"),1)])),[[p,n.licenseData.expiration_date?n.licenseData.expiration_date:"---"]])])]),a("div",vj,[a("div",wj,[a("label",null,r(e.trans("license_type")),1)]),a("div",kj,[w((o(),l("a",Cj,[g(r(n.licenseData.license_type?i.subString(n.licenseData.license_type.name):"---"),1)])),[[p,n.licenseData.license_type?n.licenseData.license_type.name:"---"]])])]),a("div",Dj,[a("div",Sj,[a("label",null,r(e.trans("description")),1)]),a("div",Fj,[a("a",{href:"javascript:;",class:"btn btn-info btn-xs",onClick:t[0]||(t[0]=b=>n.showDescription=!0)},[Mj,g(r(e.trans("show_description")),1)])])]),n.licenseData.custom_field_values&&n.licenseData.custom_field_values.length>0?(o(!0),l(I,{key:0},$(n.licenseData.custom_field_values,b=>(o(),l("div",Ij,[a("div",Aj,[a("label",null,r(b.label),1)]),a("div",Pj,[Array.isArray(b.value)?(o(),l("div",Tj,[(o(!0),l(I,null,$(b.value,(k,D)=>w((o(),l("a",Vj,[g(r(k?i.subString(k):"---"),1),D!=Object.keys(b.value).length-1?(o(),l("span",Lj,",")):c("",!0),g("  ")])),[[p,k]])),256))])):w((o(),l("a",Uj,[g(r(b.field_type=="date"?b.value:b?i.subString(b.value):"---"),1)])),[[p,b.field_type=="date"?b.value:b.value?b.value.replace(/\r?\n/g,"<br />"):"---"]])])]))),256)):c("",!0),a("div",$j,[a("div",Nj,[a("label",null,r(e.trans("attachments")),1)]),a("div",Ej,[n.licenseData.attachments.length>0?(o(),l("span",qj,[(o(!0),l(I,null,$(n.licenseData.attachments,b=>(o(),l(I,null,[a("span",Oj,[w((o(),l("span",null,[a("img",{src:b.thumbnail_url,class:"attach_img"},null,8,jj),g(" "+r(i.subString(b.name,15))+" "+r("("+b.size+")"),1)])),[[p,b.name]]),w((o(),l("a",{id:"download",href:b.download_url},[g("   "),xj],8,Rj)),[[p,e.trans("download")]])]),Bj],64))),256))])):(o(),l("span",Kj,"---"))])])])]),zj,n.licenseData.custom_field_values_for_software_license_type&&n.licenseData.custom_field_values_for_software_license_type.length>0?(o(),l("div",Hj,[a("div",Yj,[a("h3",Wj,r(n.licenseData.license_type.name+" "+e.trans("properties")),1)]),a("div",Jj,[a("div",Gj,[a("div",Zj,[(o(!0),l(I,null,$(n.licenseData.custom_field_values_for_software_license_type,b=>(o(),l("div",Qj,[a("div",Xj,[a("label",null,r(b.label),1)]),a("div",eR,[Array.isArray(b.value)?(o(),l("div",tR,[(o(!0),l(I,null,$(b.value,(k,D)=>w((o(),l("a",sR,[g(r(i.subString(k)),1),D!=Object.keys(b.value).length-1?(o(),l("span",aR,",")):c("",!0),g("  ")])),[[p,k]])),256))])):w((o(),l("a",nR,[g(r(b.field_type=="date"?b.value:i.subString(b.value)),1)])),[[p,b.value]])])]))),256))])])])])):c("",!0)]),n.showDescription?(o(),v(_,{key:0,onClose:i.onClose,showModal:n.showDescription,description:n.licenseData.description},null,8,["onClose","showModal","description"])):c("",!0)],64)):c("",!0),n.loading?(o(),l("div",oR,[m(f,{"animation-duration":4e3,size:60})])):c("",!0)])}const lR=C(HO,[["render",iR],["__scopeId","data-v-dec13976"]]);const rR={name:"software-license-view",description:"SoftwareLicense view page",computed:{licenseId(){return W(this.currentPath())}},data(){return{loading:!1}},components:{"software-license-associates":wO,"software-license-details":lR}},dR={class:"col-sm-12"};function cR(e,t,s,d,n,i){const h=u("alert"),_=u("software-license-details"),f=u("software-license-associates");return o(),l("div",dR,[m(h,{componentName:"software-license-view"}),m(_,{licenseId:i.licenseId},null,8,["licenseId"]),m(f,{licenseId:i.licenseId},null,8,["licenseId"])])}const uR=C(rR,[["render",cR]]),hR={name:"softwarelicense-form",props:{category:{type:String,required:!0},panel:{type:String,default:"agent"},showViewButton:{type:Boolean,default:!1}},data(){return{fetchFormFieldApi:"/api/form/render/",formUniqueKey:null,submitFormInProgress:!1,editId:"",selectedForm:"",formSelected:!1}},mixins:[ve],beforeMount(){if(this.mode==="edit"){const e=W(this.currentPath());this.fetchFormFieldApi="service-desk/api/edit-software-license/"+e,this.editId=W(this.currentPath()),this.formSelected=!0}else this.getDefaultFormValue()},computed:{mode(){return this.currentPath().indexOf("edit")!==-1?"edit":"create"}},methods:{getDefaultFormValue(){this.showLoader=!0,S.get("/from/forms/"+this.category).then(e=>{this.selectedForm=e.data.data.data[0],this.showLoader=!1,this.updateFetchApi()}).catch(e=>{this.showLoader=!1,A(e,"faveo-form")})},updateFetchApi(){this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey),this.$store.dispatch("unsetValidationError"),this.fetchFormFieldApi="/render/form?id="+this.selectedForm.id+"&mode=render",setTimeout(()=>{this.$store.dispatch("createNewFormInstance",{formUniqueKey:this.formUniqueKey,scenario:this.scenario||this.mode}),this.formSelected=!0},1)},afterSubmit(e){window.emitter.emit("updateAgentSidebar"),this.$store.dispatch("destroyFormInsatnce",this.formUniqueKey);let t=Je(this.category);this.$store.dispatch("createNewFormInstance",{formUniqueKey:t,scenario:this.mode}),this.formUniqueKey=t,this.mode==="create"&&setTimeout(()=>{let s=e.data.data.id;this.$router.push("/service-desk/software/license/"+s+"/show")},1e3)}},components:{FormRenderer:we,CustomLoader:Ne,Alert:ke,FaveoBox:Re}},mR={class:"col-sm-12"},_R={key:0,class:"pull-right"},pR=a("span",null,[a("i",{class:"fas fa-eye"})],-1),fR={key:0,class:"form-group row mt-3"},gR={class:"col-md-12"},bR=["disabled"],yR={key:0},vR=a("i",{class:"fas fa-sync"},null,-1),wR=[vR],kR={key:1},CR=a("i",{class:"fas fa-save"},null,-1),DR=[CR];function SR(e,t,s,d,n,i){const h=u("Alert"),_=u("CustomLoader"),f=u("router-link"),p=u("FormRenderer"),b=u("ValidationObserver"),k=u("FaveoBox"),D=N("tooltip");return o(),l("div",mR,[n.formUniqueKey&&n.formSelected?(o(),v(k,{key:0,title:e.lang(i.mode)},{headerMenu:y(()=>[s.showViewButton?(o(),l("span",_R,[w((o(),v(f,{to:"/service-desk/software/license/"+n.editId+"/show",class:"btn btn-tool has-tooltip"},{default:y(()=>[pR]),_:1},8,["to"])),[[D,e.trans("view")]])])):c("",!0)]),default:y(()=>[m(h,{componentName:"faveo-form"}),m(h,{componentName:"form-renderer"}),e.showLoader||n.submitFormInProgress?(o(),v(_,{key:0,duration:4e3})):c("",!0),m(b,{ref:"faveoFormObserver"},{default:y(({values:P,errors:E,validate:M})=>[(o(),v(p,{key:n.formUniqueKey,fetchFormFieldApi:n.fetchFormFieldApi,formUniqueKey:n.formUniqueKey,scenario:i.mode,category:s.category,panel:s.panel,selectDependencyId:n.editId},null,8,["fetchFormFieldApi","formUniqueKey","scenario","category","panel","selectDependencyId"])),e.showLoader?c("",!0):(o(),l("div",fR,[a("div",gR,[a("button",{type:"button",class:"btn btn-primary pull-right",disabled:n.submitFormInProgress,onClick:t[0]||(t[0]=F=>e.onSubmit())},[i.mode==="edit"?(o(),l("span",yR,wR)):(o(),l("span",kR,DR)),g(" "+r(i.mode==="edit"?e.trans("update"):e.trans("submit")),1)],8,bR)])]))]),_:1},512)]),_:1},8,["title"])):c("",!0)])}const Cs=C(hR,[["render",SR]]);const FR={name:"product-list",description:"Product lists table component",data:()=>({columns:["name","manufacturer","product_status","status","actions"],options:{},apiUrl:"/service-desk/api/product-list"}),beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-up",down:"glyphicon-chevron-down"},texts:{filter:"",limit:""},headings:{name:e.lang("name"),manufacturer:e.lang("manufacturer"),product_status:e.lang("product_status"),status:e.lang("status"),actions:e.lang("actions")},columnsClasses:{name:"product-name",manufacturer:"product-man",product_status:"product_status",status:"product-status"},templates:{status:function(t,s){let d=e.h("span",{class:s.status===1?"btn btn-success btn-xs pointer_normal":"btn btn-danger btn-xs pointer_normal"},s.status===1?"Enable":"Disable");return e.h("a",{class:"pointer_normal"},[d])},product_status:function(t,s){return s.product_status?e.h("span",{},[e.h("i",{class:s.product_status.icon_class,style:{color:s.product_status.icon_color,marginRight:"5px"}})],s.product_status.name):"---"},manufacturer:function(t,s){return s.manufacturer?s.manufacturer:"--"},actions:(t,s)=>e.h(_e,{data:s})},sortable:["name","manufacturer","status"],filterable:["name","manufacturer","status"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.products.map(s=>(s.edit_url="/service-desk/products/"+s.id+"/edit",s.view_url="/service-desk/products/"+s.id+"/show",s.delete_url=e.basePath()+"/service-desk/api/product-delete/"+s.id,s)),count:t.data.total}}}}},MR={class:"col-sm-12"},IR={class:"card card-light"},AR={class:"card-header"},PR={id:"product-list",class:"card-title"},TR={class:"card-tools"},VR=a("span",{class:"glyphicon glyphicon-plus"},null,-1),LR={class:"card-body",id:"product-table"};function UR(e,t,s,d,n,i){const h=u("alert"),_=u("router-link"),f=u("data-table"),p=N("tooltip");return o(),l("div",MR,[m(h,{componentName:"dataTableModal"}),a("div",IR,[a("div",AR,[a("h3",PR,r(e.lang("list_of_product")),1),a("div",TR,[w((o(),v(_,{class:"btn btn-tool",to:"/service-desk/products/create"},{default:y(()=>[VR]),_:1})),[[p,e.lang("create_new_product")]])])]),a("div",LR,[m(f,{url:e.apiUrl,dataColumns:e.columns,option:e.options,scroll_to:"product-list"},null,8,["url","dataColumns","option"])])])])}const $R=C(FR,[["render",UR]]);function NR(e){const{name:t,manufacturer:s,product_status:d,product_proc_mode:n,department:i,description:h,assetType:_}=e;var f={name:[t,"isRequired"],manufacturer:[s,"isRequired"],product_proc_mode:[n,"isRequired"],product_status:[d,"isRequired"],department:[i,"isRequired"],description:[h,"isRequired"]};const p=new ce(ae),{errors:b,isValid:k}=p.validate(f);return ie.dispatch("setValidationError",b),{errors:b,isValid:k}}const ER={data(){return{title:"create_new_product",iconClass:"fas fa-save",btnName:"save",hasDataPopulated:!1,loading:!1,product_id:"",name:"",status:1,radioOptions:[{name:"enable",value:1},{name:"disable",value:0}],manufacturer:"",product_status:"",product_proc_mode:"",department:"",description:"",assetType:"",assetDisabled:!1}},beforeMount(){const e=window.location.pathname;this.getValues(e)},methods:{getValues(e){const t=W(e);e.indexOf("edit")>=0?(this.title="edit_product",this.iconClass="fas fa-sync",this.btnName="update",this.hasDataPopulated=!1,this.getInitialValues(t)):(this.loading=!1,this.hasDataPopulated=!0)},getInitialValues(e){this.loading=!0,S.get("/service-desk/api/product/"+e).then(t=>{this.loading=!1,this.hasDataPopulated=!0,this.updateStatesWithData(t.data.data.product),this.product_id=t.data.data.product.id}).catch(t=>{this.loading=!1})},updateStatesWithData(e){const t=this,s=this.$data;Object.keys(e).map(d=>{s.hasOwnProperty(d)&&(t[d]=e[d])}),this.product_proc_mode=e.procurement,this.assetType=e.asset_type,this.assetDisabled=!!e.asset_type},isValid(){const{errors:e,isValid:t}=NR(this.$data);return!!t},onChange(e,t){this[t]=e,e===null&&(this[t]="")},onSubmit(){if(this.isValid()){this.loading=!0;var e=new FormData;this.product_id!=""&&e.append("id",this.product_id),e.append("name",this.name),e.append("status_id",this.status),this.product_status&&this.product_status.id&&e.append("product_status_id",this.product_status.id),e.append("manufacturer",this.manufacturer),this.department&&this.department.id&&e.append("department_id",this.department.id),this.product_proc_mode&&this.product_proc_mode.id&&e.append("procurement_mode_id",this.product_proc_mode.id),e.append("description",this.description),e.append("asset_type_id",this.assetType?this.assetType.id:"");const t={headers:{"Content-Type":"multipart/form-data"}};S.post("/service-desk/api/product",e,t).then(s=>{this.loading=!1,U(s,"product"),this.product_id?this.getInitialValues(this.product_id):setTimeout(()=>{let d=s.data.data.id;this.$router.push("/service-desk/products/"+d+"/show")},3e3)}).catch(s=>{this.loading=!1,A(s,"product")})}}},components:{"text-field":le,"dynamic-select":G,"radio-button":Ee}},qR={class:"col-sm-12"},OR={key:0,class:"row"},jR={key:1,class:"card card-light"},RR={class:"card-header"},xR={class:"card-title"},BR={class:"card-tools"},KR=a("i",{class:"fas fa-eye"},null,-1),zR={class:"card-body"},HR={class:"row"},YR={class:"row"},WR={class:"row"},JR={class:"row"},GR={class:"row"},ZR={class:"card-footer"};function QR(e,t,s,d,n,i){const h=u("custom-loader"),_=u("alert"),f=u("router-link"),p=u("text-field"),b=u("radio-button"),k=u("dynamic-select"),D=u("tiny-editor"),P=N("tooltip"),E=N("focus-first-input");return o(),l("div",qR,[!n.hasDataPopulated||n.loading?(o(),l("div",OR,[m(h,{duration:4e3})])):c("",!0),m(_,{componentName:"product"}),n.hasDataPopulated?(o(),l("div",jR,[a("div",RR,[a("h3",xR,r(e.lang(n.title)),1),a("div",BR,[n.product_id?w((o(),v(f,{key:0,class:"btn btn-tool",type:"button",to:"/service-desk/products/"+n.product_id+"/show"},{default:y(()=>[KR]),_:1},8,["to"])),[[P,e.trans("view")]]):c("",!0)])]),a("div",zR,[w((o(),l("div",HR,[m(p,{label:e.lang("name"),value:n.name,type:"text",name:"name",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold"]),m(b,{options:n.radioOptions,label:e.lang("status"),name:"status",value:n.status,onChange:i.onChange,classname:"form-group col-sm-4"},null,8,["options","label","value","onChange"])])),[[E]]),a("div",YR,[m(p,{label:e.lang("manufacturer"),value:n.manufacturer,type:"text",name:"manufacturer",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold"]),m(k,{label:e.lang("product_status"),multiple:!1,name:"product_status",prePopulate:!1,classname:"col-sm-6",apiEndpoint:"/service-desk/api/status/list?module=6",value:n.product_status,onChange:i.onChange,required:!0,clearable:!!n.product_status},null,8,["label","value","onChange","clearable"])]),a("div",WR,[m(k,{label:e.lang("product_mode_procurement"),multiple:!1,name:"product_proc_mode",prePopulate:!1,classname:"col-sm-6",apiEndpoint:"/service-desk/api/dependency/product_proc_mode",value:n.product_proc_mode,onChange:i.onChange,required:!0,clearable:!!n.product_proc_mode},null,8,["label","value","onChange","clearable"]),m(k,{label:e.lang("department_access"),multiple:!1,name:"department",prePopulate:!1,classname:"col-sm-6",apiEndpoint:"/api/dependency/departments",value:n.department,onChange:i.onChange,clearable:!!n.department,required:!0},null,8,["label","value","onChange","clearable"])]),a("div",JR,[m(k,{label:e.lang("asset_type"),multiple:!1,name:"assetType",disabled:n.assetDisabled,prePopulate:!1,classname:"col-sm-6",apiEndpoint:"/service-desk/api/dependency/asset_types",value:n.assetType,onChange:i.onChange,clearable:!!n.assetType},null,8,["label","disabled","value","onChange","clearable"])]),a("div",GR,[m(D,{value:n.description,type:"text",onChange:i.onChange,name:"description",label:e.lang("description"),classname:"col-xs-12",required:!0},null,8,["value","onChange","label"])])]),a("div",ZR,[a("button",{id:"submit_btn",class:"btn btn-primary",onClick:t[0]||(t[0]=M=>i.onSubmit())},[a("i",{class:j(n.iconClass)},null,2),g(" "+r(e.lang(n.btnName)),1)])])])):c("",!0)])}const Ds=C(ER,[["render",QR]]),XR={name:"release-add-modal",description:"Release add Modal component",props:{showModal:{type:Boolean,default:!1},productId:{type:[String,Number],default:""},onClose:{type:Function}},data(){return{isDisabled:!0,containerStyle:{width:"500px"},loading:!1,vendorIds:""}},methods:{onChange(e,t){this[t]=e,this.isDisabled=!(this.vendorIds.length>0)},onSubmit(){this.loading=!0,this.isDisabled=!0;const e={};e.vendor_ids=this.vendorIds.map(s=>s.id),e.product_id=this.productId;const t={headers:{"Content-Type":"application/json"}};S.post("/service-desk/api/product/attach/vendor",e,t).then(s=>{U(s,"product-view"),window.emitter.emit("ProductVendorsrefreshData"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(s=>{this.loading=!1,this.isDisabled=!0,A(s,"product-view"),this.onClose()})}},components:{"dynamic-select":G}},ex={class:"modal-title"},tx={key:0},sx={class:"row"},ax={key:1,class:"row"},nx=["disabled"],ox=a("i",{class:"fas fa-check"},null,-1);function ix(e,t,s,d,n,i){const h=u("dynamic-select"),_=u("reuse-loader"),f=u("modal");return s.showModal?(o(),v(f,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{title:y(()=>[a("h4",ex,r(e.lang("vendor")),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",tx,[a("div",sx,[m(h,{label:e.lang("vendor"),multiple:!0,name:"vendorIds",prePopulate:!1,classname:"col-sm-12",value:n.vendorIds,onChange:i.onChange,required:!0,apiEndpoint:"/service-desk/api/dependency/vendors_based_on_product?product_id="+s.productId},null,8,["label","value","onChange","apiEndpoint"])])])),n.loading?(o(),l("div",ax,[m(_,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=p=>i.onSubmit()),class:"btn btn-primary",disabled:n.isDisabled},[ox,g(" "+r(e.lang("proceed")),1)],8,nx)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const lx=C(XR,[["render",ix]]);const rx={name:"release-add-modal",description:"Release add Modal component",props:{showModal:{type:Boolean,default:!1},productId:{type:[String,Number],default:""},onClose:{type:Function}},data(){return{isDisabled:!1,containerStyle:{width:"800px"},loading:!1}},methods:{onSubmit(){this.$refs.vendorCreate.onSubmit()},onCompleted(){window.emitter.emit("ProductVendorsrefreshData"),this.onClose()}},components:{vendor:Tt}},dx={class:"modal-title"},cx={key:0},ux={key:1,class:"row"},hx=["disabled"],mx=a("i",{class:"fas fa-save"},null,-1);function _x(e,t,s,d,n,i){const h=u("vendor"),_=u("reuse-loader"),f=u("modal");return s.showModal?(o(),v(f,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle,modalBodyClass:"vendor_fields"},{title:y(()=>[a("h4",dx,r(e.lang("vendor")),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",cx,[m(h,{from:"modal",ref:"vendorCreate",product_id:s.productId,onComplete:i.onCompleted,alertName:"product-view",tinyMceWidth:"100%"},null,8,["product_id","onComplete"])])),n.loading?(o(),l("div",ux,[m(_,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=p=>i.onSubmit()),class:"btn btn-primary",disabled:n.isDisabled},[mx,g(" "+r(e.lang("save")),1)],8,hx)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const px=C(rx,[["render",_x]]);const fx={name:"product-assets",description:"Product asset Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},productId:{type:[String,Number],default:""}},data(){return{used_by_ids:"",asset_type_ids:"",managed_by_ids:"",org_ids:"",isDisabled:!0,containerStyle:{width:"950px"},loading:!1,size:60,apiUrl:"",assetIds:[],selectedFilters:{},componentTitle:"ProductAssets"}},watch:{assetIds(e){this.isDisabled=!(e.length>0)}},methods:{onChange(e,t){window.emitter.emit(this.componentTitle+"uncheckCheckbox"),this[t]=e||"",this.selectedFilters[t]=e||""},onApply(){let e="/service-desk/api/asset-list?product_id="+this.productId+"&",t="";for(var s in this.selectedFilters)this.selectedFilters[s].id&&(t+=s+"="+this.selectedFilters[s].id+"&");t[t.length-1]==="&"&&(t=t.slice(0,-1)),this.apiUrl=e+t},assetsData(e){this.assetIds=e},onSubmit(){if(this.assetIds.length>0){this.loading=!0;const e={};e.asset_ids=this.assetIds,e.product_id=this.productId;const t={headers:{"Content-Type":"application/json"}};S.post("/service-desk/api/product/attach-asset",e,t).then(s=>{this.loading=!1,U(s,"product-view"),window.emitter.emit(this.componentTitle+"refreshData"),this.onClose()}).catch(s=>{this.loading=!1,A(s,"product-view"),this.onClose()})}}},components:{"asset-list-with-checkbox":Oe,"dynamic-select":G}},gx={class:"modal-title"},bx={class:"row"},yx={class:"col-sm-12"},vx=a("span",{class:"fas fa-check"},null,-1),wx=a("br",null,null,-1),kx={class:"height-limit"},Cx={key:0,class:"row"},Dx=["disabled"],Sx=a("i",{class:"fas fa-save"},null,-1);function Fx(e,t,s,d,n,i){const h=u("dynamic-select"),_=u("asset-list-with-checkbox"),f=u("custom-loader"),p=u("modal");return o(),l("div",null,[s.showModal?(o(),v(p,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{title:y(()=>[a("h4",gx,r(e.lang("attach_assets")),1)]),fields:y(()=>[a("div",bx,[m(h,{label:e.lang("asset_types"),multiple:!1,name:"asset_type_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"/service-desk/api/dependency/asset_types",value:n.asset_type_ids,onChange:i.onChange,clearable:!!n.asset_type_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),m(h,{label:e.lang("used_by"),multiple:!1,name:"used_by_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"api/dependency/users?meta=true",value:n.used_by_ids,onChange:i.onChange,clearable:!!n.used_by_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),m(h,{label:e.lang("managed_by"),multiple:!1,name:"managed_by_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"api/dependency/agents?meta=true",value:n.managed_by_ids,onChange:i.onChange,clearable:!!n.managed_by_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),m(h,{label:e.lang("organizations"),multiple:!1,name:"org_ids",prePopulate:!1,classname:"col-sm-3",apiEndpoint:"api/dependency/organizations",value:n.org_ids,onChange:i.onChange,clearable:!!n.org_ids,strlength:"10"},null,8,["label","value","onChange","clearable"]),a("div",yx,[a("button",{id:"apply-btn",class:"btn btn-primary round-btn float-left",type:"button",onClick:t[0]||(t[0]=b=>i.onApply())},[vx,g("  "+r(e.lang("apply")),1)])])]),wx,a("div",kx,[n.apiUrl?(o(),v(_,{key:0,apiUrl:n.apiUrl,tickets:i.assetsData,componentTitle:n.componentTitle,from:"admin"},null,8,["apiUrl","tickets","componentTitle"])):c("",!0)]),n.loading===!0?(o(),l("div",Cx,[m(f,{duration:4e3})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[1]||(t[1]=b=>i.onSubmit()),class:"btn btn-primary",disabled:n.isDisabled},[Sx,g(" "+r(e.lang("attach")),1)],8,Dx)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)])}const Mx=C(fx,[["render",Fx]]),Ix={name:"product-actions",description:"Product actions component",props:{product:{type:Object,default:()=>{}}},data(){return{showDeleteModal:!1,showVendorCreate:!1,showVendorExists:!1,showAttach:!1}},methods:{subString(e,t=15){return oe(e,t)},onClose(){this.showDeleteModal=!1,this.showVendorCreate=!1,this.showVendorExists=!1,this.showAttach=!1,this.$store.dispatch("unsetValidationError")}},components:{"delete-modal":De,"vendor-add-modal":lx,"vendor-create-modal":px,"product-assets":Mx}},Ax={class:"card-tools"},Px={class:"btn-group"},Tx={type:"button",class:"btn btn-tool dropdown-toggle","data-toggle":"dropdown"},Vx=a("i",{class:"fas fa-link"},null,-1),Lx={class:"dropdown-menu"},Ux={class:"nav-item"},$x={class:"nav-item"},Nx=a("i",{class:"fas fa-server"},null,-1),Ex={class:"btn-group"},qx={type:"button",class:"btn btn-tool dropdown-toggle","data-toggle":"dropdown"},Ox=a("i",{class:"fas fa-cog"},null,-1),jx={class:"dropdown-menu dropdown-menu-right"},Rx={class:"nav-item"},xx={class:"nav-item"};function Bx(e,t,s,d,n,i){const h=u("router-link"),_=u("delete-modal"),f=u("vendor-create-modal"),p=u("vendor-add-modal"),b=u("product-assets");return o(),l("div",Ax,[a("div",Px,[a("button",Tx,[Vx,g(" "+r(e.lang("vendor")),1)]),a("ul",Lx,[a("li",Ux,[a("a",{class:"nav-link text-dark",href:"javascript:;",onClick:t[0]||(t[0]=k=>n.showVendorCreate=!0)},r(e.lang("new_vendor")),1)]),a("li",$x,[a("a",{class:"nav-link text-dark",href:"javascript:;",onClick:t[1]||(t[1]=k=>n.showVendorExists=!0)},r(e.lang("existing_vendor")),1)])])]),a("button",{class:"btn btn-tool",onClick:t[2]||(t[2]=k=>n.showAttach=!0)},[Nx,g(" "+r(e.lang("attach_asset")),1)]),a("div",Ex,[a("button",qx,[Ox,g(" "+r(e.lang("more")),1)]),a("ul",jx,[a("li",Rx,[m(h,{class:"nav-link text-dark",to:"/service-desk/products/"+s.product.id+"/edit"},{default:y(()=>[g(r(e.lang("edit")),1)]),_:1},8,["to"])]),a("li",xx,[a("a",{class:"nav-link text-dark",href:"javascript:;",onClick:t[3]||(t[3]=k=>n.showDeleteModal=!0)},r(e.lang("delete")),1)])])]),m(q,{name:"modal"},{default:y(()=>[n.showDeleteModal?(o(),v(_,{key:0,onClose:i.onClose,showModal:n.showDeleteModal,alertComponentName:"product-view",deleteUrl:"/service-desk/api/product-delete/"+s.product.id,redirectUrl:"/service-desk/products"},null,8,["onClose","showModal","deleteUrl"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showVendorCreate?(o(),v(f,{key:0,onClose:i.onClose,showModal:n.showVendorCreate,productId:s.product.id},null,8,["onClose","showModal","productId"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showVendorExists?(o(),v(p,{key:0,onClose:i.onClose,showModal:n.showVendorExists,productId:s.product.id},null,8,["onClose","showModal","productId"])):c("",!0)]),_:1}),m(q,{name:"modal"},{default:y(()=>[n.showAttach?(o(),v(b,{key:0,onClose:i.onClose,showModal:n.showAttach,productId:s.product.id},null,8,["onClose","showModal","productId"])):c("",!0)]),_:1})])}const Kx=C(Ix,[["render",Bx]]);const zx={name:"change-description",description:"Change description Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},description:{type:String,default:""}}},Hx={class:"modal-title"},Yx={id:"log_desc"},Wx=["innerHTML"];function Jx(e,t,s,d,n,i){const h=u("modal");return s.showModal?(o(),v(h,{key:0,showModal:s.showModal,onClose:s.onClose},{title:y(()=>[a("h4",Hx,r(e.lang("description")),1)]),fields:y(()=>[a("div",Yx,[a("span",{innerHTML:s.description},null,8,Wx)])]),_:1},8,["showModal","onClose"])):c("",!0)}const Gx=C(zx,[["render",Jx],["__scopeId","data-v-4bff2a23"]]);const Zx={name:"product-details",description:"Product details page",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},props:{product:{type:Object,default:()=>{}}},data(){return{showDescription:!1}},methods:{subString(e,t=15){return oe(e,t)},onClose(){this.showDescription=!1,this.$store.dispatch("unsetValidationError")}},components:{"product-actions":Kx,"product-description":Gx}},Qx=e=>(K("data-v-890c09ff"),e=e(),z(),e),Xx={class:"card card-light"},e9={class:"card-header"},t9={class:"card-title text-capitalize"},s9={class:"card-body"},a9={class:"row"},n9={class:"col-md-12"},o9={class:"callout callout-info bg-info"},i9={class:"row"},l9={class:"col-md-4"},r9={class:"col-md-4 text-center"},d9={class:"col-md-4"},c9={class:"col-md-12"},u9={class:"row"},h9={class:"col-md-6 info-row d-flex"},m9={class:"col-md-6"},_9={class:"col-md-6"},p9={class:"text-primary"},f9={class:"col-md-6 info-row d-flex"},g9={class:"col-md-6"},b9={class:"col-md-6"},y9={key:0,class:"text-primary"},v9={key:1},w9={class:"col-md-6 info-row d-flex"},k9={class:"col-md-6"},C9={class:"col-md-6"},D9={class:"text-primary"},S9={class:"col-md-6 info-row d-flex"},F9={class:"col-md-6"},M9={class:"col-md-6"},I9=Qx(()=>a("i",{class:"fas fa-file-code"}," ",-1)),A9={class:"col-md-6 info-row d-flex"},P9={class:"col-md-6"},T9={class:"col-md-6"},V9={key:0,class:"text-primary"},L9={key:1};function U9(e,t,s,d,n,i){const h=u("product-actions"),_=u("product-description"),f=N("tooltip");return o(),l("div",Xx,[a("div",e9,[w((o(),l("h3",t9,[g(r(i.subString(s.product.name,50)),1)])),[[f,s.product.name]]),m(h,{product:s.product},null,8,["product"])]),a("div",s9,[a("div",a9,[a("div",n9,[a("div",o9,[a("div",i9,[a("div",l9,[a("b",null,r(e.lang("created_date"))+" : ",1),w((o(),l("span",null,[g(r(d.formattedTime(s.product.created_at)),1)])),[[f,d.formattedTime(s.product.created_at)]])]),a("div",r9,[a("b",null,r(e.lang("status"))+" : ",1),w((o(),l("span",null,[g(r(s.product.status?e.lang("enable"):e.lang("disable")),1)])),[[f,s.product.status?"Enable":"Disable"]])]),a("div",d9,[a("b",null,r(e.lang("manufacturer"))+" : ",1),w((o(),l("span",null,[g(r(i.subString(s.product.manufacturer)),1)])),[[f,s.product.manufacturer]])])])])])]),a("div",c9,[a("div",u9,[a("div",h9,[a("div",m9,[a("label",null,r(e.lang("product_status")),1)]),a("div",_9,[w((o(),l("a",p9,[g(r(i.subString(s.product.product_status.name)),1)])),[[f,s.product.product_status.name]])])]),a("div",f9,[a("div",g9,[a("label",null,r(e.lang("department_access")),1)]),a("div",b9,[s.product.department?w((o(),l("a",y9,[g(r(i.subString(s.product.department.name)),1)])),[[f,s.product.department.name]]):(o(),l("p",v9,"---"))])]),a("div",w9,[a("div",k9,[a("label",null,r(e.lang("product_mode_procurement")),1)]),a("div",C9,[w((o(),l("a",D9,[g(r(i.subString(s.product.procurement.name)),1)])),[[f,s.product.procurement.name]])])]),a("div",S9,[a("div",F9,[a("label",null,r(e.lang("description")),1)]),a("div",M9,[a("a",{href:"javascript:;",class:"btn btn-info btn-xs",onClick:t[0]||(t[0]=p=>n.showDescription=!0)},[I9,g(r(e.lang("show_description")),1)])])]),a("div",A9,[a("div",P9,[a("label",null,r(e.lang("asset_type")),1)]),a("div",T9,[s.product.asset_type?w((o(),l("a",V9,[g(r(i.subString(s.product.asset_type.name)),1)])),[[f,s.product.asset_type.name]]):(o(),l("p",L9,"---"))])])])])]),m(q,{name:"modal"},{default:y(()=>[n.showDescription?(o(),v(_,{key:0,onClose:i.onClose,showModal:n.showDescription,description:s.product.description},null,8,["onClose","showModal","description"])):c("",!0)]),_:1})])}const $9=C(Zx,[["render",U9],["__scopeId","data-v-890c09ff"]]),N9={name:"detach-modal",description:"Detach Modal component",props:{showModal:{type:Boolean,default:!1},detachId:{type:[String,Number],default:""},compName:{type:String,default:""},alertCompName:{type:String,default:"product-view"},productId:{type:[String,Number],default:""},onClose:{type:Function}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1}},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0;let e=this.compName==="ProductAssets"?"/service-desk/api/product/detach-asset/"+this.productId+"/"+this.detachId:"/service-desk/api/product/detach-vendor/"+this.productId+"/"+this.detachId;S.delete(e).then(t=>{U(t,"product-view"),window.emitter.emit("updateProductData"),window.emitter.emit(this.compName+"refreshData"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(t=>{this.loading=!1,this.isDisabled=!0,A(t,"product-view"),this.onClose()})}}},E9={class:"modal-title"},q9={key:0},O9={key:1,class:"row"},j9=["disabled"],R9=a("i",{class:"fas fa-unlink","aria-hidden":"true"},null,-1);function x9(e,t,s,d,n,i){const h=u("reuse-loader"),_=u("modal");return s.showModal?(o(),v(_,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{title:y(()=>[a("h4",E9,r(e.lang("detach")),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",q9,[a("span",null,r(e.lang("are_you_sure")),1)])),n.loading?(o(),l("div",O9,[m(h,{"animation-duration":4e3,size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=f=>i.onSubmit()),class:"btn btn-danger",disabled:n.isDisabled},[R9,g(" "+r(e.lang("detach")),1)],8,j9)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const B9=C(N9,[["render",x9]]),K9={name:"product-associates-actions",description:"Contains detach button which can be used as a component as whole. It is built basically for displaying deatch button in a datable.",props:{data:{type:Object,required:!0}},data(){return{showModal:!1}},methods:{onClose(){this.showModal=!1,this.$store.dispatch("unsetValidationError")}},components:{"product-detach":B9}},z9={class:"btn-group"},H9=a("i",{class:"fas fa-unlink"},null,-1),Y9=[H9];function W9(e,t,s,d,n,i){const h=u("product-detach"),_=N("tooltip");return o(),l("div",z9,[s.data.detach?w((o(),l("a",{key:0,id:"detach-button",onClick:t[0]||(t[0]=()=>n.showModal=!0),href:"javascript:;",class:"btn btn-primary"},Y9)),[[_,e.lang("detach")]]):c("",!0),m(q,{name:"modal"},{default:y(()=>[n.showModal?(o(),v(h,{key:0,onClose:i.onClose,showModal:n.showModal,detachId:s.data.id,productId:s.data.product_id,compName:s.data.compName},null,8,["onClose","showModal","detachId","productId","compName"])):c("",!0)]),_:1})])}const J9=C(K9,[["render",W9]]);const G9={name:"changes-associates-table",description:"Changes associates table page",props:{category:{type:String,default:"assets"},apiUrl:{type:String,default:""},productId:{type:[String,Number],default:""},componentTitle:{type:String,default:""},disableLoader:{type:Boolean,default:!1}},data(){return{columns:[],options:{},apiEndPoint:this.apiUrl}},beforeMount(){this.columns=this.category==="assets"?["name","managed_by","used_by","contract","action"]:["name","email","primary_contact","action"];const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},headings:{name:this.lang("name"),managed_by:this.lang("managed_by"),used_by:this.lang("used_by"),contract:this.lang("contract"),email:this.lang("email"),primary_contact:this.lang("primary_contact"),action:this.lang("action")},columnsClasses:{name:"associate-name",managed_by:"associate-manage",used_by:"associate-used",contract:"associate-contract",action:"associate-action"},texts:{filter:"",limit:""},templates:{name:function(t,s){var d=e.category==="vendors"?"vendor":e.category;let n=d=="vendor"?"":e.basePath()+"/panel";return d=="vendor"?e.h(se,{to:"/service-desk/"+d+"/"+s.id+"/show"},s.name):e.h("a",{href:n+"/service-desk/"+d+"/"+s.id+"/show",target:"_blank"},s.name)},contract:function(t,s){return s.contract?e.h("a",{href:e.basePath()+"/panel/service-desk/contracts/"+s.contract.id+"/show",target:"_blank"},s.contract.name):"--"},used_by:function(t,s){return s.used_by?e.h("a",{href:e.basePath()+"/panel/user/"+s.used_by.id,target:"_blank"},s.used_by.first_name.length>0||s.used_by.last_name.length>0?s.used_by.first_name+" "+s.used_by.last_name:s.used_by.user_name):"--"},managed_by:function(t,s){return s.managed_by?e.h("a",{href:e.basePath()+"/panel/user/"+s.managed_by.id,target:"_blank"},s.managed_by.first_name.length>0||s.managed_by.last_name.length>0?s.managed_by.first_name+" "+s.managed_by.last_name:s.managed_by.user_name):"--"},action:(t,s)=>e.h(J9,{data:s})},sortable:["name"],filterable:["name"],pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){let s=e.category==="assets"?"data":e.category;return{data:t.data[s].map(d=>(d.detach=!0,d.product_id=e.productId,d.compName=e.componentTitle,d)),count:t.data.total}}}},methods:{handelLoader(e){this.$emit("loaderValue",e)}}};function Z9(e,t,s,d,n,i){const h=u("data-table");return o(),v(h,{url:n.apiEndPoint,dataColumns:n.columns,option:n.options,scroll_to:"product-associates",componentTitle:s.componentTitle,onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","componentTitle","onLoaderState","disableLoader"])}const Q9=C(G9,[["render",Z9]]);const X9={name:"product-associates",description:"Product associates page",props:{productId:{type:[String,Number],default:""},product:{type:Object,default:()=>{}}},data(){return{tabs:[{id:"assets",title:"associated_assets"},{id:"vendors",title:"associated_vendors"}],category:"assets",loading:!0,tabLoading:!1,disableLoader:!0}},computed:{apiUrl(){return this.category==="assets"?"/service-desk/api/asset-list?product_ids="+this.productId:"service-desk/api/product/vendor/"+this.productId},compTitle(){return this.category==="assets"?"ProductAssets":"ProductVendors"}},methods:{associates(e){this.category!==e&&(this.tabLoading=!0,this.loading=!0,this.category=e,setTimeout(()=>{this.tabLoading=!1},1))},handelLoader(e){this.loading=e}},components:{"product-associates-table":Q9}},eB=e=>(K("data-v-166bb14a"),e=e(),z(),e),tB={id:"product-associates"},sB={class:"card card-light card-tabs"},aB={class:"card-header p-0 pt-1"},nB={class:"nav nav-tabs",role:"tablist"},oB=["onClick"],iB={class:"nav-item ml-auto mt-04"},lB={key:0,type:"button",class:"btn btn-tool rotating","data-card-widget":"refresh"},rB=eB(()=>a("i",{class:"fas fa-refresh"},null,-1)),dB=[rB],cB={class:"card-body"},uB={class:"tab-content"},hB={class:"tab-pane active",role:"tabpanel"},mB={key:0};function _B(e,t,s,d,n,i){const h=u("alert"),_=u("product-associates-table");return o(),l("div",tB,[m(h,{componentName:"ProductAssociates"}),a("div",sB,[a("div",aB,[a("ul",nB,[(o(!0),l(I,null,$(n.tabs,f=>(o(),l("li",{key:f.id,class:"nav-item"},[a("a",{id:"product_tab",onClick:p=>i.associates(f.id),class:j(["nav-link",{active:n.category===f.id}]),"data-toggle":"pill",role:"tab"},r(e.lang(f.title)),11,oB)]))),128)),a("li",iB,[n.loading?(o(),l("a",lB,dB)):c("",!0)])])]),a("div",cB,[a("div",uB,[a("div",hB,[n.tabLoading?c("",!0):(o(),l("div",mB,[m(_,{category:n.category,componentTitle:i.compTitle,productId:s.productId,apiUrl:i.apiUrl,disableLoader:n.disableLoader,onLoaderValue:i.handelLoader},null,8,["category","componentTitle","productId","apiUrl","disableLoader","onLoaderValue"])]))])])])])])}const pB=C(X9,[["render",_B],["__scopeId","data-v-166bb14a"]]),fB={name:"product-view",description:"Product view page",data(){return{product:"",product_id:"",loading:!0}},created(){window.emitter.on("updateProductData",this.getValues)},beforeMount(){this.getValues()},methods:{getValues(){const e=window.location.pathname;this.product_id=W(e),S.get("/service-desk/api/product/"+this.product_id).then(t=>{this.loading=!1,this.product=t.data.data.product}).catch(t=>{this.loading=!1})}},components:{"product-details":$9,"product-associates":pB}},gB={class:"col-sm-12"},bB={key:1,class:"row"};function yB(e,t,s,d,n,i){const h=u("alert"),_=u("product-details"),f=u("product-associates"),p=u("reuse-loader");return o(),l("div",gB,[m(h,{componentName:"product-view"}),n.loading?c("",!0):(o(),l(I,{key:0},[(o(),v(_,{product:n.product,key:n.product_id},null,8,["product"])),m(f,{productId:n.product_id,product:n.product},null,8,["productId","product"])],64)),n.loading?(o(),l("div",bB,[m(p,{"animation-duration":4e3,size:60})])):c("",!0)])}const vB=C(fB,[["render",yB]]);const wB={name:"procurement-type-list",description:"Procurement type lists table component",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime)}},data:()=>({columns:["name","created_at","updated_at","action"],options:{},apiUrl:"/service-desk/api/procurement-mode-list"}),beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-up",down:"glyphicon-chevron-down"},texts:{filter:"",limit:""},headings:{name:e.lang("name"),created_at:e.lang("created-at"),updated_at:e.lang("updated-at"),action:e.lang("action")},columnsClasses:{name:"procurement-type-name",created_at:"procurement-type-created",updated_at:"procurement-type-updated"},templates:{created_at(t,s){return e.formattedTime(s.created_at)},updated_at(t,s){return e.formattedTime(s.updated_at)},action:(t,s)=>e.h(_e,{data:s})},sortable:["name","created_at","updated_at"],filterable:["name","created_at","updated_at"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.procurement_modes.map(s=>(s.edit_url="/service-desk/procurement/"+s.id+"/edit",s.delete_url=e.basePath()+"/service-desk/api/procurement-mode/"+s.id,s)),count:t.data.total}}}}},kB={class:"col-sm-12"},CB={class:"card card-light procurement-type-table"},DB={class:"card-header"},SB={id:"procurement-type-list",class:"card-title"},FB={class:"card-tools"},MB=a("span",{class:"glyphicon glyphicon-plus"},null,-1),IB={class:"card-body",id:"procurement-type-table"};function AB(e,t,s,d,n,i){const h=u("alert"),_=u("router-link"),f=u("data-table"),p=N("tooltip");return o(),l("div",kB,[m(h,{componentName:"dataTableModal"}),a("div",CB,[a("div",DB,[a("h3",SB,r(e.lang("list_of_procurements")),1),a("div",FB,[w((o(),v(_,{class:"btn btn-tool",to:"/service-desk/procurement/create"},{default:y(()=>[MB]),_:1})),[[p,e.lang("add-procurement")]])])]),a("div",IB,[m(f,{url:e.apiUrl,dataColumns:e.columns,option:e.options,scroll_to:"procurement-type-list"},null,8,["url","dataColumns","option"])])])])}const PB=C(wB,[["render",AB]]);function TB(e){const{name:t}=e;var s={name:[t,"isRequired"]};const d=new ce(ae),{errors:n,isValid:i}=d.validate(s);return ie.dispatch("setValidationError",n),{errors:n,isValid:i}}const VB={data(){return{title:"open_new_procurment",iconClass:"fas fa-save",btnName:"save",hasDataPopulated:!1,loading:!1,procurement_type_id:"",name:""}},beforeMount(){const e=window.location.pathname;this.getValues(e)},methods:{getValues(e){const t=W(e);e.indexOf("edit")>=0?(this.title="edit-procurement",this.iconClass="fas fa-sync",this.btnName="update",this.hasDataPopulated=!1,this.getInitialValues(t)):(this.loading=!1,this.hasDataPopulated=!0)},getInitialValues(e){this.loading=!0,S.get("/service-desk/api/procurement-mode/"+e).then(t=>{this.loading=!1,this.hasDataPopulated=!0,this.name=t.data.data.procurement_mode.name,this.procurement_type_id=t.data.data.procurement_mode.id}).catch(t=>{this.loading=!1,this.hasDataPopulated=!0,A(t,"procurementType")})},isValid(){const{errors:e,isValid:t}=TB(this.$data);return!!t},onChange(e,t){this[t]=e},onSubmit(){if(this.isValid()){this.loading=!0;var e=new FormData;this.procurement_type_id!=""&&e.append("id",this.procurement_type_id),e.append("name",this.name);const t={headers:{"Content-Type":"multipart/form-data"}};S.post("/service-desk/api/procurement-mode",e,t).then(s=>{this.loading=!1,U(s,"procurementType"),this.procurement_type_id||setTimeout(()=>{this.$router.push({name:"Procurement Index"})},3e3)}).catch(s=>{this.loading=!1,A(s,"procurementType")})}},triggerEvent(e){var t=e.which||e.keyCode;t===13&&this.onSubmit()}},components:{"text-field":le}},LB={class:"col-sm-12"},UB={key:0,class:"row"},$B={key:1,class:"card card-light"},NB={class:"card-header"},EB={class:"card-title"},qB={class:"card-body"},OB={class:"row"},jB={class:"card-footer"};function RB(e,t,s,d,n,i){const h=u("custom-loader"),_=u("alert"),f=u("text-field"),p=N("focus-first-input");return o(),l("div",LB,[!n.hasDataPopulated||n.loading?(o(),l("div",UB,[m(h,{duration:4e3})])):c("",!0),m(_,{componentName:"procurementType"}),n.hasDataPopulated?(o(),l("div",$B,[a("div",NB,[a("h3",EB,r(e.lang(n.title)),1)]),a("div",qB,[w((o(),l("div",OB,[m(f,{label:e.lang("name"),value:n.name,type:"text",name:"name",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-6",keyupListener:i.triggerEvent,required:!0},null,8,["label","value","onChange","placehold","keyupListener"])])),[[p]])]),a("div",jB,[a("button",{id:"submit_btn",class:"btn btn-primary",onClick:t[0]||(t[0]=b=>i.onSubmit())},[a("i",{class:j(n.iconClass)},null,2),g(" "+r(e.lang(n.btnName)),1)])])])):c("",!0)])}const Ss=C(VB,[["render",RB]]);const xB={name:"contract-type-list",description:"Contract type lists table component",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime)}},data:()=>({columns:["name","created_at","updated_at","action"],options:{},apiUrl:"/service-desk/api/contract-type-list"}),beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-up",down:"glyphicon-chevron-down"},texts:{filter:"",limit:""},headings:{name:e.lang("name"),created_at:e.lang("created-at"),updated_at:e.lang("updated-at"),action:e.lang("action")},columnsClasses:{name:"contract-type-name",created_at:"contract-type-created",updated_at:"contract-type-updated"},templates:{created_at(t,s){return e.formattedTime(s.created_at)},updated_at(t,s){return e.formattedTime(s.updated_at)},action:(t,s)=>e.h(_e,{data:s})},sortable:["name","created_at","updated_at"],filterable:["name","created_at","updated_at"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.contract_types.map(s=>(s.edit_url="/service-desk/contract-type/"+s.id+"/edit",s.delete_url=e.basePath()+"/service-desk/api/contract-type/"+s.id,s)),count:t.data.total}}}}},BB={class:"col-sm-12"},KB={class:"card card-light contract-type-table"},zB={class:"card-header"},HB={id:"contract-type-list",class:"card-title"},YB={class:"card-tools"},WB=a("span",{class:"glyphicon glyphicon-plus"},null,-1),JB={class:"card-body",id:"contract-type-table"};function GB(e,t,s,d,n,i){const h=u("alert"),_=u("router-link"),f=u("data-table"),p=N("tooltip");return o(),l("div",BB,[m(h,{componentName:"dataTableModal"}),a("div",KB,[a("div",zB,[a("h3",HB,r(e.lang("list_of_contract_types")),1),a("div",YB,[w((o(),v(_,{class:"btn btn-tool",to:"/service-desk/contract-type/create"},{default:y(()=>[WB]),_:1})),[[p,e.lang("create_new_contract_type")]])])]),a("div",JB,[m(f,{url:e.apiUrl,dataColumns:e.columns,option:e.options,scroll_to:"contract-type-list"},null,8,["url","dataColumns","option"])])])])}const ZB=C(xB,[["render",GB]]);const QB={name:"license-type-list",description:"License type lists table component",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime)}},data:()=>({columns:["name","created_at","updated_at","action"],options:{},apiUrl:"/service-desk/api/license-type-list"}),beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},texts:{filter:"",limit:""},headings:{name:e.lang("name"),created_at:e.lang("created_at"),updated_at:e.lang("updated_at"),action:e.lang("action")},columnsClasses:{name:"license-type-name",created_at:"license-type-created",updated_at:"license-type-updated"},templates:{created_at(t,s){return e.formattedTime(s.created_at)},updated_at(t,s){return e.formattedTime(s.updated_at)},action:(t,s)=>e.h(_e,{data:s})},sortable:["name","created_at","updated_at"],filterable:["name","created_at","updated_at"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.license_types.map(s=>(s.edit_url="/service-desk/license-type/"+s.id+"/edit",s.delete_url=e.basePath()+"/service-desk/api/license-type/"+s.id,s)),count:t.data.total}}}}},XB={class:"col-sm-12"},eK={class:"card card-light license-type-table"},tK={class:"card-header"},sK={id:"license-type-list",class:"card-title"},aK={class:"card-tools"},nK=a("span",{class:"glyphicon glyphicon-plus"},null,-1),oK={class:"card-body",id:"license-type-table"};function iK(e,t,s,d,n,i){const h=u("alert"),_=u("router-link"),f=u("data-table"),p=N("tooltip");return o(),l("div",XB,[m(h,{componentName:"dataTableModal"}),a("div",eK,[a("div",tK,[a("h3",sK,r(e.lang("list_of_license_types")),1),a("div",aK,[w((o(),v(_,{class:"btn btn-tool",to:"/service-desk/license-type/create"},{default:y(()=>[nK]),_:1})),[[p,e.lang("add-license-type")]])])]),a("div",oK,[m(f,{url:e.apiUrl,dataColumns:e.columns,option:e.options,scroll_to:"license-type-list"},null,8,["url","dataColumns","option"])])])])}const lK=C(QB,[["render",iK]]);function rK(e){const{name:t}=e;var s={name:[t,"isRequired"]};const d=new ce(ae),{errors:n,isValid:i}=d.validate(s);return ie.dispatch("setValidationError",n),{errors:n,isValid:i}}const dK={data(){return{title:"open_new_license_type",iconClass:"fas fa-save",btnName:"save",hasDataPopulated:!1,loading:!1,license_type_id:"",name:""}},beforeMount(){const e=window.location.pathname;this.getValues(e)},methods:{getValues(e){const t=W(e);e.indexOf("edit")>=0?(this.title="edit_license_type",this.iconClass="fas fa-sync",this.btnName="update",this.hasDataPopulated=!1,this.getInitialValues(t)):(this.loading=!1,this.hasDataPopulated=!0)},getInitialValues(e){this.loading=!0,S.get("/service-desk/api/license-type/"+e).then(t=>{this.loading=!1,this.hasDataPopulated=!0,this.name=t.data.data.license_type.name,this.license_type_id=t.data.data.license_type.id}).catch(t=>{this.loading=!1,this.hasDataPopulated=!0,A(t,"licenseType")})},isValid(){const{errors:e,isValid:t}=rK(this.$data);return!!t},onChange(e,t){this[t]=e},onSubmit(){if(this.isValid()){this.loading=!0;var e=new FormData;this.license_type_id!=""&&e.append("id",this.license_type_id),e.append("name",this.name);const t={headers:{"Content-Type":"multipart/form-data"}};S.post("/service-desk/api/license-type",e,t).then(s=>{this.loading=!1,U(s,"licenseType"),this.license_type_id||setTimeout(()=>{this.$router.push({name:"License Types Index"})},3e3)}).catch(s=>{this.loading=!1,A(s,"licenseType")})}},triggerEvent(e){var t=e.which||e.keyCode;t===13&&this.onSubmit()}},components:{"text-field":le}},cK={class:"col-sm-12"},uK={key:0,class:"row"},hK={key:1,class:"card card-light"},mK={class:"card-header"},_K={class:"card-title"},pK={class:"card-body"},fK={class:"row"},gK={class:"card-footer"};function bK(e,t,s,d,n,i){const h=u("custom-loader"),_=u("alert"),f=u("text-field"),p=N("focus-first-input");return o(),l("div",cK,[!n.hasDataPopulated||n.loading?(o(),l("div",uK,[m(h,{duration:4e3})])):c("",!0),m(_,{componentName:"licenseType"}),n.hasDataPopulated?(o(),l("div",hK,[a("div",mK,[a("h3",_K,r(e.lang(n.title)),1)]),a("div",pK,[w((o(),l("div",fK,[m(f,{label:e.lang("name"),value:n.name,type:"text",name:"name",onChange:i.onChange,placehold:e.lang("enter_a_value"),keyupListener:i.triggerEvent,classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold","keyupListener"])])),[[p]])]),a("div",gK,[a("button",{id:"submit_btn",class:"btn btn-primary",onClick:t[0]||(t[0]=b=>i.onSubmit())},[a("i",{class:j(n.iconClass)},null,2),g(" "+r(e.lang(n.btnName)),1)])])])):c("",!0)])}const Fs=C(dK,[["render",bK]]);const yK={name:"vendor-list",description:"Vendor lists table component",data:()=>({columns:["name","primary_contact","mobile","email","address","status","actions"],options:{},apiUrl:"/service-desk/api/vendor-list"}),beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-up",down:"glyphicon-chevron-down"},texts:{filter:"",limit:""},headings:{name:this.lang("name"),email:this.lang("email"),primary_contact:this.lang("primary_contact"),address:this.lang("address"),status:this.lang("status"),actions:this.lang("actions")},columnsClasses:{name:"vendor-name",email:"vendor-email",primary_contact:"vendor-contact",address:"vendor-address",mobile:"vendor-mobile"},templates:{status:(t,s)=>e.h(Ta,{data:s}),actions:(t,s)=>e.h(_e,{data:s}),primary_contact(t,s){const d=s.primary_contact||"--",n=s.phone_country_code?"+"+s.phone_country_code+" ":"",i=s.ext?"-"+s.ext:"";return`${n}${d}${i}`},mobile(t,s){return s.mobile&&s.country_code?"+"+s.country_code+" "+s.mobile:s.mobile?s.mobile:"--"}},sortable:["name","primary_contact","mobile","email","address","status"],filterable:["name","primary_contact","mobile","email","address","status"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.vendors.map(s=>(s.view_url="/service-desk/vendor/"+s.id+"/show",s.edit_url="/service-desk/vendor/"+s.id+"/edit",s.delete_url=e.basePath()+"/service-desk/api/vendor/"+s.id,s)),count:t.data.total}}}}},vK={class:"col-sm-12"},wK={class:"card card-light"},kK={class:"card-header"},CK={id:"vendor-list",class:"card-title"},DK={class:"card-tools"},SK=a("span",{class:"glyphicon glyphicon-plus"},null,-1),FK={class:"card-body",id:"vendor-table"};function MK(e,t,s,d,n,i){const h=u("alert"),_=u("router-link"),f=u("data-table"),p=N("tooltip");return o(),l("div",vK,[m(h,{componentName:"dataTableModal"}),a("div",wK,[a("div",kK,[a("h3",CK,r(e.lang("list_of_vendors")),1),a("div",DK,[w((o(),v(_,{class:"btn btn-tool",to:"/service-desk/vendor/create"},{default:y(()=>[SK]),_:1})),[[p,e.lang("create_vendors")]])])]),a("div",FK,[m(f,{url:e.apiUrl,dataColumns:e.columns,option:e.options,scroll_to:"vendor-list"},null,8,["url","dataColumns","option"])])])])}const IK=C(yK,[["render",MK]]);const AK={name:"vendor-modal",description:"Vendor Modal component",props:{showModal:{type:Boolean,default:!1},data:{type:[Object,String],default:()=>{}},title:{type:String,default:""},onClose:{type:Function}},data:()=>({containerStyle:{width:"500px"},loading:!1,isDisabled:!1}),beforeMount(){this.title!=="delete"&&(this.containerStyle.width="800px")},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,S.delete("/service-desk/api/vendor/"+this.data.id).then(e=>{U(e,"vendor-view"),this.afterRespond(),setTimeout(()=>{this.$router.push({name:"Vendor Index"})},3e3)}).catch(e=>{A(e,"vendor-view"),this.afterRespond()})},afterRespond(){this.onClose(),this.loading=!1,this.isDisabled=!0}}},PK={class:"modal-title"},TK={key:0},VK={key:0},LK={key:1,id:"log_desc"},UK=["innerHTML"],$K={key:1,class:"row"},NK=["disabled"],EK=a("i",{class:"fas fa-trash","aria-hidden":"true"},null,-1);function qK(e,t,s,d,n,i){const h=u("reuse-loader"),_=u("modal");return o(),l("div",null,[s.showModal?(o(),v(_,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:e.containerStyle},vt({title:y(()=>[a("h4",PK,r(e.lang(s.title)),1)]),fields:y(()=>[e.loading?c("",!0):(o(),l("div",TK,[s.title==="delete"?(o(),l("span",VK,r(e.lang("are_you_sure_you_want_to_delete")),1)):(o(),l("div",LK,[a("span",{innerHTML:s.data.description},null,8,UK)]))])),e.loading?(o(),l("div",$K,[m(h,{"animation-duration":4e3,color:"#1d78ff",size:60})])):c("",!0)]),_:2},[s.title==="delete"?{name:"controls",fn:y(()=>[a("button",{type:"button",onClick:t[0]||(t[0]=(...f)=>i.onSubmit&&i.onSubmit(...f)),class:"btn btn-danger",disabled:e.isDisabled},[EK,g(" "+r(e.lang("delete")),1)],8,NK)]),key:"0"}:void 0]),1032,["showModal","onClose","containerStyle"])):c("",!0)])}const OK=C(AK,[["render",qK]]);const jK={name:"vendor-associates-table",description:"Vendor associates table",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},props:{vendorId:{type:[String,Number],default:""},category:{type:String,default:""},disableLoader:{type:Boolean,default:!1}},computed:{apiEndPoint(){return this.category==="contracts"?"/service-desk/api/vendor/contract/"+this.vendorId:"/service-desk/api/vendor/product/"+this.vendorId},columns(){return this.category==="contracts"?["name","cost","contract_start_date","contract_end_date"]:["name","manufacturer","status","department"]},options(){const e=this;return{sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},texts:{filter:"",limit:""},headings:{name:e.lang("name"),cost:e.lang("cost"),contract_start_date:e.lang("contract_start_date"),contract_end_date:e.lang("contract_end_date"),manufacturer:e.lang("manufacturer"),department:e.lang("department"),status:e.lang("status")},columnsClasses:{name:"associate-name",cost:"contract-cost",contract_start_date:"contract-start",contract_end_date:"contract-end",manufacturer:"product-manufacturer",department:"product-dept",status:"product-status"},templates:{name:function(t,s){return e.category=="contracts"?e.h("a",{href:e.basePath()+"/panel/service-desk/contracts/"+s.id+"/show",target:"_blank"},s.name):e.h(se,{to:"/service-desk/"+e.category+"/"+s.id+"/show"},s.name)},status:function(t,s){return s.product_status?e.h("span",{},[e.h("i",{class:s.product_status.icon_class,style:{color:s.product_status.icon_color,marginRight:"5px"}})],s.product_status.name):"---"},department(t,s){return s.department?s.department.name:"--"},contract_start_date(t,s){return s.contract_start_date?e.formattedTime(s.contract_start_date):"--"},contract_end_date(t,s){return s.contract_end_date?e.formattedTime(s.contract_end_date):"--"}},sortable:e.category==="contracts"?e.columns:["name","manufacturer","status"],filterable:e.columns,pagination:{chunk:5,nav:"scroll"},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"name","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data[e.category].map(s=>s),count:t.data.total}}}}},methods:{handelLoader(e){this.$emit("loaderValue",e)}}};function RK(e,t,s,d,n,i){const h=u("data-table");return o(),l("div",null,[m(h,{url:i.apiEndPoint,dataColumns:i.columns,option:i.options,scroll_to:"vendor-associates",componentTitle:"vendor-view",onLoaderState:i.handelLoader,disableLoader:s.disableLoader},null,8,["url","dataColumns","option","onLoaderState","disableLoader"])])}const xK=C(jK,[["render",RK]]);const BK={name:"vendor-view",description:"Vendor details page component",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},data(){return{hasDataPopulated:!1,loading:!1,vendorData:"",showModal:!1,title:"",tabs:[{id:"contracts",title:"associated_contracts"},{id:"products",title:"associated_products"}],category:"contracts",tabloading:!0}},beforeMount(){const e=window.location.pathname;this.getInitialValues(e)},methods:{associates(e){this.category!==e&&(this.tabloading=!0,this.category=e)},subString(e,t=20){return oe(e,t)},modalMethod(e){this.title=e,this.showModal=!0},getInitialValues(e){const t=W(e);this.loading=!0,S.get("/service-desk/api/vendor/"+t).then(s=>{this.loading=!1,this.hasDataPopulated=!0,this.vendorData=s.data.data.vendor}).catch(s=>{this.loading=!1,A(s,"vendor-view"),this.hasDataPopulated=!0})},onClose(){this.showModal=!1},handelLoader(e){this.tabloading=e}},components:{"vendor-modal":OK,"vendor-associates-table":xK}},dt=e=>(K("data-v-84c00f01"),e=e(),z(),e),KK={class:"col-sm-12"},zK={key:0,class:"row"},HK={key:1,class:"card card-light"},YK={class:"card-header"},WK={class:"card-title"},JK=dt(()=>a("i",{class:"fas fa-barcode","aria-hidden":"true"},null,-1)),GK={class:"card-tools"},ZK=dt(()=>a("span",{class:"fas fa-edit"},null,-1)),QK=dt(()=>a("span",{class:"fas fa-trash"},null,-1)),XK=[QK],ez={class:"card-body"},tz={class:"row"},sz={class:"col-md-12"},az={class:"callout callout-info bg-info"},nz={class:"row"},oz={class:"col-md-4"},iz={class:"col-md-4"},lz={class:"col-md-4"},rz={class:"col-md-12"},dz={class:"row"},cz={class:"col-md-6 info-row d-flex"},uz={class:"col-md-6"},hz={class:"col-md-6"},mz={class:"text-primary"},_z={class:"col-md-6 info-row d-flex"},pz={class:"col-md-6"},fz={class:"col-md-6"},gz={class:"text-primary"},bz={class:"col-md-6 info-row d-flex"},yz={class:"col-md-6"},vz={class:"col-md-6"},wz={class:"text-primary"},kz={class:"col-md-6 info-row d-flex"},Cz={class:"col-md-6"},Dz={class:"col-md-6"},Sz={class:"col-md-6 info-row d-flex"},Fz={class:"col-md-6"},Mz={class:"col-md-6"},Iz=dt(()=>a("i",{class:"fas fa-file-code"},null,-1)),Az={class:"card card-light card-tabs"},Pz={class:"card-header p-0 pt-1"},Tz={class:"nav nav-tabs",role:"tablist"},Vz=["onClick"],Lz={class:"nav-item ml-auto mt-04"},Uz={key:0,type:"button",class:"btn btn-tool rotating","data-card-widget":"refresh"},$z=dt(()=>a("i",{class:"fas fa-refresh"},null,-1)),Nz=[$z],Ez={class:"card-body"},qz={class:"tab-content"},Oz={class:"tab-pane active",role:"tabpanel"};function jz(e,t,s,d,n,i){const h=u("alert"),_=u("reuse-loader"),f=u("router-link"),p=u("vendor-associates-table"),b=u("vendor-modal"),k=N("tooltip");return o(),l("div",KK,[m(h,{componentName:"vendor-view"}),!n.hasDataPopulated||n.loading?(o(),l("div",zK,[m(_,{"animation-duration":4e3,size:60})])):c("",!0),n.hasDataPopulated&&n.vendorData?(o(),l("div",HK,[a("div",YK,[w((o(),l("h3",WK,[JK,g(" "+r(i.subString(n.vendorData.name,50)),1)])),[[k,n.vendorData.name]]),a("div",GK,[w((o(),v(f,{class:"btn btn-tool",to:"/service-desk/vendor/"+n.vendorData.id+"/edit"},{default:y(()=>[ZK]),_:1},8,["to"])),[[k,e.lang("edit")]]),w((o(),l("a",{class:"btn btn-tool",onClick:t[0]||(t[0]=D=>i.modalMethod("delete")),href:"javascript:;"},XK)),[[k,e.lang("delete")]])])]),a("div",ez,[a("div",tz,[a("div",sz,[a("div",az,[a("div",nz,[a("div",oz,[a("b",null,r(e.lang("created_date"))+" : ",1),w((o(),l("span",null,[g(r(d.formattedTime(n.vendorData.created_at)),1)])),[[k,d.formattedTime(n.vendorData.created_at)]])]),a("div",iz,[a("b",null,r(e.lang("updated_date"))+" : ",1),w((o(),l("span",null,[g(r(d.formattedTime(n.vendorData.updated_at)),1)])),[[k,d.formattedTime(n.vendorData.updated_at)]])]),a("div",lz,[a("b",null,r(e.lang("status"))+" : ",1),w((o(),l("span",null,[g(r(i.subString(n.vendorData.status.name)),1)])),[[k,n.vendorData.status.name]])])])])])]),a("div",rz,[a("div",dz,[a("div",cz,[a("div",uz,[a("label",null,r(e.lang("email")),1)]),a("div",hz,[w((o(),l("a",mz,[g(r(i.subString(n.vendorData.email)),1)])),[[k,n.vendorData.email]])])]),a("div",_z,[a("div",pz,[a("label",null,r(e.lang("primary_contact")),1)]),a("div",fz,[w((o(),l("a",gz,[g(r(n.vendorData.phone_country_code&&n.vendorData.primary_contact?"+"+n.vendorData.phone_country_code+" "+n.vendorData.primary_contact+" "+(n.vendorData.ext?"-"+n.vendorData.ext:""):n.vendorData.primary_contact?n.vendorData.primary_contact+" "+(n.vendorData.ext?"-"+n.vendorData.ext:""):"--"),1)])),[[k,n.vendorData.primary_contact]])])]),a("div",bz,[a("div",yz,[a("label",null,r(e.lang("mobile")),1)]),a("div",vz,[w((o(),l("a",wz,[g(r(n.vendorData.mobile&&n.vendorData.mobile?"+"+n.vendorData.country_code+" "+n.vendorData.mobile:n.vendorData.mobile||"--"),1)])),[[k,n.vendorData.mobile]])])]),a("div",kz,[a("div",Cz,[a("label",null,r(e.lang("address")),1)]),a("div",Dz,[w((o(),l("a",null,[g(r(i.subString(n.vendorData.address)),1)])),[[k,n.vendorData.address]])])]),a("div",Sz,[a("div",Fz,[a("label",null,r(e.lang("description")),1)]),a("div",Mz,[a("button",{type:"button",class:"btn btn-info btn-xs",onClick:t[1]||(t[1]=D=>i.modalMethod("vendor_description"))},[Iz,g(" "+r(e.lang("show_description")),1)])])])])])])])):c("",!0),a("div",null,[a("div",Az,[a("div",Pz,[a("ul",Tz,[(o(!0),l(I,null,$(n.tabs,D=>(o(),l("li",{key:D.id,class:"nav-item"},[a("a",{id:"vendor_tab",onClick:P=>i.associates(D.id),class:j(["nav-link",{active:n.category===D.id}]),"data-toggle":"pill",role:"tab"},r(e.lang(D.title)),11,Vz)]))),128)),a("li",Lz,[n.tabloading?(o(),l("a",Uz,Nz)):c("",!0)])])]),a("div",Ez,[a("div",qz,[a("div",Oz,[m(p,{category:n.category,vendorId:n.vendorData.id,disableLoader:"true",onLoaderValue:i.handelLoader},null,8,["category","vendorId","onLoaderValue"])])])])])]),m(q,{name:"modal"},{default:y(()=>[n.showModal?(o(),v(b,{key:0,onClose:i.onClose,showModal:n.showModal,data:n.vendorData,title:n.title},null,8,["onClose","showModal","data","title"])):c("",!0)]),_:1})])}const Rz=C(BK,[["render",jz],["__scopeId","data-v-84c00f01"]]);const xz={name:"asset-type-lists",description:"Asset type lists table component",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime)}},data:()=>({columns:["name","parent","created_at","action"],options:{},apiUrl:"service-desk/api/asset-type-list"}),beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},texts:{filter:"",limit:""},headings:{name:e.lang("name"),parent:e.lang("parent"),created_at:e.lang("created_at"),action:e.lang("action")},columnsClasses:{name:"assets-type-name",is_default:"Default",parent:"parent",created_at:"assets-type-created"},templates:{created_at(t,s){return e.formattedTime(s.created_at)},parent(t,s){return s.parent?s.parent.name:"--"},action:(t,s)=>e.h(_e,{data:s})},sortable:["name","created_at"],filterable:["name"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query,page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.asset_types.map(s=>(s.edit_url="/service-desk/asset-type/"+s.id+"/edit",s.delete_url=e.basePath()+"/service-desk/api/asset-type/"+s.id,s)),count:t.data.total}}}}},Bz=e=>(K("data-v-0f083239"),e=e(),z(),e),Kz={class:"col-sm-12"},zz={class:"card card-light assets-type-table"},Hz={class:"card-header"},Yz={id:"asset-type-list",class:"card-title"},Wz={class:"card-tools"},Jz=Bz(()=>a("span",{class:"glyphicon glyphicon-plus"},null,-1)),Gz={class:"card-body",id:"assets-type-table"};function Zz(e,t,s,d,n,i){const h=u("alert"),_=u("router-link"),f=u("data-table"),p=N("tooltip");return o(),l("div",Kz,[m(h,{componentName:"dataTableModal"}),a("div",zz,[a("div",Hz,[a("h3",Yz,r(e.lang("asset_type_lists-page-title")),1),a("div",Wz,[w((o(),v(_,{class:"btn btn-tool",to:"/service-desk/asset-type/create"},{default:y(()=>[Jz]),_:1})),[[p,e.lang("create_asset_type")]])])]),a("div",Gz,[m(f,{url:e.apiUrl,dataColumns:e.columns,option:e.options,scroll_to:"asset-type-lists"},null,8,["url","dataColumns","option"])])])])}const Qz=C(xz,[["render",Zz],["__scopeId","data-v-0f083239"]]);const ia=e=>(K("data-v-13cc6584"),e=e(),z(),e),Xz={class:"col-sm-12"},eH={class:"card card-light shadow-none"},tH={class:"card-header sticky-top menu-border sticky-top-menu"},sH={key:1,class:"card-title"},aH={key:2,class:"card-tools"},nH=ia(()=>a("i",{class:"fas fa-save"},null,-1)),oH={class:"card-body p-0 pt-2 bg-light"},iH={class:"row"},lH={class:"col-sm-3"},rH={class:"card sticky-top sticky-fields"},dH={class:"card-body p-2"},cH={class:"row"},uH={key:0,class:"col-12"},hH={class:"nav nav-tabs",role:"tablist"},mH={class:"nav-item"},_H={class:"col-sm-9"},pH={key:0,class:"card"},fH={class:"card-body row"},gH={key:0,class:"form-group col-md-12",id:"text"},bH={class:"label_align1"},yH=["name","checked"],vH={class:"ml-3"},wH={class:"card"},kH={class:"card-body p-2"},CH={key:0,class:"row no-drag-form-card"},DH={class:"text-center pt-4 no-drag-fields"},SH=["src"],FH={class:"modal-title"},MH=ia(()=>a("i",{class:"fas fa-trash-alt","aria-hidden":"true"},null,-1)),IH={__name:"ModuleBuilder",props:{auth:{type:Object,default:()=>({})},formMode:{type:String,default:""},formNameObj:{type:Object,default:()=>({})},formCheckbox:{type:Object,default:()=>({})},formLinker:{type:Array,default:()=>[]},editFormApi:{type:String,default:""},postFromApi:{type:String,default:""},formCategoryType:{type:String,default:""},pageHeading:{type:String,default:"form"},editFormId:{type:[String,Number],default:""},editResponseKey:{type:String,default:""},routeModuleName:{type:String,default:""}},setup(e){const t=B(),s=Ma(),d=Ia(),{basePathVersion:n}=qs.methods;let i=e;const h=x(""),_=x(!0),f=x(!1),p=x(!1),b=x(!1),k=x(!1),D=x("fields");let P=x({}),E=x({}),M=x([]);const F=x(!1),T=x(""),O=x(""),Z=x("");Ce(()=>{P.value=i.formNameObj,E.value=i.formCheckbox,M.value=i.formLinker,i.formMode==="create"&&(P.value.value="",E.value.value=!1,M.value=M.value.map(V=>({...V,value:""}))),J()});const J=()=>{i.formMode==="create"?(b.value=!0,p.value=!0,P.value.value="",E.value.value=0,M.value.forEach((V,R)=>{V.value=""}),_.value=!1):i.formMode==="edit"&&(k.value=!0,_.value=!1),h.value=i.formCategoryType,ee(),be()},ee=()=>{S.get("api/get-form-menu/"+h.value).then(V=>{t.commit("updateFormMenu",V.data.data),f.value=!0})},be=()=>{re().then(V=>{k.value&&(P.value.value=V.data.data[i.editResponseKey][P.value.id]?V.data.data[i.editResponseKey][P.value.id]:"",E.value.value=V.data.data[i.editResponseKey][E.value.id]?V.data.data[i.editResponseKey][E.value.id]:"",M.value.forEach(R=>{R.value=V.data.data[i.editResponseKey][R.id]?V.data.data[i.editResponseKey][R.id]:""})),p.value=!0})},re=()=>{_.value=!0,t.commit("updateFormCategoryType",h.value);let V="/field-manager-section",R={category:i.formCategoryType,page:"config"};return k.value&&(V=i.editFormApi,R.config=!1),S.get(V,{params:R}).then(Y=>(t.commit("updateFormSections",i.formMode==="create"?Y.data.data:Y.data.data[i.editResponseKey].nodes),_.value=!1,Y)).catch(Y=>{_.value=!1,A(Y,"form-builder-main")})},fe=async()=>{if(ct()){const V=t.getters.getFormSections;Qe(V),await X(V)}},ct=()=>{if(b.value||k.value){const{errors:V,isValid:R}=Wa(i);return R}else return!0},Qe=V=>{for(let R=0;R<V.length;R++){const Y=V[R];Y.sort_order=R,Y.form_fields&&typeof Y.form_fields=="object"?Object.keys(Y.form_fields).forEach(ne=>{const Q=Y.form_fields[ne];for(let he=0;he<Q.length;he++)Q[he].sort_order=he;Qe(Q)}):Object.keys(V[R]).forEach(ne=>{pe(V[R][ne])&&Array.isArray(V[R][ne])&&Qe(V[R][ne])})}},X=async V=>{try{_.value=!0;const R=V.filter(Q=>{if(Q.data_type==="section"){const he=Q.form_fields.first?Q.form_fields.first.length===0:!1,ts=Q.form_fields.second?Q.form_fields.second.length===0:!1;return!(he&&ts||he&&!Q.form_fields.second||!Q.form_fields.first&&ts)}return!0}),Y=ue(),ne=await ye(Y,R);ha(ne)}catch(R){_a(R)}},ue=()=>b.value||k.value?i.postFromApi:"post/form-fields",ye=async(V,R)=>{let Y=H(R);return await S.post(V,Xe(Y))},H=V=>{for(let R=0;R<V.length;R++)if(V[R].form_fields&&typeof V[R].form_fields=="object"&&!Array.isArray(V[R].form_fields)){const Y=V[R].form_fields.first||[],ne=V[R].form_fields.second||[];Y.forEach(Q=>{Q.column="first"}),ne.forEach(Q=>{Q.column="second"}),V[R].form_fields=Y.concat(ne),V[R].form_fields.forEach(Q=>{pe(Q.options)&&Q.options.forEach(he=>{H(he.nodes?he.nodes:[])})})}else pe(V[R].options)&&V[R].options.forEach(Y=>{H(Y.nodes?Y.nodes:[])});return V},Xe=V=>{let R={};return R.category=i.formCategoryType,R.id=d.params.id,R.is_clone=1,R.is_delete=0,R.form_sections=V,(b.value||k.value)&&(R[P.value.submitFormParamKey]=P.value.value,R[E.value.submitFormParamKey]=E.value.value,M.value.forEach(Y=>{R[Y.submitFormParamKey]=Y.value?Y.value.id:""})),k.value&&(R.id=i.editFormId),R},ha=V=>{U(V,"form-builder-main"),b.value||k.value?ma():Qt()},ma=()=>{_.value=!1,i.formMode==="create"?setTimeout(()=>{s.push({name:i.routeModuleName})},3e3):Qt()},Qt=()=>{re().then(()=>{_.value=!1})},_a=V=>{_.value=!1,A(V,"form-builder-main")};let et=x(!1),It=x(null);const Xt=()=>{et.value=!1,It.value=null},pa=({data:V})=>{et.value=!1,It.value=V,setTimeout(()=>{et.value=!0},0)},es=L({get(){return t.getters.getFormSections},set(V){t.dispatch("updateFormSections",V)}}),fa=async V=>{const R=t.getters.getFormSections;await At(R,V.form_identifier,V)&&await t.dispatch("updateFormSections",R),Xt(),window.emitter.emit("updateNestedObjects")},At=(V,R,Y)=>{let ne=is.findIndex(V,Q=>Q.form_identifier===R);if(ne!==-1)V[ne]=Y;else for(let Q=0;Q<V.length;Q++)V[Q].form_fields&&typeof V[Q].form_fields=="object"?Object.keys(V[Q].form_fields).forEach(he=>{At(V[Q].form_fields[he],R,Y)}):pe(V[Q].options)&&V[Q].options.forEach(he=>{At(he.nodes?he.nodes:[],R,Y)});return new Promise(Q=>{Q(!0)})},ga=V=>{F.value=!0,T.value=V.reference_type,O.value=V.fieldData,Z.value=V.reference_id},ba=()=>{F.value=!1,wa(O.value)?va(O.value.id,Z.value,T.value,O.value.data_type):ya(O.value.form_identifier,O.value.data_type)},ya=(V,R)=>{const Y=t.getters.getFormSections;Pt(Y,V)&&(t.dispatch("updateFormFields",Y),window.emitter.emit("updateNestedObjects"),window.emitter.emit("updateMenuCount",{type:R,from:"local"}))},va=(V,R,Y,ne)=>{_.value=!0;let Q=O.value.data_type==="section"?"/remove/form-sections/"+V:"/remove/form-fields/"+V;R&&(Q="api/unlink-form-group/"+Y+"/"+R),S.delete(Q).then(he=>{U(he,"form-builder-main"),p.value=!1,re().then(()=>{p.value=!0}),window.emitter.emit("updateNestedObjects"),window.emitter.emit("updateMenuCount",{type:ne,from:"db"}),_.value=!1}).catch(he=>{_.value=!1,A(he,"form-builder-main")})},wa=V=>V.type==="group"?typeof V.groupid>"u":V.id.toString().length<13,Pt=(V,R)=>{let Y=is.findIndex(V,ne=>ne.form_identifier===R);if(Y!==-1)V.splice(Y,1);else for(let ne=0;ne<V.length;ne++)V[ne].form_fields&&typeof V[ne].form_fields=="object"?Object.keys(V[ne].form_fields).forEach(Q=>{Pt(V[ne].form_fields[Q],R)}):pe(V[ne].options)&&V[ne].options.forEach(Q=>{Pt(Q.nodes?Q.nodes:[],R)});return Promise.resolve(!0)};return window.emitter.on("formFieldSettingsApplied",fa),window.emitter.on("onRemoveElement",ga),window.emitter.on("getFormDataFromServer",re),window.emitter.on("onEditElement",pa),(V,R)=>(o(),l("div",Xz,[m(ke,{"component-name":"form-builder-main"}),a("div",eH,[a("div",tH,[_.value?(o(),v(Ne,{key:0})):c("",!0),p.value&&f.value?(o(),l("h3",sH,r(V.trans(e.pageHeading)),1)):c("",!0),p.value&&f.value?(o(),l("div",aH,[a("button",{class:"btn btn-tool btn-default form-save-btn float-right form_save_btn",onClick:R[0]||(R[0]=Y=>fe())},[nH,g(" "+r(V.trans("save")),1)])])):c("",!0)]),a("div",oH,[a("div",iH,[a("div",lH,[a("div",rH,[a("div",dH,[a("div",cH,[f.value?(o(),l("div",uH,[a("ul",hH,[a("li",mH,[a("a",{class:j(["nav-link",D.value==="fields"?"active font-weight-bold":""]),href:"javascript:;","data-toggle":"pill",role:"tab"},r(V.trans("form_fields")),3)])]),(o(),v(za,{key:D.value,type:D.value},null,8,["type"]))])):c("",!0)])])])]),p.value&&f.value?(o(),l(I,{key:0},[a("div",_H,[b.value||k.value?(o(),l("div",pH,[a("div",fH,[m(le,{id:te(P).id,classname:te(P).className,label:V.trans(te(P).label),value:te(P).value,type:"text",name:te(P).id,onChange:Y=>te(P).value=Y,placehold:V.trans(te(P).placeholder),required:!0},null,8,["id","classname","label","value","name","onChange","placehold"]),(o(!0),l(I,null,$(te(M),Y=>(o(),v(G,{key:Y.id,id:Y.id,name:Y.submitFormParamKey,classname:Y.className,apiEndpoint:Y.apiEndpoint,label:V.trans(Y.label),value:Y.value,required:!1,multiple:Y.multiple,onChange:ne=>Y.value=ne},null,8,["id","name","classname","apiEndpoint","label","value","multiple","onChange"]))),128)),te(E)&&te(E).id?(o(),l("div",gH,[a("label",bH,[a("input",{class:"checkbox_align",type:"checkbox",name:te(E).id,onChange:R[1]||(R[1]=Y=>te(E).value=Y.target.checked===!0),checked:te(E).value===!0},null,40,yH),g(" "+r(V.lang(te(E).label))+" ",1),a("span",vH,[m(tt,{message:V.lang(te(E).hint),size:"small"},null,8,["message"])])])])):c("",!0)])])):c("",!0),a("div",wH,[a("div",kH,[m(Ha,{sections:es.value,auth:e.auth,isFormGroup:b.value||k.value},null,8,["sections","auth","isFormGroup"]),es.value.length?c("",!0):(o(),l("div",CH,[a("div",DH,[a("img",{src:te(n)()+"/themes/default/common/images/drag.png",alt:"form-no-drag",class:"no-drag-img"},null,8,SH),a("h5",null,r(V.trans("drag_elements_here")),1),a("p",null,r(V.trans("grab_an_element_from_the_left")),1)])]))])])]),te(et)?(o(),v(Ya,{key:0,fieldData:te(It),isShowSettingModal:te(et),onCloseSettingModal:Xt,auth:e.auth},null,8,["fieldData","isShowSettingModal","auth"])):c("",!0)],64)):c("",!0)])])]),m(q,{name:"modal"},{default:y(()=>[F.value?(o(),v(ft,{key:0,showModal:!0,onClose:()=>F.value=!1,containerStyle:{width:"400px"}},{title:y(()=>[a("h4",FH,r(V.trans("delete")),1)]),fields:y(()=>[a("span",null,r(V.trans("are_you_sure_you_want_to_delete")),1)]),controls:y(()=>[a("button",{id:"approval-action-confirm",type:"button",onClick:R[2]||(R[2]=Y=>ba()),class:"btn btn-danger"},[MH,g(" "+r(V.trans("confirm")),1)])]),_:1},8,["onClose"])):c("",!0)]),_:1})]))}},AH=C(IH,[["__scopeId","data-v-13cc6584"]]),Ms={__name:"AssetTypeCreateEdit",setup(e){const t=x({id:"name",className:"col-md-6",label:"name",placeholder:"name",value:"",submitFormParamKey:"name"}),s=x([{id:"parent",className:"col-md-6",apiEndpoint:"service-desk/api/dependency/asset_types",label:"parent",value:"",submitFormParamKey:"parent_id",multiple:!1}]),d=x({id:"is_default",className:"col-md-6",value:!1,label:"make_default_asset_type",hint:"make_default_asset_type_tooltip",submitFormParamKey:"is_default"}),n=x("new"),i=x("create"),h=x(""),_=x(null),f=x("asset_types.index"),p=b=>{b.indexOf("edit")>=0&&(n.value="edit_assetstypes",i.value="edit",h.value=W(b),_.value="/service-desk/api/asset-type/"+h.value,f.value="asset_types.edit")};return Ce(()=>{const b=window.location.pathname;p(b)}),(b,k)=>(o(),v(AH,{formCategoryType:"asset",pageHeading:n.value,formMode:i.value,"form-checkbox":d.value,"post-from-api":"/service-desk/api/asset-type","form-name-obj":t.value,"form-linker":s.value,editFormApi:_.value,editFormId:h.value,editResponseKey:"asset_type",routeModuleName:f.value},null,8,["pageHeading","formMode","form-checkbox","form-name-obj","form-linker","editFormApi","editFormId","routeModuleName"]))}};const PH={name:"change-type-lists",components:{DataTableActions:_e},description:"Change type lists table component",setup(){const e=B(),t=L(()=>e.getters.formattedTime),s=x(["name","updated_at","action"]),d="service-desk/api/change-type-list",n=x({}),i=h=>Aa(_e,{data:h});return Ce(h=>{n.value={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},texts:{filter:"",limit:""},headings:{name:ae("name"),updated_at:ae("updated_at"),action:ae("action")},columnsClasses:{name:"changes-type-name",is_default:"Default",parent:"parent",updated_at:"changes-type-created",actions:"actions"},templates:{updated_at(_,f){return t.value(f.updated_at)},parent(_,f){return f.parent?f.parent.name:"--"},action(_,f){return i(f)}},sortable:["name","updated_at"],filterable:["name"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(_){return{"sort-field":_.orderBy?_.orderBy:"id","sort-order":_.ascending?"desc":"asc","search-query":_.query,page:_.page,limit:_.limit}},responseAdapter({data:_}){return{data:_.data.change_types.map(f=>(f.edit_url="/service-desk/change-type/"+f.id+"/edit",f.delete_url="/service-desk/api/change-type/"+f.id,f)),count:_.data.total}}}}),{columns:s,apiUrl:d,options:n}}},TH=e=>(K("data-v-763cec93"),e=e(),z(),e),VH={class:"col-sm-12"},LH={class:"card card-light changes-type-table"},UH={class:"card-header"},$H={id:"change-type-list",class:"card-title"},NH={class:"card-tools"},EH=TH(()=>a("span",{class:"glyphicon glyphicon-plus"},null,-1)),qH={class:"card-body",id:"changes-type-table"};function OH(e,t,s,d,n,i){const h=u("alert"),_=u("router-link"),f=u("data-table"),p=N("tooltip");return o(),l("div",VH,[m(h,{componentName:"dataTableModal"}),a("div",LH,[a("div",UH,[a("h3",$H,r(e.lang("change_type_lists-page-title")),1),a("div",NH,[w((o(),v(_,{class:"btn btn-tool",to:"/service-desk/change-type/create"},{default:y(()=>[EH]),_:1})),[[p,e.lang("create_change_type")]])])]),a("div",qH,[m(f,{url:d.apiUrl,dataColumns:d.columns,option:d.options,scroll_to:"change-type-lists"},null,8,["url","dataColumns","option"])])])])}const jH=C(PH,[["render",OH],["__scopeId","data-v-763cec93"]]);function RH(e){const{name:t}=e;var s={name:[t,"isRequired"]};const d=new ce(ae),{errors:n,isValid:i}=d.validate(s);return ie.dispatch("setValidationError",n),{errors:n,isValid:i}}const xH={setup(){B();const e=x("new_changes"),t=x("fas fa-save"),s=x("save"),d=x(!1),n=x(!1),i=x(!1),h=x(""),_=x(""),f=x(!1);Ce(()=>{const F=window.location.pathname;p(F)});const p=F=>{const T=W(F);F.includes("edit")?(e.value="edit_changestypes",t.value="fas fa-sync",s.value="update",d.value=!1,b(T)):(i.value=!1,d.value=!0,f.value=!1)},b=F=>{i.value=!0,S.get(`/service-desk/api/change-type/${F}`).then(T=>{i.value=!1,d.value=!0;const O=T.data.data.change_type;_.value=O.id,f.value=O.is_default,h.value=O.name}).catch(T=>{i.value=!1,d.value=!0,A(T,"changestypes")})},k=()=>{const{errors:F,isValid:T}=RH({title:e.value,btnName:s.value,hasDataPopulated:d.value,name:h.value,make_default:f.value});return T},D=(F,T)=>{h.value=F||""},P=F=>{f.value=F.target.checked},E=()=>{if(k()){i.value=!0;const F=new FormData;_.value!==""&&F.append("id",_.value),F.append("name",h.value),F.append("is_default",f.value);const T={headers:{"Content-Type":"multipart/form-data"}};S.post("/service-desk/api/change-type",F,T).then(O=>{i.value=!1,U(O,"changestypes"),_.value?b(_.value):setTimeout(()=>{this.$router.push({name:"change Types Index"})},3e3)}).catch(O=>{i.value=!1,A(O,"changestypes")})}};return{title:e,iconClass:t,btnName:s,hasDataPopulated:d,shouldShowLoader:n,loading:i,name:h,changeTypeId:_,make_default:f,getValues:p,getInitialValues:b,isValid:k,onChange:D,changeDefault:P,onSubmit:E,triggerEvent:F=>{F.key==="Enter"&&E()}}},components:{"dynamic-select":G,"text-field":le,"tool-tip":tt}},BH={class:"col-sm-12"},KH={key:0},zH={key:1,class:"card card-light"},HH={class:"card-header"},YH={class:"card-title"},WH={class:"card-body"},JH={class:"row"},GH={class:"row"},ZH={class:"form-group col-md-12",id:"text"},QH={class:"label_align1"},XH=["keyupListener","checked"],eY={class:"ml-3"},tY={class:"card-footer"};function sY(e,t,s,d,n,i){const h=u("custom-loader"),_=u("alert"),f=u("text-field"),p=u("ToolTip"),b=N("focus-first-input");return o(),l("div",BH,[d.shouldShowLoader?(o(),l("div",KH,[m(h,{duration:4e3})])):c("",!0),m(_,{componentName:"changestypes"}),d.hasDataPopulated?(o(),l("div",zH,[a("div",HH,[a("h3",YH,r(e.lang(d.title)),1)]),a("div",WH,[w((o(),l("div",JH,[m(f,{label:e.lang("name"),value:d.name,type:"text",name:"name",onChange:d.onChange,keyupListener:d.triggerEvent,classname:"col-sm-6",required:!0},null,8,["label","value","onChange","keyupListener"])])),[[b]]),a("div",GH,[a("div",ZH,[a("label",QH,[a("input",{class:"checkbox_align mr-1",type:"checkbox",name:"default",onChange:t[0]||(t[0]=(...k)=>d.changeDefault&&d.changeDefault(...k)),keyupListener:d.triggerEvent,checked:d.make_default},null,40,XH),g(r(e.lang("make_default_change_type"))+" ",1),a("span",eY,[m(p,{message:e.lang("make_default_change_type_tooltip"),size:"medium"},null,8,["message"])])])])])]),a("div",tY,[a("button",{id:"submit_btn",class:"btn btn-primary",onClick:t[1]||(t[1]=(...k)=>d.onSubmit&&d.onSubmit(...k))},[a("i",{class:j(d.iconClass)},null,2),g(" "+r(e.lang(d.btnName)),1)])])])):c("",!0)])}const Is=C(xH,[["render",sY],["__scopeId","data-v-0995f2b1"]]);const aY={name:"asset-status-index",description:"Asset Status Index Component",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime)}},data(){return{apiUrl:"/service-desk/api/asset-status-list",columns:["name","created_at","updated_at","action"],options:{}}},beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},columnsClasses:{name:"asset-status-name",created_at:"asset-status-created",updated_at:"asset-status-updated",action:"asset-status-action"},texts:{filter:"",limit:""},templates:{created_at(t,s){return e.formattedTime(s.created_at)},updated_at(t,s){return e.formattedTime(s.updated_at)},action:(t,s)=>e.h(_e,{data:s})},sortable:["name","created_at","updated_at"],filterable:["name"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query,page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.data.map(s=>(s.edit_url="/service-desk/asset-status/"+s.id+"/edit",s.delete_url=e.basePath()+"/service-desk/api/asset-status/"+s.id,s)),count:t.data.total}}}}},nY={id:"asset_status_list",class:"col-sm-12"},oY={class:"card card-light"},iY={class:"card-header"},lY={class:"card-title"},rY={class:"card-tools"},dY=a("span",{class:"glyphicon glyphicon-plus"},null,-1),cY={class:"card-body",id:"asset_status_table"};function uY(e,t,s,d,n,i){const h=u("alert"),_=u("router-link"),f=u("data-table"),p=N("tooltip");return o(),l("div",nY,[m(h,{componentName:"dataTableModal"}),a("div",oY,[a("div",iY,[a("h3",lY,r(e.trans("list_of_asset_statuses")),1),a("div",rY,[w((o(),v(_,{class:"btn btn-tool",to:"/service-desk/asset-status/create"},{default:y(()=>[dY]),_:1})),[[p,e.trans("create_asset_status")]])])]),a("div",cY,[m(f,{url:n.apiUrl,dataColumns:n.columns,option:n.options,scroll_to:"asset_status_list"},null,8,["url","dataColumns","option"])])])])}const hY=C(aY,[["render",uY]]);function mY(e){const{name:t,description:s}=e;var d={name:[t,"isRequired",{"max(50)":ae("name_should_be_less_than_50_characters")}],description:[s,"isRequired"]};const n=new ce(ae),{errors:i,isValid:h}=n.validate(d);return ie.dispatch("setValidationError",i),{errors:i,isValid:h}}const _Y={data(){return{title:"create_asset_status",iconClass:"fas fa-save",btnName:"save",hasDataPopulated:!1,loading:!1,asset_status_id:"",name:"",description:""}},beforeMount(){const e=window.location.pathname;this.getValues(e)},methods:{getValues(e){const t=W(e);e.indexOf("edit")>=0?(this.title="edit_asset_status",this.iconClass="fas fa-sync",this.btnName="update",this.hasDataPopulated=!1,this.getInitialValues(t)):(this.loading=!1,this.hasDataPopulated=!0)},getInitialValues(e){this.loading=!0,S.get("/service-desk/api/asset-status/"+e).then(t=>{this.loading=!1,this.hasDataPopulated=!0,this.name=t.data.data.asset_status.name,this.description=t.data.data.asset_status.description,this.asset_status_id=t.data.data.asset_status.id}).catch(t=>{this.loading=!1,this.hasDataPopulated=!0,A(t,"assetStatus")})},isValid(){const{errors:e,isValid:t}=mY(this.$data);return t},onChange(e,t){this[t]=e},onSubmit(){if(this.isValid()){this.loading=!0;var e=new FormData;this.asset_status_id!=""&&e.append("id",this.asset_status_id),e.append("name",this.name),e.append("description",this.description);const t={headers:{"Content-Type":"multipart/form-data"}};S.post("/service-desk/api/asset-status",e,t).then(s=>{this.loading=!1,U(s,"assetStatus"),this.asset_status_id||setTimeout(()=>{this.$router.push({name:"Asset Statuses Index"})},3e3)}).catch(s=>{this.loading=!1,A(s,"assetStatus")})}}},components:{"text-field":le}},pY={class:"col-sm-12"},fY={key:0,class:"row"},gY={key:1,class:"card card-light"},bY={class:"card-header"},yY={class:"card-title"},vY={class:"card-body"},wY={class:"row"},kY={class:"row"},CY={class:"card-footer"};function DY(e,t,s,d,n,i){const h=u("custom-loader"),_=u("alert"),f=u("text-field"),p=u("tiny-editor"),b=N("focus-first-input");return o(),l("div",pY,[!n.hasDataPopulated||n.loading?(o(),l("div",fY,[m(h,{duration:4e3})])):c("",!0),m(_,{componentName:"assetStatus"}),n.hasDataPopulated?(o(),l("div",gY,[a("div",bY,[a("h3",yY,r(e.trans(n.title)),1)]),a("div",vY,[w((o(),l("div",wY,[m(f,{label:e.trans("name"),value:n.name,type:"text",name:"name",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold"])])),[[b]]),a("div",kY,[m(p,{value:n.description,type:"text",onChange:i.onChange,name:"description",label:e.trans("description"),classname:"col-sm-12",required:!0,lang:"en"},null,8,["value","onChange","label"])])]),a("div",CY,[a("button",{id:"submit_btn",class:"btn btn-primary",onClick:t[0]||(t[0]=k=>i.onSubmit())},[a("i",{class:j(n.iconClass)},null,2),g(" "+r(e.trans(n.btnName)),1)])])])):c("",!0)])}const As=C(_Y,[["render",DY]]);const SY={name:"cab-index",description:"Cab table component",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},data(){return{columns:["name","created_at","updated_at","action"],options:{},apiUrl:"/service-desk/api/cab"}},beforeMount(){const e=this;this.options={texts:{filter:"",limit:""},headings:{name:e.lang("name"),created_at:e.lang("created-at"),updated_at:e.lang("updated-at"),action:e.lang("action")},columnsClasses:{name:"cab-name",created_at:"cab-created",updated_at:"cab-updated",action:"cab-action"},templates:{action:(t,s)=>e.h(_e,{data:s}),created_at(t,s){return e.formattedTime(s.created_at)},updated_at(t,s){return e.formattedTime(s.updated_at)}},sortable:["name","created_at","updated_at"],filterable:["name","created_at","updated_at"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{sort_by:t.orderBy?t.orderBy:"id",order:t.ascending?"desc":"asc",search:t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.data.map(s=>(s.view_url="/service-desk/cab/"+s.id+"/show",s.edit_url="/service-desk/cab/"+s.id+"/edit",s.delete_url=e.basePath()+"/service-desk/api/cab/"+s.id+"/workflow/",s)),count:t.data.total}}}}},FY={id:"cab-index",class:"col-sm-12"},MY={class:"card card-light"},IY={class:"card-header"},AY={class:"card-title"},PY={class:"card-tools"},TY=a("span",{class:"glyphicon glyphicon-plus"},null,-1),VY={class:"card-body",id:"cab-table"};function LY(e,t,s,d,n,i){const h=u("alert"),_=u("router-link"),f=u("data-table"),p=N("tooltip");return o(),l("div",FY,[m(h,{componentName:"dataTableModal"}),a("div",MY,[a("div",IY,[a("h3",AY,r(e.lang("list_of_cabs")),1),a("div",PY,[w((o(),v(_,{class:"btn btn-tool",to:"/service-desk/cab/create"},{default:y(()=>[TY]),_:1})),[[p,e.lang("create_cab")]])])]),a("div",VY,[n.apiUrl!==""?(o(),v(f,{key:0,url:n.apiUrl,dataColumns:n.columns,option:n.options,scroll_to:"cab-index"},null,8,["url","dataColumns","option"])):c("",!0)])])])}const UY=C(SY,[["render",LY]]);function $Y(e){const{name:t,levels:s,send_auto_reminders:d,reminder_interval:n}=e;let i={name:[t,"isRequired"]};e.send_auto_reminders&&(i.reminder_interval=[e.reminder_interval,"isRequired"]);let h,_;s.map((b,k)=>{i["level-name-"+k]=[b.name,"isRequired"],i["level-match-"+k]=[b.match,"isRequired"],h=NY(b.approvers.users,b.approvers.user_types,k)});const p=new ce(ae).validate(i);return _=p.errors,h=h&&p.isValid,ie.dispatch("setValidationError",_),{errors:_,isValid:h}}function NY(e,t,s){let d=0;if(e.length==0&&t.length==0){let n=ae("atleast_one_user_or_one_user_type_is_required_to_create_cab");d++,ie.dispatch("setAlert",{type:"danger",message:n,component_name:"cab-level-"+s})}return!(d>0)}const EY={name:"cab-create-edit",description:"handles create/edit part of cab",data(){return{title:"create_cab",btnName:"save",iconClass:"fas fa-save",id:0,name:"",action_on_approve:"",action_on_deny:"",levels:[{id:0,name:"",order:1,match:"all",approvers:{users:[],user_types:[]}}],loading:!1,showDeletePopUp:!1,matcherOptions:[{id:"any",name:"Any"},{id:"all",name:"All"}],hasDataPopulated:!0,deletingLevelIndex:null,deletingLevelId:null,containerStyle:{width:"500px"},send_auto_reminders:0,radioOptions:[{name:"yes",value:1},{name:"no",value:0}],reminder_interval:"",reminderOptions:[{id:1,name:"1 Hour"},{id:4,name:"4 Hours"},{id:8,name:"8 Hours"},{id:12,name:"12 Hours"},{id:24,name:"24 Hours"}]}},mounted(){const e=window.location.pathname,t=W(e);e.indexOf("edit")>=0&&(this.hasDataPopulated=!1,this.title="edit_cab",this.btnName="update",this.iconClass="fas fa-sync",this.getInitialValues(t))},methods:{loadCabData(){const e=window.location.pathname,t=W(e);e.indexOf("edit")>=0&&this.getInitialValues(t)},getInitialValues(e){this.loading=!0,S.get("/service-desk/api/cab/"+e).then(t=>{this.id=t.data.data.id,this.name=t.data.data.name,this.action_on_approve=t.data.data.action_on_approve,this.action_on_deny=t.data.data.action_on_deny,this.send_auto_reminders=t.data.data.send_auto_reminders,this.reminder_interval=t.data.data.reminder_interval?t.data.data.reminder_interval:"",this.levels=t.data.data.levels,this.loading=!1,this.hasDataPopulated=!0}).catch(t=>{this.loading=!1,this.hasDataPopulated=!0})},addLevel(){this.levels.push({id:0,name:"",order:this.levels.length+1,match:"all",approvers:{users:[],user_types:[]}}),this.scrollToSubmitButton()},scrollToSubmitButton(){let e=document.getElementById("submit-cab");setTimeout(()=>{e.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})},2)},onChange(e,t){let s=t.split("-");s.length==1&&(this[t]=e);let d=s[s.length-1];t.includes("level-name-")&&(this.levels[d].name=e),t.includes("cab-user-type-")&&(this.levels[d].approvers.user_types=e),t.includes("cab-agent-")&&(this.levels[d].approvers.users=e),t.includes("level-match-")&&(this.levels[d].match=e)},isValid(){const{errors:e,isValid:t}=$Y(this.$data);return!!t},onSubmit(){if(this.isValid()){this.loading=!0;const e={};e.id=this.id,e.name=this.name,e.levels=this.getFormattedLevelData(),e.action_on_approve=this.action_on_approve?this.action_on_approve.id:"",e.action_on_deny=this.action_on_deny?this.action_on_deny.id:"",e.send_auto_reminders=this.send_auto_reminders,this.send_auto_reminders?e.reminder_interval=this.reminder_interval:e.reminder_interval="",S.post("/service-desk/api/cab",e).then(t=>{U(t,"cab"),this.loading=!1,window.location.pathname.indexOf("edit")>=0?this.loadCabData():setTimeout(()=>{let s=t.data.data.id;this.$router.push("/service-desk/cab/"+s+"/show")},3e3)}).catch(t=>{A(t,"cab"),this.loading=!1})}},getFormattedLevelData(){return this.$data.levels.map(t=>({id:t.id,name:t.name,order:t.order,match:t.match,approvers:{users:ss(t.approvers.users),user_types:ss(t.approvers.user_types)}}))},onDelete(){this.deletingLevelId!=0&&(this.loading=!0,S.delete("/service-desk/api/cab/"+this.deletingLevelId+"/level").then(e=>{U(e,"cab"),this.loadCabData(),this.loading=!1}).catch(e=>{A(e,"cab")})),this.levels.splice(this.deletingLevelIndex,1),this.showDeletePopUp=!1},deleting(e,t){this.deletingLevelIndex=e,this.deletingLevelId=t,this.showDeletePopUp=!0}},watch:{showDeletePopUp(e){e||(this.deletingLevelIndex=null,this.deletingLevelId=null)}},components:{"text-field":le,"dynamic-select":G,"static-select":st,"radio-button":Ee}},qY={class:"col-sm-12"},OY={key:0,class:"row"},jY={key:1,class:"card card-light"},RY={class:"card-header"},xY={class:"card-title"},BY={class:"card-body"},KY={class:"row",id:"cab-name"},zY={key:0,class:"row"},HY={id:"list-of-levels"},YY={class:"card card-light"},WY={class:"card-header"},JY={class:"card-title"},GY={class:"card-tools"},ZY=["id","onClick"],QY=a("span",{class:"fas fa-times"},null,-1),XY=[QY],eW={class:"card-body"},tW={class:"row"},sW=["id"],aW={class:"modal-title"},nW=["id"],oW=a("i",{class:"fas fa-trash","aria-hidden":"true"},null,-1),iW={class:"card-footer"},lW=a("span",{class:"glyphicon glyphicon-plus"},null,-1),rW=["disabled"];function dW(e,t,s,d,n,i){const h=u("alert"),_=u("custom-loader"),f=u("text-field"),p=u("dynamic-select"),b=u("radio-button"),k=u("static-select"),D=u("modal"),P=N("focus-first-input"),E=N("tooltip");return o(),l("div",qY,[m(h,{componentName:"cab"}),n.hasDataPopulated===!1||n.loading===!0?(o(),l("div",OY,[m(_)])):c("",!0),n.hasDataPopulated?(o(),l("div",jY,[a("div",RY,[a("h3",xY,r(e.trans(n.title)),1)]),a("div",BY,[w((o(),l("div",KY,[m(f,{label:e.trans("name"),value:n.name,name:"name",onChange:i.onChange,placehold:e.lang("enter_a_value"),required:!0,classname:"col-md-4"},null,8,["label","value","onChange","placehold"]),m(p,{label:e.trans("status_on_approve"),name:"action_on_approve",multiple:!1,value:n.action_on_approve,classname:"col-sm-3",onChange:i.onChange,apiEndpoint:"/service-desk/api/status/list?module=2",clearable:!!n.action_on_approve},null,8,["label","value","onChange","clearable"]),m(p,{label:e.trans("status_on_deny"),name:"action_on_deny",multiple:!1,value:n.action_on_deny,classname:"col-sm-3",onChange:i.onChange,apiEndpoint:"/service-desk/api/status/list?module=2",clearable:!!n.action_on_deny},null,8,["label","value","onChange","clearable"]),m(b,{options:n.radioOptions,label:e.trans("send_auto_reminders"),name:"send_auto_reminders",value:n.send_auto_reminders,onChange:i.onChange,classname:"form-group col-sm-2"},null,8,["options","label","value","onChange"])])),[[P]]),n.send_auto_reminders?(o(),l("div",zY,[m(k,{label:e.trans("reminder_interval"),elements:n.reminderOptions,name:"reminder_interval",onChange:i.onChange,required:!0,classname:"col-sm-4",value:n.reminder_interval},null,8,["label","elements","onChange","value"])])):c("",!0),a("div",HY,[(o(!0),l(I,null,$(n.levels,(M,F)=>(o(),l(I,null,[m(h,{componentName:"cab-level-"+F},null,8,["componentName"]),a("div",YY,[a("div",WY,[a("h3",JY,r(e.trans("level"))+" "+r(F+1),1),a("div",GY,[n.levels.length>1?w((o(),l("button",{key:0,id:"cab-level-delete-"+F,onClick:T=>i.deleting(F,M.id),class:"btn btn-tool"},XY,8,ZY)),[[E,e.trans("close")]]):c("",!0)])]),a("div",eW,[a("div",tW,[m(f,{label:e.trans("name"),value:M.name,name:"level-name-"+F,onChange:i.onChange,placehold:e.lang("enter_a_value"),required:!0,classname:"col-md-6"},null,8,["label","value","name","onChange","placehold"]),m(k,{label:e.trans("matcher"),elements:n.matcherOptions,name:"level-match-"+F,onChange:i.onChange,required:!0,classname:"col-md-6",value:M.match},null,8,["label","elements","name","onChange","value"])]),a("div",{class:"row",id:"cab-level-"+F},[m(p,{label:e.trans("contacts"),value:M.approvers.users,onChange:i.onChange,name:"cab-agent-"+F,apiEndpoint:"/api/dependency/users?meta=true",multiple:!0,classname:"col-md-6",strlength:"50"},null,8,["label","value","onChange","name"]),m(p,{label:e.trans("user_types"),value:M.approvers.user_types,onChange:i.onChange,name:"cab-user-type-"+F,apiEndpoint:"/service-desk/api/dependency/user_types",multiple:!0,classname:"col-md-6",strlength:"50"},null,8,["label","value","onChange","name"])],8,sW)]),n.showDeletePopUp?(o(),v(D,{key:0,showModal:!0,onClose:()=>n.showDeletePopUp=!1,containerStyle:n.containerStyle},{title:y(()=>[a("h4",aW,r(e.trans("delete_cab_level")),1)]),fields:y(()=>[a("span",null,r(e.trans("you_are_about_to_delete_a_cab_level"))+". "+r(e.trans("please_confirm")),1)]),controls:y(()=>[a("button",{id:"confirm-delete-button-"+F,type:"button",onClick:t[0]||(t[0]=T=>i.onDelete()),class:"btn btn-danger"},[oW,g(" "+r(e.trans("delete")),1)],8,nW)]),_:2},1032,["onClose","containerStyle"])):c("",!0)])],64))),256))])]),a("div",iW,[a("button",{type:"button",id:"add-level",onClick:t[1]||(t[1]=(...M)=>i.addLevel&&i.addLevel(...M)),class:"btn btn-primary"},[lW,g(" "+r(e.trans("add_level")),1)]),a("button",{type:"button",id:"submit-cab",onClick:t[2]||(t[2]=(...M)=>i.onSubmit&&i.onSubmit(...M)),disabled:n.loading,class:"btn btn-primary"},[a("span",{class:j(n.iconClass)},null,2),g(" "+r(e.trans(n.btnName)),1)],8,rW)])])):c("",!0)])}const Ps=C(EY,[["render",dW]]),cW={name:"cursor-pagination",props:{prev_page_url:{type:[String,null],default:""},next_page_url:{type:[String,null],default:""},onPagination:{type:Function,default:()=>{}}}},uW={key:0,class:"simple-pagination"},hW=["disabled"],mW=a("i",{class:"fas fa-arrow-left"},null,-1),_W=["disabled"],pW=a("i",{class:"fas fa-arrow-right"},null,-1);function fW(e,t,s,d,n,i){return s.prev_page_url||s.next_page_url?(o(),l("div",uW,[a("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=h=>s.onPagination("previous")),disabled:!s.prev_page_url},[mW,g("   "+r(e.trans("previous")),1)],8,hW),a("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=h=>s.onPagination("next")),disabled:!s.next_page_url},[g(r(e.trans("next"))+"  ",1),pW],8,_W)])):c("",!0)}const gW=C(cW,[["render",fW]]);const bW={name:"cab-activity",description:"Cab activity page",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},data(){return{loading:!0,apiUrl:"",activity_log:"",perPage:10,total:0,maxSize:5,pagination:1,paramsObj:{},filtering:!1,sort_key:"desc",cabId:"",next_page_url:"",prev_page_url:""}},created(){window.emitter.on("updateActivity",this.getUpdateActivity)},beforeMount(){this.cabId=W(window.location.pathname),this.apiUrl="service-desk/api/cab-log/"+this.cabId,this.paramsObj.page=this.pagination,this.getValues(this.paramsObj)},watch:{pagination(e,t){this.filtering=!0;var s=document.getElementById("activity_log_div");return s.scrollIntoView({behavior:"smooth"}),this.paramsObj.page=e,this.getValues(this.paramsObj),e},filtering(e){this.$emit("loaderValue",e)},loading(e){this.$emit("loaderValue",e)}},computed:{PerPage:function(){return this.perPage?parseInt(this.perPage):10},Records:function(){return this.total?parseInt(this.total):0}},methods:{onPagination(e){this.loading=!0,this.apiUrl=e==="next"?this.next_page_url:this.prev_page_url,this.getValues(this.paramsObj)},getUpdateActivity(){this.activity_log=[],this.loading=!0,this.pagination=1,this.sort_key="desc",this.perPage=10,this.total=0,this.paramsObj.page=1,this.paramsObj.limit=10,this.paramsObj["sort-order"]="desc",this.getValues(this.paramsObj)},commonFilter(){this.filtering=!0,this.pagination=1,this.paramsObj.page=1,this.getValues(this.paramsObj)},logLimit(e){this.paramsObj.limit=e,this.apiUrl="service-desk/api/cab-log/"+this.cabId,this.commonFilter()},orderBy(e){this.sort_key=e,this.paramsObj["sort-order"]=e,this.commonFilter()},getValues(e){S.get(this.apiUrl,{params:e}).then(t=>{this.loading=!1,this.filtering=!1,this.activity_log=t.data.data.cab_activity_logs.data,this.activity_log.forEach(function(s,d){s.name="<div>"+s.name+"</div>"}),this.total=t.data.data.cab_activity_logs.total,this.perPage=t.data.data.cab_activity_logs.per_page,this.next_page_url=t.data.data.cab_activity_logs.next_page_url,this.prev_page_url=t.data.data.cab_activity_logs.prev_page_url}).catch(t=>{this.loading=!1,this.filtering=!1})},checkDate(e){if(e==0)return!0;var t=this.formattedDate(this.activity_log[e-1].created_at),s=this.formattedDate(this.activity_log[e].created_at);if(t!=s)return!0},showThreadEnd(e){return e===this.activity_log.length-1}},components:{"cursor-pagination":gW,"activity-parser":xe}},Le=e=>(K("data-v-5c2b28cb"),e=e(),z(),e),yW={class:"row",id:"activity_log_div"},vW={class:"col-sm-12 mb-2"},wW={key:0,id:"select_limit"},kW=Le(()=>a("option",{value:"10"},"10",-1)),CW=Le(()=>a("option",{value:"25"},"25",-1)),DW=Le(()=>a("option",{value:"50"},"50",-1)),SW=Le(()=>a("option",{value:"100"},"100",-1)),FW=[kW,CW,DW,SW],MW={key:1,id:"choose_order"},IW={id:"sort_btn",type:"button","data-toggle":"dropdown",class:"btn btn-default dropdown-toggle"},AW={class:"dropdown-menu",style:{"z-index":"9999"}},PW=Le(()=>a("i",{class:"fas fa-sort-amount-up"},null,-1)),TW=Le(()=>a("i",{class:"fas fa-sort-amount-down"},null,-1)),VW={class:"float-right"},LW={class:"col-md-12"},UW={key:0,class:"timeline"},$W={key:0,class:"time-label"},NW={class:"bg-default border"},EW={class:"change-activity-timline"},qW=Le(()=>a("i",{class:"far fa-dot-circle"},null,-1)),OW={class:"timeline-item"},jW={class:"time"},RW=Le(()=>a("i",{class:"far fa-clock"},null,-1)),xW={class:"timeline-header"},BW={class:"timeline-body break"},KW={key:1},zW=Le(()=>a("i",{class:"far fa-clock bg-gray"},null,-1)),HW=[zW],YW={key:0,class:"col-sm-12"},WW={class:"text-center"};function JW(e,t,s,d,n,i){const h=u("cursor-pagination"),_=u("faveo-image-element"),f=u("router-link"),p=u("activity-parser");return o(),l("div",yW,[a("div",vW,[!n.loading&&n.activity_log.length>0?(o(),l("div",wW,[w(a("select",{class:"form-control","onUpdate:modelValue":t[0]||(t[0]=b=>n.perPage=b),onChange:t[1]||(t[1]=b=>i.logLimit(n.perPage))},FW,544),[[qe,n.perPage]])])):c("",!0),!n.loading&&n.activity_log.length>0?(o(),l("div",MW,[a("button",IW,r(e.lang("created_time"))+" - "+r(e.lang(n.sort_key)),1),a("div",AW,[a("a",{href:"javascript:;",class:"dropdown-item",onClick:t[2]||(t[2]=b=>i.orderBy("asc"))},[PW,g(" "+r(e.lang("asc")),1)]),a("a",{href:"javascript:;",onClick:t[3]||(t[3]=b=>i.orderBy("desc")),class:"dropdown-item"},[TW,g(" "+r(e.lang("desc")),1)])])])):c("",!0),a("div",VW,[m(h,{prev_page_url:n.prev_page_url,next_page_url:n.next_page_url,onPagination:i.onPagination},null,8,["prev_page_url","next_page_url","onPagination"])])]),a("div",LW,[!n.loading&&n.activity_log.length>0?(o(),l("div",UW,[(o(!0),l(I,null,$(n.activity_log,(b,k)=>(o(),l(I,null,[i.checkDate(k)?(o(),l("div",$W,[a("span",NW,r(d.formattedDate(b.created_at)),1)])):c("",!0),a("div",EW,[qW,a("div",OW,[a("span",jW,[RW,g(" "+r(d.formattedTime(b.created_at)),1)]),a("h3",xW,[m(_,{id:"change_img","source-url":b.creator.profile_pic,classes:["img-circle","img-bordered-sm"],"alternative-text":"User Image","img-width":25,"img-height":25},null,8,["source-url"]),m(f,{to:"/user/"+b.creator.id},{default:y(()=>[g(" "+r(b.creator.full_name),1)]),_:2},1032,["to"])]),a("div",BW,[m(p,{data:b.name},null,8,["data"])])])]),i.showThreadEnd(k)?(o(),l("div",KW,HW)):c("",!0)],64))),256))])):c("",!0)]),!n.filtering&&!n.loading&&n.activity_log.length===0?(o(),l("div",YW,[a("h6",WW,r(e.lang("no_data_found")),1)])):c("",!0)])}const GW=C(bW,[["render",JW],["__scopeId","data-v-5c2b28cb"]]),ZW={name:"cab-detail",description:"Change Advisory Board",props:{cab:{type:String,default:()=>{}}},data(){return{name:"",cab_id:this.cab,title:"Cab Detail",action_on_approve:"",action_on_deny:"",send_auto_reminders:""}},beforeMount(){this.getData()},methods:{subString(e,t=15){return oe(e,t)},getData(){this.loading=!0,axios.get("/service-desk/api/cab/"+this.cab_id).then(e=>{this.action_on_approve=e.data.data.action_on_approve.name,this.action_on_deny=e.data.data.action_on_deny.name,this.send_auto_reminders=e.data.data.send_auto_reminders?"Yes":"No",document.getElementById("on_approve").innerText=this.action_on_approve,document.getElementById("on_deny").innerText=this.action_on_deny,document.getElementById("logs").innerText=e.data.data.name,document.getElementById("reminder").innerText=this.send_auto_reminders})}}},QW={class:"card card-light"},XW=a("div",{class:"card-header"},[a("h3",{class:"card-title",id:"logs"})],-1),eJ={class:"card-body"},tJ={class:"row"},sJ={class:"col-md-12"},aJ={class:"callout callout-info bg-info"},nJ={class:"row"},oJ={class:"col-md-4"},iJ={id:"on_approve"},lJ={class:"col-md-4"},rJ={id:"on_deny"},dJ={class:"col-md-4"},cJ={id:"reminder"};function uJ(e,t,s,d,n,i){const h=N("tooltip");return o(),l("div",null,[a("div",QW,[XW,a("div",eJ,[a("div",tJ,[a("div",sJ,[a("div",aJ,[a("div",nJ,[a("div",oJ,[a("p",null,[a("b",null,r(e.trans("status_on_approve"))+" : ",1),w(a("span",iJ,null,512),[[h,this.action_on_approve]])])]),a("div",lJ,[a("p",null,[a("b",null,r(e.trans("status_on_deny"))+" : ",1),w(a("span",rJ,null,512),[[h,n.action_on_deny]])])]),a("div",dJ,[a("p",null,[a("b",null,r(e.trans("send_auto_reminders"))+" : ",1),w(a("span",cJ,null,512),[[h,n.send_auto_reminders]])])])])])])])])])])}const la=C(ZW,[["render",uJ]]);const hJ={name:"cab-associates",description:"cab associates page",props:{cab:{type:String,default:()=>{}},cabId:{type:String|Number,default:""},actions:{type:Object|String,default:()=>{}}},data(){return{tabs:[{id:"activity",title:"activity_log",show:!0}],category:"activity",loading:!0}},methods:{associates(e){this.category=e},handelLoader(e){this.loading=e}},components:{CabDetail:la,CabActivity:GW}},mJ=e=>(K("data-v-246defc5"),e=e(),z(),e),_J={id:"cab-associates",class:"card card-light card-tabs"},pJ={class:"card-header p-0 pt-1"},fJ={class:"nav nav-tabs"},gJ={key:0,class:"nav-item"},bJ=["onClick"],yJ={class:"nav-item ml-auto mt-04"},vJ={key:0,type:"button",class:"btn btn-tool rotating","data-card-widget":"refresh"},wJ=mJ(()=>a("i",{class:"fas fa-refresh"},null,-1)),kJ=[wJ],CJ={class:"card-body"},DJ={class:"tab-content"},SJ={class:"active tab-pane",id:"activity"};function FJ(e,t,s,d,n,i){const h=u("alert"),_=u("cab-activity");return o(),l("div",_J,[m(h,{componentName:"cabAssociates"}),a("div",pJ,[a("ul",fJ,[(o(!0),l(I,null,$(n.tabs,f=>(o(),l(I,null,[f.show?(o(),l("li",gJ,[a("a",{id:"change_tab",class:j(["nav-link",{active:n.category===f.id}]),"data-toggle":"pill",onClick:p=>i.associates(f.id)},r(e.trans(f.title)),11,bJ)])):c("",!0),a("li",yJ,[n.loading?(o(),l("a",vJ,kJ)):c("",!0)])],64))),256))])]),a("div",CJ,[a("div",DJ,[a("div",SJ,[a("div",null,[n.category==="activity"?(o(),v(_,{key:0,cabId:s.cabId,onLoaderValue:i.handelLoader},null,8,["cabId","onLoaderValue"])):c("",!0)])])])])])}const MJ=C(hJ,[["render",FJ],["__scopeId","data-v-246defc5"]]),IJ={name:"cab-view",description:"Cab view page",data(){return{cab:"",cab_id:"",loading:!0,actions:"",counter:0}},beforeMount(){this.getValues()},created(){window.emitter.on("updateCabAssociates",this.updateAssociates),window.emitter.on("updateCabView",this.updateView)},methods:{updateView(){this.loading=!0,setTimeout(()=>{this.getValues()},500)},refreshData(){this.getValues()},updateAssociates(){setTimeout(()=>{this.getValues(!0,Date.now())},500)},getValues(e,t=""){const s=window.location.pathname;this.cab_id=W(s),S.get("/service-desk/api/cab/"+this.cab_id+"?time="+t).then(d=>{this.cab=d.data.data.cab,this.getActions(e,t)}).catch(d=>{this.loading=!1,A(d,"cab-view")})},handelLoader(e){this.tabloading=e}},components:{CabAssociates:MJ,CabDetail:la}},AJ={key:0};function PJ(e,t,s,d,n,i){const h=u("alert"),_=u("reuse-loader"),f=u("cab-detail"),p=u("cab-associates");return o(),l("div",{class:"col-sm-12",key:n.counter},[m(h,{componentName:"cab-view"}),n.loading?(o(),l("div",AJ,[m(_,{"animation-duration":4e3,size:60})])):c("",!0),n.loading?c("",!0):(o(),l(I,{key:1},[m(f,{cabId:n.cab_id,cab:n.cab_id},null,8,["cabId","cab"]),m(p,{cabId:n.cab_id,cab:n.cab_id,actions:n.actions},null,8,["cabId","cab","actions"])],64))])}const TJ=C(IJ,[["render",PJ]]);function VJ(e){const{to:t,subject:s,organization:d,department:n,description:i}=e;var h={subject:[s,"isRequired"],description:[i,"isRequired"]};t==="department"&&(h.department=[n,"isRequired"]),t==="organization"&&(h.organization=[d,"isRequired"]);const _=new ce(ae),{errors:f,isValid:p}=_.validate(h);return ie.dispatch("setValidationError",f),{errors:f,isValid:p}}const LJ={name:"announcement",description:"Announcement page",data(){return{to:"department",subject:"",description:"",organization:"",department:"",loading:!1,radioOptions:[{name:"department",value:"department"},{name:"organization",value:"organization"}],classname:"form-group",show_err:!1,showField:!0}},methods:{isValid(){const{errors:e,isValid:t}=VJ(this.$data);return!!t},onChange(e,t){this[t]=e,t==="to"&&(this.department="",this.organization="",this.showField=!1,setTimeout(()=>{this.showField=!0},1))},onSubmit(){if(this.isValid()){this.loading=!0;var e=new FormData;e.append("option",this.to+"_id"),e.append("subject",this.subject),this.organization&&e.append("organization_id",this.organization.id),this.department&&e.append("department_id",this.department.id),e.append("announcement",this.description);const t={headers:{"Content-Type":"multipart/form-data"}};S.post("/service-desk/api/announcement",e,t).then(s=>{this.loading=!1,this.subject="",this.description="",this.to="department",this.department="",this.organization="",U(s,"announcement")}).catch(s=>{this.loading=!1,A(s,"announcement")})}}},components:{"text-field":le,"dynamic-select":G,"radio-button":Ee}},UJ={class:"col-sm-12"},$J={key:0,class:"row"},NJ={class:"card card-light"},EJ={class:"card-header"},qJ={class:"card-title"},OJ={class:"card-body"},jJ={class:"row"},RJ={class:"row"},xJ={class:"card-footer"},BJ=a("i",{class:"fas fa-paper-plane"},null,-1);function KJ(e,t,s,d,n,i){const h=u("custom-loader"),_=u("alert"),f=u("text-field"),p=u("radio-button"),b=u("dynamic-select"),k=u("tiny-editor"),D=N("focus-first-input");return o(),l("div",UJ,[n.loading?(o(),l("div",$J,[m(h,{duration:4e3})])):c("",!0),m(_,{componentName:"announcement"}),a("div",NJ,[a("div",EJ,[a("h3",qJ,r(e.lang("announcement")),1)]),a("div",OJ,[w((o(),l("div",jJ,[m(f,{label:e.lang("subject"),value:n.subject,type:"text",name:"subject",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-5",required:!0},null,8,["label","value","onChange","placehold"]),m(p,{options:n.radioOptions,label:e.lang("announcement_to"),name:"to",value:n.to,onChange:i.onChange,classname:"form-group col-sm-3"},null,8,["options","label","value","onChange"]),n.showField?(o(),l(I,{key:0},[n.to==="department"?(o(),v(b,{key:0,label:e.lang("department"),multiple:!1,name:"department",prePopulate:!1,classname:"col-sm-4",apiEndpoint:"/api/dependency/departments",value:n.department,required:!0,clearable:!!n.department,strlength:"30",onChange:i.onChange},null,8,["label","value","clearable","onChange"])):c("",!0),n.to==="organization"?(o(),v(b,{key:1,label:e.lang("organization"),multiple:!1,name:"organization",prePopulate:!1,classname:"col-sm-4",apiEndpoint:"/api/dependency/organizations",value:n.organization,required:!0,clearable:!!n.organization,strlength:"30",onChange:i.onChange},null,8,["label","value","clearable","onChange"])):c("",!0)],64)):c("",!0)])),[[D]]),a("div",RJ,[m(k,{value:n.description,type:"text",onChange:i.onChange,name:"description",label:e.lang("description"),classname:"col-sm-12",required:!0,lang:"en"},null,8,["value","onChange","label"])])]),a("div",xJ,[a("button",{id:"submit_btn",class:"btn btn-primary",onClick:t[0]||(t[0]=P=>i.onSubmit())},[BJ,g(" "+r(e.lang("send")),1)])])])])}const zJ=C(LJ,[["render",KJ]]),HJ={components:{"text-field":le,radio:Ee,file:He},beforeMount(){this.getExistingCustomTemplateDetails()},data(){return{labelType:1,display_logo_confirmed:0,radioOptionsLogo:[{name:"Yes",value:1},{name:"No",value:0}],width:"",height:"",logo_image:null,labels_per_row:"",space_between_labels:"",showModal:!1,loading:!1,loadingSpeed:4e3,logo_text:"",barcode_mode:"system_default",template_exists:!1,image_exists:!1,isDisabled:!0,templateId:"",componentRenderKey:Math.random(),isLoading:!1,containerStyle:{width:" 500px"}}},watch:{},methods:{onChange(e,t){this[t]=e,t=="logo_image"&&(this.logo_image=e?e[0]:""),e===null&&(this[t]="")},deleteTemplate(){this.isLoading=!0,this.isDisabled=!0,S.patch("service-desk/barcode/template/reset/"+this.templateId).then(e=>{U(e,"barcode_settings"),Object.assign(this.$data,this.$options.data.apply(this)),this.getExistingCustomTemplateDetails()}).catch(e=>{A(e,"barcode_settings")}).finally(()=>{this.showModal=!1,this.isLoading=!1,this.loading=!1})},toggleModal(){this.showModal=!this.showModal},onClose(){this.showModal=!1},onSubmit(){let e=new FormData;this.image_exists=!!this.logo_image,this.logo_image instanceof File&&e.append("logo_image",this.logo_image),e.append("image_exists",this.image_exists),e.append("width",this.width),e.append("height",this.height),e.append("labels_per_row",this.labels_per_row),e.append("space_between_labels",this.space_between_labels),e.append("display_logo_confirmed",this.display_logo_confirmed),this.loading=!0;let t=this.template_exists?"service-desk/barcode/template/update/"+this.templateId:"service-desk/barcode/template/create";S.post(t,e,{headers:{"Content-Type":"multipart/form-data"}}).then(s=>{U(s,"barcode_settings"),this.loading=!1,this.$store.dispatch("unsetValidationError"),Object.assign(this.$data,this.$options.data.apply(this)),this.getExistingCustomTemplateDetails()}).catch(s=>{A(s,"barcode_settings"),this.loading=!1})},updateStatesWithData(e){const t=this,s=this.$data;Object.keys(e).map(d=>{s.hasOwnProperty(d)&&(t[d]=e[d])})},getExistingCustomTemplateDetails(){S.get("service-desk/barcode-template").then(e=>{this.template_exists=!0;let t=e.data.data;this.updateStatesWithData(t),this.isDisabled=!1,this.templateId=t.id}).catch(e=>{this.template_exists=!1,this.isDisabled=!0})},triggerEvent(e){var t=e.which||e.keyCode;t===13&&this.onSubmit()}}},YJ={class:"col-sm-12"},WJ={class:"card card-light"},JJ={class:"card-header"},GJ={class:"card-title"},ZJ={class:"card-body"},QJ={class:"row"},XJ={class:"row"},eG={class:"card-footer"},tG=a("i",{class:"fas fa-save"},null,-1),sG=["disabled"],aG=a("i",{class:"glyphicon glyphicon-repeat"},null,-1),nG={class:"modal-title"},oG={key:0},iG={key:1,class:"row"},lG=a("i",{class:"glyphicon glyphicon-repeat","aria-hidden":"true"},null,-1);function rG(e,t,s,d,n,i){const h=u("custom-loader"),_=u("alert"),f=u("text-field"),p=u("radio"),b=u("file"),k=u("reuse-loader"),D=u("modal"),P=N("focus-first-input");return o(),l("div",YJ,[n.loading?(o(),v(h,{key:0,duration:n.loadingSpeed},null,8,["duration"])):c("",!0),m(_,{componentName:"barcode_settings"}),a("div",WJ,[a("div",JJ,[a("h3",GJ,r(e.lang("barcode_settings")),1)]),a("div",ZJ,[w((o(),l("div",QJ,[m(f,{label:e.lang("label_width"),onChange:i.onChange,placehold:e.lang("enter_a_value"),value:n.width,type:"text",name:"width",keyupListener:i.triggerEvent,classname:"col-sm-3",id:"label_width",required:!0},null,8,["label","onChange","placehold","value","keyupListener"]),m(f,{label:e.lang("label_height"),onChange:i.onChange,placehold:e.lang("enter_a_value"),value:n.height,type:"text",keyupListener:i.triggerEvent,name:"height",required:!0,classname:"col-sm-3",id:"label_height"},null,8,["label","onChange","placehold","value","keyupListener"]),m(f,{label:e.lang("space_between_labels"),onChange:i.onChange,placehold:e.lang("enter_a_value"),value:n.space_between_labels,type:"text",keyupListener:i.triggerEvent,name:"space_between_labels",required:!0,classname:"col-sm-3",id:"space_between_labels"},null,8,["label","onChange","placehold","value","keyupListener"]),m(f,{label:e.lang("labels_per_row"),onChange:i.onChange,placehold:e.lang("enter_a_value"),value:n.labels_per_row,type:"text",keyupListener:i.triggerEvent,name:"labels_per_row",required:!0,classname:"col-sm-3",id:"labels_per_row"},null,8,["label","onChange","placehold","value","keyupListener"])])),[[P]]),a("div",XJ,[m(p,{name:"display_logo_confirmed",value:n.display_logo_confirmed,label:e.lang("display_logo_confirm"),options:e.lang(n.radioOptionsLogo),required:!0,classname:"form-group col-sm-3",onChange:i.onChange},null,8,["value","label","options","onChange"]),(o(),v(b,{name:"logo_image",value:n.logo_image,label:e.lang("logo_image"),onChange:i.onChange,id:"logo_image",classname:"col-sm-6",key:n.componentRenderKey,accept:"image/x-png,image/jpeg"},null,8,["value","label","onChange"]))])]),a("div",eG,[a("button",{type:"button",onClick:t[0]||(t[0]=(...E)=>i.onSubmit&&i.onSubmit(...E)),class:"btn btn-primary"},[tG,g(" "+r(e.lang("save")),1)]),a("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=(...E)=>i.toggleModal&&i.toggleModal(...E)),id:"resetBtn",disabled:n.isDisabled},[aG,g("  "+r(e.lang("reset")),1)],8,sG)])]),m(q,{name:"modal"},{default:y(()=>[n.showModal?(o(),v(D,{key:0,showModal:!0,onClose:()=>n.showModal=!1,containerStyle:n.containerStyle},{title:y(()=>[a("h4",nG,r(e.lang("reset")),1)]),fields:y(()=>[n.isLoading?c("",!0):(o(),l("div",oG,[a("span",null,r(e.lang("reset_confirm")),1)])),n.isLoading?(o(),l("div",iG,[m(k,{"animation-duration":4e3,color:"#1d78ff",size:60})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",onClick:t[2]||(t[2]=(...E)=>i.deleteTemplate&&i.deleteTemplate(...E)),class:"btn btn-primary"},[lG,g("  "+r(e.lang("reset")),1)])]),_:1},8,["onClose","containerStyle"])):c("",!0)]),_:1})])}const dG=C(HJ,[["render",rG]]);const cG={name:"SdimportProgress",description:"Common component to track the import progress",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},data(){return{urlLabel:"",url:"",trackingId:"",responseData:null,loading:!0,dataTableOptions:{headings:{row:this.trans("row_number"),field:this.trans("field_name"),comment:this.trans("reason")},columnsClasses:{row:"import__failed__row",field:"import__failed__field",comment:"import__failed__comment"},filterable:!1,sortable:[],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(e){return{page:e.page,limit:e.limit}},responseAdapter({data:e}){return{data:e.data.map(t=>t),count:e.total}}}}},beforeMount(){let e=new URLSearchParams(window.location.search);this.urlLabel=e.get("sd_import_redirect_url_label_after_track"),this.url=e.get("sd_import_redirect_url_after_track"),this.trackingId=W(window.location.pathname),this.getTrackingData()},computed:{getUrlAttribute(){const e=this.basePath()+"/"+this.url,t=this.urlLabel?this.urlLabel:this.lang("sd_importer_import_tracking_view_label");return`<p><a href="${e}">${t}</a></p>`},showFailedRows(){return this.responseData.totalFailed||this.responseData.totalWarning},failedRowsUrl(){return`service-desk/import-tracking-failed/${this.trackingId}`}},methods:{async getTrackingData(){try{let e=await S.get(`service-desk/import-tracking-details/${this.trackingId}`);this.responseData=e.data.data,this.loading=!1}catch(e){console.error("Sd_Import_Progress_Error:",e)}}}},uG={class:"col-sm-12"},hG={key:1},mG={class:"row"},_G={class:"col-md-12"},pG={class:"table-responsive"},fG={class:"table table-bordered"},gG={class:"thead-light"},bG={key:0},yG=["innerHTML"],vG={key:0,class:"row"},wG={class:"col-sm-12"};function kG(e,t,s,d,n,i){const h=u("custom-loader"),_=u("faveo-box"),f=u("data-table");return o(),l("div",uG,[n.loading?(o(),v(h,{key:0,"animation-duration":4e3,size:60})):(o(),l("div",hG,[m(_,{title:e.lang("sd_import_result_summary_label")},{default:y(()=>[a("div",mG,[a("div",_G,[a("div",pG,[a("table",fG,[a("thead",gG,[a("tr",null,[a("th",null,r(e.lang("sd_import_result_name_label")),1),a("th",null,r(e.lang("sd_import_result_type_label")),1),a("th",null,r(e.lang("sd_import_result_status_label")),1),a("th",null,r(e.lang("sd_import_result_ended_at_label")),1),a("th",null,r(e.lang("sd_import_result_created_label")),1),a("th",null,r(e.lang("sd_import_result_updated_label")),1),a("th",null,r(e.lang("sd_import_result_failed_label")),1),a("th",null,r(e.lang("sd_import_result_warning_label")),1),n.url?(o(),l("th",bG,r(e.lang("sd_import_result_action_label")),1)):c("",!0)])]),a("tbody",null,[a("tr",null,[a("td",null,r(n.responseData.name),1),a("td",null,r(n.responseData.type),1),a("td",null,r(n.responseData.status_text),1),a("td",null,r(d.formattedTime(n.responseData.ended_at)),1),a("td",null,r(n.responseData.totalCreated),1),a("td",null,r(n.responseData.totalUpdated),1),a("td",null,r(n.responseData.totalFailed),1),a("td",null,r(n.responseData.totalWarning),1),n.url?(o(),l("td",{key:0,innerHTML:i.getUrlAttribute},null,8,yG)):c("",!0)])])])])])])]),_:1},8,["title"]),i.showFailedRows?(o(),l("div",vG,[a("div",wG,[m(_,{title:e.lang("sd_importer_import_tracking_view_failed_box_label")},{default:y(()=>[m(f,{url:i.failedRowsUrl,dataColumns:["row","field","comment"],option:n.dataTableOptions},null,8,["url","option"])]),_:1},8,["title"])])])):c("",!0)]))])}const CG=C(cG,[["render",kG],["__scopeId","data-v-ccd988fa"]]);const DG={name:"SdImportMapper",components:{ToolTip:tt,FormFieldTemplate:Es,StaticSelect:st},props:{getDetailsApiEndpoint:{type:String,required:!0},submitApiEndpoint:{type:String,required:!0},updateParent:{required:!0,type:Function},tableHeadings:{required:!0,type:Object},importId:{required:!1,type:[String,Number]},extraData:{type:Object,required:!1,default:()=>{}}},beforeMount(){this.getDataForMapping()},data(){return{systemAttributes:[],importAttributes:[],loading:!1,hasDataPopulated:!1,formFieldLabelStyle:{display:"none"},shouldUpdateExisting:!1,date_time_format:"",shouldHandleDateFormat:!1,dateFieldHasMapping:!1,dateTimeFormats:[{id:"Y-m-d H:i",name:"YYYY-MM-DD HH:mm"},{id:"m-d-Y H:i",name:"MM-DD-YYYY HH:mm"},{id:"d-m-Y H:i",name:"DD-MM-YYYY HH:mm"},{id:"Y/m/d H:i",name:"YYYY/MM/DD HH:mm"},{id:"m/d/Y H:i",name:"MM/DD/YYYY HH:mm"},{id:"d/m/Y H:i",name:"DD/MM/YYYY HH:mm"}]}},watch:{systemAttributes:{handler(e){e.forEach(t=>{t.type==="date"&&(t.mapped_to!=="No mapping"?this.dateFieldHasMapping=!0:this.dateFieldHasMapping=!1)})},deep:!0}},computed:{loadingState(){return this.loading||!this.hasDataPopulated},showDateFormatField(){return this.shouldHandleDateFormat&&this.dateFieldHasMapping}},methods:{getDataForMapping(){let e=this.extraData?this.extraData:{};S.get(this.getDetailsApiEndpoint,{params:e}).then(t=>{this.systemAttributes=t.data.data.columns_to_import,this.importAttributes=t.data.data.csv_headers_for_mapping,this.shouldHandleDateFormat=t.data.data.handle_date_field,this.loading=!1,this.hasDataPopulated=!0}).catch(t=>{A(t),this.loading=!1})},onChange(e,t){this[t]=e},emitDiscardModalButtonIsClicked(){this.$emit("sdImportDiscardModalButtonClicked")},onSubmit(){this.loading=!0;let e={mapped_system_attributes:this.systemAttributes,import_id:this.importId,update_existing:this.shouldUpdateExisting,should_handle_date:this.showDateFormatField,date_time_format:this.date_time_format?this.date_time_format:null};this.extraData&&Object.keys(this.extraData).length===0&&this.extraData.constructor===Object||(e.special_keys=this.extraData),S.post(this.submitApiEndpoint,e).then(t=>{U(t,this.$options.name),setTimeout(()=>{this.$store.dispatch("unsetAlert"),this.$store.dispatch("unsetValidationError"),this.loading=!1,this.updateParent()},5e3)}).catch(t=>{A(t,this.$options.name),this.loading=!1})}}},ra=e=>(K("data-v-9fd1b076"),e=e(),z(),e),SG={class:"com-sm-12"},FG={key:1,class:"card card-light"},MG={class:"card-header"},IG={class:"d-flex align-items-center"},AG={class:"mr-auto"},PG={class:"card-title"},TG={class:"btn-group",role:"group"},VG=["title"],LG=ra(()=>a("i",{class:"fas fa-arrow-up"},null,-1)),UG=[LG],$G={class:"card-body"},NG={class:"row"},EG={class:"col-sm-6"},qG={class:"form-check form-check-inline mb-3"},OG={class:"form-check-label",for:"shouldUpdateExisting"},jG={id:"faveo-attribute-list",class:"faveo-table table table-bordered"},RG={class:"thead-default"},xG={class:"padding-top-12"},BG=["id"],KG=["id"],zG={key:1,class:"text-red"},HG=["onUpdate:modelValue","id"],YG=["id","value"],WG={key:0,class:"row mt-3"},JG={class:"card-footer"},GG=["disabled"],ZG=ra(()=>a("span",{class:"fas fa-upload"},null,-1));function QG(e,t,s,d,n,i){const h=u("alert"),_=u("custom-loader"),f=u("tool-tip"),p=u("form-field-template"),b=u("static-select");return o(),l("div",SG,[m(h,{componentName:this.$options.name},null,8,["componentName"]),i.loadingState?(o(),v(_,{key:0})):c("",!0),n.hasDataPopulated?(o(),l("div",FG,[a("div",MG,[a("div",IG,[a("div",AG,[a("h3",PG,r(e.lang("sd_import_mapper")),1),m(f,{message:e.lang("sd_import_mapper_description"),size:"large"},null,8,["message"])]),a("div",TG,[a("button",{class:"btn btn-default btn-sm",id:"discard-import-button",title:e.lang("sd_import_discard"),onClick:t[0]||(t[0]=(...k)=>i.emitDiscardModalButtonIsClicked&&i.emitDiscardModalButtonIsClicked(...k))},UG,8,VG)])])]),a("div",$G,[a("div",NG,[a("div",EG,[a("div",qG,[w(a("input",{class:"form-check-input cursor-pointer",type:"checkbox",id:"shouldUpdateExisting","onUpdate:modelValue":t[1]||(t[1]=k=>n.shouldUpdateExisting=k)},null,512),[[Lt,n.shouldUpdateExisting]]),a("label",OG,r(e.lang("sd_importer_should_update_existing")),1)])])]),a("table",jG,[a("thead",RG,[a("tr",null,[a("th",null,[g(r(e.lang(s.tableHeadings.system.header))+" ",1),m(f,{message:e.lang(s.tableHeadings.system.description)},null,8,["message"])]),a("th",null,[g(r(e.lang(s.tableHeadings.import.header))+" ",1),m(f,{message:e.lang(s.tableHeadings.import.description)},null,8,["message"])])])]),(o(!0),l(I,null,$(n.systemAttributes,(k,D)=>(o(),l("tr",{class:"faveo-attribute-elements",key:k.uuid},[k.hidden?(o(),l(I,{key:0},[],64)):(o(),l(I,{key:1},[a("td",xG,[k.nested?(o(),l("span",{key:0,id:"faveo-attribute-label-arrow-"+D,style:{"font-size":"1rem"}},"⤷",8,BG)):c("",!0),a("span",{id:"faveo-attribute-label-"+D},r(k.label),9,KG),k.required?(o(),l("span",zG,"*")):c("",!0),k.description?(o(),v(f,{key:2,message:k.description,size:"small"},null,8,["message"])):c("",!0)]),a("td",null,[m(p,{name:`mapped_system_attributes.${D}.mapped_to`,label:"",labelStyle:n.formFieldLabelStyle},{default:y(()=>[w(a("select",{"onUpdate:modelValue":P=>k.mapped_to=P,id:"attribute-list-"+D,class:"attribute-list form-control"},[(o(!0),l(I,null,$(n.importAttributes,P=>(o(),l("option",{id:"attribute-element-"+D,key:P.id,value:P.id},r(P.name),9,YG))),128))],8,HG),[[qe,k.mapped_to]])]),_:2},1032,["name","labelStyle"])])],64))]))),128))]),n.shouldHandleDateFormat?(o(),l("div",WG,[m(b,{label:e.lang("sd_import_date_format_label"),elements:n.dateTimeFormats,name:"date_time_format",value:n.date_time_format,classname:"col-sm-6",onChange:i.onChange,hint:e.lang("sd_importer_import_date_label_hint")},null,8,["label","elements","value","onChange","hint"])])):c("",!0)]),a("div",JG,[n.hasDataPopulated?(o(),l("button",{key:0,id:"sd-import-mapper-submit",type:"button",onClick:t[2]||(t[2]=(...k)=>i.onSubmit&&i.onSubmit(...k)),disabled:n.loading,class:"btn btn-primary update-btn"},[ZG,g(" "+r(e.lang("sd_import_action_button")),1)],8,GG)):c("",!0)])])):c("",!0)])}const da=C(DG,[["render",QG],["__scopeId","data-v-9fd1b076"]]),XG={name:"DiscardSdImportModal",description:"Confirms whether user wants to discard ongoing import",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function},apiUrl:{type:String,default:""}},data(){return{isDisabled:!1,loading:!1,containerStyle:{width:"500px"}}},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,S.delete(this.apiUrl).then(e=>{this.loading=!1,this.isDisabled=!0,this.$emit("performImportDiscard"),this.onClose()}).catch(e=>{this.loading=!1,this.onClose()})}}},eZ={class:"modal-title"},tZ={key:0},sZ={key:1,class:"row"},aZ=["disabled"],nZ=a("i",{class:"fas fa-arrow-right"},null,-1);function oZ(e,t,s,d,n,i){const h=u("reuse-loader"),_=u("modal");return s.showModal?(o(),v(_,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:n.containerStyle},{title:y(()=>[a("h4",eZ,r(e.lang("sd_import_discard_modal_title")),1)]),fields:y(()=>[n.loading?c("",!0):(o(),l("div",tZ,[a("span",null,r(e.lang("sd_import_discard_confirm")),1)])),n.loading?(o(),l("div",sZ,[m(h,{duration:4e3})])):c("",!0)]),controls:y(()=>[a("button",{type:"button",id:"submit_btn",onClick:t[0]||(t[0]=(...f)=>i.onSubmit&&i.onSubmit(...f)),class:"btn btn-danger",disabled:n.isDisabled},[nZ,g(" "+r(e.lang("sd_import_discard_confirm_button")),1)],8,aZ)]),_:1},8,["showModal","onClose","containerStyle"])):c("",!0)}const iZ=C(XG,[["render",oZ]]),lZ={name:"SdImporter",components:{SdImportMapper:da,DynamicSelect:G,DiscardSdImportModal:iZ},props:{uploadUrl:{type:String,required:!0},discardUrl:{type:String,required:!0},mappingDetailsGetUrl:{type:String,required:!0},mappingPostUrl:{type:String,required:!0},importType:{type:String,default:""}},data(){return{apiUrl:"",importId:null,importFile:null,componentRenderKey:Math.random(),loading:!1,loadingSpeed:4e3,uploaded:!1,tableHeadings:{system:{header:"sd_importer_system_attributes",description:"sd_importer_system_attributes_description"},import:{header:"sd_importer_import_attributes",description:"sd_importer_import_attributes_description"}},buttonText:"importer_import",assetTypeId:null,extraDataObject:{},showModal:!1}},computed:{discardImportUrl(){return this.discardUrl+this.importId}},methods:{onDiscardModalButtonIsClicked(){this.showModal=!0},onChange(e,t){this[t]=e,t==="assetTypeId"&&(e?this.extraDataObject.asset_type_id=e.id:this.extraDataObject={}),e===null&&(this[t]="")},fileSelected(e){e.target.files[0].size<25e6?this.importFile=e.target.files[0]:alert(lang("importer_max_upload_size"))},updateParent(){setTimeout(()=>{this.discardImportProcessing()},2e3)},customErrors(e){e.response.status===412?this.setAlert(e.response.data.message.import_file):A(e,"importerUpload")},setAlert(e){A({response:{status:400,data:{message:e}}},"importerUpload")},submitCallback(){this.loading=!0;let e=new FormData;e.append("import_file",this.importFile),S.post(this.uploadUrl,e,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{this.importId=t.data.data.import_id,this.apiUrl=this.mappingDetailsGetUrl+this.importId,U(t,"importerUpload"),this.uploaded=!0}).catch(t=>{this.customErrors(t),this.uploaded=!1}).finally(()=>{this.loading=!1})},discardImportProcessing(){this.uploaded=!1,this.importFile=null,this.importId=null,this.extraDataObject={},this.assetTypeId=null},onDiscardModalClose(){this.showModal=!1}}},rZ={class:"col-sm-12"},dZ={key:0,class:"row mb-2"},cZ={class:"row"},uZ={class:"form-group col-sm-12"},hZ=a("span",{class:"text-red"},"*  ",-1),mZ={class:"card-footer"},_Z=a("i",{class:"fas fa-upload"},null,-1);function pZ(e,t,s,d,n,i){const h=u("custom-loader"),_=u("alert"),f=u("dynamic-select"),p=u("faveo-box"),b=u("sd-import-mapper"),k=u("discard-sd-import-modal");return o(),l("div",rZ,[n.loading?(o(),v(h,{key:0,duration:n.loadingSpeed},null,8,["duration"])):c("",!0),m(_,{componentName:"importerUpload"}),n.uploaded?c("",!0):(o(),v(p,{key:1,title:e.lang("sd_importer_upload")},{actions:y(()=>[a("div",mZ,[a("button",{type:"button",onClick:t[1]||(t[1]=(...D)=>i.submitCallback&&i.submitCallback(...D)),class:"btn btn-primary",id:"upload-btn"},[_Z,g(" "+r(e.lang("sd_importer_upload_button")),1)])])]),default:y(()=>[s.importType==="asset"?(o(),l("div",dZ,[m(f,{name:"assetTypeId",classname:"col-sm-6",value:n.assetTypeId,onChange:i.onChange,placeholder:"Select Asset type",label:e.lang("sd_importer_asset_import_asset_type_label"),hint:e.lang("sd_importer_asset_import_asset_type_hint"),apiEndpoint:"service-desk/api/dependency/asset_types?meta=true"},null,8,["value","onChange","label","hint"])])):c("",!0),a("div",cZ,[a("div",uZ,[a("label",null,[g(r(e.lang("sd_importer_import_file_label"))+" ",1),hZ]),a("input",{type:"file",name:"import_file",onChange:t[0]||(t[0]=(...D)=>i.fileSelected&&i.fileSelected(...D))},null,32)])])]),_:1},8,["title"])),n.uploaded?(o(),v(b,{key:2,"update-parent":i.updateParent,"table-headings":n.tableHeadings,"button-text":n.buttonText,"import-id":n.importId,"expand-by-default":!0,"submit-api-endpoint":s.mappingPostUrl,"get-details-api-endpoint":n.apiUrl,"extra-data":n.extraDataObject,onSdImportDiscardModalButtonClicked:i.onDiscardModalButtonIsClicked},null,8,["update-parent","table-headings","button-text","import-id","submit-api-endpoint","get-details-api-endpoint","extra-data","onSdImportDiscardModalButtonClicked"])):c("",!0),m(q,{name:"modal"},{default:y(()=>[n.showModal?(o(),v(k,{key:0,onClose:i.onDiscardModalClose,showModal:n.showModal,"api-url":i.discardImportUrl,onPerformImportDiscard:i.discardImportProcessing},null,8,["onClose","showModal","api-url","onPerformImportDiscard"])):c("",!0)]),_:1})])}const fZ=C(lZ,[["render",pZ]]);const gZ={name:"cmdb-relationship-list",description:"Cmdb relationship lists table component",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime)}},data:()=>({columns:["forward_relation_name","inverse_relation_name","action"],options:{},apiUrl:"/service-desk/api/cmdb-list"}),beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-up",down:"glyphicon-chevron-down"},texts:{filter:"",limit:""},columnsClasses:{forward_relation_name:"cmdb-forward_relation_name",inverse_relation_name:"cmdb-inverse_relation_name"},headings:{forward_relation_name:e.lang("forward_relation_name"),inverse_relation_name:e.lang("inverse_relation_name"),action:e.lang("actions")},templates:{forward_relation_name(t,s){return s.forward_relation_name?s.forward_relation_name:"--"},inverse_relation_name(t,s){return s.inverse_relation_name?s.inverse_relation_name:"--"},action:(t,s)=>e.h(_e,{data:s})},sortable:["forward_relation_name","inverse_relation_name"],filterable:["forward_relation_name","inverse_relation_name"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.cmdbs.map(s=>(s.edit_url="/service-desk/cmdb-relation/edit/"+s.id,s.delete_url=e.basePath()+"/service-desk/api/cmdb/"+s.id,s)),count:t.data.total}}}}},bZ={class:"col-sm-12"},yZ={class:"card card-light assets-type-table"},vZ={class:"card-header"},wZ={id:"cmdb-list",class:"card-title"},kZ={class:"card-tools"},CZ=a("span",{class:"glyphicon glyphicon-plus"},null,-1),DZ={class:"card-body",id:"cmdb-table"};function SZ(e,t,s,d,n,i){const h=u("alert"),_=u("router-link"),f=u("data-table"),p=N("tooltip");return o(),l("div",bZ,[m(h,{componentName:"dataTableModal"}),a("div",yZ,[a("div",vZ,[a("h3",wZ,r(e.lang("cmdb_relations-page-title")),1),a("div",kZ,[w((o(),v(_,{class:"btn btn-tool",to:"/service-desk/cmdb-relation/create"},{default:y(()=>[CZ]),_:1})),[[p,e.lang("create_cmdb_relation")]])])]),a("div",DZ,[m(f,{url:e.apiUrl,dataColumns:e.columns,option:e.options,scroll_to:"cmdb-relationship-list"},null,8,["url","dataColumns","option"])])])])}const FZ=C(gZ,[["render",SZ]]);function MZ(e){const{forward_relation_name:t,inverse_relation_name:s,key:d}=e;var n={forward_relation_name:[t,"isRequired"],inverse_relation_name:[s,"isRequired"],key:[d,"isRequired"]};const i=new ce(ae),{errors:h,isValid:_}=i.validate(n);return ie.dispatch("setValidationError",h),{errors:h,isValid:_}}const IZ={data(){return{title:"create_cmdb_relation",iconClass:"fas fa-save",btnName:"save",hasDataPopulated:!1,loading:!1,cmdbRelationId:"",forward_relation_name:"",inverse_relation_name:"",description:""}},beforeMount(){const e=window.location.pathname;this.getValues(e)},methods:{getValues(e){const t=W(e);e.indexOf("edit")>=0?(this.title="edit",this.iconClass="fas fa-sync",this.btnName="update",this.hasDataPopulated=!1,this.getInitialValues(t)):(this.loading=!1,this.hasDataPopulated=!0)},getInitialValues(e){this.loading=!0,S.get("/service-desk/api/cmdb/"+e).then(t=>{this.loading=!1,this.hasDataPopulated=!0,this.cmdbRelationId=t.data.data.cmdb.id,this.forward_relation_name=t.data.data.cmdb.forward_relation_name,this.inverse_relation_name=t.data.data.cmdb.inverse_relation_name,this.description=t.data.data.cmdb.description}).catch(t=>{this.loading=!1,this.hasDataPopulated=!0,A(t,"cmdbRelation")})},isValid(){const{errors:e,isValid:t}=MZ(this.$data);return!!t},onChange(e,t){this[t]=e,e||(this[t]="")},onSubmit(){if(this.isValid()){this.loading=!0;var e=new FormData;this.cmdbRelationId!=""&&e.append("id",this.cmdbRelationId),e.append("forward_relation_name",this.forward_relation_name),e.append("inverse_relation_name",this.inverse_relation_name),e.append("description",this.description);const t={headers:{"Content-Type":"multipart/form-data"}};S.post("/service-desk/api/cmdb",e,t).then(s=>{this.loading=!1,U(s,"cmdbRelation"),this.cmdbRelationId?this.getInitialValues(this.cmdbRelationId):setTimeout(()=>{this.$router.push({name:"CMDB Relation Index"})},3e3)}).catch(s=>{this.loading=!1,A(s,"cmdbRelation")})}},triggerEvent(e){var t=e.which||e.keyCode;t===13&&this.onSubmit()}},components:{"text-field":le}},AZ={class:"col-sm-12"},PZ={key:0,class:"row"},TZ={key:1,class:"card card-light"},VZ={class:"card-header"},LZ={class:"card-title"},UZ={class:"card-body"},$Z={class:"row"},NZ={class:"row"},EZ={class:"card-footer"};function qZ(e,t,s,d,n,i){const h=u("custom-loader"),_=u("alert"),f=u("text-field"),p=N("focus-first-input");return o(),l("div",AZ,[!n.hasDataPopulated||n.loading?(o(),l("div",PZ,[m(h,{duration:4e3})])):c("",!0),m(_,{componentName:"cmdbRelation"}),n.hasDataPopulated?(o(),l("div",TZ,[a("div",VZ,[a("h3",LZ,r(e.lang(n.title)),1)]),a("div",UZ,[w((o(),l("div",$Z,[m(f,{label:e.lang("forward_relation_name"),value:n.forward_relation_name,type:"text",name:"forward_relation_name",onChange:i.onChange,placehold:e.lang("enter_a_value"),keyupListener:i.triggerEvent,classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold","keyupListener"]),m(f,{label:e.lang("inverse_relation_name"),value:n.inverse_relation_name,type:"text",name:"inverse_relation_name",onChange:i.onChange,placehold:e.lang("enter_a_value"),keyupListener:i.triggerEvent,classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold","keyupListener"])])),[[p]]),a("div",NZ,[m(f,{label:e.lang("description"),value:n.description,type:"textarea",name:"description",onChange:i.onChange,placehold:e.lang("enter_a_value"),keyupListener:i.triggerEvent,classname:"col-sm-12",required:!1},null,8,["label","value","onChange","placehold","keyupListener"])])]),a("div",EZ,[a("button",{id:"submit_btn",class:"btn btn-primary",onClick:t[0]||(t[0]=b=>i.onSubmit())},[a("i",{class:j(n.iconClass)},null,2),g(" "+r(e.lang(n.btnName)),1)])])])):c("",!0)])}const Ts=C(IZ,[["render",qZ]]);const OZ={name:"status-list",components:{"status-filter":Oa},description:"Status lists table component",data:()=>({columns:["name","module","purpose_of_status","display_order","icon","action"],options:{},apiUrl:"/service-desk/api/status/list?meta=true",isShowFilter:!1,loading:!0,pageLoader:!1,filterParams:{},appliedFilters:{},filterOptions:[{section:[{name:"default",url:"service-desk/api/default/list",label:"default"},{name:"module",url:"service-desk/api/modules/list?status=1",label:"module"},{name:"purpose",url:"/service-desk/api/status/type/all",label:"purpose_of_status"}]}]}),created(){window.emitter.on("updateFilter",this.updateFilter)},computed:{apiEndPoint(){return this.apiUrl}},beforeMount(){this.filterData();const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-up",down:"glyphicon-chevron-down"},texts:{filter:"",limit:""},heading:{name:this.lang("name"),module:this.lang("module"),purpose_of_status:this.lang("purpose_of_status"),display_order:this.lang("display_order"),icon:this.lang("icon"),action:this.lang("action")},columnsClasses:{name:"status-name",module:"status-module",purpose_of_status:"status-purpose-of-status",display_order:"status-display-order",action:"status-action"},templates:{name:function(t,s){return s.name?s.name:"--"},module:function(t,s){return s.module?s.module.modules:"--"},purpose_of_status:function(t,s){return s.purpose_of_status?s.purpose_of_status.name:"--"},display_order:function(t,s){return s.display_order?s.display_order:"--"},icon:function(t,s){return e.h("i",{class:s.icon_class,style:"color : "+s.icon_color},"")},action:(t,s)=>this.h(_e,{data:s})},sortable:["name","display_order"],filterable:["name","module","purpose_of_status","display_order"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{sort_field:t.orderBy?t.orderBy:"id",sort_order:t.ascending?"asc":"desc",search:t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.data.map(s=>(s.edit_url="/service-desk/status/"+s.id+"/edit",s.delete_url="/service-desk/api/status/delete/"+s.id,s)),count:t.data.total}}}},methods:{updateFilter(e){this.filterOptions.map(function(t){t.section.map(function(s){e.name===s.name&&(s.value=e.value)})})},filterData(){this.filterOptions.map(function(e){e.section.map(function(t){t.elements=[],t.isMultiple=!0,t.isPrepopulate=!1,t.value="",t.className="col-sm-4"})})},selectedFilters(e){return e==="closeEvent"?this.isShowFilter=!1:e==="resetEvent"?this.resetFilter():this.applyFilter(e)},resetFilter(){this.apiUrl="/service-desk/api/status/list?meta=true",this.filterOptions=this.filterOptions.map(function(e){return e.section.map(function(t){t.elements=[],t.isMultiple=!0,t.isPrepopulate=!1,t.value="",t.className="col-sm-4"}),e})},applyFilter(e){this.appliedFilters=e;let t="/service-desk/api/status/list?meta=true&",s=new URLSearchParams(je(this.filterOptions,e));this.apiUrl=t+s,this.isShowFilter=!1},toggleFilterView(){this.isShowFilter=!this.isShowFilter}}},jZ={class:"col-sm-12"},RZ={class:"card card-light"},xZ={class:"card-header"},BZ={id:"status-list",class:"card-title"},KZ={class:"card-tools"},zZ=a("span",{class:"glyphicon glyphicon-plus"},null,-1),HZ=a("i",{class:"glyphicon glyphicon-filter"},null,-1),YZ=[HZ],WZ={class:"card-body",id:"status-table"},JZ={key:1,class:"row"};function GZ(e,t,s,d,n,i){const h=u("alert"),_=u("router-link"),f=u("status-filter"),p=u("data-table"),b=u("custom-loader"),k=N("tooltip");return o(),l("div",jZ,[m(h,{componentName:"dataTableModal"}),a("div",RZ,[a("div",xZ,[a("h3",BZ,r(e.trans("list_of_status")),1),a("div",KZ,[w((o(),v(_,{class:"btn btn-tool",to:"/service-desk/status/create"},{default:y(()=>[zZ]),_:1})),[[k,e.lang("create_new_status")]]),w((o(),l("button",{class:"btn btn-tool",onClick:t[0]||(t[0]=(...D)=>i.toggleFilterView&&i.toggleFilterView(...D)),href:"javascript:;"},YZ)),[[k,e.trans("filter")]])])]),a("div",WZ,[e.isShowFilter?(o(),v(f,{key:0,id:"filter-box",metaData:e.filterOptions,onSelectedFilters:i.selectedFilters,updateFields:e.updateFilterFields,appliedFilters:e.appliedFilters,endPoint:"/service-desk/api/status/list?meta=true"},null,8,["metaData","onSelectedFilters","updateFields","appliedFilters"])):c("",!0),m(p,{url:e.apiUrl,dataColumns:e.columns,option:e.options,scroll_to:"status-list"},null,8,["url","dataColumns","option"]),e.pageLoader?(o(),l("div",JZ,[m(b)])):c("",!0)])])])}const ZZ=C(OZ,[["render",GZ]]);function QZ(e){const{name:t,module:s,purpose_of_status:d,icon_class:n,icon_color:i,display_order:h}=e,_={name:[t,"isRequired"],module:[s,"isRequired"],purpose_of_status:[d,"isRequired"],icon_class:[n,"isRequired"],icon_color:[i,"isRequired"],display_order:[h,"isRequired"]},f=new ce(ae),{errors:p,isValid:b}=f.validate(_);return ie.dispatch("setValidationError",p),{errors:p,isValid:b}}const XZ={name:"status-create-edit",data(){return{page_title:"create_new_status",iconClass:"fas fa-save",btnName:"save",status_id:"",hasDataPopulated:!1,name:"",display_order:"",icon_class:{icon_class:"fas fa-edit"},iconList:[],icon_color:"",purpose_of_status:"",module:"",showErr:!1,loading:!1}},beforeMount(){const e=window.location.pathname;this.getValues(e),this.getIconList()},computed:{getPurposeOfStatusEndpoint(){return this.module?`/service-desk/api/status/type/${this.module.id}`:"/service-desk/api/status/type/"}},methods:{getIconList(){S.get("/json/icon-list.json").then(e=>{this.iconList=e.data.data}).catch(e=>{this.iconList=[]})},getValues(e){const t=W(e);e.indexOf("edit")>=0?(this.page_title="edit_status",this.iconClass="fas fa-sync-alt",this.btnName="update",this.hasDataPopulated=!1,this.getInitialValues(t)):(this.loading=!1,this.hasDataPopulated=!0)},getInitialValues(e){this.loading=!0,S.get("/service-desk/api/status/edit/"+e).then(t=>{this.loading=!1,this.hasDataPopulated=!0,this.status_id=e;let s=t.data.data;this.updateStatesWithData(s),this.icon_class={icon_class:s.icon_class}}).catch(t=>{this.loading=!1,A(t)})},updateStatesWithData(e){const t=this,s=this.$data;Object.keys(e).map(d=>{s.hasOwnProperty(d)&&(t[d]=e[d])})},onChange(e,t){this[t]=e,e===null&&(this[t]="")},isValid(){const{errors:e,isValid:t}=QZ(this.$data);return t},onSubmit(){if(this.icon_color=this.icon_color==="#"?"":this.icon_color,this.showErr=!this.icon_color,this.isValid()&&this.icon_color){this.loading=!0;let e={};e.name=this.name,e.display_order=this.display_order,e.icon_color=this.icon_color,e.icon_class=this.icon_class.icon_class,e.purpose_of_status=this.purpose_of_status.id,e.module=this.module.id,this.status_id&&(e.id=this.status_id);let t="service-desk/api/store/status";S.post(t,e).then(s=>{this.loading=!1,U(s,"status-create-edit"),this.status_id?this.getInitialValues(this.status_id):setTimeout(()=>{this.$router.push({name:"Sd Status Index"})},3e3)}).catch(s=>{this.loading=!1,A(s,"status-create-edit")})}}},components:{alert:ke,"text-field":le,"number-field":yt,"dynamic-select":G,"color-picker":ja,"radio-button":Ee}},eQ={class:"container col-sm-12"},tQ={key:0},sQ={key:1,class:"card card-light"},aQ={class:"card-header"},nQ={class:"card-title"},oQ={class:"card-body"},iQ={class:"row"},lQ={class:"row"},rQ=a("span",{class:"text-red"}," *",-1),dQ={key:0,class:"error-block is-danger"},cQ={class:"row"},uQ={class:"card-footer"};function hQ(e,t,s,d,n,i){const h=u("alert"),_=u("custom-loader"),f=u("text-field"),p=u("number-field"),b=u("dynamic-select"),k=u("color-picker");return o(),l("div",eQ,[m(h,{componentName:"status-create-edit"}),!n.hasDataPopulated||n.loading?(o(),l("div",tQ,[m(_,{loadingSpeed:4e3})])):c("",!0),n.hasDataPopulated?(o(),l("div",sQ,[a("div",aQ,[a("h3",nQ,r(e.trans(n.page_title)),1)]),a("div",oQ,[a("div",iQ,[m(f,{label:e.trans("name"),type:"text",value:n.name,name:"name",class:"col-sm-6",required:!0,onChange:i.onChange,placehold:e.lang("enter_a_value")},null,8,["label","value","onChange","placehold"]),m(p,{label:e.trans("display_order"),value:n.display_order,name:"display_order",classname:"col-sm-6",onChange:i.onChange,placeholder:"n",type:"number",required:!0},null,8,["label","value","onChange"])]),a("div",lQ,[m(b,{name:"icon_class",label:e.trans("icon_class"),value:n.icon_class,onChange:i.onChange,classname:"col-sm-6",elements:n.iconList,multiple:!1,"option-label":"icon_class",required:!0,clearable:!1},null,8,["label","value","onChange","elements"]),a("div",{class:j(["col-sm-6 form-group",{"has-error":n.showErr}])},[a("label",null,[g(r(e.trans("icon_color"))+" ",1),rQ]),m(k,{color:n.icon_color,name:"icon_color",onColor:i.onChange,showError:n.showErr},null,8,["color","onColor","showError"]),n.showErr?(o(),l("div",dQ,r(e.trans("this_field_is_required")),1)):c("",!0)],2)]),a("div",cQ,[m(b,{label:e.trans("module"),multiple:!1,name:"module",required:!0,classname:"col-sm-6",apiEndpoint:"/service-desk/api/modules/list?status=1",value:n.module,onChange:i.onChange,clearable:!!n.module,hint:e.trans("sd_module_for_which_status_needs_to_be_created")},null,8,["label","value","onChange","clearable","hint"]),m(b,{label:e.trans("purpose_of_status"),multiple:!1,name:"purpose_of_status",required:!0,classname:"col-sm-6",apiEndpoint:i.getPurposeOfStatusEndpoint,value:n.purpose_of_status,onChange:i.onChange,clearable:!!n.purpose_of_status,hint:e.trans("purpose_of_status_will_perform_the_action_to_be_applied_on_the_status_selection")},null,8,["label","apiEndpoint","value","onChange","clearable","hint"])])]),a("div",uQ,[a("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=(...D)=>i.onSubmit&&i.onSubmit(...D))},[a("i",{class:j(n.iconClass)},null,2),g(" "+r(e.trans(n.btnName)),1)])])])):c("",!0)])}const Vs=C(XZ,[["render",hQ]]);const mQ={name:"depreciation-modal",description:"Depreciation Modal component",props:{showModal:{type:Boolean,default:!1},data:{type:[Object,String],default:()=>{}},title:{type:String,default:""},apiUrl:{type:String,default:()=>{}},alertData:{type:String,default:()=>{}},routeData:{type:String,default:()=>{}},onClose:{type:Function}},data:()=>({containerStyle:{width:"500px"},loading:!1,isDisabled:!1}),beforeMount(){this.title!=="delete"&&(this.containerStyle.width="800px"),console.log(this.alertData,this.routeData,this.apiUrl)},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,S.delete(this.apiUrl+this.data.id).then(e=>{U(e,this.alertData),this.afterRespond(),setTimeout(()=>{this.$router.push({name:this.routeData})},3e3)}).catch(e=>{A(e,this.alertData),this.afterRespond()})},afterRespond(){this.onClose(),this.loading=!1,this.isDisabled=!0}}},_Q={class:"modal-title"},pQ={key:0},fQ={key:0},gQ={key:1,class:"row"},bQ=["disabled"],yQ=a("i",{class:"fas fa-trash","aria-hidden":"true"},null,-1);function vQ(e,t,s,d,n,i){const h=u("reuse-loader"),_=u("modal");return o(),l("div",null,[s.showModal?(o(),v(_,{key:0,showModal:s.showModal,onClose:s.onClose,containerStyle:e.containerStyle},vt({title:y(()=>[a("h4",_Q,r(e.lang(s.title)),1)]),fields:y(()=>[e.loading?c("",!0):(o(),l("div",pQ,[s.title==="delete"?(o(),l("span",fQ,r(e.lang("are_you_sure_you_want_to_delete")),1)):c("",!0)])),e.loading?(o(),l("div",gQ,[m(h,{"animation-duration":4e3,color:"#1d78ff",size:60})])):c("",!0)]),_:2},[s.title==="delete"?{name:"controls",fn:y(()=>[a("button",{type:"button",onClick:t[0]||(t[0]=(...f)=>i.onSubmit&&i.onSubmit(...f)),class:"btn btn-danger",disabled:e.isDisabled},[yQ,g(" "+r(e.lang("delete")),1)],8,bQ)]),key:"0"}:void 0]),1032,["showModal","onClose","containerStyle"])):c("",!0)])}const ca=C(mQ,[["render",vQ]]);const wQ={name:"depreciation-list",description:"depreciation lists table component",data:()=>({columns:["name","useful_life","type","actions"],options:{},apiUrl:"service-desk/api/deprecation-list"}),beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-up",down:"glyphicon-chevron-down"},texts:{filter:"",limit:""},headings:{name:e.lang("name"),useful_life:e.lang("useful-life"),type:e.lang("type"),actions:e.lang("actions")},columnsClasses:{name:"depreciation-name",months:"depreciation-months",useful_life:"depreciation-useful-life",type:"depreciation-type"},templates:{floor_value(t,s){return s.floor_value?s.floor_value:"---"},actions:(t,s)=>e.h(_e,{data:s})},sortable:["name","months","floor_value"],filterable:["name","months","floor_value"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.depreciation.map(s=>(s.view_url="/service-desk/deprication/"+s.id+"/show",s.edit_url="/service-desk/deprication/"+s.id+"/edit",s.delete_url=e.basePath()+"/service-desk/api/deprecation/"+s.id,s)),count:t.data.total}}}}},kQ={class:"col-sm-12"},CQ={class:"card card-light"},DQ={class:"card-header"},SQ={id:"depreciation-list",class:"card-title"},FQ={class:"card-tools"},MQ=a("span",{class:"glyphicon glyphicon-plus"},null,-1),IQ={class:"card-body",id:"depreciation-table"};function AQ(e,t,s,d,n,i){const h=u("alert"),_=u("router-link"),f=u("data-table"),p=N("tooltip");return o(),l("div",kQ,[m(h,{componentName:"dataTableModal"}),a("div",CQ,[a("div",DQ,[a("h3",SQ,r(e.lang("list_of_depreciation")),1),a("div",FQ,[w((o(),v(_,{class:"btn btn-tool",to:"/service-desk/deprication/create"},{default:y(()=>[MQ]),_:1})),[[p,e.lang("create_depreciation")]])])]),a("div",IQ,[m(f,{url:e.apiUrl,dataColumns:e.columns,option:e.options,scroll_to:"depreciation-list"},null,8,["url","dataColumns","option"])])])])}const PQ=C(wQ,[["render",AQ]]);function TQ(e){const{name:t,number_of_months:s,type:d}=e;var n={name:[t,"isRequired"],number_of_months:[s,"isRequired","number_of_months"],type:[d,"isRequired","number_of_months"]};const i=new ce(ae),{errors:h,isValid:_}=i.validate(n);return ie.dispatch("setValidationError",h),{errors:h,isValid:_}}const VQ={name:"depreciation-create-edit",props:{from:{type:String,default:""},onComplete:{type:Function}},data(){return{isEditMode:!1,title:"create_depreciation",iconClass:"fas fa-save",btnName:"save",hasDataPopulated:!1,loading:!1,depreciation_id:"",name:"",type:"",useful_life:"",depreciationOptions:[{id:"Straight Line",name:"Straight Line"},{id:"Double Declining Balance",name:"Double Declining Balance"},{id:"Sum-of-Years Digits",name:"Sum-of-Years Digits"}],depreciation_methods:""}},beforeMount(){const e=window.location.pathname;this.isEditMode=e.includes("edit"),this.getValues(e)},methods:{async getValues(e){const t=W(e);e.includes("edit")?this.from?(this.loading=!1,this.hasDataPopulated=!0):(this.title="edit_depreciation",this.iconClass="fas fa-sync",this.btnName="update",this.hasDataPopulated=!1,await this.getInitialValues(t),this.loading=!1):(this.loading=!1,this.hasDataPopulated=!0)},getInitialValues(e){this.loading=!0,S.get("service-desk/api/deprecation/"+e).then(t=>{this.loading=!1,this.hasDataPopulated=!0,this.updateStatesWithData(t.data.data.depreciation),this.depreciation_id=t.data.data.depreciation.id}).catch(t=>{this.loading=!1,A(t,"depreciation-create-edit"),this.hasDataPopulated=!0})},updateStatesWithData(e){Object.keys(e).map(t=>{this.$data.hasOwnProperty(t)&&(this[t]=e[t])})},isValid(){const{errors:e,isValid:t}=TQ(this.$data);return!!t},onChange(e,t){e!==0&&(this[t]=e)},onSubmit(){if(this.isValid()){this.loading=!0;const e=new FormData;this.depreciation_id!==""&&e.append("id",this.depreciation_id),e.append("name",this.name),e.append("useful_life",this.useful_life),e.append("type",this.type);const t={headers:{"Content-Type":"multipart/form-data"}};S.post("service-desk/api/deprecation",e,t).then(s=>{this.loading=!1,U(s,"depreciation-create-edit"),!this.from||!this.depreciation_id?setTimeout(()=>{let d=s.data.data.id;this.$router.push("/service-desk/deprication/"+d+"/show")},3e3):this.getInitialValues(this.depreciation_id).then(()=>{this.from&&this.onComplete(this.name,"depreciation-create-edit")})}).catch(s=>{this.loading=!1,A(s,"depreciation-create-edit")})}}},components:{"static-select":st,"tool-tip":tt,"text-field":le,"number-field":yt}},LQ={class:"col-sm-12"},UQ={key:0,class:"row"},$Q={key:0,class:"card-header"},NQ={class:"card-title"},EQ={class:"card-tools"},qQ=a("span",{class:"fas fa-eye"},null,-1),OQ={class:"row"},jQ={key:1,class:"card-footer"};function RQ(e,t,s,d,n,i){const h=u("custom-loader"),_=u("alert"),f=u("router-link"),p=u("text-field"),b=u("number-field"),k=u("static-select"),D=N("tooltip");return o(),l("div",LQ,[!n.hasDataPopulated||n.loading?(o(),l("div",UQ,[m(h,{duration:4e3})])):c("",!0),m(_,{componentName:"depreciation-create-edit"}),n.hasDataPopulated?(o(),l("div",{key:1,class:j([{"card card-light":!s.from}])},[s.from?c("",!0):(o(),l("div",$Q,[a("h3",NQ,r(e.lang(n.title)),1),a("div",EQ,[n.depreciation_id?w((o(),v(f,{key:0,id:"view_depreciation_id",class:"btn btn-tool m-unset",to:"/service-desk/deprication/"+n.depreciation_id+"/show"},{default:y(()=>[qQ]),_:1},8,["to"])),[[D,e.lang("view")]]):c("",!0)])])),a("div",{class:j([{"card-body":!s.from}])},[a("div",OQ,[m(p,{label:e.lang("name"),value:n.name,type:"text",name:"name",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold"]),m(b,{label:e.lang("useful_life"),value:n.useful_life,name:"useful_life",classname:"col-sm-6",onChange:i.onChange,placeholder:"n",type:"number",required:!0},null,8,["label","value","onChange"]),m(k,{label:e.trans("depreciation_methods"),elements:n.depreciationOptions,name:"type",onChange:i.onChange,required:!0,classname:"col-sm-6",value:n.type,disabled:n.isEditMode},null,8,["label","elements","onChange","value","disabled"])])],2),s.from?c("",!0):(o(),l("div",jQ,[a("button",{id:"submit_btn",class:"btn btn-primary",onClick:t[0]||(t[0]=P=>i.onSubmit())},[a("i",{class:j(n.iconClass)},null,2),g(" "+r(e.lang(n.btnName)),1)])]))],2)):c("",!0)])}const Ls=C(VQ,[["render",RQ]]);const xQ={name:"depreciation-view",description:"depreciation details page component",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},data(){return{hasDataPopulated:!1,loading:!1,deprecationData:"",showModal:!1,title:"",apiUrl:"/service-desk/api/deprecation/",alertData:"depreciation-view",routeData:"Depreciation Index"}},beforeMount(){const e=window.location.pathname;this.getInitialValues(e)},methods:{subString(e,t=20){return oe(e,t)},getInitialValues(e){const t=W(e);this.loading=!0,S.get("/service-desk/api/deprecation/"+t).then(s=>{this.loading=!1,this.hasDataPopulated=!0,this.deprecationData=s.data.data.depreciation}).catch(s=>{this.loading=!1,A(s,"depreciation-view"),this.hasDataPopulated=!0})},modalMethod(e){this.title=e,this.showModal=!0},onClose(){this.showModal=!1}},components:{"depreciation-modal":ca}},ua=e=>(K("data-v-2cdd9aad"),e=e(),z(),e),BQ={class:"col-sm-12"},KQ={key:0,class:"row"},zQ={key:1,class:"card card-light"},HQ={class:"card-header"},YQ={class:"card-title"},WQ={class:"card-tools"},JQ=ua(()=>a("span",{class:"fas fa-edit"},null,-1)),GQ=ua(()=>a("span",{class:"fas fa-trash"},null,-1)),ZQ=[GQ],QQ={class:"card-body"},XQ={class:"row"},eX={class:"col-md-12"},tX={class:"callout callout-info bg-info"},sX={class:"row"},aX={class:"col-md-6"},nX={class:"col-md-6"},oX={class:"col-md-12"},iX={class:"row"},lX={class:"col-md-6 info-row d-flex"},rX={class:"col-md-6"},dX={class:"col-md-6"},cX={class:"text-primary"},uX={class:"col-md-6 info-row d-flex"},hX={class:"col-md-6"},mX={class:"col-md-6"},_X={class:"text-primary"};function pX(e,t,s,d,n,i){const h=u("alert"),_=u("reuse-loader"),f=u("router-link"),p=u("depreciation-modal"),b=N("tooltip");return o(),l("div",BQ,[m(h,{componentName:"depreciation-view"}),!n.hasDataPopulated||n.loading?(o(),l("div",KQ,[m(_,{"animation-duration":4e3,size:60})])):c("",!0),n.hasDataPopulated&&n.deprecationData?(o(),l("div",zQ,[a("div",HQ,[w((o(),l("h3",YQ,[g(r(i.subString(n.deprecationData.name,50)),1)])),[[b,n.deprecationData.name]]),a("div",WQ,[w((o(),v(f,{class:"btn btn-tool",to:"/service-desk/deprication/"+n.deprecationData.id+"/edit"},{default:y(()=>[JQ]),_:1},8,["to"])),[[b,e.lang("edit")]]),w((o(),l("a",{class:"btn btn-tool",onClick:t[0]||(t[0]=k=>i.modalMethod("delete")),href:"javascript:;"},ZQ)),[[b,e.lang("delete")]])])]),a("div",QQ,[a("div",XQ,[a("div",eX,[a("div",tX,[a("div",sX,[a("div",aX,[a("b",null,r(e.lang("created_date"))+" : ",1),w((o(),l("span",null,[g(r(d.formattedTime(n.deprecationData.created_at)),1)])),[[b,d.formattedTime(n.deprecationData.created_at)]])]),a("div",nX,[a("b",null,r(e.lang("updated_date"))+" : ",1),w((o(),l("span",null,[g(r(d.formattedTime(n.deprecationData.updated_at)),1)])),[[b,d.formattedTime(n.deprecationData.updated_at)]])])])])])]),a("div",oX,[a("div",iX,[a("div",lX,[a("div",rX,[a("label",null,r(e.lang("useful_life")),1)]),a("div",dX,[w((o(),l("a",cX,[g(r(i.subString(n.deprecationData.useful_life)),1)])),[[b,n.deprecationData.useful_life]])])]),a("div",uX,[a("div",hX,[a("label",null,r(e.lang("depreciation_methods")),1)]),a("div",mX,[w((o(),l("a",_X,[g(r(i.subString(n.deprecationData.type?n.deprecationData.type:"---")),1)])),[[b,n.deprecationData.type]])])])])])])])):c("",!0),m(q,{name:"modal"},{default:y(()=>[n.showModal?(o(),v(p,{key:0,onClose:i.onClose,showModal:n.showModal,data:n.deprecationData,routeData:n.routeData,alertData:n.alertData,apiUrl:n.apiUrl,title:n.title},null,8,["onClose","showModal","data","routeData","alertData","apiUrl","title"])):c("",!0)]),_:1})])}const fX=C(xQ,[["render",pX],["__scopeId","data-v-2cdd9aad"]]);const gX={name:"ManufacturersIndex",description:"manufacturer lists table component",data:()=>({columns:["name","support_number","support_url","support_mail","actions"],options:{},apiUrl:"service-desk/api/manufacturer-list"}),beforeMount(){const e=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-up",down:"glyphicon-chevron-down"},texts:{filter:"",limit:""},headings:{name:e.lang("name"),support_number:e.lang("support_number"),support_url:e.lang("support_url"),support_mail:e.lang("support_mail"),actions:e.lang("actions")},columnsClasses:{name:"manufacturer-name",support_number:"manufacturer-support_number",support_url:"manufacturer-support_url",support_mail:"manufacturer-support_mail"},templates:{support_number(t,s){return s.support_number?s.support_number:"---"},support_url(t,s){return s.support_url?s.support_url:"---"},support_mail(t,s){return s.support_mail?s.support_mail:"---"},actions:(t,s)=>e.h(_e,{data:s})},sortable:["name","support_number","support_mail","support_url"],filterable:["name","support_number","support_mail","support_url"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"desc":"asc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.manufacturer.map(s=>(s.view_url="/service-desk/manufacturers/"+s.id+"/show",s.edit_url="/service-desk/manufacturers/"+s.id+"/edit",s.delete_url=e.basePath()+"/service-desk/api/manufacturer/"+s.id,s)),count:t.data.total}}}}},bX={class:"col-sm-12"},yX={class:"card card-light"},vX={class:"card-header"},wX={id:"manufacturer-list",class:"card-title"},kX={class:"card-tools"},CX=a("span",{class:"glyphicon glyphicon-plus"},null,-1),DX={class:"card-body",id:"manufacturer-table"};function SX(e,t,s,d,n,i){const h=u("alert"),_=u("router-link"),f=u("data-table"),p=N("tooltip");return o(),l("div",bX,[m(h,{componentName:"dataTableModal"}),a("div",yX,[a("div",vX,[a("h3",wX,r(e.lang("list_of_manufacturers")),1),a("div",kX,[w((o(),v(_,{class:"btn btn-tool",to:"/service-desk/manufacturers/create"},{default:y(()=>[CX]),_:1})),[[p,e.lang("create_manufacturer")]])])]),a("div",DX,[m(f,{url:e.apiUrl,dataColumns:e.columns,option:e.options,scroll_to:"manufacturer-list"},null,8,["url","dataColumns","option"])])])])}const FX=C(gX,[["render",SX]]);function MX(e){const{name:t}=e;var s={name:[t,"isRequired"]};const d=new ce(ae),{errors:n,isValid:i}=d.validate(s);return ie.dispatch("setValidationError",n),{errors:n,isValid:i}}const IX={name:"manufacturers-create-edit",props:{from:{type:String,default:""},onComplete:{type:Function}},data(){return{title:"create_manufacturer",iconClass:"fas fa-save",btnName:"save",hasDataPopulated:!1,loading:!1,manufacturer_id:"",name:"",support_number:"",support_url:"",support_mail:""}},beforeMount(){const e=window.location.pathname;this.getValues(e)},methods:{async getValues(e){const t=W(e);e.includes("edit")?this.from?(this.loading=!1,this.hasDataPopulated=!0):(this.title="edit_manufacturer",this.iconClass="fas fa-sync",this.btnName="update",this.hasDataPopulated=!1,await this.getInitialValues(t),this.loading=!1):(this.loading=!1,this.hasDataPopulated=!0)},getInitialValues(e){this.loading=!0,S.get("service-desk/api/manufacturer/"+e).then(t=>{this.loading=!1,this.hasDataPopulated=!0,this.updateStatesWithData(t.data.data.sd_manufacturer),this.manufacturer_id=t.data.data.sd_manufacturer.id}).catch(t=>{this.loading=!1,A(t,"manufacturers-create-edit"),this.hasDataPopulated=!0})},updateStatesWithData(e){const t=this,s=this.$data;Object.keys(e).map(d=>{s.hasOwnProperty(d)&&(t[d]=e[d])})},isValid(){const{errors:e,isValid:t}=MX(this.$data);return!!t},onChange(e,t){this[t]=e},onSubmit(){if(this.isValid()){this.loading=!0;var e=new FormData;this.manufacturer_id!=""&&e.append("id",this.manufacturer_id),e.append("name",this.name),e.append("support_number",this.support_number),e.append("support_url",this.support_url),e.append("support_mail",this.support_mail);const t={headers:{"Content-Type":"multipart/form-data"}};S.post("service-desk/api/manufacturer",e,t).then(s=>{this.loading=!1,U(s,"manufacturers-create-edit"),this.from||(this.manufacturer_id?this.getInitialValues(this.manufacturer_id):setTimeout(()=>{let d=s.data.data.id;this.$router.push("/service-desk/manufacturers/"+d+"/show")},3e3))}).catch(s=>{this.loading=!1,A(s,"manufacturers-create-edit")})}}},components:{"text-field":le,"number-field":yt}},AX={class:"col-sm-12"},PX={key:0,class:"row"},TX={key:0,class:"card-header"},VX={class:"card-title"},LX={class:"card-tools"},UX=a("span",{class:"fas fa-eye"},null,-1),$X={class:"row"},NX={class:"row"},EX={key:1,class:"card-footer"};function qX(e,t,s,d,n,i){const h=u("custom-loader"),_=u("alert"),f=u("router-link"),p=u("text-field"),b=u("number-field"),k=N("tooltip");return o(),l("div",AX,[!n.hasDataPopulated||n.loading?(o(),l("div",PX,[m(h,{duration:4e3})])):c("",!0),m(_,{componentName:"manufacturers-create-edit"}),n.hasDataPopulated?(o(),l("div",{key:1,class:j([{"card card-light":!s.from}])},[s.from?c("",!0):(o(),l("div",TX,[a("h3",VX,r(e.lang(n.title)),1),a("div",LX,[n.manufacturer_id?w((o(),v(f,{key:0,id:"view_manufacturer_id",class:"btn btn-tool m-unset",to:"/service-desk/manufacturers/"+n.manufacturer_id+"/show"},{default:y(()=>[UX]),_:1},8,["to"])),[[k,e.lang("view")]]):c("",!0)])])),a("div",{class:j([{"card-body":!s.from}])},[a("div",$X,[m(p,{label:e.lang("name"),value:n.name,type:"text",name:"name",onChange:i.onChange,placehold:e.lang("enter_a_value"),classname:"col-sm-6",required:!0},null,8,["label","value","onChange","placehold"]),m(b,{label:e.lang("support_number"),value:n.support_number,name:"support_number",classname:"col-sm-6",onChange:i.onChange,placeholder:"n",type:"number",required:!0},null,8,["label","value","onChange"])]),a("div",NX,[m(p,{label:e.lang("support_url"),value:n.support_url,name:"support_url",classname:"col-sm-6",onChange:i.onChange,placehold:e.lang("enter_a_value")},null,8,["label","value","onChange","placehold"]),m(p,{label:e.lang("support_mail"),value:n.support_mail,name:"support_mail",classname:"col-sm-6",onChange:i.onChange,placehold:e.lang("enter_a_value"),type:"email",required:!0},null,8,["label","value","onChange","placehold"])])],2),s.from?c("",!0):(o(),l("div",EX,[a("button",{id:"submit_btn",class:"btn btn-primary",onClick:t[0]||(t[0]=D=>i.onSubmit())},[a("i",{class:j(n.iconClass)},null,2),g(" "+r(e.lang(n.btnName)),1)])]))],2)):c("",!0)])}const Us=C(IX,[["render",qX]]);const OX={name:"manufacturer-view",description:"manufacturer details page component",setup(){const e=B();return{formattedTime:L(()=>e.getters.formattedTime),formattedDate:L(()=>e.getters.formattedDate)}},data(){return{hasDataPopulated:!1,loading:!1,manufacturerData:"",showModal:!1,title:"",apiUrl:"/service-desk/api/manufacturer/",alertData:"manufacturer-view",routeData:"Manufacturers Index"}},beforeMount(){const e=window.location.pathname;this.getInitialValues(e)},methods:{subString(e,t=20){return oe(e,t)},getInitialValues(e){const t=W(e);this.loading=!0,S.get("service-desk/api/manufacturer/"+t).then(s=>{this.loading=!1,this.hasDataPopulated=!0,this.manufacturerData=s.data.data.sd_manufacturer,this.manufacturerData.support_mail=this.handleEmptyField(this.manufacturerData.support_mail),this.manufacturerData.support_number=this.handleEmptyField(this.manufacturerData.support_number),this.manufacturerData.support_url=this.handleEmptyField(this.manufacturerData.support_url)}).catch(s=>{this.loading=!1,A(s,"manufacturer-view"),this.hasDataPopulated=!0})},handleEmptyField(e){return e===""?"---":e},modalMethod(e){this.title=e,this.showModal=!0},onClose(){this.showModal=!1}},components:{"depreciation-modal":ca}},Gt=e=>(K("data-v-433ad105"),e=e(),z(),e),jX={class:"col-sm-12"},RX={key:0,class:"row"},xX={key:1,class:"card card-light"},BX={class:"card-header"},KX={class:"card-title"},zX={class:"card-tools"},HX=Gt(()=>a("span",{class:"fas fa-edit"},null,-1)),YX=Gt(()=>a("span",{class:"fas fa-trash"},null,-1)),WX=[YX],JX={class:"card-body"},GX={class:"row"},ZX={class:"col-md-12"},QX={class:"callout callout-info bg-info"},XX={class:"row"},eee={class:"col-md-6"},tee={class:"col-md-6"},see={class:"col-md-12"},aee={class:"row"},nee={class:"col-md-6 info-row d-flex"},oee={class:"col-md-6"},iee={class:"col-md-6"},lee={class:"text-primary"},ree={class:"col-md-6 info-row d-flex"},dee={class:"col-md-6"},cee={class:"col-md-6"},uee={class:"text-primary"},hee={class:"col-md-6 info-row d-flex"},mee={class:"col-md-6"},_ee={class:"col-md-6"},pee={class:"text-primary"},fee=Gt(()=>a("div",{class:"col-md-6 info-row d-flex"},null,-1));function gee(e,t,s,d,n,i){const h=u("alert"),_=u("reuse-loader"),f=u("router-link"),p=u("depreciation-modal"),b=N("tooltip");return o(),l("div",jX,[m(h,{componentName:"manufacturer-view"}),!n.hasDataPopulated||n.loading?(o(),l("div",RX,[m(_,{"animation-duration":4e3,size:60})])):c("",!0),n.hasDataPopulated&&n.manufacturerData?(o(),l("div",xX,[a("div",BX,[w((o(),l("h3",KX,[g(r(i.subString(n.manufacturerData.name,50)),1)])),[[b,n.manufacturerData.name]]),a("div",zX,[w((o(),v(f,{class:"btn btn-tool",to:"/service-desk/manufacturers/"+n.manufacturerData.id+"/edit"},{default:y(()=>[HX]),_:1},8,["to"])),[[b,e.lang("edit")]]),w((o(),l("a",{class:"btn btn-tool",onClick:t[0]||(t[0]=k=>i.modalMethod("delete")),href:"javascript:;"},WX)),[[b,e.lang("delete")]])])]),a("div",JX,[a("div",GX,[a("div",ZX,[a("div",QX,[a("div",XX,[a("div",eee,[a("b",null,r(e.lang("created_date"))+" : ",1),w((o(),l("span",null,[g(r(d.formattedTime(n.manufacturerData.created_at)),1)])),[[b,d.formattedTime(n.manufacturerData.created_at)]])]),a("div",tee,[a("b",null,r(e.lang("updated_date"))+" : ",1),w((o(),l("span",null,[g(r(d.formattedTime(n.manufacturerData.updated_at)),1)])),[[b,d.formattedTime(n.manufacturerData.updated_at)]])])])])])]),a("div",see,[a("div",aee,[a("div",nee,[a("div",oee,[a("label",null,r(e.lang("support_mail")),1)]),a("div",iee,[w((o(),l("a",lee,[g(r(i.subString(n.manufacturerData.support_mail?n.manufacturerData.support_mail:"---")),1)])),[[b,n.manufacturerData.support_mail]])])]),a("div",ree,[a("div",dee,[a("label",null,r(e.lang("support_number")),1)]),a("div",cee,[w((o(),l("a",uee,[g(r(i.subString(n.manufacturerData.support_number?n.manufacturerData.support_number:"---")),1)])),[[b,n.manufacturerData.support_number]])])]),a("div",hee,[a("div",mee,[a("label",null,r(e.lang("support_url")),1)]),a("div",_ee,[w((o(),l("a",pee,[g(r(i.subString(n.manufacturerData.support_url?n.manufacturerData.support_url:"---")),1)])),[[b,n.manufacturerData.support_url]])])]),fee])])])])):c("",!0),m(q,{name:"modal"},{default:y(()=>[n.showModal?(o(),v(p,{key:0,onClose:i.onClose,showModal:n.showModal,data:n.manufacturerData,routeData:n.routeData,alertData:n.alertData,apiUrl:n.apiUrl,title:n.title},null,8,["onClose","showModal","data","routeData","alertData","apiUrl","title"])):c("",!0)]),_:1})])}const bee=C(OX,[["render",gee],["__scopeId","data-v-433ad105"]]);const yee={name:"currency",components:{currencySelect:Ga},data(){return{currency:"",currencyOptions:Za(),isLoading:!1}},mounted(){this.getInitialValues()},methods:{onChange(e,t){this[t]=e||""},getInitialValues(){this.isLoading=!0,S.get("service-desk/api/currency").then(e=>{this.currency=e.data.data.currency||"USD",this.hasDataPopulated=!0}).catch(e=>{A(e,"currency-create")}).finally(()=>{this.isLoading=!1})},onSubmit(){if(!this.isValid())return;this.isLoading=!0;const e={currency:this.currency};S.post("service-desk/api/currency",e).then(t=>{U(t,"currency-create"),this.getInitialValues()}).catch(t=>{A(t,"currency-create")}).finally(()=>{this.isLoading=!1})},isValid(){const{errors:e,isValid:t}=Qa(this.$data);return t}}},vee=e=>(K("data-v-80a56287"),e=e(),z(),e),wee={class:"col-sm-12"},kee={class:"row"},Cee=vee(()=>a("i",{class:"fas fa-save"},null,-1));function Dee(e,t,s,d,n,i){const h=u("alert"),_=u("currency-select"),f=u("faveo-box");return o(),l("div",wee,[m(h,{componentName:"currency-create"}),m(f,{title:e.trans("currency")},{default:y(()=>[a("div",kee,[m(_,{name:"currency",classname:"col-sm-4 faveo-dynamic-select",options:n.currencyOptions,label:e.lang("currency"),value:n.currency,onChange:i.onChange,required:!0},null,8,["options","label","value","onChange"])]),a("div",null,[a("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=(...p)=>i.onSubmit&&i.onSubmit(...p))},[Cee,g(" "+r(e.trans("save")),1)])])]),_:1},8,["title"])])}const See=C(yee,[["render",Dee],["__scopeId","data-v-80a56287"]]);ge("ticket-associated-list",Ot,"user-box-mounted","user-view-table");ge("associated-problem",wl,"timeline-meta-box-mounted","timeline-meta-list-box");ge("sd-ticket-actions",Go,"timeline-action-bar-mounted","timeline-action-bar");ge("ticket-associated-list",Ot,"ticket-tab-mounted","timeline-tab");ge("ticket-associated-list",Ot,"org-page-mounted","org-page-table");ge("user-permissions",El,"user-permission-mounted","users-action-div");ge("dashboard-charts",Wl,"dashboard-mounted","dashboard-chart-container");ge("sd-agent-permission",tr,"permission-list-box-mounted","permission-list-box");ge("create-form-group-button",or,"create-form-group-button-mounted","form-group-create-button","admin");ge("custom-type-form-field",yr,"custom-type-form-field-mounted","faveo-app-extra-form-field");ge("create-workflow-button",Cr,"create-workflow-button-mounted","workflow-create-button","admin");ge("create-listener-button",Mr,"create-listener-button-mounted","listener-create-button","admin");let Fee=[{path:"/change-approval",component:ls,name:"SD Change Conversation",redirect:"/change-approval/:id",children:[{path:"/change-approval/:id",component:id,name:"ChangeConversation",meta:{breadcrumb:[{text:"Change Conversation"}]}}]},{path:"/service-desk/contract-approval",component:ls,name:"SD Contract Conversation",redirect:"/service-desk/contract-approval/:hash/:id",children:[{path:"/service-desk/contract-approval/:hash/:id",component:Ed,name:"ContractConversation",meta:{breadcrumb:[{text:"Contract Approval"}]}}]}];Fee.forEach(function(e){Ua.addRoute(e)});let Mee={path:"/service-desk/problem",component:Be,name:"SD Problems",redirect:"/service-desk/problem/list",children:[{path:"list",name:"Problem Index",component:_s,meta:{title:"problem",crumb:{link:{name:"dashboard",to:"/"},active:"problem"}}},{path:"create",name:"Problem Create",component:ps,props:{category:"problem",panel:"agent"},meta:{title:"problem",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"problem",to:"/service-desk/problem/list"},active:"create"}}},{path:":id/edit",name:"Problem Edit",component:ps,props:{category:"problem",panel:"agent",showViewButton:!0},meta:{title:"problem",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"problem",to:"/service-desk/problem/list"},active:"edit"}}},{path:":id/show",name:"Problem View",component:rD,meta:{title:"problem",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"problem",to:"/service-desk/problem/list"},active:"view"}}},{path:"filter/:id",name:"Problem Filter",component:_s,props:{filterIndex:!0},meta:{title:"problem",crumb:{link:{name:"dashboard",to:"/"},active:"filter"}}}]},Iee={path:"/service-desk/changes",component:Be,name:"SD Changes",redirect:"/service-desk/changes/list",children:[{path:"list",name:"Changes Index",component:gs,meta:{title:"changes",crumb:{link:{name:"dashboard",to:"/"},active:"changes"}}},{path:"create",name:"Change Create",component:bs,props:{category:"changes",panel:"agent"},meta:{title:"changes",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"changes",to:"/service-desk/changes/list"},active:"create"}}},{path:":id/edit",name:"Change Edit",component:bs,props:{category:"changes",panel:"agent",showViewButton:!0},meta:{title:"changes",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"changes",to:"/service-desk/changes/list"},active:"edit"}}},{path:":id/show",name:"Change View",component:p4,meta:{title:"changes",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"changes",to:"/service-desk/changes/list"},active:"view"}}},{path:"filter/:id",name:"Change Filter",component:gs,props:{filterIndex:!0},meta:{title:"changes",crumb:{link:{name:"dashboard",to:"/"},active:"filter"}}}]},Aee={path:"/service-desk/assets",component:Be,name:"Servicedesk Assets",redirect:"/service-desk/assets/list",children:[{path:"list",component:us,name:"SD Assets Index",meta:{title:"assets",crumb:{link:{name:"dashboard",to:"/"},active:"assets"}}},{path:"create",name:"Asset Create",component:hs,props:{category:"asset",panel:"agent"},meta:{title:"assets",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"assets",to:"/service-desk/assets/list"},active:"create"}}},{path:":id/edit",name:"Asset Edit",component:hs,props:{category:"asset",panel:"agent",showViewButton:!0},meta:{title:"assets",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"assets",to:"/service-desk/assets/list"},active:"edit"}}},{path:":id/show",component:cy,name:"SD Assets View",meta:{title:"assets",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"assets",to:"/service-desk/assets/list"},active:"view"}}},{path:"filter/:id",name:"Asset Filter",component:us,props:{filterIndex:!0},meta:{title:"assets",crumb:{link:{name:"dashboard",to:"/"},active:"filter"}}}]},Pee={path:"/service-desk/contracts",component:Be,name:"Servicedesk Contracts",redirect:"/service-desk/contracts/list",children:[{path:"list",component:ys,name:"SD Contracts Index",meta:{title:"contracts",crumb:{link:{name:"dashboard",to:"/"},active:"contracts"}}},{path:"create",name:"Contract Create",component:vs,props:{category:"contract",panel:"agent"},meta:{title:"contracts",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"contracts",to:"/service-desk/contracts/list"},active:"create"}}},{path:":id/edit",name:"Contract Edit",component:vs,props:{category:"contract",panel:"agent",showViewButton:!0},meta:{title:"contracts",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"contracts",to:"/service-desk/contracts/list"},active:"edit"}}},{path:":id/show",component:PL,name:"SD Contract View",meta:{title:"contracts",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"contracts",to:"/service-desk/contracts/list"},active:"view"}}},{path:"filter/:id",name:"Contract Filter",component:ys,props:{filterIndex:!0},meta:{title:"contracts",crumb:{link:{name:"dashboard",to:"/"},active:"filter"}}}]},Tee={path:"/service-desk/releases",component:Be,name:"Servicedesk Releases",redirect:"/service-desk/releases/list",children:[{path:"list",component:ws,name:"SD Release Index",meta:{title:"releases",crumb:{link:{name:"dashboard",to:"/"},active:"releases"}}},{path:"create",name:"Release Create",component:Vt,props:{category:"releases",panel:"agent"},meta:{title:"releases",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"releases",to:"/service-desk/releases/list"},active:"create"}}},{path:":id/edit",name:"Release Edit",component:Vt,props:{category:"releases",panel:"agent",showViewButton:!0},meta:{title:"releases",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"releases",to:"/service-desk/releases/list"},active:"edit"}}},{path:":id/show",component:XE,name:"SD Release View",meta:{title:"releases",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"releases",to:"/service-desk/releases/list"},active:"view"}}},{path:"filter/:id",name:"Release Filter",component:ws,props:{filterIndex:!0},meta:{title:"releases",crumb:{link:{name:"dashboard",to:"/"},active:"filter"}}}]},Vee={path:"/service-desk/software/license",component:Be,name:"SD Softwarelicense",redirect:"/service-desk/software/license/list",children:[{path:"list",name:"SoftwareLicense Index",component:ks,meta:{title:"software/license",crumb:{link:{name:"dashboard",to:"/"},active:"software/license"}}},{path:"create",name:"Softwarelicense Create",component:Cs,props:{category:"license",panel:"agent"},meta:{title:"software/license",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"software/license",to:"/service-desk/software/license/list"},active:"create"}}},{path:":id/edit",name:"Softwarelicense Edit",component:Cs,props:{category:"license",panel:"agent",showViewButton:!0},meta:{title:"software/license",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"software/license",to:"/service-desk/software/license/list"},active:"edit"}}},{path:":id/show",name:"Softwarelicense View",component:uR,meta:{title:"software/license",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"software/license",to:"/service-desk/software/license/list"},active:"view"}}},{path:"filter/:id",name:"Softwarelicense Filter",component:ks,props:{filterIndex:!0},meta:{title:"Software License",crumb:{link:{name:"dashboard",to:"/"},active:"filter"}}}]},Lee=[{path:"/service-desk/reports",component:Be,name:"Servicedesk Reports",redirect:"/service-desk/reports/get",children:[{path:"get",component:nc,name:"SD Reports Home",meta:{title:"servicedesk_reports",crumb:{active:"servicedesk_reports"}}},{path:"assets",component:_c,name:"SD Reports Index",meta:{title:"assets_report",crumb:{link:{name:"servicedesk_reports",to:"/service-desk/reports/get"},active:"assets_report"}}},{path:"assets/create",component:cs,name:"SD Reports Create",meta:{title:"assets_report",crumb:{link:{name:"servicedesk_reports",to:"/service-desk/reports/get"},root_link:{name:"assets_report",to:"/service-desk/reports/assets"},active:"create"}}},{path:"assets/edit/:id",component:cs,name:"SD Reports Edit",meta:{title:"assets_report",crumb:{link:{name:"servicedesk_reports",to:"/service-desk/reports/get"},root_link:{name:"assets_report",to:"/service-desk/reports/assets"},active:"edit"}}},{path:"assets/:id",component:ah,name:"SD Reports View",meta:{title:"assets_report",crumb:{link:{name:"servicedesk_reports",to:"/service-desk/reports/get"},root_link:{name:"assets_report",to:"/service-desk/reports/assets"},active:"view"}}},{path:":type/:module/:id",component:Ks,name:"SD Reports",meta:{title:"from_report",crumb:{link:{name:"servicedesk_reports",to:"/service-desk/reports/get"},active:"from_report"}},props:!0}]},Mee,Iee,Aee,Pee,Tee,Vee];Lee.forEach(function(e){qa.addRoute(e)});let Uee={path:"/service-desk/products",component:de,name:"Products",redirect:"/service-desk/products/list",children:[{path:"list",component:$R,name:"Products Index",meta:{title:"products",crumb:{link:{name:"admin_panel",to:"/"},active:"products"}}},{path:"create",name:"Product Create",component:Ds,meta:{title:"products",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"products",to:"/service-desk/products"},active:"create"}}},{path:":id/edit",name:"Product Edit",component:Ds,meta:{title:"products",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"products",to:"/service-desk/products"},active:"edit"}}},{path:":id/show",name:"Product View",component:vB,meta:{title:"products",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"products",to:"/service-desk/products"},active:"view"}}}]},$ee={path:"/service-desk/procurement",component:de,name:"Procurement",redirect:"/service-desk/procurement/list",children:[{path:"list",component:PB,name:"Procurement Index",meta:{title:"procurement",crumb:{link:{name:"admin_panel",to:"/"},active:"procurement"}}},{path:"create",name:"Procurement Create",component:Ss,meta:{title:"procurement",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"procurement",to:"/service-desk/procurement"},active:"create"}}},{path:":id/edit",name:"Procurement Edit",component:Ss,meta:{title:"procurement",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"procurement",to:"/service-desk/procurement"},active:"edit"}}}]},Nee={path:"/service-desk/contract-type",component:de,name:"ContractType",redirect:"/service-desk/contract-type/list",children:[{path:"list",component:ZB,name:"Contract Types Index",meta:{title:"contract_types",crumb:{link:{name:"admin_panel",to:"/"},active:"contract_types"}}},{path:"create",name:"Contract Type Create",component:as,meta:{title:"contract_types",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"contract_types",to:"/service-desk/contract-type"},active:"create"}}},{path:":id/edit",name:"Contract Type Edit",component:as,meta:{title:"contract_types",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"contract_types",to:"/service-desk/contract-type"},active:"edit"}}}]},Eee={path:"/service-desk/license-type",component:de,name:"License",redirect:"/service-desk/license-type/list",children:[{path:"list",component:lK,name:"License Types Index",meta:{title:"license_type",crumb:{link:{name:"admin_panel",to:"/"},active:"license_type"}}},{path:"create",name:"License Type Create",component:Fs,meta:{title:"license_type",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"license_type",to:"/service-desk/license-type"},active:"create"}}},{path:":id/edit",name:"License Type Edit",component:Fs,meta:{title:"license_type",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"license_type",to:"/service-desk/license-type"},active:"edit"}}}]},qee={path:"/service-desk/vendor",component:de,name:"Vendor",redirect:"/service-desk/vendor/list",children:[{path:"list",component:IK,name:"Vendor Index",meta:{title:"vendor",crumb:{link:{name:"admin_panel",to:"/"},active:"vendor"}}},{path:"create",name:"Vendor Create",component:Tt,meta:{title:"vendor",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"vendor",to:"/service-desk/vendor"},active:"create"}}},{path:":id/edit",name:"Vendor Edit",component:Tt,meta:{title:"vendor",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"vendor",to:"/service-desk/vendor"},active:"edit"}}},{path:":id/show",name:"Vendor View",component:Rz,meta:{title:"vendor",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"vendor",to:"/service-desk/vendor"},active:"view"}}}]},Oee={path:"/service-desk/asset-type",component:de,name:"Asset Type",redirect:"/service-desk/asset-type/list",children:[{path:"list",component:Qz,name:"asset_types.index",meta:{title:"asset_types",crumb:{link:{name:"admin_panel",to:"/"},active:"asset_types"}}},{path:"create",name:"asset_types.create",component:Ms,meta:{title:"asset_types",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"asset_types",to:"/service-desk/asset-type"},active:"create"}}},{path:":id/edit",name:"asset_types.edit",component:Ms,meta:{title:"asset_types",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"asset_types",to:"/service-desk/asset-type"},active:"edit"}}}]},jee={path:"/service-desk/change-type",component:de,name:"Change Type",redirect:"/service-desk/change-type/list",children:[{path:"list",component:jH,name:"Change Types Index",meta:{title:"change_types",crumb:{link:{name:"admin_panel",to:"/"},active:"change_types"}}},{path:"create",name:"Change Type Create",component:Is,meta:{title:"change_types",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"change_types",to:"/service-desk/change-type"},active:"create"}}},{path:":id/edit",name:"Change Type Edit",component:Is,meta:{title:"change_types",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"change_types",to:"/service-desk/change-type"},active:"edit"}}}]},Ree={path:"/service-desk/asset-status",component:de,name:"Asset Status",redirect:"/service-desk/asset-status/list",children:[{path:"list",component:hY,name:"Asset Statuses Index",meta:{title:"asset_statuses",crumb:{link:{name:"admin_panel",to:"/"},active:"asset_status"}}},{path:"create",name:"Asset Status Create",component:As,meta:{title:"asset_statuses",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"asset_status",to:"/service-desk/asset-status"},active:"create"}}},{path:":id/edit",name:"Asset Status Edit",component:As,meta:{title:"asset_statuses",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"asset_status",to:"/service-desk/asset-status"},active:"edit"}}}]},xee={path:"/service-desk/cab",component:de,name:"CAB",redirect:"/service-desk/cab/list",children:[{path:"list",component:UY,name:"CAB Index",meta:{title:"change_advisory_board",crumb:{link:{name:"admin_panel",to:"/"},active:"change_advisory_board"}}},{path:"create",name:"CAB Create",component:Ps,meta:{title:"change_advisory_board",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"cabs",to:"/service-desk/cab"},active:"create"}}},{path:":id/edit",name:"CAB Edit",component:Ps,meta:{title:"change_advisory_board",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"cabs",to:"/service-desk/cab"},active:"edit"}}},{path:":id/show",name:"CAB VIEW",component:TJ,meta:{title:"change_advisory_board",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"cabs",to:"/service-desk/cab"},active:"view"}}}]},Bee={path:"/service-desk/announcement",component:de,name:"Announcement",redirect:"/service-desk/announcement/settings",children:[{path:"settings",component:zJ,name:"Announcement Settings",meta:{title:"announcement",crumb:{link:{name:"admin_panel",to:"/"},active:"announcement"}}}]},Kee={path:"/service-desk/barcode",component:de,name:"Barcode",redirect:"/service-desk/barcode/settings",children:[{path:"settings",component:dG,name:"Barcode Settings",meta:{title:"barcode_settings",crumb:{link:{name:"admin_panel",to:"/"},active:"barcode_settings"}}}]},zee={path:"/service-desk/import-tracking",component:de,name:"Asset Import Progress",redirect:"/service-desk/import-tracking/settings",children:[{path:":id",component:CG,name:"Asset Import Progress Settings",props:{},meta:{title:"sd_importer_asset_import",crumb:{link:{name:"admin_panel",to:"/"},active:"sd_importer_asset_import"}}}]},Hee={path:"/service-desk/asset-importer",component:de,name:"Asset Import",redirect:"/service-desk/asset-importer/settings",children:[{path:"settings",component:fZ,name:"Asset Import Settings",props:{"upload-url":"service-desk/asset-upload-csv","mapping-details-get-url":"service-desk/get-asset-mapping-details/","mapping-post-url":"service-desk/post-asset-mapping","import-type":"asset","discard-url":"service-desk/import-discard/"},meta:{title:"sd_importer_asset_import",crumb:{link:{name:"admin_panel",to:"/"},active:"sd_importer_asset_import"}}}]},Yee={path:"/service-desk/cmdb-relation",component:de,name:"CMDB",redirect:"/service-desk/cmdb-relation/list",children:[{path:"list",component:FZ,name:"CMDB Relation Index",meta:{title:"cmdb_relations",crumb:{link:{name:"admin_panel",to:"/"},active:"cmdb_relations"}}},{path:"create",name:"CMDB Create",component:Ts,meta:{title:"cmdb_relations",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"cmdb_relations",to:"/service-desk/cmdb-relation"},active:"create"}}},{path:"edit/:id",name:"CMDB Edit",component:Ts,meta:{title:"cmdb_relations",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"cmdb_relations",to:"/service-desk/cmdb-relation"},active:"edit"}}}]},Wee={path:"/service-desk/status",component:de,name:"SdStatus",redirect:"/service-desk/status/list",children:[{path:"list",component:ZZ,name:"Sd Status Index",meta:{title:"service_desk_status",crumb:{link:{name:"admin_panel",to:"/"},active:"status"}}},{path:"create",name:"Sd Status Create",component:Vs,meta:{title:"service_desk_status",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"status",to:"/service-desk/status/"},active:"create"}}},{path:":id/edit",name:"SD Status Edit",component:Vs,meta:{title:"service_desk_status",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"status",to:"/service-desk/status"},active:"edit"}}}]},Jee={path:"/service-desk/form-group",component:de,name:"Form-Groups",redirect:"/service-desk/form-group/create/asset",children:[{path:"create/asset",name:"Asset Form-Group Create",component:ut,props:{"form-name-obj":{id:"name",className:"col-md-6",label:"form_group_name",placeholder:"name_your_form_group",value:"",submitFormParamKey:"name"},"form-linker":[{id:"asset_types",className:"col-md-6",apiEndpoint:"service-desk/api/dependency/asset_types?config=true",label:"asset_type",value:[],submitFormParamKey:"asset_type_ids"}],"post-from-group-api":"service-desk/api/post-form-group/asset","edit-form-group-api":"service-desk/api/get-form-group/asset","form-category-type":"asset","group-mode":"create"},meta:{title:"form-groups",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"form-groups",to:"/form-group"},active:"create"}}},{path:"edit/asset/:id",name:"Asset Form-Group Edit",component:ut,props:{"form-name-obj":{id:"name",className:"col-md-6",label:"form_group_name",placeholder:"name_your_form_group",value:"",submitFormParamKey:"name"},"form-linker":[{id:"asset_types",className:"col-md-6",apiEndpoint:"service-desk/api/dependency/asset_types?config=true",label:"asset_type",value:[],submitFormParamKey:"asset_type_ids"}],"post-from-group-api":"service-desk/api/post-form-group/asset","edit-form-group-api":"service-desk/api/get-form-group/asset","form-category-type":"asset","group-mode":"edit"},meta:{title:"form-groups",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"form-groups",to:"/form-group"},active:"edit"}}},{path:"create/change",name:"Change Form-Group Create",component:ut,props:{"form-name-obj":{id:"name",className:"col-md-6",label:"form_group_name",placeholder:"name_your_form_group",value:"",submitFormParamKey:"name"},"form-linker":[{id:"change_types",className:"col-md-6",apiEndpoint:"service-desk/api/dependency/change_types?config=true",label:"change_type",value:[],submitFormParamKey:"change_type_ids"}],"post-from-group-api":"service-desk/api/post-form-group/change","edit-form-group-api":"service-desk/api/get-form-group/change","form-category-type":"change","group-mode":"create"},meta:{title:"form-groups",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"form-groups",to:"/form-group"},active:"create"}}},{path:"edit/change/:id",name:"Change Form-Group Edit",component:ut,props:{"form-name-obj":{id:"name",className:"col-md-6",label:"form_group_name",placeholder:"name_your_form_group",value:"",submitFormParamKey:"name"},"form-linker":[{id:"change_types",className:"col-md-6",apiEndpoint:"service-desk/api/dependency/change_types?config=true",label:"change_type",value:[],submitFormParamKey:"change_type_ids"}],"post-from-group-api":"service-desk/api/post-form-group/change","edit-form-group-api":"service-desk/api/get-form-group/change","form-category-type":"change","group-mode":"edit"},meta:{title:"form-groups",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"form-groups",to:"/form-group"},active:"edit"}}}]},Gee={path:"/service-desk/workflow",component:de,name:"SD Workflow",redirect:"/service-desk/workflow/create",children:[{path:"create",name:"SD Workflow Create",component:_t,props:{category:"workflow"},meta:{title:"workflow",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"workflow",to:"/workflow"},active:"create"}}},{path:":id/edit",name:"SD Workflow Edit",component:_t,props:{category:"workflow"},meta:{title:"workflow",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"workflow",to:"/workflow"},active:"edit"}}}]},Zee={path:"/service-desk/listener",component:de,name:"SD Listener",redirect:"/service-desk/listener/create",children:[{path:"create",name:"SD Listener Create",component:_t,props:{category:"listener"},meta:{title:"listeners",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"listeners",to:"/listener"},active:"create"}}},{path:":id/edit",name:"SD Listener Edit",component:_t,props:{category:"listener"},meta:{title:"listeners",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"listeners",to:"/listener"},active:"edit"}}}]},Qee={path:"/service-desk/deprication",component:de,name:"Depreciation",redirect:"/service-desk/deprication/list",children:[{path:"list",component:PQ,name:"Depreciation Index",meta:{title:"depreciation",crumb:{link:{name:"admin_panel",to:"/"},active:"depreciation"}}},{path:"create",name:"Depreciation Create",component:Ls,meta:{title:"depreciation",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"depreciation",to:"/service-desk/deprication"},active:"create"}}},{path:":id/edit",name:"Depreciation Edit",component:Ls,meta:{title:"depreciation",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"depreciation",to:"/service-desk/deprication"},active:"edit"}}},{path:":id/show",name:"Depreciation View",component:fX,meta:{title:"depreciation",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"depreciation",to:"/service-desk/deprication"},active:"view"}}}]},Xee={path:"/service-desk/manufacturers",component:de,name:"Manufacturers",redirect:"/service-desk/manufacturers/list",children:[{path:"list",component:FX,name:"Manufacturers Index",meta:{title:"manufacturers",crumb:{link:{name:"admin_panel",to:"/"},active:"manufacturers"}}},{path:"create",name:"Manufacturers Create",component:Us,meta:{title:"manufacturers",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"manufacturers",to:"/service-desk/manufacturers/"},active:"create"}}},{path:":id/edit",name:"Manufacturers Edit",component:Us,meta:{title:"manufacturers",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"manufacturers",to:"/service-desk/manufacturers/"},active:"edit"}}},{path:":id/show",name:"Manufacturers View",component:bee,meta:{title:"manufacturers",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"manufacturers",to:"/service-desk/manufacturers/"},active:"view"}}}]},ete={path:"/service-desk/currency",component:de,name:"Currency",redirect:"/service-desk/currency/create",children:[{path:"create",component:See,name:"CurrencyCreate",meta:{title:"Create Currency",crumb:{link:{name:"admin_panel",to:"/"},active:"Create Currency"}}}]},tte=[ete,Uee,$ee,Nee,Eee,qee,Oee,jee,Ree,xee,Bee,Kee,Hee,zee,Yee,Jee,Gee,Zee,Wee,Qee,Xee];tte.forEach(function(e){Ja.addRoute(e)});ie.dispatch("deleteUser");ie.dispatch("updateUser");app.component("agent-asset-index",Rt);app.component("sd-import-mapper",da);const Zt=Pa({components:{SDReports:Ks}});Zt.use(ie);Zt.mixin(qs);Zt.mount("#sd-reports");
