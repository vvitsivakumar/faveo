import{_ as V,s as S,e as v,N as I,M as z,c as W,V as X,l as Y,j as Z,D as x,m as j}from"../chunks/bootstrap.js";import{a as k,r as c,q as M,b as D,w as h,T as N,o as a,f as i,e as l,d as u,t as r,i as q,c as n,g as _,n as P,G as R,p as F,j as L,F as A,u as ee}from"../chunks/vendor.js";import{V as B,F as U,r as H,a as J}from"../chunks/clientRouter.js";import{T as te}from"../chunks/PermaLink.js";import{r as se,A as ie}from"../chunks/adminRouter.js";import"../chunks/LoginLogs.js";import"../chunks/BarcodeModal.js";import"../chunks/DataTableActions.js";import"../chunks/approvalTicketRules.js";import"../chunks/FormGenerator.js";import"../chunks/AdminNavigationBar.js";import"../chunks/HelpSection.js";const oe={name:"verify-2fa",description:"Two-factor Authentication component",props:{layout:{type:Object,default:()=>{}},auth:{type:Object,default:()=>{}},pp:{type:[Object,String],default:""},remember:{type:Boolean,default:!1}},data(){return{retry_after:59,loading:!1,otp:"",mobile:"",buttonStyle:{borderColor:this.layout.portal.client_button_border_color,backgroundColor:this.layout.portal.client_button_color},language:this.layout.language,isDisabled:!1,updateEmail:!1,isVerifyingMobile:!1,requireMobileRegistration:!1,token:""}},beforeMount(){this.$route.query.requireMobileRegistration==1&&(this.requireMobileRegistration=!0,this.updateEmail=!0),this.$route.query.isVerifyingMobile&&(this.isVerifyingMobile=!0),this.token=this.$route.query.token,this.resendOTP(!0)},methods:{onChange(e,t){this[t]=e,t==="otp"&&(this.isDisabled=e.length<6)},showField(e=1){this.updateEmail=e==1},triggerEvent(e){(e.which||e.keyCode)===13&&this.onSubmit()},resendOTP(e=!1){this.$store.dispatch("unsetValidationError"),this.$Progress.start(),this.isDisabled=!0,this.loading=!0,this.otp="",k.post("api/resend-sms-otp",{token:this.$route.query.token}).then(t=>{this.$Progress.finish(),this.isDisabled=!1,this.loading=!1,this.retry_after=t.data.data.retry_after,e||S(t,"otp"),this.setTimeIntervalForOTP()}).catch(t=>{this.$Progress.fail(),this.isDisabled=!1,this.loading=!1,v(t,"otp")})},setTimeIntervalForOTP(){const t=setInterval(()=>{this.retry_after=this.retry_after-1,this.retry_after==0&&(console.log(this.retry_after),clearInterval(t))},1e3)},isValidMobile(e){return e.length>=7&&e.length<=20},onSubmitUdateMobileAndResendOTP(){if(this.otp="",this.$store.dispatch("unsetValidationError"),!this.isValidMobile(this.mobile)){this.$store.dispatch("setValidationError",{mobile:this.mobile.length<7?this.lang("invalid_mobile_number_min_length"):this.lang("invalid_mobile_number_max_length")});return}this.$Progress.start(),this.isDisabled=!0,this.loading=!0;const e={};e.mobile=this.mobile,e.token=this.$route.query.token,k.post("api/update-mobile-resend-otp",e).then(t=>{this.$Progress.finish(),this.isDisabled=!1,this.loading=!1,this.retry_after=59,this.updateEmail=!1,S(t,"otp")}).catch(t=>{this.$Progress.fail(),this.isDisabled=!1,this.loading=!1,v(t,"otp")})},isValidOtp(){return this.otp.length===6},onSubmit(){if(this.$store.dispatch("unsetValidationError"),!this.isValidOtp()){this.$store.dispatch("setValidationError",{otp:this.lang("otp_validation")});return}this.$Progress.start(),this.isDisabled=!0,this.loading=!0;const e={};e.otp=this.otp,e.token=this.$route.query.token,e.isVerifyingMobile=this.isVerifyingMobile,k.post("/api/verify-otp",e).then(t=>{if(this.$Progress.finish(),this.isDisabled=!1,this.loading=!1,S(t,"otp"),this.redirectUrl=t.data.data.redirect_url,this.redirectPath=localStorage.getItem("redirectPath"),this.redirectPath){const d=this.$store.getters.getLayoutData.system.url;window.location.href=d+"/mytickets"}else this.redirectUrl=="/"?window.location.href=this.auth.system_url:this.$router.push(this.redirectUrl)}).catch(t=>{this.$Progress.fail(),this.isDisabled=!1,this.loading=!1,this.otp="",v(t,"otp")})}},components:{VerificationProgress:B,"form-helper":U,"number-field":I}},G=e=>(F("data-v-668949ef"),e=e(),L(),e),ae={id:"content",class:"site-content col-md-12"},ne={id:"head3"},re={key:0},le=G(()=>i("i",{class:"fa fa-mobile-phone",style:{"font-size":"18px"}},null,-1)),de={key:1},ue={class:"row"},ce=["disabled"],pe=G(()=>i("i",{class:"fa fa-check"},null,-1)),he={class:"row ml-0 mt-1"},_e={key:0},me={key:1},ge={id:"h3"},fe={key:0},ve={key:0},be={key:0,class:"row"},ye=["disabled"];function ke(e,t,d,C,s,o){const f=c("alert"),m=c("verification-progress"),g=c("number-field"),p=c("custom-loader"),w=c("form-helper"),O=c("loader"),T=M("focus-first-input");return a(),D(N,{name:"page",mode:"out-in"},{default:h(()=>[i("div",{class:P({fa_align:s.language==="ar"})},[i("div",ae,[l(f,{componentName:"otp"}),s.isVerifyingMobile?(a(),D(m,{key:0,active:"otp-verify",token:s.token},null,8,["token"])):u("",!0),s.updateEmail?u("",!0):(a(),D(w,{key:1},{title:h(()=>[i("h3",ne,r(s.isVerifyingMobile?e.lang("mobile_verification_required"):e.lang("verify-otp")),1)]),fields:h(()=>[s.loading?u("",!0):q((a(),n("div",re,[l(g,{slot:"fields",label:e.lang("enter_code"),value:s.otp,keyupListener:o.triggerEvent,type:"text",name:"otp",onChange:o.onChange,classname:"",required:!0,placeholder:e.lang("otp_placeholder")},null,8,["label","value","keyupListener","onChange","placeholder"]),i("p",null,[le,_(" "+r(e.lang("verify-otp-message")),1)])])),[[T]]),s.loading?(a(),n("div",de,[l(p,{"animation-duration":4e3,color:d.layout.portal.client_header_color,size:50},null,8,["color"])])):u("",!0)]),controls:h(()=>[i("div",ue,[i("div",{class:P(["col-sm-12 offset-sm-12",{left:s.language==="ar"}])},[i("button",{class:"btn btn-custom btn-block btn-flat",onClick:t[0]||(t[0]=b=>o.onSubmit()),style:R(s.buttonStyle),disabled:!s.otp},[pe,_(" "+r(e.lang("verify")),1)],12,ce),i("div",he,[s.retry_after>0?(a(),n("div",_e,[i("a",{id:"update_email",href:"javascript:void(0)",onClick:t[1]||(t[1]=b=>o.showField())},r(e.lang("update_mobile")),1),_(" | "+r(e.lang("retry_after"))+" ",1),i("b",null,r(s.retry_after)+" s ",1)])):(a(),n("div",me,[i("a",{id:"update_email",href:"javascript:void(0)",onClick:t[2]||(t[2]=b=>o.showField())},r(e.lang("update_mobile")),1),_(" | "),i("a",{id:"resent_otp",href:"javascript:void(0)",onClick:t[3]||(t[3]=b=>o.resendOTP())},r(e.lang("resend_otp")),1)]))])],2)])]),_:1})),s.updateEmail?(a(),D(w,{key:2},{title:h(()=>[i("h3",ge,r(e.lang("update_mobile_and_send_OTP")),1),s.loading?u("",!0):(a(),n("p",fe,r(e.lang("provide_the_mobile_number_to_verify_with_OTP")),1))]),fields:h(()=>[i("div",{class:P({left:s.language==="ar"})},[l(g,{slot:"fields",label:e.lang("mobile_number"),value:s.mobile,type:"text",name:"mobile",onChange:o.onChange,classname:"",required:!0},null,8,["label","value","onChange"])],2),s.loading?(a(),n("div",ve,[l(O,{"animation-duration":4e3,color:d.layout.portal.client_header_color,size:50},null,8,["color"])])):u("",!0)]),controls:h(()=>[s.loading?u("",!0):(a(),n("div",be,[i("div",{class:P(["col-xs-12 col-sm-12 col-md-12",{left:s.language==="ar"}])},null,2),i("div",{class:P(["col-xs-12 col-sm-12 col-md-12",{left:s.language==="ar"}])},[i("button",{id:"update_btn2",class:"btn btn-custom btn-block btn-flat",onClick:t[4]||(t[4]=(...b)=>o.onSubmitUdateMobileAndResendOTP&&o.onSubmitUdateMobileAndResendOTP(...b)),style:R(s.buttonStyle),disabled:!s.mobile},r(e.lang("update_and_send_OTP")),13,ye),i("div",null,[i("a",{id:"have_otp",href:"javascript:void(0)",onClick:t[5]||(t[5]=b=>o.showField(0))},r(e.lang("already_have_OTP_verify_here")),1)])],2)]))]),_:1})):u("",!0)])],2)]),_:1})}const we=V(oe,[["render",ke],["__scopeId","data-v-668949ef"]]),Ce={name:"sms-otp-toggle",components:{TextField:te,Modal:z,"number-field":I},props:{data:{type:String,required:!0}},data(){return{isEnabled:!1,updating:!1,otpVerified:!1,showModal:!1,otp:"",isDisabled:!0,loading:!1,canTurnOn:!0,retry_after:60,intervalId:null}},created(){window.emitter.on("updateSmsToggleButton",e=>{this.canTurnOn=!e.is_2fa_enabled})},beforeMount(){this.optData=JSON.parse(this.data),this.getRequireOTPLoginStatus(),this.canTurnOn=!this.optData.twoFAStatus},methods:{onClose(){this.showModal=!1},onChange(e,t){this.otp=e,t==="otp"&&(this.isDisabled=e.length<6)},isValidOtp(){return this.otp.length===6},async verifyOtp(){if(this.$store.dispatch("unsetValidationError"),!this.isValidOtp()){this.$store.dispatch("setValidationError",{otp:this.lang("otp_validation")});return}try{const e=await k.post("api/verify-otp",{otp:this.otp});this.otpVerified=!0,this.showModal=!1,this.toggleOTPRequire()}catch(e){v(e,"otp_page")}this.isDisabled=!0,this.otp=""},async askToSendOTP(){try{this.showModal=!0,this.loading=!0;const e=await k.post("/api/resend-sms-otp");this.loading=!1,this.retry_after=e.data.data.retry_after,S(e,"otp_page"),this.setTimeIntervalForOTP()}catch(e){this.loading=!1,v(e,"otp_page")}},setTimeIntervalForOTP(){clearInterval(this.intervalId);let e=this.retry_after;const t=()=>{e=e-1,this.retry_after=e,e===0&&clearInterval(this.intervalId)};this.intervalId=setInterval(t,1e3)},toggleOTPRequire(e=1){if(e||(this.otpVerified=!1),e&&!this.otpVerified){this.askToSendOTP();return}this.updating=!0;const t={};t["require-otp-login"]=e,k.post("api/toggle-otp-login",t).then(d=>{this.isEnabled=e,this.updating=!1,window.emitter.emit("updateEditData"),S(d,this.optData.alert)}).catch(d=>{this.updating=!1,v(d,this.optData.alert)})},getRequireOTPLoginStatus(){k.get("api/get-otp-login-status").then(e=>{this.isEnabled=e.data.data.otp_required}).catch(e=>{v(e,this.optData.alert)})},triggerEvent(e){(e.which||e.keyCode)===13&&this.verifyOtp()}}},Te=i("hr",null,null,-1),Pe={class:"row"},Se={class:"col-md-9"},Oe=i("i",{class:"fas fa-sms fa-lg ml-1 mr-1"},null,-1),De={class:"col-md-3"},qe=["disabled"],Ve=i("i",{class:"fas fa-toggle-on"},null,-1),Me=i("i",{class:"fas fa-power-off"},null,-1),Ie={key:2,type:"button",class:"btn btn-primary float-right disabled"},Ee={class:"modal-title"},Re={key:0,class:"row"},Ne={key:1,class:"row"},Fe={class:"row ml-0"},Le={key:0},$e={key:1},ze=["disabled"],je=i("i",{class:"fas fa-check","aria-hidden":"true"},null,-1),Ae={key:0,class:"row"};function Be(e,t,d,C,s,o){const f=c("alert"),m=c("reuse-loader"),g=c("number-field"),p=c("modal"),w=M("tooltip"),O=M("focus-first-input");return a(),n("div",null,[Te,i("div",Pe,[i("div",Se,[i("span",null,[Oe,_(" "+r(e.lang("toggle_sms_otp_for_login")),1)])]),i("div",De,[!s.isEnabled&&!s.updating?q((a(),n("button",{key:0,type:"button",class:"btn btn-primary float-right",onClick:t[0]||(t[0]=T=>o.toggleOTPRequire()),disabled:!s.canTurnOn},[Ve,_(" "+r(e.lang("turn_on")),1)],8,qe)),[[w,e.lang("sms_2fa_tooltip_for_status_"+s.canTurnOn)]]):u("",!0),s.isEnabled&&!s.updating?(a(),n("button",{key:1,type:"button",class:"btn btn-danger float-right",onClick:t[1]||(t[1]=T=>o.toggleOTPRequire(0))},[Me,_(" "+r(e.lang("turn_off")),1)])):u("",!0),s.updating?(a(),n("button",Ie,r(e.lang("updating")),1)):u("",!0),s.showModal?(a(),D(p,{key:3,showModal:s.showModal,onClose:o.onClose},{title:h(()=>[i("h4",Ee,r(e.lang("otp_verification_modal")),1)]),alert:h(()=>[l(f,{componentName:"otp_page"})]),fields:h(()=>[s.loading?(a(),n("div",Re,[l(m,{"animation-duration":4e3,color:"#1d78ff",size:e.size},null,8,["size"])])):q((a(),n("div",Ne,[l(g,{name:"otp",keyupListener:o.triggerEvent,value:s.otp,label:e.lang("otp_verification_in_profile"),type:"text",onChange:o.onChange,required:!0,classname:"col-sm-12",placeholder:e.lang("otp_placeholder")},null,8,["keyupListener","value","label","onChange","placeholder"])])),[[O]]),i("div",Fe,[s.retry_after>0?(a(),n("div",Le,[_(r(e.lang("retry_after"))+" ",1),i("b",null,r(s.retry_after),1),_(" s ")])):(a(),n("div",$e,[i("a",{id:"resent_otp",href:"javascript:void(0)",onClick:t[2]||(t[2]=T=>o.askToSendOTP())},r(e.lang("resend_otp")),1)]))])]),controls:h(()=>[i("button",{type:"button",id:"submit_btn",onClick:t[3]||(t[3]=(...T)=>o.verifyOtp&&o.verifyOtp(...T)),class:"btn btn-primary",disabled:s.isDisabled},[je,_(" "+r(e.lang("verify")),1)],8,ze)]),default:h(()=>[s.loading?(a(),n("div",Ae,[l(m,{"animation-duration":4e3,size:60,color:e.color},null,8,["color"])])):u("",!0)]),_:1},8,["showModal","onClose"])):u("",!0)])])])}const Ue=V(Ce,[["render",Be]]);const He={name:"sms-otp-toggle",components:{"number-field":I,Modal:z},props:{data:{type:String,required:!0}},data(){return{isEnabled:!1,updating:!1,loading:!1,canTurnOn:!0,showModal:!1,otp:"",isDisabled:!0,otpVerified:!1,retry_after:0,intervalId:null}},created(){window.emitter.on("updateSmsToggleButton",e=>{this.canTurnOn=!e.is_2fa_enabled})},beforeMount(){this.optData=JSON.parse(this.data),this.getRequireOTPLoginStatus(),this.canTurnOn=!this.optData.user.user_data.is_2fa_enabled},methods:{onClose(){this.showModal=!1},onChange(e,t){this[t]=e,t==="otp"&&(this.isDisabled=e.length<6)},isValidOtp(){return this.otp.length===6},async verifyOtp(){if(this.$store.dispatch("unsetValidationError"),!this.isValidOtp()){this.$store.dispatch("setValidationError",{otp:this.lang("otp_validation")});return}try{const e=await k.post("api/verify-otp",{otp:this.otp});this.otpVerified=!0,this.showModal=!1,this.otp="",this.toggleOTPRequire()}catch(e){v(e,"otp_page")}this.isDisabled=!0,this.otp=""},async askToSendOTP(){try{this.showModal=!0,this.loading=!0;const e=await k.post("/api/resend-sms-otp");this.loading=!1,S(e,"otp_page"),this.retry_after=e.data.data.retry_after,this.setTimeIntervalForOTP()}catch(e){this.loading=!1,v(e,"otp_page")}},setTimeIntervalForOTP(){clearInterval(this.intervalId);let e=this.retry_after;const t=()=>{e=e-1,this.retry_after=e,e===0&&clearInterval(this.intervalId)};this.intervalId=setInterval(t,1e3)},toggleOTPRequire(e=1){if(e||(this.otpVerified=!1),e&&!this.otpVerified){this.askToSendOTP();return}this.updating=!0,this.loading=!0;const t={};t["require-otp-login"]=e,k.post("api/toggle-otp-login",t).then(d=>{this.isEnabled=e,this.updating=!1,this.loading=!1,window.emitter.emit("togglingSMS",e),S(d,this.optData.alert)}).catch(d=>{this.updating=!1,this.loading=!1,v(d,this.optData.alert)})},getRequireOTPLoginStatus(){this.loading=!0,k.get("api/get-otp-login-status").then(e=>{this.updating=!1,this.isEnabled=e.data.data.otp_required}).catch(e=>{this.updating=!1,v(e,this.optData.alert)})}}},E=e=>(F("data-v-4edcf5d2"),e=e(),L(),e),Je=E(()=>i("hr",null,null,-1)),Ge={class:"row"},Ke={key:0,class:"col-sm-12"},Qe={class:"col-sm-9"},We={class:"d_flex"},Xe=E(()=>i("i",{class:"fas fa-sms fa-lg"},null,-1)),Ye={class:"col-sm-3"},Ze=["disabled"],xe=E(()=>i("i",{class:"fa fa-toggle-on"},null,-1)),et=E(()=>i("i",{class:"fa fa-power-off"},null,-1)),tt={class:"modal-title"},st={key:0,class:"row"},it={key:1,class:"row"},ot={class:"row ml-3"},at={key:0},nt={key:1},rt=["disabled"],lt=E(()=>i("i",{class:"fas fa-check","aria-hidden":"true"},null,-1)),dt={key:0,class:"row"};function ut(e,t,d,C,s,o){const f=c("custom-loader"),m=c("alert"),g=c("reuse-loader"),p=c("number-field"),w=c("modal"),O=M("tooltip"),T=M("focus-first-input");return a(),n(A,null,[Je,i("div",null,[i("div",Ge,[s.updating?(a(),n("div",Ke,[l(f,{duration:4e3})])):u("",!0),i("div",Qe,[i("span",We,[Xe,_(" Â "+r(e.lang("toggle_sms_otp_for_login")),1)])]),i("div",Ye,[s.isEnabled?u("",!0):q((a(),n("button",{key:0,type:"button",class:"btn btn-custom pull-right",style:R({borderColor:this.optData.layout.portal.client_button_border_color,backgroundColor:this.optData.layout.portal.client_button_color}),onClick:t[0]||(t[0]=b=>o.toggleOTPRequire()),id:"otp_turn_on",disabled:!s.canTurnOn},[xe,_(" "+r(e.lang("turn_on")),1)],12,Ze)),[[O,e.lang("sms_2fa_tooltip_for_status_"+s.canTurnOn)]]),s.isEnabled?(a(),n("button",{key:1,type:"button",class:"btn btn-danger pull-right",onClick:t[1]||(t[1]=b=>o.toggleOTPRequire(0)),id:"otp_turn_off"},[et,_(" "+r(e.lang("turn_off")),1)])):u("",!0)]),s.showModal?(a(),D(w,{key:1,showModal:s.showModal,onClose:o.onClose},{title:h(()=>[i("h4",tt,r(e.lang("otp_verification_modal")),1)]),alert:h(()=>[l(m,{componentName:"otp_page"})]),fields:h(()=>[s.loading?(a(),n("div",st,[l(g,{"animation-duration":4e3,color:"#1d78ff",size:"60"})])):q((a(),n("div",it,[l(p,{name:"otp",value:s.otp,label:e.lang("otp_verification_in_profile"),type:"text",onChange:o.onChange,required:!0,classname:"col-sm-12",placeholder:e.lang("otp_placeholder")},null,8,["value","label","onChange","placeholder"]),i("div",ot,[s.retry_after>0?(a(),n("div",at,[_(" Retry after "),i("b",null,r(s.retry_after),1),_(" seconds ")])):(a(),n("div",nt,[i("a",{id:"resent_otp",href:"javascript:void(0)",onClick:t[2]||(t[2]=b=>o.askToSendOTP())},r(e.lang("resend_otp")),1)]))])])),[[T]])]),controls:h(()=>[i("button",{type:"button",id:"submit_btn",onClick:t[3]||(t[3]=(...b)=>o.verifyOtp&&o.verifyOtp(...b)),class:"btn btn-primary",disabled:s.isDisabled},[lt,_(" "+r(e.lang("verify")),1)],8,rt)]),default:h(()=>[s.loading?(a(),n("div",dt,[l(g,{"animation-duration":4e3,size:60,color:"#1d78ff"})])):u("",!0)]),_:1},8,["showModal","onClose"])):u("",!0)])])],64)}const ct=V(He,[["render",ut],["__scopeId","data-v-4edcf5d2"]]);function pt(e){const{provider:t,mobile:d,auth_key:C,sender_id:s,route:o,owner_email:f,subacc:m,subacc_pass:g,smslive_sender_id:p,userid_gupshup:w,password_gupshup:O,vonage_api_key:T,vonage_api_secret:b}=e;var y={provider:[t,"isRequired"]};t&&t.name==="msg91.com"&&(y.auth_key=[C,"isRequired"],y.sender_id=[s,"isRequired"],y.route=[o,"isRequired"]),t&&t.name==="smslive247.com"&&(y.owner_email=[f,"isRequired","isEmail"],y.subacc=[m,"isRequired"],y.subacc_pass=[g,"isRequired"],y.smslive_sender_id=[p,"isRequired"]),t&&t.name==="gupshup.com"&&(y.userid_gupshup=[w,"isRequired"],y.password_gupshup=[O,"isRequired"]),t&&t.name==="vonage"&&(y.vonage_api_key=[T,"isRequired"],y.vonage_api_secret=[b,"isRequired"]),y.mobile=[d,"isRequired"];const K=new X(Y),{errors:$,isValid:Q}=K.validate(y);return W.dispatch("setValidationError",$),{errors:$,isValid:Q}}const ht={name:"sms-provider-settings",data(){return{providerName:"",providers:[],providerData:{},loading:!0,hasDataPopulated:!1,pageLoad:!1,provider:"",mobile:"",auth_key:"",sender_id:"",route:"",owner_email:"",subacc:"",subacc_pass:"",smslive_sender_id:"",userid_gupshup:"",password_gupshup:"",vonage_api_key:"",vonage_api_secret:""}},beforeMount(){this.providerName=this.$route.params.provider,this.getValues()},methods:{setProviderConfigs(){this.provider={id:this.providerData.id,name:this.providerName},this.providerName=="msg91.com"&&(this.auth_key=this.providerData.auth_key,this.sender_id=this.providerData.sender_id,this.route=this.providerData.route),this.providerName=="smslive247.com"&&(this.owner_email=this.providerData.owner_email,this.subacc=this.providerData.subacc,this.subacc_pass=this.providerData.subacc_pass,this.smslive_sender_id=this.providerData.smslive_sender_id),this.providerName=="gupshup.com"&&(this.userid_gupshup=this.providerData.userid_gupshup,this.password_gupshup=this.providerData.password_gupshup),this.providerName=="vonage"&&(this.vonage_api_key=this.providerData.vonage_api_key,this.vonage_api_secret=this.providerData.vonage_api_secret)},getValues(){this.loading=!0,k.get("/sms/api/provider/settings/"+this.providerName).then(e=>{this.providerData=e.data.data.providersDetails,this.setProviderConfigs(),this.loading=!1,this.hasDataPopulated=!0}).catch(e=>{this.loading=!1,this.hasDataPopulated=!0,v(e,"sms-provider-settings")})},onChange(e,t){this[t]=e,e===null&&(this[t]="")},isValid(){const{errors:e,isValid:t}=pt(this.$data);return t},onSubmit(){if(this.isValid()){this.pageLoad=!0;const e={};e.provider_id=this.provider.id,this.providerName=="msg91.com"&&(e.auth_key=this.auth_key,e.sender_id=this.sender_id,e.route=this.route),this.providerName=="smslive247.com"&&(e.owner_email=this.owner_email,e.subacc=this.subacc,e.subacc_pass=this.subacc_pass,e.smslive_sender_id=this.smslive_sender_id),this.providerName=="gupshup.com"&&(e.userid_gupshup=this.userid_gupshup,e.password_gupshup=this.password_gupshup),this.providerName==="vonage"&&(e.vonage_api_key=this.vonage_api_key,e.vonage_api_secret=this.vonage_api_secret),e.mobile=this.mobile,k.post("/sms/api/provider/settings",e).then(t=>{this.pageLoad=!1,this.hasDataPopulated=!1,this.mobile="",S(t,"sms-provider-settings"),this.getValues()}).catch(t=>{this.pageLoad=!1,v(t,"sms-provider-settings")})}}},components:{"text-field":Z,"number-field":I,"dynamic-select":x}},_t={class:"col-sm-12"},mt={key:0,class:"row"},gt={class:"card card-light"},ft={class:"card-header"},vt={class:"card-title"},bt={class:"card-body"},yt={key:0,class:"row"},kt={key:0,class:"row"},wt={key:1,class:"row"},Ct={key:2,class:"row"},Tt={key:3,class:"row"},Pt={class:"row"},St={class:"card-footer"},Ot=i("i",{class:"fas fa-save"},null,-1);function Dt(e,t,d,C,s,o){const f=c("alert"),m=c("custom-loader"),g=c("reuse-loader"),p=c("text-field"),w=c("number-field");return a(),n("div",_t,[l(f,{componentName:"sms-provider-settings"}),s.pageLoad?(a(),n("div",mt,[l(m,{duration:4e3})])):u("",!0),i("div",gt,[i("div",ft,[i("h3",vt,r(e.lang(s.providerName))+" "+r(e.lang("configurations")),1)]),i("div",bt,[!s.hasDataPopulated||s.loading?(a(),n("div",yt,[l(g,{"animation-duration":4e3,size:60})])):u("",!0),s.hasDataPopulated?(a(),n(A,{key:1},[s.providerName=="msg91.com"?(a(),n("div",kt,[l(p,{label:e.trans("auth_key"),value:s.auth_key,type:"text",name:"auth_key",onChange:o.onChange,classname:"col-sm-12",required:!0,placehold:e.trans("auth_key_placeholder")},null,8,["label","value","onChange","placehold"]),l(p,{label:e.trans("sender_id"),value:s.sender_id,type:"text",name:"sender_id",onChange:o.onChange,classname:"col-sm-12",required:!0,placehold:e.trans("sender_id_placeholder")},null,8,["label","value","onChange","placehold"]),l(p,{label:e.trans("route"),value:s.route,type:"text",name:"route",onChange:o.onChange,classname:"col-sm-12",required:!0,placehold:e.trans("route_placeholder")},null,8,["label","value","onChange","placehold"])])):u("",!0),s.providerName=="smslive247.com"?(a(),n("div",wt,[l(p,{label:e.trans("owner_email"),value:s.owner_email,type:"text",name:"owner_email",onChange:o.onChange,classname:"col-sm-12",required:!0,placehold:e.trans("owner_email_placeholder")},null,8,["label","value","onChange","placehold"]),l(p,{label:e.trans("subacc"),value:s.subacc,type:"text",name:"subacc",onChange:o.onChange,classname:"col-sm-12",required:!0,placehold:e.trans("subacc_placeholder")},null,8,["label","value","onChange","placehold"]),l(p,{label:e.trans("subacc_pass"),value:s.subacc_pass,type:"password",name:"subacc_pass",onChange:o.onChange,classname:"col-sm-12",required:!0,placehold:e.trans("subacc_pass_placeholder")},null,8,["label","value","onChange","placehold"]),l(p,{label:e.trans("smslive_sender_id"),value:s.smslive_sender_id,type:"text",name:"smslive_sender_id",onChange:o.onChange,classname:"col-sm-12",required:!0,placehold:e.trans("smslive_sender_id_placeholder")},null,8,["label","value","onChange","placehold"])])):u("",!0),s.providerName=="gupshup.com"?(a(),n("div",Ct,[l(p,{label:e.trans("userid_gupshup"),value:s.userid_gupshup,type:"text",name:"userid_gupshup",onChange:o.onChange,classname:"col-sm-12",required:!0,placehold:e.trans("userid_gupshup_placeholder")},null,8,["label","value","onChange","placehold"]),l(p,{label:e.trans("password_gupshup"),value:s.password_gupshup,type:"password",name:"password_gupshup",onChange:o.onChange,classname:"col-sm-12",required:!0,placehold:e.trans("password_gupshup_placeholder")},null,8,["label","value","onChange","placehold"])])):u("",!0),s.providerName=="vonage"?(a(),n("div",Tt,[l(p,{label:e.trans("vonage_api_key"),value:s.vonage_api_key,type:"text",name:"vonage_api_key",onChange:o.onChange,classname:"col-sm-12",required:!0,placehold:e.trans("vonage_api_key_placeholder")},null,8,["label","value","onChange","placehold"]),l(p,{label:e.trans("vonage_api_secret"),value:s.vonage_api_secret,type:"text",name:"vonage_api_secret",onChange:o.onChange,classname:"col-sm-12",required:!0,placehold:e.trans("vonage_api_secret_placeholder")},null,8,["label","value","onChange","placehold"])])):u("",!0),i("div",Pt,[l(w,{label:e.trans("mobile"),value:s.mobile,name:"mobile",classname:"col-sm-12",onChange:o.onChange,type:"number",required:!0,placeholder:e.trans("mobile-placeholder")},null,8,["label","value","onChange","placeholder"])])],64)):u("",!0)]),i("div",St,[i("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=O=>o.onSubmit())},[Ot,_(" "+r(e.trans("save")),1)])])])])}const qt=V(ht,[["render",Dt]]),Vt={name:"provider-actions",description:"Providers Action",props:{data:{type:Object,required:!0}},data(){return{loading:!1,showModal:!1,isDisabled:!1,containerStyle:{width:"650px"}}},methods:{onClose(){this.showModal=!1,window.emitter.emit("refreshData")},onSubmit(){axios.post("sms/api/provider/"+this.data.name+"/"+(this.data.status?"deactivate":"activate")).then(e=>{S(e,"providers-index"),this.onClose()}).catch(e=>{this.showModal=!1,v(e,"providers-index")})},redirectToSettingPages(){this.$router.push(`settings/${this.data.name}`)}},components:{}},Mt={key:0},It=i("i",{class:"fas fa-cog"},null,-1),Et=[It],Rt={class:"modal-title"},Nt={key:0},Ft={key:1,class:"row"},Lt=["disabled"],$t=i("i",{class:"fas fa-check"},null,-1);function zt(e,t,d,C,s,o){const f=c("reuse-loader"),m=c("modal"),g=M("tooltip");return d.data?(a(),n("div",Mt,[q((a(),n("span",null,[i("button",{class:"btn btn-default table_btn",onClick:t[0]||(t[0]=p=>s.showModal=!0)},[i("i",{class:P(d.data.status?"fas fa-solid fa-xmark":"fas fa-check-circle")},null,2)])])),[[g,d.data.status?e.trans("deactivate"):e.trans("activate")]]),q((a(),n("span",null,[i("button",{class:"btn btn-default table_btn",onClick:t[1]||(t[1]=(...p)=>o.redirectToSettingPages&&o.redirectToSettingPages(...p))},Et)])),[[g,e.trans("configure")]]),l(N,{name:"modal"},{default:h(()=>[s.showModal?(a(),D(m,{key:0,showModal:s.showModal,onClose:o.onClose,"container-style":s.containerStyle},{title:h(()=>[i("h4",Rt,r(d.data.status?e.trans("deactivate"):e.trans("activate")),1)]),fields:h(()=>[s.loading?u("",!0):(a(),n("div",Nt,[i("span",null,r(e.trans("are_you_sure")),1)])),s.loading?(a(),n("div",Ft,[l(f,{"animation-duration":4e3,size:60})])):u("",!0)]),controls:h(()=>[i("button",{type:"button",onClick:t[2]||(t[2]=(...p)=>o.onSubmit&&o.onSubmit(...p)),class:P(d.data.status?"btn btn-danger":"btn btn-primary"),disabled:s.isDisabled},[$t,_(" "+r(d.data.status?e.trans("deactivate"):e.trans("activate")),1)],10,Lt)]),_:1},8,["showModal","onClose","container-style"])):u("",!0)]),_:1})])):u("",!0)}const jt=V(Vt,[["render",zt]]),At={name:"providers-list",description:"providers List",data(){return{apiUrl:"sms/providers/list",columns:["name","status","actions"],options:{}}},setup(){const e=ee();return{formattedTime:computed(()=>e.getters.formattedTime)}},beforeMount(){const e=this;this.options={headings:{name:this.trans("name"),status:this.trans("status")},sortIcon:{base:"glyphicon",up:"glyphicon-chevron-up",down:"glyphicon-chevron-down"},texts:{filter:"",limit:""},templates:{name:function(t,d){return d.name},status:function(t,d){let C=e.h("span",{class:d.status===1?"btn btn-success btn-xs":"btn btn-danger btn-xs"},d.status===1?this.lang("active"):this.lang("inactive"));return e.h("a",{},[C])},actions:(t,d)=>e.h(jt,{data:d})},sortable:["name"],filterable:["name"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(t){return{paginate:1,"sort-field":t.orderBy?t.orderBy:"id","sort-order":t.ascending?"asc":"desc","search-query":t.query.trim(),page:t.page,limit:t.limit}},responseAdapter({data:t}){return{data:t.data.data,count:t.data.total}}}},components:{}},Bt={class:"col-sm-12"},Ut={class:"card card-light"},Ht={class:"card-header"},Jt={id:"contract-type-list",class:"card-title"},Gt={class:"card-body"};function Kt(e,t,d,C,s,o){const f=c("alert"),m=c("data-table");return a(),n("div",Bt,[l(f,{componentName:"providers-index"}),i("div",Ut,[i("div",Ht,[i("h3",Jt,r(e.lang("providers_list")),1)]),i("div",Gt,[l(m,{url:s.apiUrl,dataColumns:s.columns,option:s.options,scroll_to:"contract-type-list"},null,8,["url","dataColumns","option"])])])])}const Qt=V(At,[["render",Kt]]);const Wt={name:"verification-completed",description:"Verification completed Component",data(){return{remainingTime:10,language:"en",loading:!1,buttonStyle:{borderColor:"#00c0ef",backgroundColor:"#009aba"}}},beforeMount(){this.setTimeIntervalForRedirection()},methods:{redirectToHomePage(){this.redirect("/")},setTimeIntervalForRedirection(){const t=setInterval(()=>{this.remainingTime=this.remainingTime-1,console.log(this.remainingTime),this.remainingTime===0&&(clearInterval(t),this.redirectToHomePage())},1e3)}},components:{VerificationProgress:B,"form-helper":U,"number-field":I}},Xt=e=>(F("data-v-067f95a0"),e=e(),L(),e),Yt={id:"content",class:"site-content col-md-12"},Zt={id:"head3"},xt={style:{"text-align":"center","margin-top":"30px","margin-bottom":"50px"}},es={key:0},ts={class:"row"},ss=Xt(()=>i("i",{class:"fa fa-check"},null,-1));function is(e,t,d,C,s,o){const f=c("alert"),m=c("verification-progress"),g=c("custom-loader"),p=c("form-helper");return a(),D(N,{name:"page",mode:"out-in"},{default:h(()=>[i("div",{class:P({fa_align:s.language==="ar"})},[i("div",Yt,[l(f,{componentName:"verification-completed"}),l(m,{active:"final"}),l(p,null,{title:h(()=>[i("h3",Zt,r(e.lang("verification_successful")),1)]),fields:h(()=>[i("h6",xt,r(e.lang("after_verification_message"))+" "+r(s.remainingTime)+" s ",1),s.loading?(a(),n("div",es,[l(g,{"animation-duration":4e3,size:50})])):u("",!0)]),controls:h(()=>[i("div",ts,[i("div",{class:P(["col-sm-12 offset-sm-12",{left:s.language==="ar"}])},[i("button",{class:"btn btn-custom btn-block btn-flat",onClick:t[0]||(t[0]=w=>o.redirectToHomePage()),style:R(s.buttonStyle)},[ss,_(" "+r(e.lang("go_to_login_page")),1)],4)],2)])]),_:1})])],2)]),_:1})}const os=V(Wt,[["render",is],["__scopeId","data-v-067f95a0"]]);j("otp-box-profile",Ue,"profile-box-mounted","profile-view-boxes");j("otp-box-profile-client",ct,"2step-box-mounted","2step-boxes");H.addRoute({path:"/verify-otp",component:J,name:"VerifyOtpMain",redirect:"/verify-otp",children:[{path:"",component:we,name:"VerifyOTP",meta:{breadcrumb:[{text:"verify_mobile_number"}]}}]});H.addRoute({path:"/verification-completed",component:J,name:"VerificationCompletedMain",redirect:"/verification-completed",children:[{path:"",component:os,name:"VerificationCompleted",meta:{breadcrumb:[{text:"Verification Completed"}]}}]});se.addRoute({path:"/sms",component:ie,name:"SMS",redirect:"/sms/providers/list",children:[{path:"providers/settings/:provider",component:qt,name:"SMSProviderSettings",meta:{title:"SMS",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},parent_link:{name:"providers",to:"/sms"},active:"provider"}}},{path:"providers/list",component:Qt,name:"SMSProviderIndex",meta:{title:"sms_providers",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},active:"sms_providers"}}}]});
