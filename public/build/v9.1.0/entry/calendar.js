import{_ as w,s as R,e as S,n as lt,D as G,S as mt,f as pt,k as K,o as _t,M as kt,p as et,j as st,q as gt,r as ft,T as bt,m as ut}from"../chunks/bootstrap.js";import{a as C,r,o as i,b as y,w as b,f as s,t as c,c as d,d as _,e as u,g,u as N,m as M,q,i as v,n as I,T as F,O as yt,Q as vt,R as wt,U as Tt,F as j,h as P,V as Ct,W as x,B as V,p as H,j as Y,x as jt,X as Mt,K as St,Y as Dt,D as It,v as X}from"../chunks/vendor.js";import{D as At,S as tt,u as $t,a as Et,C as at,r as Ft,A as Ot}from"../chunks/agentRouter.js";import{d as Pt,c as Lt}from"../chunks/DataTableActions.js";import{T as Vt,a as ht,b as Nt,c as Ut}from"../chunks/TaskActionButtons.js";import{A as qt,T as Rt}from"../chunks/TicketsIndex.js";import{T as nt,a as Bt,b as xt,r as zt,A as Kt}from"../chunks/adminRouter.js";import"../chunks/FormGenerator.js";import"../chunks/AdminNavigationBar.js";import"../chunks/HelpSection.js";import"../chunks/LoginLogs.js";import"../chunks/BarcodeModal.js";import"../chunks/PermaLink.js";import"../chunks/Loader.js";import"../chunks/approvalTicketRules.js";const Ht={name:"detach-task-modal",description:"Detach Task Modal component",props:{showModal:{type:Boolean,default:!1},taskId:{type:[String,Number],default:""},ticketId:{type:[String,Number],default:""},onClose:{type:Function}},data(){return{isDisabled:!1,containerStyle:{width:"500px"},loading:!1}},methods:{onSubmit(){this.loading=!0,this.isDisabled=!0,C.delete("/tasks/api/detach-task?task_id="+this.taskId+"&ticket_id="+this.ticketId).then(t=>{R(t,"timeline"),window.emitter.emit("refreshData"),window.emitter.emit("closeTimelineActions"),window.emitter.emit("actionDone","external"),this.onClose(),this.loading=!1,this.isDisabled=!0}).catch(t=>{this.loading=!1,this.isDisabled=!1,S(t,"timeline")})}}},Yt={class:"modal-title"},Jt={key:0},Wt={key:1,class:"row"},Gt=["disabled"],Qt=s("i",{class:"fa fa-unlink"},null,-1);function Xt(t,e,a,l,n,o){const h=r("reuse-loader"),p=r("modal");return a.showModal?(i(),y(p,{key:0,showModal:a.showModal,onClose:a.onClose,containerStyle:n.containerStyle},{title:b(()=>[s("h4",Yt,c(t.lang("detach")),1)]),fields:b(()=>[n.loading?_("",!0):(i(),d("div",Jt,[s("span",null,c(t.lang("are_you_sure")),1)])),n.loading?(i(),d("div",Wt,[u(h,{"animation-duration":4e3,color:"#1d78ff",size:60})])):_("",!0)]),controls:b(()=>[s("button",{type:"button",id:"submit_btn",onClick:e[0]||(e[0]=f=>o.onSubmit()),class:"btn btn-danger",disabled:n.isDisabled},[Qt,g(" "+c(t.lang("detach")),1)],8,Gt)]),_:1},8,["showModal","onClose","containerStyle"])):_("",!0)}const Zt=w(Ht,[["render",Xt]]);const te={setup(){const t=N();return{formattedTime:M(()=>t.getters.formattedTime),formattedDate:M(()=>t.getters.formattedDate),getStoredTicketId:M(()=>t.getters.getStoredTicketId)}},props:["ticketProp","from"],data:()=>({columns:["task_name","task_start_date","task_end_date","users","teams"],options:{},apiUrl:"",hideData:"",ticketId:"",cardOpen:!1,taskId:"",showModal:!1,loading:!0}),watch:{getStoredTicketId(t,e){this.apiUrl="/tasks/api/get-all-tasks?associate_task=1&ticket_ids[0]="+t}},created(){window.emitter.on("refreshData",this.updateSideBar),window.emitter.on("showHideDiv",this.showCard)},beforeMount(){lt(this.$route.path)||this.columns.push("action"),this.ticketProp&&(this.apiUrl="/tasks/api/get-all-tasks?associate_task=1&ticket_ids[0]="+this.getStoredTicketId+"&isArchive="+lt(this.$route.path));const t=this;this.options={headings:{task_name:this.lang("name"),task_template:"Task Template",status:"Status",task_start_date:this.lang("start_date"),task_end_date:this.lang("due_date"),action:this.lang("actions"),assigned:this.lang("assignee(s)"),teams:this.lang("team(s)"),users:this.lang("agents(s)")},columnsClasses:{task_name:"task_view_columns",task_start_date:"task_view_columns",task_end_date:"task_view_columns",status:"task_view_columns",action:"task_view_columns",task_template:"task_view_columns",users:"task_view_columns",teams:"task_view_columns"},sortIcon:{base:"glyphicon",up:"glyphicon-chevron-up",down:"glyphicon-chevron-down"},texts:{filter:"",limit:""},templates:{task_start_date(e,a){return t.formattedTime(a.task_start_date)},task_end_date(e,a){return t.formattedTime(a.task_end_date)},task_name:(e,a)=>t.h(At,{data:a}),users:(e,a,l,n)=>t.h(tt,{data:a,index:l,column:n}),teams:(e,a,l,n)=>t.h(tt,{data:a,index:l,column:n}),action(e,a){let l=t.h("i",{class:"fa fa-unlink"});return t.h("a",{class:"btn btn-primary btn-sm",title:this.trans("detach"),href:"javascript:;",onClick:function(){t.onDetach(a.id)}},[l])}},sortable:["task_name","task_start_date","task_end_date"],filterable:["task_name"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(e){return{sort_field:e.orderBy?e.orderBy:"id",sort_order:e.ascending?"desc":"asc",search_term:e.query,page:e.page,limit:e.limit}},responseAdapter({data:e}){return{data:e.data.tasks.map(a=>(a.from="agent",a.view_url="/tasks/task/"+a.id,a.edit_url="/tasks/task/"+a.id+"/edit",a.delete_url=t.basePath()+"/tasks/task/"+a.id,a.alertComponentName="timeline",a.tableName="task",a)),count:e.data.total}}}},methods:{toggleCard(){this.cardOpen=!this.cardOpen,this.loading=!0},showCard(){this.cardOpen=!0},refreshTable(){window.emitter.emit("refreshData")},updateSideBar(){window.emitter.emit("updateAgentSidebar")},onDetach(t){this.taskId=t,this.showModal=!0},onClose(){this.showModal=!1},handelLoader(t){this.loading=t}},components:{"task-detach-modal":Zt}},ee={class:"card card-light"},se={class:"card-header pointer"},ae={class:"card-tools"},ne=s("i",{class:"fas fa-sync-alt"},null,-1),oe=[ne],ie={key:0,class:"card-body",id:"associated_tasks"};function le(t,e,a,l,n,o){const h=r("alert"),p=r("data-table"),f=r("task-detach-modal"),k=q("tooltip");return i(),d("div",null,[u(h,{componentName:"taskView"}),s("div",ee,[s("div",se,[s("h3",{class:"card-title w_80",onClick:e[0]||(e[0]=(...m)=>o.toggleCard&&o.toggleCard(...m))},c(t.lang("associated_tasks")),1),s("div",ae,[t.cardOpen?v((i(),d("a",{key:0,id:"associates_tab",class:I(["btn btn-tool",t.loading?"rotating":""]),"data-card-widget":"refresh",onClick:e[1]||(e[1]=(...m)=>o.refreshTable&&o.refreshTable(...m))},oe,2)),[[k,t.lang("refresh")]]):_("",!0),s("button",{type:"button",class:"btn btn-tool",onClick:e[2]||(e[2]=(...m)=>o.toggleCard&&o.toggleCard(...m))},[s("i",{class:I([{"fas fa-angle-up":t.cardOpen,"fas fa-angle-down":!t.cardOpen},"fs-25"])},null,2)])])]),t.cardOpen&&t.apiUrl?(i(),d("div",ie,[u(p,{url:t.apiUrl,dataColumns:t.columns,disableLoader:"true",onLoaderState:o.handelLoader,option:t.options,scroll_to:"problem-list"},null,8,["url","dataColumns","onLoaderState","option"])])):_("",!0)]),u(F,{name:"modal"},{default:b(()=>[t.showModal?(i(),y(f,{key:0,onClose:o.onClose,showModal:t.showModal,isArchive:t.disabled,ticketId:l.getStoredTicketId,taskId:t.taskId},null,8,["onClose","showModal","isArchive","ticketId","taskId"])):_("",!0)]),_:1})])}const de=w(te,[["render",le]]),re={props:{data:{type:[String,Object],default:""}},components:{TicketsTaskView:de},computed:{ticketNumber(){return JSON.parse(this.data)}}},ce={id:"associated-task-list"};function me(t,e,a,l,n,o){const h=r("TicketsTaskView");return i(),d("div",ce,[u(h,{ticketProp:o.ticketNumber},null,8,["ticketProp"])])}const ue=w(re,[["render",me]]);const he={name:"task-ticket-actions",description:"Contains ticket actions on timline page, specific to Task Plugin",setup(){const t=N();return{ticketActions:M(()=>t.getters.getTicketActions)}},props:{data:{type:[String,Object],required:!0}},data(){return{showModal:!1,showTemplateChooserModal:!1}},computed:{ticketId(){return JSON.parse(this.data).ticket_id},taskCount(){return JSON.parse(this.data).task_count}},methods:{updateTaskUi(){window.emitter.emit("showHidedData"),window.emitter.emit("showCalendarData")},onClose(){this.showModal=!1,this.$store.dispatch("unsetValidationError")},onTemplateChooserClose(){this.showTemplateChooserModal=!1,this.$store.dispatch("unsetValidationError")},reloadData(){window.emitter.emit("actionDone","external")}},components:{TaskActionButtons:Vt,"task-create-modal":ht,"task-template-modal":Nt}},pe={id:"task-ticket-actions"},_e={key:0,class:"btn-group"};function ke(t,e,a,l,n,o){const h=r("TaskActionButtons"),p=r("task-create-modal"),f=r("task-template-modal");return i(),d("div",pe,[l.ticketActions.has_calender?(i(),d("div",_e,[u(h,{data:a.data,"view-button-action":o.updateTaskUi},null,8,["data","view-button-action"])])):_("",!0),u(F,{name:"modal"},{default:b(()=>[n.showModal?(i(),y(p,{key:0,onClose:o.onClose,showModal:n.showModal,ticketId:o.ticketId,componentTitle:"timeline",reloadDetails:o.reloadData},null,8,["onClose","showModal","ticketId","reloadDetails"])):_("",!0)]),_:1}),u(F,{name:"modal"},{default:b(()=>[n.showTemplateChooserModal?(i(),y(f,{key:0,onClose:o.onTemplateChooserClose,showModal:n.showTemplateChooserModal,ticketId:o.ticketId,componentTitle:"timeline",reloadDetails:o.reloadData},null,8,["onClose","showModal","ticketId","reloadDetails"])):_("",!0)]),_:1})])}const ge=w(he,[["render",ke]]),fe={name:"Calendar",components:{FullCalendar:yt},props:{api:{type:String,required:!0},alertComponent:{type:String,required:!0}},beforeMount(){this.getEvents()},data(){return{loading:!1,calendarOptions:{plugins:[vt,wt,Tt],headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},buttonText:{prev:"Prev",next:"Next",today:"Today",month:"Month",week:"Week",day:"Day"},initialView:"dayGridMonth",editable:!0,selectable:!0,selectMirror:!0,dayMaxEvents:!0,weekends:!0,eventClick:this.handleEventClick,events:[]},currentEvents:[]}},watch:{api(t){this.rerender()}},methods:{rerender(){this.getEvents()},handleEventClick(t){const e=t.event;this.$router.push({path:`/tasks/task/${e.id}`})},async getEvents(){this.loading=!0;try{const{data:t}=await axios.get(this.api);this.calendarOptions.events=t.tasks,window.emitter.emit("update-nav-count-calendar-ui",t.count)}catch(t){S(t,this.alertComponent)}finally{this.loading=!1}}}},be={style:{width:"100%"}},ye={class:"row"},ve={class:"col-sm-12"},we={key:1};function Te(t,e,a,l,n,o){const h=r("FullCalendar"),p=r("reuse-loader");return i(),d("div",be,[s("div",ye,[s("div",ve,[n.loading?(i(),d("div",we,[u(p,{"animation-duration":4e3,size:60})])):(i(),y(h,{key:0,class:"demo-app-calendar",options:n.calendarOptions},null,8,["options"]))])])])}const Ce=w(fe,[["render",Te]]),je={props:{metaData:{type:Array,required:!0},appliedFilters:{type:Object,default:()=>{}}},data(){return{selectedFilters:this.appliedFilters,close_on_select:!this.multiple,isShowFilter:!1,componentMetaData:this.metaData,sections:[1,2,3],loading:!1,timeFilterOptions:[{id:"minute",value:"unit_minute"},{id:"hour",value:"unit_hour"},{id:"day",value:"unit_day"},{id:"month",value:"unit_month"}]}},methods:{onChange(t,e){this.$emit("updateMeta",t,e),this.selectedFilters[e]=t},onCancel(){this.$emit("selectedFilters","closeEvent")},onApply(){this.$emit("selectedFilters",this.selectedFilters)},onReset(){this.selectedFilters={},this.loading=!0,setTimeout(()=>{this.loading=!1},1e3),this.$emit("selectedFilters","resetEvent")}},components:{"dynamic-select":G,TimeRangeField:Pt,StaticSelect:mt}},Me={class:"card card-light"},Se={class:"card-header"},De={class:"card-title"},Ie={class:"card-body"},Ae={key:0,class:"row"},$e={key:1,class:"row"},Ee={class:"card-footer"},Fe={class:"single-btn"},Oe=s("span",{class:"fas fa-check"},null,-1),Pe={class:"single-btn"},Le=s("span",{class:"fas fa-undo"},null,-1),Ve={class:"single-btn"},Ne=s("span",{class:"fas fa-times"},null,-1);function Ue(t,e,a,l,n,o){const h=r("reuse-loader"),p=r("time-range-field"),f=r("static-select"),k=r("dynamic-select");return i(),d("div",Me,[s("div",Se,[s("h3",De,c(t.lang("filter")),1)]),s("div",Ie,[n.loading?(i(),d("div",Ae,[u(h,{"animation-duration":4e3,color:"#1d78ff",size:60})])):(i(),d("div",$e,[(i(!0),d(j,null,P(a.metaData,m=>(i(),d(j,null,[m.type==="date"?(i(),y(p,{label:m.label,value:m.value,type:"datetime",key:m.name,id:m.name,name:m.name,onChange:o.onChange,range:m.range,required:!1,format:"MMMM DD YYYY, h:mm a",classname:m.className,clearable:!1,disabled:!1,editable:!0,pickers:m.pickers,currentYearDate:!1,"time-picker-options":m.timeOptions,isDateSelector:!1,numberStyle:{width:"20%"},confirm:!0},null,8,["label","value","id","name","onChange","range","classname","pickers","time-picker-options"])):m.type==="static_select"?(i(),y(f,{key:1,id:m.name,name:m.name,classname:"col-sm-4",elements:m.elements,label:t.trans(m.label),value:m.value,onChange:o.onChange,strlength:"35",hideEmptySelect:!0},null,8,["id","name","elements","label","value","onChange"])):(i(),y(k,{key:2,id:m.name,name:m.name,apiEndpoint:m.url,classname:"col-sm-4",elements:m.elements,multiple:m.isMultiple,prePopulate:m.isPrepopulate,label:t.trans(m.label),value:m.value,onChange:o.onChange,strlength:"35"},null,8,["id","name","apiEndpoint","elements","multiple","prePopulate","label","value","onChange"]))],64))),256))]))]),s("div",Ee,[s("span",Fe,[s("button",{id:"apply-btn",class:"btn btn-primary round-btn",type:"button",onClick:e[0]||(e[0]=(...m)=>o.onApply&&o.onApply(...m))},[Oe,g("  "+c(t.lang("apply")),1)])]),s("span",Pe,[s("button",{id:"apply-btn",class:"btn btn-primary single-btn round-btn",type:"button",onClick:e[1]||(e[1]=(...m)=>o.onReset&&o.onReset(...m))},[Le,g("  "+c(t.lang("reset")),1)])]),s("span",Ve,[s("button",{id:"apply-btn",class:"btn btn-danger single-btn round-btn",type:"button",onClick:e[2]||(e[2]=(...m)=>o.onCancel&&o.onCancel(...m))},[Ne,g("  "+c(t.lang("cancel")),1)])])])])}const qe=w(je,[["render",Ue]]);const dt=[{name:"task_ids",url:"/tasks/api/list",label:"task"},{name:"ticket_ids",url:"api/dependency/tickets",label:"ticket"},{name:"projects",url:"/tasks/api/project/view",label:"project"},{name:"task_categories",url:"tasks/api/category/view",label:"task-plugin-category"},{name:"status",elements:[{name:"Open",id:"Open"},{name:"Closed",id:"Closed"},{name:"In-progress",id:"In-progress"}],label:"task-status-label"},{name:"created_at",type:"date",label:["created_at","created_within_last"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},pickers:!0,range:!0},{name:"due_at",type:"date",label:["due_at","task_due_within_next"],timeOptions:{start:"00:00",step:"00:30",end:"23:30"},pickers:!0,range:!0},{name:"is_private",elements:[{name:"No",id:0},{name:"Yes",id:1}],label:"task_private",type:"static_select"},{name:"created_by_array",url:"api/dependency/agents?meta=true",label:"created_by",isMultiple:!0,isPrepopulate:!1,value:""}],rt={name:"change_ids",url:"service-desk/api/dependency/changes",label:"change",isMultiple:!0,isPrepopulate:!1,value:""},Z={list:"calendar",calendar:"list"},Re={setup(){const t=N();return{formattedTime:M(()=>t.getters.formattedTime),formattedDate:M(()=>t.getters.formattedDate),getStoredTicketId:M(()=>t.getters.getStoredTicketId)}},data(){const t="assigned_to_agent[0]=",e="created_by_array[0]=",a="assigned_to_team_of_agent[0]=",l="only_public=1",n="tasks/api/tasks-calender",o="tasks/api/get-all-tasks";return{dataReady:!1,appliedFilters:{},columns:[],options:{},filterOptions:[],isShowFilter:!1,staticColumns:["actions"],hideData:"",ticketId:"",navs:{all_tasks:{count:0,url:{list:`${o}?${l}`,calendar:`${n}?${l}`}},task_assigned_to_me:{count:0,url:{list:`${o}?${t}`,calendar:`${n}?${t}`}},task_created_by_me:{count:0,url:{list:`${o}?${e}`,calendar:`${n}?${e}`}},task_assigned_to_my_team:{count:0,url:{list:`${o}?${a}`,calendar:`${n}?${a}`}}},selectedSection:"undefined",randomKey:Math.floor(Math.random()*1e6),showSdChange:!1,viewType:"list",params:"",columnData:null,taskData:null,visibleColumns:{},reportType:"tasks",newReportId:""}},computed:{category(){return location.search.substring(1).split("=")[location.search.substring(1).split("=").length-1]},apiUrl(){return`${this.navs[this.selectedSection].url[this.viewType]}${this.$attrs.auth.user_data.id}&${this.params}`},viewIcon(){return Z[this.viewType]},viewTooltip(){return this.trans(Z[this.viewType])}},created(){window.emitter.on("refreshData",this.updateSideBar),window.emitter.on("update-nav-count-calendar-ui",t=>{this.updateNavCount(t)}),window.emitter.on("dataCount",this.updateNavCount),window.emitter.on("onColumnUpdate",this.onColumnUpdate),window.emitter.on("updateFilter",this.updateFilter)},beforeMount(){this.getInitialTasksCount(),this.checkSdPlugin(),this.filterOptions=[...dt],this.getTasks(this.navs.all_tasks),this.filterData(),this.getTaskData()},methods:{toggleView(){this.viewType=Z[this.viewType]},updateFilter(t){this.filterOptions.map(function(e){e.section.map(function(a){t.name==a.name&&(a.value=t.value)})})},updateNavCount(t){this.navs[this.selectedSection].count=t},getTasks(t,e="all_tasks"){this.loading=!0,this.selectedSection=e,this.setAdditionalFilter(e),this.loading=!1},getInitialTasksCount(){C.get("tasks/api/get-task-count-for-logged-in-agent").then(t=>{let e=t.data;for(let a in e)this.navs[a].count=e[a]})},removeChangeColumn(){this.columns=this.columns.filter(t=>t!=="changes")},checkSdPlugin(){C.get("tasks/api/plugin-status/ServiceDesk").then(({data:t})=>{t?(this.showSdChange=!0,this.filterOptions.push(rt)):this.removeChangeColumn()}).catch(t=>this.removeChangeColumn())},setAdditionalFilter(t){this.showSdChange&&this.checkForExistenceAndPushFilter(rt,"change_ids")},checkForExistenceAndPushFilter(t,e){this.filterOptions.find(l=>l.name===e)||(this.filterOptions=[...dt],this.filterData(),this.filterOptions.push(JSON.parse(JSON.stringify(t))),this.setFilterValue())},updateSideBar(){window.emitter.emit("updateAgentSidebar")},filterData(){this.filterOptions.map(function(t){t.elements=t.elements?t.elements:[],t.isMultiple=!0,t.isPrepopulate=!1,t.value="",t.className="col-sm-4"})},setFilterValue(){this.filterOptions.map(t=>{t.value=this.appliedFilters.hasOwnProperty(t.name)?this.appliedFilters[t.name]:""})},updateMetaData(t,e){let a="";e=="projects"&&(t.forEach((l,n)=>{a+=`project_ids[${n}]=${l.id}&`}),this.filterOptions[3].url="tasks/api/category/view?"+a)},selectedFilters(t){return t==="closeEvent"?(this.updateMetaData([],"projects"),this.isShowFilter=!1):t==="resetEvent"?(this.updateMetaData([],"projects"),this.resetFilter()):this.applyFilter(t)},resetFilter(){this.apiUrl=this.navs[this.selectedSection].url+this.$attrs.auth.user_data.id,this.appliedFilters={},this.getTasks(this.navs[this.selectedSection],this.selectedSection),this.filterData()},applyFilter(t){this.appliedFilters=t;let e="",a={};for(const l of Object.keys(t)){let n=t[l];const o=this.filterOptions.findIndex(h=>h.name===l);o!==-1&&(this.filterOptions[o].value=n),Array.isArray(n)?n.forEach((h,p)=>{h.id?e+=`${l}[${p}]=${h.id}&`:a[l]=n}):n!==null&&n.id?e+=`${l}=${n.id}&`:n!==null&&(e+=`${l}=${n}&`)}for(const l in a)e+=`${l}=date::${a[l].map(n=>Ct(n).format("YYYY-MM-DD+HH:mm:ss")).join("~")}&`;e[e.length-1]==="&"&&(e=e.slice(0,-1)),this.params=e,this.isShowFilter=!1},toggleFilterView(){this.isShowFilter=!this.isShowFilter},getTaskData(){this.loading=!1,C.get("api/agent/report-config/task-report").then(t=>{this.taskData=t.data.data,this.newReportId=t.data.data.id,this.columnData=t.data.data.sub_reports,this.columnData.forEach(e=>{this.columns=e.columns}),this.columns.map(e=>{e.is_visible=!!e.is_visible}),this.updateVisibleColumns()}).catch(t=>{this.columns=[],S(t)})},onColumnUpdate(t){this.columns=t,this.updateVisibleColumns()},updateVisibleColumns(){this.visibleColumns={},this.columns.map(t=>{pt(t.is_visible)&&(this.visibleColumns[t.key]=t.label)})}},components:{"user-column-list":$t,"dynamic-datatable":Et,"task-filter":qe,calendar:Ce}},Be={class:"col-sm-12"},xe={class:"card card-light"},ze={class:"card-header"},Ke={class:"card-title"},He={class:"card-tools"},Ye=s("i",{class:"glyphicon glyphicon-plus"},null,-1),Je=s("i",{class:"glyphicon glyphicon-filter"},null,-1),We=[Je],Ge={class:"card-body",id:"my_tasks"},Qe={class:"mb-3"},Xe={class:"nav nav-tabs",role:"tablist"},Ze=["onClick"],ts={class:"badge badge-primary"},es={class:"tab-content"},ss={class:"mt-3"};function as(t,e,a,l,n,o){const h=r("alert"),p=r("router-link"),f=r("task-filter"),k=r("reuse-loader"),m=r("user-column-list"),T=r("dynamic-datatable"),A=r("calendar"),z=q("tooltip");return i(),d("div",Be,[u(h,{componentName:"dataTableModal"}),s("div",xe,[s("div",ze,[s("h3",Ke,c(t.lang("list_of_tasks")),1),s("div",He,[v((i(),y(p,{class:"btn-tool",to:"/tasks/task/create/"},{default:b(()=>[Ye]),_:1})),[[z,t.lang("add_tasks")]]),v((i(),d("a",{class:"btn-tool",onClick:e[0]||(e[0]=(...D)=>o.toggleFilterView&&o.toggleFilterView(...D)),href:"javascript:;"},We)),[[z,t.lang("filter")]]),v((i(),d("a",{class:"btn-tool",onClick:e[1]||(e[1]=(...D)=>o.toggleView&&o.toggleView(...D)),href:"javascript:;"},[s("i",{class:I(`fas fa-${o.viewIcon}`)},null,2)])),[[z,o.viewTooltip]])])]),s("div",Ge,[s("div",Qe,[n.isShowFilter?(i(),y(f,{id:"filter-box",metaData:n.filterOptions,onUpdateMeta:o.updateMetaData,onSelectedFilters:o.selectedFilters,appliedFilters:n.appliedFilters,key:n.randomKey},null,8,["metaData","onUpdateMeta","onSelectedFilters","appliedFilters"])):_("",!0)]),t.loading?_("",!0):(i(),d(j,{key:0},[s("ul",Xe,[(i(!0),d(j,null,P(n.navs,(D,B)=>(i(),d("li",{class:"nav-item",key:B},[s("a",{class:I(["nav-link",{active:n.selectedSection===B}]),"data-toggle":"pill",role:"tab",href:"javascript:;",onClick:it=>o.getTasks(D,B),id:"tickets_tab"},[g(c(t.trans(B))+" ",1),s("span",ts,c(D.count),1)],10,Ze)]))),128))]),s("div",es,[s("div",ss,[t.loading?(i(),y(k,{key:0,"animation-duration":4e3,size:60})):(i(),d(j,{key:1},[n.viewType==="list"?(i(!0),d(j,{key:0},P(n.columnData,D=>(i(),d("section",{key:D},[u(m,{"table-columns":D.columns,reportId:D.id,columnId:n.newReportId},null,8,["table-columns","reportId","columnId"]),n.columns.length?(i(),y(T,{key:0,"data-url":o.apiUrl,columns:n.visibleColumns,columnsMeta:D.columns,staticColumns:n.staticColumns,"report-type":n.reportType,showNameWithStatus:!0},null,8,["data-url","columns","columnsMeta","staticColumns","report-type"])):_("",!0)]))),128)):(i(),y(A,{key:1,"alert-component":"task-view",api:o.apiUrl},null,8,["api"]))],64))])])],64))])])])}const ns=w(Re,[["render",as]]),os={props:{editPage:{type:Boolean,default:!1},taskId:{type:String,default:""}},data(){return{id:this.taskId,showChangeSelectionInput:!1}},beforeMount(){this.editPage&&(this.id=K(window.location.pathname)),C.get("tasks/api/plugin-status/ServiceDesk").then(({data:t})=>{t&&(this.showChangeSelectionInput=!0)}).catch(t=>{})},components:{TaskCreate:Ut}},is={class:"col-sm-12"},ls={key:0,class:"card-tools"},ds=s("i",{class:"fas fa-eye"},null,-1);function rs(t,e,a,l,n,o){const h=r("alert"),p=r("router-link"),f=r("TaskCreate"),k=r("faveo-box"),m=q("tooltip");return i(),d("div",is,[u(h,{componentName:"taskCreate"}),u(k,{title:a.editPage?t.lang("task_edit"):t.lang("task_create")},{customActions:b(()=>[a.editPage?(i(),d("div",ls,[v((i(),y(p,{class:"btn-tool",to:"/tasks/task/"+n.id},{default:b(()=>[ds]),_:1},8,["to"])),[[m,t.lang("view")]])])):_("",!0)]),default:b(()=>[u(f,{"show-change-selection-input":n.showChangeSelectionInput},null,8,["show-change-selection-input"])]),_:1},8,["title"])])}const W=w(os,[["render",rs]]);const cs={name:"AssociatedChanges",components:{DetachModal:at},props:{taskId:{required:!0,type:[String,Number]},disableLoader:{type:Boolean,default:!1}},data(){return{columns:["change_number","subject","requester","status","priority","department","action"],showModal:!1,staticOptions:{texts:{filter:"",limit:""},columnsClasses:{change_number:"changes-number",subject:"changes-subject",action:"changes-action"},sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},sortable:["subject","created_at"],filterable:["subject","created_at"],pagination:{chunk:5,nav:"fixed",edge:!0}},options:{},changeId:"",apiUrl:"",totalCount:""}},beforeMount(){this.apiUrl=`/tasks/api/attached-change?task_id=${this.taskId}`;const t=this,e={templates:{department(a,l){return l.department?t.h("a",{href:t.basePath()+"/department/"+l.department.id,target:"_blank"},l.department.name):"--"},requester(a,l){if(!l.requester)return"--";const n=l.requester.name||l.requester.email;return t.h(x,{to:`/user/${l.id}`},n)},priority(a,l){return l.priority?l.priority.name:"--"},status(a,l){return l.status?l.status.name:"--"},subject(a,l){return t.h(x,{to:"/service-desk/changes/"+l.id+"/show"},l.subject)},change_number(a,l){return t.h(x,{to:"/service-desk/changes/"+l.id+"/show"},l.identifier)},action(a,l){let n=t.h("i",{class:"fa fa-unlink"});return t.h("a",{class:"btn btn-primary",title:this.trans("detach"),href:"javascript:;",onClick:()=>{t.onDetach(l.id)}},[n])}},requestAdapter(a){return{"sort-field":a.orderBy?a.orderBy:"id","sort-order":a.ascending?"desc":"asc",search_query:a.query.trim(),page:a.page,limit:a.limit}},responseAdapter({data:a}){return t.totalCount=a.data.total,{data:a.data.data,count:t.totalCount}}};this.options={...this.staticOptions,...e,headings:{change_number:this.lang("change_number"),subject:this.lang("subject"),requester:this.lang("requester"),status:this.lang("status"),priority:this.lang("priority"),department:this.lang("department"),action:this.lang("action")}}},computed:{detachParams(){return{task_id:this.taskId,change_id:this.changeId}},detachUrl(){return"tasks/api/detach-change"}},methods:{onDetach(t){this.changeId=t,this.showModal=!0},onClose(){this.showModal=!1},handelLoader(t){this.$emit("loaderValue",t)}},watch:{totalCount(t){t===0&&(window.emitter.emit("updateTaskTable"),window.emitter.emit("updateTaskActions"))}}},ms={id:"task-associated-changes"};function us(t,e,a,l,n,o){const h=r("alert"),p=r("data-table"),f=r("detach-modal");return i(),d("div",ms,[u(h,{componentName:"TaskAssociatedChange"}),u(p,{url:n.apiUrl,dataColumns:n.columns,option:n.options,scroll_to:"task-associated-changes",componentTitle:"TaskAssociatedChange",onLoaderState:o.handelLoader,disableLoader:a.disableLoader},null,8,["url","dataColumns","option","onLoaderState","disableLoader"]),s("div",null,[u(F,{name:"modal"},{default:b(()=>[u(f,{"detach-url":o.detachUrl,"detach-params":o.detachParams,"alert-component-name":"tasks-associates-view","show-modal":n.showModal,"on-close":o.onClose,"detach-type":"task_change"},null,8,["detach-url","detach-params","show-modal","on-close"])]),_:1})])])}const hs=w(cs,[["render",us],["__scopeId","data-v-982450a8"]]);const ps={name:"AssociatedTickets",components:{DetachModal:at},props:{taskId:{required:!0,type:[String,Number]},disableLoader:{type:Boolean,default:!1}},data(){return{apiEndPoint:`tasks/api/attached-ticket?task_id=${this.taskId}`,columns:["ticket_number","subject","assignedTo","action"],options:{},ticketId:"",showModal:!1,totalCount:""}},computed:{detachParams(){return{task_id:this.taskId,ticket_id:this.ticketId}},detachUrl(){return"tasks/api/detach-ticket"}},beforeMount(){const t=this;this.options={sortIcon:{base:"glyphicon",up:"glyphicon-chevron-down",down:"glyphicon-chevron-up"},headings:{ticket_number:t.lang("ticket_number"),subject:t.lang("subject"),assignedTo:t.lang("assigned_to"),action:t.lang("action")},columnsClasses:{ticket_number:"associate-number",subject:"associate-subject",assignedTo:"associate-assigned",action:"associate-action"},texts:{filter:"",limit:""},templates:{subject:function(e,a){return t.h(x,{to:"/thread/"+a.id},a.subject)},ticket_number:function(e,a){return t.h(x,{to:"/thread/"+a.id},"#"+a.ticket_number)},assignedTo:function(e,a){return a.assignedTo?t.h(x,{to:"/user/"+a.assignedTo.id},a.assignedTo.full_name):a.assignedTeam?t.h("a",{href:t.basePath()+"/assign-teams/"+a.assignedTeam.id},a.assignedTeam.name):"--"},action(e,a){let l=t.h("i",{class:"fa fa-unlink"});return t.h("a",{href:"javascript:;",class:"btn btn-primary",title:this.trans("detach"),onClick:function(){t.onDetach(a.id)}},[l])}},sortable:["ticket_number"],filterable:["ticket_number"],pagination:{chunk:5,nav:"scroll"},requestAdapter(e){return{"sort-field":e.orderBy?e.orderBy:"id","sort-order":e.ascending?"desc":"asc",search_query:e.query.trim(),page:e.page,limit:e.limit}},responseAdapter({data:e}){return t.totalCount=e.total,{data:e.tickets,count:t.totalCount}}}},methods:{onDetach(t){this.ticketId=t,this.showModal=!0},onClose(){this.showModal=!1},handelLoader(t){this.$emit("loaderValue",t)}},watch:{totalCount(t){t===0&&(window.emitter.emit("updateTaskTable"),window.emitter.emit("updateTaskActions"))}}},_s={class:"task_ticket_associations"};function ks(t,e,a,l,n,o){const h=r("alert"),p=r("data-table"),f=r("detach-modal");return i(),d("div",_s,[u(h,{componentName:"TaskAssociatedTicket"}),u(p,{url:n.apiEndPoint,dataColumns:n.columns,option:n.options,scroll_to:"task_ticket_associations",componentTitle:"TaskAssociatedTicket",onLoaderState:o.handelLoader,disableLoader:a.disableLoader},null,8,["url","dataColumns","option","onLoaderState","disableLoader"]),s("div",null,[u(F,{name:"modal"},{default:b(()=>[u(f,{"detach-url":o.detachUrl,"detach-params":o.detachParams,"alert-component-name":"tasks-associates-view","show-modal":n.showModal,"on-close":o.onClose,"detach-type":"task_ticket"},null,8,["detach-url","detach-params","show-modal","on-close"])]),_:1})])])}const gs=w(ps,[["render",ks]]);const fs={name:"TaskCommentModal",components:{AddMedia:qt},props:{showModal:{type:Boolean,default:!1},onClose:{type:Function},alertComponentName:{type:String,required:!0},modalTitle:{type:String,default:"task_add_comment"},taskId:{type:[String,Number],required:!0},parentComment:{type:[String,Number],required:!1},commentText:{type:String,default:""},commentForEdit:{type:[String,Number],default:""},attachmentsForEdit:{type:Array,default:()=>[]}},data(){return{containerStyle:{width:"700px"},loading:!1,attachments:[...this.attachmentsForEdit],inline:[],comment:this.commentText}},computed:{isDisabled(){return!this.comment}},methods:{async onSubmit(){this.loading=!0;let t="tasks/api/add-comment-to-task",e="POST",a={task_id:this.taskId,comment:this.comment,parent_id:this.parentComment||null,attachments:this.attachments};this.commentForEdit&&(t="tasks/api/update-comment",e="PUT",a.comment_id=this.commentForEdit);try{let l=await C.request({method:e,url:t,data:a});this.$store.dispatch("unsetValidationError"),R(l,this.alertComponentName),this.onClose(),window.emitter.emit("updateTaskDiscussion")}catch(l){S(l,this.alertComponentName)}finally{this.loading=!1}},getAttachments(t){this.attachments=t},onChange(t,e){this[e]=t}}},bs={class:"modal-title"},ys={key:0},vs={key:1,class:"row"},ws=s("i",{class:"fas fa-sync"},null,-1);function Ts(t,e,a,l,n,o){const h=r("add-media"),p=r("reuse-loader"),f=r("modal");return a.showModal?(i(),y(f,{key:0,showModal:a.showModal,onClose:a.onClose,modalBodyClass:"modal__dimensions"},{title:b(()=>[s("h4",bs,c(t.trans(a.modalTitle)),1)]),fields:b(()=>[n.loading?_("",!0):(i(),d("div",ys,[u(h,{attachments:n.attachments,inlineFile:n.inline,description:n.comment,classname:"col-sm-12",name:"comment",onAttach:o.getAttachments,onInput:o.onChange,page_name:"task_comment","label-name":"task_comment",id:"focus_editor",style:{width:"97%"}},null,8,["attachments","inlineFile","description","onAttach","onInput"])])),n.loading?(i(),d("div",vs,[u(p,{"animation-duration":4e3,color:"#1d78ff",size:60})])):_("",!0)]),controls:b(()=>[s("button",{type:"button",id:"submit_btn",onClick:e[0]||(e[0]=k=>o.onSubmit()),class:"btn btn-primary"},[ws,g("  "+c(t.trans("update")),1)])]),_:1},8,["showModal","onClose"])):_("",!0)}const Cs=w(fs,[["render",Ts]]);const js={name:"TaskCommentThreads",description:"Task Comment Threads Component",setup(){const t=N();return{formattedDate:M(()=>t.getters.formattedDate)}},props:{taskId:{type:[String,Number],required:!0},maximized:{type:Boolean,default:!1}},components:{ThreadBody:Rt,TaskCommentModal:Cs,DetachModal:at},data(){return{inboxThreads:[],page:1,showLoader:!1,showModal:!1,parentComment:"",commentText:"",modalKey:Math.floor(Math.random()*1e6),loading:!1,commentForEdit:"",showDeleteModal:!1,attachments:[],refreshDiscussion:!1,showDiscussion:!1}},computed:{detachParams(){return{task_id:this.taskId,comment_id:this.commentForEdit}}},beforeMount(){this.getThreads()},created(){window.emitter.on("updateTaskDiscussion",()=>this.refreshDiscussion=!0),window.emitter.on("updateTimelineThreads",this.updateLogs),window.emitter.on("threadReply",t=>{this.modalKey++,this.parentComment=t.id,this.commentText=t.content,this.showModal=!0}),window.emitter.on("threadEdit",t=>{this.modalKey++,this.parentComment="",this.commentText=t.originalText,this.commentForEdit=t.id,this.attachments=t.attach,this.showModal=!0}),window.emitter.on("threadDelete",t=>{this.commentForEdit=t.id,this.showDeleteModal=!0})},watch:{showLoader(t,e){return this.showLoader=t,this.$emit("loaderValue",t),t},loading(t){this.$emit("loaderValue",t)},refreshDiscussion(t){t===!0&&this.updateLogs(),this.refreshDiscussion=!1}},methods:{updateLogs(){this.showLoader=!0,this.inboxThreads=[],this.page=1,this.getThreads(void 0,!0)},async getThreads(t,e=!1){this.page===1?this.loading=!0:this.showLoader=!0;try{let{data:a}=await C.get(`tasks/api/get-comments?task_id=${this.taskId}`,{params:{page:this.page}});a.data.length&&this.inboxThreads.push(...a.data),t&&t.loaded(),a.data.length<10&&t&&t.complete(),this.page++,this.showDiscussion=!0,this.inboxThreads.length===0&&(this.showDiscussion=!1)}catch(a){S(a,"task-comment-threads"),this.inboxThreads=[]}finally{this.showLoader=!1,this.loading=!1}},showAddCommentModal(){this.parentComment="",this.commentText="",this.commentForEdit="",this.modalKey++,this.showModal=!0},checkDate(t){if(t==0)return!0;var e=this.formattedDate(this.inboxThreads[t-1].created_at),a=this.formattedDate(this.inboxThreads[t].created_at);if(e!=a)return!0},showThreadEnd(t){return t===this.inboxThreads.length-1},onClose(){this.showModal=!1,this.commentForEdit=""}}},J=t=>(H("data-v-1f77aafe"),t=t(),Y(),t),Ms={id:"task_discussions"},Ss={class:"row mb-3"},Ds={class:"col-sm-2",style:{display:"flex","flex-direction":"row"}},Is=J(()=>s("i",{class:"glyphicon glyphicon-plus"},null,-1)),As=J(()=>s("div",{class:"col-sm-10"},null,-1)),$s={class:"card"},Es={class:"card-body"},Fs={key:0,class:"timeline timeline-inverse"},Os={key:0,class:"time-label"},Ps={class:"bg-default border"},Ls={key:1},Vs=J(()=>s("i",{class:"fas fa-history bg-gray"},null,-1)),Ns=[Vs],Us=J(()=>s("span",null,null,-1)),qs=J(()=>s("span",null,null,-1)),Rs={key:1,style:{display:"flex","align-items":"center","justify-content":"center","flex-direction":"column"}},Bs={class:"text-center text-muted"};function xs(t,e,a,l,n,o){const h=r("alert"),p=r("task-comment-modal"),f=r("detach-modal"),k=r("thread-body"),m=r("infinite-loading");return i(),d("div",null,[u(h,{componentName:"task-comment-threads"}),s("div",Ms,[s("div",Ss,[s("div",Ds,[s("button",{class:"btn btn-default",onClick:e[0]||(e[0]=V((...T)=>o.showAddCommentModal&&o.showAddCommentModal(...T),["prevent"]))},[Is,g(" "+c(t.trans("task_add_comment")),1)])]),As,u(F,{name:"modal"},{default:b(()=>[(i(),y(p,{"task-id":a.taskId,"alert-component-name":"task-comment-threads","comment-text":n.commentText,"on-close":o.onClose,"show-modal":n.showModal,"parent-comment":n.parentComment,key:n.modalKey,"comment-for-edit":n.commentForEdit,"attachments-for-edit":n.attachments},null,8,["task-id","comment-text","on-close","show-modal","parent-comment","comment-for-edit","attachments-for-edit"]))]),_:1}),u(F,{name:"modal"},{default:b(()=>[u(f,{"detach-url":"tasks/api/delete-comment","detach-params":o.detachParams,"alert-component-name":"task-comment-threads","show-modal":n.showDeleteModal,"on-close":()=>this.showDeleteModal=!1,"event-to-fire-after-success":"updateTaskDiscussion","detach-type":"task_comment","detach-icon-class":"fas fa-trash","detach-action":"delete"},null,8,["detach-params","show-modal","on-close"])]),_:1})]),s("div",$s,[s("div",Es,[s("div",{class:I({"scrollable-thread":!a.maximized}),id:"thread_scroll"},[n.showDiscussion?(i(),d("div",Fs,[(i(!0),d(j,null,P(n.inboxThreads,(T,A)=>(i(),d(j,{key:"thread"+A},[o.checkDate(A)?(i(),d("div",Os,[s("span",Ps,c(l.formattedDate(T.created_at)),1)])):_("",!0),u(k,{thread:T,index:A,max:a.maximized},null,8,["thread","index","max"]),o.showThreadEnd(A)?(i(),d("div",Ls,Ns)):_("",!0)],64))),128)),u(m,{onInfinite:o.getThreads,ref:"infiniteLoading"},{spinner:b(()=>[Us]),complete:b(()=>[qs]),_:1},8,["onInfinite"])])):(i(),d("div",Rs,[s("h2",Bs,c(t.trans("task-no-discussions")),1),s("button",{class:"btn btn-default mt-3",onClick:e[1]||(e[1]=V((...T)=>o.showAddCommentModal&&o.showAddCommentModal(...T),["prevent"]))},c(t.trans("task-start-discussion")),1)]))],2)])])])])}const zs=w(js,[["render",xs],["__scopeId","data-v-1f77aafe"]]);const Ks={name:"task-activity",description:"Problem activity page",setup(){const t=N();return{formattedTime:M(()=>t.getters.formattedTime),formattedDate:M(()=>t.getters.formattedDate)}},props:{taskId:{type:[String,Number],default:""}},data(){return{loading:!0,apiUrl:"/tasks/api/activity/"+this.taskId,activity_log:[],perPage:"10",total:0,maxSize:5,pagination:1,paramsObj:{},filtering:!1,sort_key:"",refreshActivity:!1}},beforeMount(){this.paramsObj.page=this.pagination,this.paramsObj.sort_field="created_at",this.paramsObj.sort_order="asc",this.sort_key="asc",this.getValues(this.paramsObj)},created(){window.emitter.on("updateTaskActivity",()=>this.refreshActivity=!0)},watch:{pagination(t,e){this.filtering=!0;var a=document.getElementById("activity_log_div");return a.scrollIntoView({behavior:"smooth"}),this.paramsObj.page=t,this.getValues(this.paramsObj),t},loading(t){this.$emit("loaderValue",t)},filtering(t){this.$emit("loaderValue",t)},refreshActivity(t){t===!0&&this.getUpdateActivity(),this.refreshActivity=!1}},computed:{PerPage:function(){return this.perPage?parseInt(this.perPage):10},Records:function(){return this.total?parseInt(this.total):0}},methods:{commonFilter(){this.filtering=!0,this.pagination=1,this.paramsObj.page=1,this.getValues(this.paramsObj)},logLimit(t){this.paramsObj.limit=t,this.commonFilter()},orderBy(t){this.sort_key=t,this.paramsObj.sort_order=t,this.commonFilter()},getUpdateActivity(){this.pagination=1,this.sort_key="desc",this.perPage=10,this.total=0,this.paramsObj.page=1,this.paramsObj.limit=10,this.paramsObj.sort_order="desc",this.paramsObj.sor_field="created_at",this.getValues(this.paramsObj)},getValues(t){C.get(this.apiUrl,{params:t}).then(e=>{this.loading=!1,this.filtering=!1;let a=e.data.data.data;a=a.filter(l=>!!l.message),this.activity_log=a,this.total=e.data.data.total,this.perPage=e.data.data.per_page}).catch(e=>{this.loading=!1,this.filtering=!1})},checkDate(t){if(t==0)return!0;var e=this.formattedDate(this.activity_log[t-1].created_at),a=this.formattedDate(this.activity_log[t].created_at);if(e!=a)return!0},showThreadEnd(t){return t===this.activity_log.length-1}},components:{"activity-parser":_t}},L=t=>(H("data-v-b939c522"),t=t(),Y(),t),Hs={class:"row",id:"activity_log_div"},Ys={class:"col-sm-12 mb-2"},Js={key:0,id:"select_limit"},Ws=L(()=>s("option",{value:"10"},"10",-1)),Gs=L(()=>s("option",{value:"25"},"25",-1)),Qs=L(()=>s("option",{value:"50"},"50",-1)),Xs=L(()=>s("option",{value:"100"},"100",-1)),Zs=[Ws,Gs,Qs,Xs],ta={key:1,id:"choose_order"},ea={id:"sort_btn",type:"button","data-toggle":"dropdown",class:"btn btn-default dropdown-toggle"},sa={class:"dropdown-menu",style:{"z-index":"9999"}},aa=L(()=>s("i",{class:"fas fa-sort-amount-up"},null,-1)),na=L(()=>s("i",{class:"fas fa-sort-amount-down"},null,-1)),oa={key:2,id:"page_div"},ia={class:"col-md-12"},la={key:0,class:"timeline"},da={key:0,class:"time-label"},ra={class:"bg-default border"},ca={class:"task-activity-timline"},ma=L(()=>s("i",{class:"far fa-dot-circle"},null,-1)),ua={class:"timeline-item"},ha={class:"time"},pa=L(()=>s("i",{class:"far fa-clock"},null,-1)),_a={key:0,class:"timeline-header"},ka={class:"timeline-body break"},ga={key:1},fa=L(()=>s("i",{class:"far fa-clock bg-gray"},null,-1)),ba=[fa],ya={key:1,class:"float-right",id:"page_div"},va={key:0,class:"col-sm-12"},wa={class:"text-center"};function Ta(t,e,a,l,n,o){const h=r("uib-pagination"),p=r("faveo-image-element"),f=r("router-link"),k=r("activity-parser");return i(),d("div",Hs,[s("div",Ys,[!n.loading&&n.activity_log.length>0?(i(),d("div",Js,[v(s("select",{class:"form-control cursor-pointer","onUpdate:modelValue":e[0]||(e[0]=m=>n.perPage=m),onChange:e[1]||(e[1]=m=>o.logLimit(n.perPage))},Zs,544),[[jt,n.perPage]])])):_("",!0),!n.loading&&n.activity_log.length>0?(i(),d("div",ta,[s("button",ea,c(t.lang("created_time"))+" - "+c(t.lang(n.sort_key)),1),s("div",sa,[s("a",{href:"javascript:;",class:"dropdown-item",onClick:e[2]||(e[2]=m=>o.orderBy("asc"))},[aa,g(" "+c(t.lang("asc")),1)]),s("a",{href:"javascript:;",onClick:e[3]||(e[3]=m=>o.orderBy("desc")),class:"dropdown-item"},[na,g(" "+c(t.lang("desc")),1)])])])):_("",!0),!n.loading&&n.total>10?(i(),d("div",oa,[u(h,{id:"page2",records:o.Records,modelValue:n.pagination,"onUpdate:modelValue":e[4]||(e[4]=m=>n.pagination=m),class:"pagination","boundary-links":!1,"per-page":o.PerPage,options:{chunk:n.maxSize,chunksNavigation:"scroll"}},null,8,["records","modelValue","per-page","options"])])):_("",!0)]),s("div",ia,[!n.loading&&n.activity_log.length>0?(i(),d("div",la,[(i(!0),d(j,null,P(n.activity_log,(m,T)=>(i(),d(j,null,[o.checkDate(T)?(i(),d("div",da,[s("span",ra,c(l.formattedDate(m.created_at)),1)])):_("",!0),s("div",ca,[ma,s("div",ua,[s("span",ha,[pa,g(" "+c(l.formattedTime(m.created_at)),1)]),m.creator?(i(),d("h3",_a,[u(p,{id:"problem_img","source-url":m.creator.profile_pic,classes:["img-circle","img-bordered-sm"],"alternative-text":"User Image","img-width":25,"img-height":25},null,8,["source-url"]),u(f,{to:"/user/"+m.creator.id},{default:b(()=>[g(" "+c(m.creator.full_name),1)]),_:2},1032,["to"])])):_("",!0),s("div",ka,[m.message?(i(),y(k,{key:0,data:m.message},null,8,["data"])):_("",!0)])])]),o.showThreadEnd(T)?(i(),d("div",ga,ba)):_("",!0)],64))),256))])):_("",!0),!n.loading&&n.total>10?(i(),d("div",ya,[u(h,{id:"page2",records:o.Records,modelValue:n.pagination,"onUpdate:modelValue":e[5]||(e[5]=m=>n.pagination=m),class:"pagination","boundary-links":!1,"per-page":o.PerPage,options:{chunk:n.maxSize,chunksNavigation:"scroll"}},null,8,["records","modelValue","per-page","options"])])):_("",!0)]),!n.filtering&&!n.loading&&n.activity_log.length===0?(i(),d("div",va,[s("h6",wa,c(t.lang("no_data_found")),1)])):_("",!0)])}const Ca=w(Ks,[["render",Ta],["__scopeId","data-v-b939c522"]]);const ja={name:"TaskAssociates",description:"Task associates page",props:{taskId:{type:[String,Number],default:""}},created(){window.emitter.on("updateTaskActions",()=>this.refreshAction=!0),window.emitter.on("updateTaskTable",()=>this.associates("activity")),this.$store.dispatch("setTaskAssociateCategory",this.category)},data(){return{category:"discussions",loading:!0,showAssociatedTickets:!1,showAssociatedChanges:!1,dynamicKeys:{discussions:1,activity:1,associated_tickets:1,associated_changes:1},refreshAction:!1}},beforeMount(){this.getAction()},computed:{tabs(){return[{id:"discussions",title:"task-plugin-discussions",show:!0},{id:"activity",title:"task-plugin-activity-log",show:!0},{id:"associated_tickets",title:"task-associated-tickets",show:this.showAssociatedTickets},{id:"associated_changes",title:"task-associated-changes",show:this.showAssociatedChanges}]}},methods:{associates(t){this.category!==t&&(this.category=t,this.loading=!0),this.updateKey(t)},getAction(){C.get(`tasks/api/get-associates/${this.taskId}`).then(t=>{this.showAssociatedTickets=t.data.associated_tickets,this.showAssociatedChanges=t.data.associated_changes}).catch(t=>{console.log(t)})},handelLoader(t){this.loading=t},updateKey(t){this.dynamicKeys={...this.dynamicKeys,[t]:this.dynamicKeys[t]+1}}},watch:{category(t,e){t!==e&&this.$store.dispatch("setTaskAssociateCategory",t)},refreshAction(t){t===!0&&this.getAction(),this.refreshAction=!1}},components:{"task-activity":Ca,AssociatedChanges:hs,AssociatedTickets:gs,TaskCommentThreads:zs}},Ma=t=>(H("data-v-aae4f43f"),t=t(),Y(),t),Sa={key:0,id:"task-associates",class:"card card-light card-tabs"},Da={class:"card-header p-0 pt-1"},Ia={class:"nav nav-tabs"},Aa={key:0,class:"nav-item"},$a=["onClick"],Ea={class:"nav-item ml-auto mt-04"},Fa={key:0,type:"button",class:"btn btn-tool rotating","data-card-widget":"refresh"},Oa=Ma(()=>s("i",{class:"fas fa-refresh"},null,-1)),Pa=[Oa],La={class:"card-body"},Va={class:"tab-content"},Na={class:"active tab-pane",id:"activity"};function Ua(t,e,a,l,n,o){const h=r("alert"),p=r("task-activity"),f=r("associated-changes"),k=r("associated-tickets"),m=r("task-comment-threads");return o.tabs?(i(),d("div",Sa,[u(h,{componentName:"taskAssociates"}),s("div",Da,[s("ul",Ia,[(i(!0),d(j,null,P(o.tabs,T=>(i(),d(j,null,[T.show?(i(),d("li",Aa,[s("a",{id:"task_tab",class:I(["nav-link",{active:n.category===T.id}]),"data-toggle":"pill",onClick:A=>o.associates(T.id)},c(t.trans(T.title)),11,$a)])):_("",!0)],64))),256)),s("li",Ea,[n.loading?(i(),d("a",Fa,Pa)):_("",!0)])])]),s("div",La,[s("div",Va,[s("div",Na,[s("div",null,[n.category==="activity"?(i(),y(p,{taskId:a.taskId,key:"task_activity"+n.dynamicKeys.activity,onLoaderValue:o.handelLoader},null,8,["taskId","onLoaderValue"])):_("",!0),n.category==="associated_changes"?(i(),y(f,{"task-id":a.taskId,disableLoader:"true",key:"task_change"+n.dynamicKeys.associated_changes,onLoaderValue:o.handelLoader},null,8,["task-id","onLoaderValue"])):_("",!0),n.category==="associated_tickets"?(i(),y(k,{"task-id":a.taskId,disableLoader:"true",key:"task_ticket"+n.dynamicKeys.associated_tickets,onLoaderValue:o.handelLoader},null,8,["task-id","onLoaderValue"])):_("",!0),n.category==="discussions"?(i(),y(m,{"task-id":a.taskId,key:"task_discussions"+n.dynamicKeys.discussions,onLoaderValue:o.handelLoader},null,8,["task-id","onLoaderValue"])):_("",!0)])])])])])):_("",!0)}const qa=w(ja,[["render",Ua],["__scopeId","data-v-aae4f43f"]]),Ra={name:"task-reassign-modal",description:"Task Reassign Modal",props:{showModal:{type:Boolean,default:!1},taskId:{type:Number,default:!1},agents:{type:Array,default:()=>[]}},data(){return{loading:!1,isDisabled:!0,users:this.agents,userIds:[],previousAgents:[],showValidationMessage:!1}},beforeMount(){this.agents.length&&(this.userIds=this.agents.map(t=>t.id),this.previousAgents=this.userIds)},methods:{onChange(t,e){this.userIds=t.length?t.map(a=>a.id):[],this.isDisabled=!t.length||Mt.isEqual(this.userIds.sort(),this.previousAgents.sort())},onClose(){window.emitter.emit("taskReassignmentClose")},callApiEndpoint(){C.post("/tasks/api/re-assign/"+this.taskId,{assigned_agents:this.userIds}).then(t=>{window.emitter.emit("taskReassignment","reassigned"),R(t,"tasks-view"),window.emitter.emit("updateTaskActivity"),window.emitter.emit("updateTaskAssociates"),this.onClose()}).catch(t=>{S(t,"tasks-view")})}},components:{modal:kt,"dynamic-select":G}},Ba={class:"modal-title"},xa=["disabled"],za=s("i",{"aria-hidden":"true"},null,-1);function Ka(t,e,a,l,n,o){const h=r("dynamic-select"),p=r("alert"),f=r("modal");return a.showModal?(i(),y(f,{key:0,showModal:a.showModal,onClose:o.onClose,containerStyle:{width:"800px"}},{title:b(()=>[s("h4",Ba,c(t.trans("reassign_task")),1)]),fields:b(()=>[u(h,{label:t.trans("agents"),multiple:!0,name:"users",value:this.users,apiEndpoint:"/api/dependency/agents",onChange:o.onChange,clearable:!0},null,8,["label","value","onChange"])]),alert:b(()=>[u(p,{componentName:"task-reassign-modal"})]),controls:b(()=>[s("button",{type:"button",onClick:e[0]||(e[0]=(...k)=>o.callApiEndpoint&&o.callApiEndpoint(...k)),class:I("btn btn-primary"),disabled:n.isDisabled},[za,g(" "+c(t.trans("update")),1)],8,xa)]),_:1},8,["showModal","onClose"])):_("",!0)}const Ha=w(Ra,[["render",Ka]]);const Ya={props:{task:{type:Object,default:()=>{}},notEdit:{type:Boolean,default:!1},updateTask:{type:Function,default:()=>{}}},data(){return{showDeleteModal:!1,taskReassignment:!1,showTaskStatus:!1,actions:"",loading:!1}},created(){window.emitter.on("taskReassignment",this.updateTask),window.emitter.on("taskReassignmentClose",this.onClose)},methods:{subString(t,e=15){return et(t,e)},onClose(){this.showDeleteModal=!1,this.taskReassignment=!1,this.showTaskStatus=!1},changeTaskStatus(t){this.loading=!0,C.get("/tasks/api/change-task/"+this.task.id+"/"+t).then(e=>{this.loading=!1,R(e,"taskDetails"),window.emitter.emit("updateTaskActivity"),window.emitter.emit("updateTaskAssociates"),this.updateTask()}).catch(e=>{this.loading=!1,S(e,"taskDetails")})},showReassignModal(){this.taskReassignment=!0}},components:{"delete-modal":Lt,TaskReassignModal:Ha}},U=t=>(H("data-v-80a5e56e"),t=t(),Y(),t),Ja={class:"card-tools"},Wa={class:"btn-group"},Ga=U(()=>s("i",{class:"fas fa-hand-point-right"},null,-1)),Qa={class:"btn-group"},Xa={type:"button",class:"btn btn-tool dropdown-toggle","data-toggle":"dropdown"},Za=U(()=>s("i",{class:"fas fa-cog"},null,-1)),tn={class:"dropdown-menu dropdown-menu-right",id:"more_actions"},en=U(()=>s("i",{class:"fas fa-edit",style:{color:"#0d6aad"}},null,-1)),sn=U(()=>s("i",{class:"fas fa-trash",style:{color:"red"}},null,-1)),an={class:"btn-group"},nn={type:"button",class:"btn btn-tool dropdown-toggle","data-toggle":"dropdown"},on=U(()=>s("i",{class:"fas fa-exchange-alt"},null,-1)),ln={class:"dropdown-menu dropdown-menu-right",id:"more_actions"},dn=U(()=>s("i",{class:"far fa-clock",style:{color:"limegreen"}},null,-1)),rn=U(()=>s("i",{class:"fas fa-minus-circle",style:{color:"orangered"}},null,-1)),cn=U(()=>s("i",{class:"fas fa-exclamation-triangle",style:{color:"orange"}},null,-1));function mn(t,e,a,l,n,o){const h=r("custom-loader"),p=r("router-link"),f=r("delete-modal"),k=r("task-reassign-modal");return i(),d("div",Ja,[n.loading?(i(),y(h,{key:0,"animation-duration":4e3,color:"#1d78ff",size:60})):_("",!0),s("div",Wa,[s("button",{type:"button",onClick:e[0]||(e[0]=(...m)=>o.showReassignModal&&o.showReassignModal(...m)),class:"btn btn-tool"},[Ga,g(" "+c(t.lang("reassign")),1)])]),s("div",Qa,[s("button",Xa,[Za,g(" "+c(t.lang("actions")),1)]),s("div",tn,[a.notEdit?_("",!0):(i(),y(p,{key:0,to:"/tasks/task/"+a.task.id+"/edit",class:"dropdown-item"},{default:b(()=>[en,g(" "+c(t.lang("edit")),1)]),_:1},8,["to"])),s("a",{href:"javascript:;",onClick:e[1]||(e[1]=m=>n.showDeleteModal=!0),class:"dropdown-item"},[sn,g(" "+c(t.lang("delete")),1)])])]),s("div",an,[s("button",nn,[on,g(" "+c(t.lang("status")),1)]),s("div",ln,[s("a",{href:"javascript:;",class:I([a.task.status==="Open"?"disabledLink":"","dropdown-item"]),onClick:e[2]||(e[2]=V(m=>o.changeTaskStatus("open"),["prevent"]))},[dn,g("  "+c("Open"))],2),s("a",{href:"javascript:;",class:I([a.task.status==="Closed"?"disabledLink":"","dropdown-item"]),onClick:e[3]||(e[3]=V(m=>o.changeTaskStatus("close"),["prevent"]))},[rn,g("  "+c("Closed"))],2),s("a",{href:"javascript:;",class:I([a.task.status==="In-progress"?"disabledLink":"","dropdown-item"]),onClick:e[4]||(e[4]=V(m=>o.changeTaskStatus("inprogress"),["prevent"]))},[cn,g("  "+c("In-progress"))],2)])]),u(F,{name:"modal"},{default:b(()=>[n.showDeleteModal?(i(),y(f,{key:0,onClose:o.onClose,showModal:n.showDeleteModal,alertComponentName:"tasks-view",deleteUrl:"/tasks/task/"+a.task.id,redirectUrl:"/tasks/task",from:"agent"},null,8,["onClose","showModal","deleteUrl"])):_("",!0)]),_:1}),u(F,{name:"modal"},{default:b(()=>[u(k,{"v-if":n.taskReassignment,showModal:n.taskReassignment,taskId:a.task.id,agents:a.task.users},null,8,["v-if","showModal","taskId","agents"])]),_:1})])}const un=w(Ya,[["render",mn],["__scopeId","data-v-80a5e56e"]]);const hn={name:"task-description",description:"Task description Modal component",props:{showModal:{type:Boolean,default:!1},onClose:{type:Function,default:()=>{}},description:{type:String,default:""}}},pn={class:"modal-title"},_n={id:"log_desc"},kn=["innerHTML"];function gn(t,e,a,l,n,o){const h=r("modal");return a.showModal?(i(),y(h,{key:0,showModal:a.showModal,onClose:a.onClose},{title:b(()=>[s("h4",pn,c(t.lang("description")),1)]),fields:b(()=>[s("div",_n,[s("span",{innerHTML:a.description},null,8,kn)])]),_:1},8,["showModal","onClose"])):_("",!0)}const fn=w(hn,[["render",gn],["__scopeId","data-v-492522f8"]]);const bn={setup(){const t=N();return{formattedTime:M(()=>t.getters.formattedTime),formattedDate:M(()=>t.getters.formattedDate)}},props:{task:{type:Object,default:()=>{}},updateTask:{type:Function,default:()=>{}}},data(){return{showDescription:!1}},computed:{labelClass(){switch(this.task.status){case"Open":return"badge-success";case"Closed":return"badge-danger";case"In-progress":return"badge-warning";default:return"badge-default"}},userAuth(){return this.$store.state.auth.user.user_data.id},overdue(){return new Date().toISOString()>this.task.task_end_date},departments(){if(!this.task.watching_departments||!this.task.watching_departments.length)return"---";let t=[];return this.task.watching_departments.forEach(e=>{t.push(e.name)}),t.join(",")},watchingAgents(){if(!this.task.watching_agents||!this.task.watching_agents.length)return"---";let t=[];return this.task.watching_agents.forEach(e=>{t.push(e.name)}),t.join(",")},watchingTeams(){if(!this.task.watching_teams||!this.task.watching_teams.length)return"---";let t=[];return this.task.watching_teams.forEach(e=>{t.push(e.name)}),t.join(",")}},methods:{subString(t,e=15){return et(t,e)},gotoTicket(){this.task.association.assoc_data.ticket_number&&this.$router.push({path:"/thread/"+this.task.association.assoc_data.id})},onClose(){this.showDescription=!1}},components:{"task-actions":un,"task-description":fn}},yn=t=>(H("data-v-060b20fc"),t=t(),Y(),t),vn={class:"card card-light"},wn={class:"card-header"},Tn={class:"card-title",style:{"vertical-align":"middle"}},Cn={key:0,class:"badge badge-danger"},jn={class:"card-body"},Mn={class:"row"},Sn={class:"col-md-12"},Dn={class:"callout callout-info bg-info"},In={class:"row"},An={class:"col-md-4"},$n={class:"col-md-4"},En={class:"col-md-4"},Fn={class:"col-md-12"},On={class:"row"},Pn={class:"col-md-6 info-row d-flex"},Ln={class:"col-md-6"},Vn={class:"col-md-6"},Nn={class:"text-capitalize"},Un={class:"col-md-6 info-row d-flex"},qn={class:"col-md-6"},Rn={class:"col-md-6"},Bn={class:"col-md-6 info-row d-flex"},xn={class:"col-md-6"},zn={class:"col-md-6"},Kn={class:"text-capitalize"},Hn={class:"col-md-6 info-row d-flex"},Yn={class:"col-md-6"},Jn={class:"col-md-6"},Wn={key:0,class:"text-center"},Gn={key:0},Qn={class:"col-md-6 info-row d-flex"},Xn={class:"col-md-6"},Zn={class:"col-md-6"},to={key:0,class:"text-center"},eo={key:0},so={class:"col-md-6 info-row d-flex"},ao={class:"col-md-6"},no={class:"col-md-6"},oo=yn(()=>s("i",{class:"fas fa-file-code"}," ",-1)),io={class:"col-md-6 info-row d-flex"},lo={class:"col-md-6"},ro={class:"col-md-6"},co={class:"col-md-6 info-row d-flex"},mo={class:"col-md-6"},uo={class:"col-md-6"},ho={class:"col-md-6 info-row d-flex"},po={class:"col-md-6"},_o={class:"col-md-6"},ko={class:"col-md-6 info-row d-flex"},go={class:"col-md-6"},fo={class:"col-md-6"},bo={class:"col-md-6 info-row d-flex"},yo={class:"col-md-6"},vo={class:"col-md-6"};function wo(t,e,a,l,n,o){const h=r("alert"),p=r("task-actions"),f=r("task-description"),k=q("tooltip");return i(),d("div",null,[u(h,{componentName:"taskDetails"}),s("div",vn,[s("div",wn,[v((i(),d("h3",Tn,[g(c(o.subString(a.task.task_name,50))+" ",1),s("span",{class:I(["badge",o.labelClass])},c(a.task.status),3),g("  "),o.overdue?(i(),d("span",Cn,c(t.lang("task-plugin-overdue")),1)):_("",!0)])),[[k,a.task.subject]]),u(p,{task:a.task,updateTask:a.updateTask},null,8,["task","updateTask"])]),s("div",jn,[s("div",Mn,[s("div",Sn,[s("div",Dn,[s("div",In,[s("div",An,[s("b",null,c(t.lang("created_date"))+" : ",1),v((i(),d("span",null,[g(c(l.formattedTime(a.task.created_at)),1)])),[[k,l.formattedTime(a.task.created_at)]])]),s("div",$n,[s("b",null,c(t.lang("start_date"))+" : ",1),v((i(),d("span",null,[g(c(l.formattedTime(a.task.task_start_date)),1)])),[[k,l.formattedTime(a.task.task_start_date)]])]),s("div",En,[s("b",null,c(t.lang("end_date"))+" : ",1),v((i(),d("span",null,[g(c(l.formattedTime(a.task.task_end_date)),1)])),[[k,l.formattedTime(a.task.task_end_date)]])])])])])]),s("div",Fn,[s("div",On,[s("div",Pn,[s("div",Ln,[s("label",null,c(t.lang("task_name")),1)]),s("div",Vn,[v((i(),d("a",Nn,[g(c(a.task.task_name),1)])),[[k,t.lang("task-details-name")]])])]),s("div",Un,[s("div",qn,[s("label",null,c(t.lang("created_by")),1)]),s("div",Rn,[v((i(),d("a",null,[g(c(a.task.created_by.full_name),1)])),[[k,t.lang("task-details-created-by")]])])]),s("div",Bn,[s("div",xn,[s("label",null,c(t.lang("task-status-label")),1)]),s("div",zn,[v((i(),d("a",Kn,[g(c(a.task.status),1)])),[[k,t.lang("task-details-status")]])])]),s("div",Hn,[s("div",Yn,[s("label",null,c(t.trans("task_assigned_agents")),1)]),s("div",Jn,[a.task.users.length?(i(!0),d(j,{key:1},P(a.task.users,(m,T)=>v((i(),d("a",null,[g(c(o.subString(m.name)),1),T!==Object.keys(a.task.users).length-1?(i(),d("span",Gn,", ")):_("",!0)])),[[k,t.trans("task-details-agents")]])),256)):(i(),d("a",Wn,"---"))])]),s("div",Qn,[s("div",Xn,[s("label",null,c(t.trans("task_assigned_teams")),1)]),s("div",Zn,[a.task.teams.length?(i(!0),d(j,{key:1},P(a.task.teams,(m,T)=>v((i(),d("a",null,[g(c(o.subString(m.name)),1),T!==Object.keys(a.task.teams).length-1?(i(),d("span",eo,", ")):_("",!0)])),[[k,t.trans("task-details-teams")]])),256)):(i(),d("a",to,"---"))])]),s("div",so,[s("div",ao,[s("label",null,c(t.lang("task_description")),1)]),s("div",no,[s("a",{href:"javascript:;",class:"btn btn-info btn-xs",onClick:e[0]||(e[0]=m=>n.showDescription=!0)},[oo,g(c(t.lang("show_description")),1)])])]),s("div",io,[s("div",lo,[s("label",null,c(t.lang("task-details-task-project")),1)]),s("div",ro,[v((i(),d("a",null,[g(c(a.task.project&&a.task.project.name?o.subString(a.task.project.name,30):"---"),1)])),[[k,t.lang("task-details-task-project-tooltip")]])])]),s("div",co,[s("div",mo,[s("label",null,c(t.lang("task_list")),1)]),s("div",uo,[v((i(),d("a",null,[g(c(a.task.task_category?o.subString(a.task.task_category.name,30):"---"),1)])),[[k,t.lang("task-details-task-category-tooltip")]])])]),s("div",ho,[s("div",po,[s("label",null,c(t.lang("task_watching_departments")),1)]),s("div",_o,[v((i(),d("a",null,[g(c(o.departments),1)])),[[k,t.lang("task_watching_departments_tooltip")]])])]),s("div",ko,[s("div",go,[s("label",null,c(t.lang("task_watching_agents")),1)]),s("div",fo,[v((i(),d("a",null,[g(c(o.watchingAgents),1)])),[[k,t.lang("task_watching_agents_tooltip")]])])]),s("div",bo,[s("div",yo,[s("label",null,c(t.lang("task_watching_teams")),1)]),s("div",vo,[v((i(),d("a",null,[g(c(o.watchingTeams),1)])),[[k,t.lang("task_watching_teams_tooltip")]])])])])])])]),u(F,{name:"modal"},{default:b(()=>[n.showDescription?(i(),y(f,{key:0,onClose:o.onClose,showModal:n.showDescription,description:a.task.task_description},null,8,["onClose","showModal","description"])):_("",!0)]),_:1})])}const To=w(bn,[["render",wo],["__scopeId","data-v-060b20fc"]]),Co={data(){return{task:"",taskId:"",loading:!0,assigneeIds:[],assigneeNames:[],dataReady:!1}},created(){window.emitter.on("updateTaskAssociates",this.getValues)},beforeMount(){this.getValues()},methods:{updateTaskData(){this.getValues()},getValues(){const t=window.location.pathname;this.taskId=K(t),C.get("/tasks/api/get-task-by-id/"+this.taskId+"?policy_check=1").then(e=>{this.loading=!1,this.dataReady=!0,this.task=e.data.data}).catch(e=>{S(e,"tasks-view"),this.loading=!1,setTimeout(()=>{this.redirect("/404")},1e3)})}},components:{"task-details":To,"task-associates":qa}},jo={class:"col-sm-12"},Mo={key:1,class:"row"};function So(t,e,a,l,n,o){const h=r("alert"),p=r("task-details"),f=r("task-associates"),k=r("reuse-loader");return i(),d("div",jo,[u(h,{componentName:"tasks-view"}),!n.loading&&n.dataReady?(i(),d(j,{key:0},[u(p,{task:n.task,updateTask:o.updateTaskData},null,8,["task","updateTask"]),u(h,{componentName:"tasks-associates-view"}),u(f,{taskId:n.taskId},null,8,["taskId"])],64)):_("",!0),n.loading?(i(),d("div",Mo,[u(k,{"animation-duration":4e3,size:60})])):_("",!0)])}const ot=w(Co,[["render",So]]);const Do={name:"task-project",description:"Task Project Component",setup(){const t=N();return{formattedTime:M(()=>t.getters.formattedTime)}},props:{category:{type:String,default:""}},data(){return{apiUrl:"/tasks/api/projects",columns:["name","created_at","action"],showModal:!1,style:{width:"500px"}}},beforeMount(){const t=this;this.options={headings:{name:this.lang("name"),created_at:this.lang("created_at"),action:this.lang("actions")},columnsClasses:{name:"project-name",created_at:"project-created-at",action:"project-action"},sortIcon:{base:"glyphicon",up:"glyphicon-chevron-up",down:"glyphicon-chevron-down"},texts:{filter:"",limit:""},templates:{created_at(e,a){return t.formattedTime(a.created_at)},action:(e,a)=>t.h(nt,{data:a})},sortable:["name","created_at"],filterable:["name","created_at"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(e){return{sortField:e.orderBy?e.orderBy:"id",sortOrder:e.ascending?"desc":"asc",searchTerm:e.query.trim(),page:e.page,limit:e.limit}},responseAdapter({data:e}){return{data:e.data.projects.map(a=>(a.edit_modal=!0,a.delete_url=t.basePath()+"/tasks/api/project/delete/"+a.id,a.componentTitle="TaskProjects",a)),count:e.data.total}}}},methods:{onClose(){this.$store.dispatch("unsetValidationError"),this.showModal=!1}},components:{"task-modal":Bt}},Io={class:"col-sm-12"},Ao={class:"card-header border-0 p-0"},$o=s("i",{class:"glyphicon glyphicon-plus"},null,-1),Eo={class:"card-body p-0",id:"task-projects"};function Fo(t,e,a,l,n,o){const h=r("data-table"),p=r("task-modal");return i(),d("div",Io,[s("div",Ao,[s("button",{type:"button",class:"btn btn-default float-right",onClick:e[0]||(e[0]=f=>n.showModal=!0)},[$o,g(" "+c(t.lang("add_project")),1)])]),s("div",Eo,[u(h,{url:n.apiUrl,dataColumns:n.columns,option:t.options,componentTitle:"TaskProjects",scroll_to:"task-projects"},null,8,["url","dataColumns","option"])]),u(F,{name:"modal"},{default:b(()=>[n.showModal?(i(),y(p,{key:0,onClose:o.onClose,showModal:n.showModal,title:"add_project",containerStyle:n.style,componentTitle:"TaskProjects"},null,8,["onClose","showModal","containerStyle"])):_("",!0)]),_:1})])}const Oo=w(Do,[["render",Fo]]);const Po={name:"task-list",description:"Task List Component",setup(){const t=N();return{formattedTime:M(()=>t.getters.formattedTime)}},props:{category:{type:String,default:""}},data(){return{apiUrl:"/tasks/api/categories",columns:["name","project","created_at","action"],showModal:!1}},beforeMount(){const t=this;this.options={columnsClasses:{name:"tasklist-name",project:"tasklist-created-at",created_at:"tasklist-created-at",action:"tasklist-action"},headings:{name:t.lang("name"),created_at:t.lang("created_at"),action:t.lang("actions"),project:t.lang("project")},sortIcon:{base:"glyphicon",up:"glyphicon-chevron-up",down:"glyphicon-chevron-down"},texts:{filter:"",limit:""},templates:{created_at(e,a){return t.formattedTime(a.created_at)},project(e,a){return a.project.name},action:(e,a)=>t.h(nt,{data:a})},sortable:["name","created_at"],filterable:["name"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(e){return{sortField:e.orderBy?e.orderBy:"id",sortOrder:e.ascending?"desc":"asc",searchTerm:e.query.trim(),page:e.page,limit:e.limit}},responseAdapter({data:e}){return{data:e.data.tasklists.map(a=>(a.edit_modal=!0,a.delete_url=t.basePath()+"/tasks/api/category/delete/"+a.id,a.componentTitle="TaskList",a)),count:e.data.total}}}},methods:{onClose(){this.$store.dispatch("unsetValidationError"),this.showModal=!1}},components:{"task-list-modal":xt}},Lo={class:"col-sm-12"},Vo={class:"card-header border-0 p-0"},No=s("i",{class:"glyphicon glyphicon-plus"},null,-1),Uo={class:"card-body p-0",id:"task-list"};function qo(t,e,a,l,n,o){const h=r("data-table"),p=r("task-list-modal");return i(),d("div",Lo,[s("div",Vo,[s("button",{type:"button",class:"btn btn-default float-right",onClick:e[0]||(e[0]=f=>n.showModal=!0)},[No,g(" "+c(t.lang("add_tasklist")),1)])]),s("div",Uo,[u(h,{url:n.apiUrl,dataColumns:n.columns,option:t.options,componentTitle:"TaskList",scroll_to:"task-list"},null,8,["url","dataColumns","option"])]),u(F,{name:"modal"},{default:b(()=>[n.showModal?(i(),y(p,{key:0,onClose:o.onClose,showModal:n.showModal,title:"tasklist_create",componentTitle:"TaskList"},null,8,["onClose","showModal"])):_("",!0)]),_:1})])}const Ro=w(Po,[["render",qo]]);const Bo={name:"task-settings",description:"Task Settings page",data(){return{tabs:[{id:"project",title:"project"},{id:"tasklist",title:"task-plugin-category"}],category:"project",loading:!1}},computed:{currentComponent(){return this.category==="project"?"task-project":"task-list"}},methods:{associates(t){this.category=t}},components:{"task-project":Oo,"task-list":Ro}},xo={class:"col-sm-12"},zo={class:"card card-light card-tabs"},Ko={class:"card-header p-0 pt-1"},Ho={class:"nav nav-tabs",id:"custom-tabs-one-tab",role:"tablist"},Yo=["onClick"],Jo={class:"card-body"},Wo={class:"tab-content"},Go={class:"tab-pane active",role:"tabpanel"};function Qo(t,e,a,l,n,o){const h=r("alert");return i(),d("div",xo,[u(h,{componentName:"dataTableModal"}),s("div",zo,[s("div",Ko,[s("ul",Ho,[(i(!0),d(j,null,P(n.tabs,p=>(i(),d("li",{key:p.id,class:"nav-item"},[s("a",{id:"settings_tab",onClick:f=>o.associates(p.id),class:I(["nav-link",{active:n.category===p.id}]),"data-toggle":"pill",role:"tab"},c(t.lang(p.title)),11,Yo)]))),128))])]),s("div",Jo,[s("div",Wo,[s("div",Go,[(i(),y(St(o.currentComponent),{category:n.category},null,8,["category"]))])])])])])}const Xo=w(Bo,[["render",Qo]]);const Zo={name:"TaskTemplate",components:{"task-modal":ht},computed:{createPage(){return this.basePath()+"/tasks/template/create"}},methods:{onClose(){this.$store.dispatch("unsetValidationError"),this.showModal=!1},gotoCreateTemplatePage(){this.redirect("/tasks/template/create")}},props:{category:{type:String,default:""}},data(){return{apiUrl:"/tasks/api/template/index",columns:["name","description","project","category","template_tasks","action"],showModal:!1,style:{width:"500px"}}},beforeMount(){const t=this;this.options={headings:{name:t.lang("name"),description:t.lang("description"),category:t.lang("category"),project:t.lang("project"),template_tasks:t.lang("template_tasks"),action:t.lang("action")},columnsClasses:{name:"task-template-columns",description:"task-template-columns",category:"task-template-columns",project:"task-template-columns",template_tasks:"task-template-columns",action:"task-template-columns"},sortIcon:{base:"glyphicon",up:"glyphicon-chevron-up",down:"glyphicon-chevron-down"},texts:{filter:"",limit:""},templates:{category:(e,a)=>{let l=a.category;return l?l.name:"--"},project:(e,a)=>{let l=a.project;return l?l.name:"--"},template_tasks:(e,a,l,n)=>t.h(tt,{data:a,index:l,column:n}),action:(e,a)=>t.h(nt,{data:a})},sortable:["name"],filterable:["name"],pagination:{chunk:5,nav:"fixed",edge:!0},requestAdapter(e){return{sortField:e.orderBy?e.orderBy:"id",sortOrder:e.ascending?"desc":"asc",searchTerm:e.query.trim(),page:e.page,limit:e.limit}},responseAdapter({data:e}){return{data:e.data.data.map(a=>(a.edit_url="/tasks/template/"+a.id+"/edit",a.delete_url=t.basePath()+"/tasks/api/template/delete/"+a.id,a.alertComponentName="task-template-settings",a.componentTitle="TaskTemplate",a)),count:e.data.total}}}}},ti={class:"col-sm-12"},ei={class:"card-tools"},si=s("i",{class:"glyphicon glyphicon-plus"},null,-1);function ai(t,e,a,l,n,o){const h=r("alert"),p=r("router-link"),f=r("data-table"),k=r("faveo-box"),m=q("tooltip");return i(),d("div",ti,[u(h,{componentName:"task-template-settings"}),u(k,{title:t.lang("task-plugin-task-templates")},{headerMenu:b(()=>[s("div",ei,[v((i(),y(p,{to:"/tasks/template/create",class:"btn btn-tool"},{default:b(()=>[si]),_:1})),[[m,t.lang("task-plugin-add-task-template")]])])]),default:b(()=>[u(f,{url:n.apiUrl,dataColumns:n.columns,option:t.options,componentTitle:"TaskTemplate",scroll_to:"task-templates"},null,8,["url","dataColumns","option"])]),_:1},8,["title"])])}const ni=w(Zo,[["render",ai]]);const oi={name:"TaskTemplateCreateEdit",data(){return{templateDetails:"",randomKey:Math.floor(Math.random()*1e6),hasDataPopulated:!0,loading:!1,name:"",description:"",assigneesDropdownDisabled:!1,edit:!0,timeFilterOptions:[{id:"minute",value:"unit_minute",label:"Minute(s)"},{id:"hour",value:"unit_hour",label:"Hour(s)"},{id:"day",value:"unit_day",label:"Day(s)"},{id:"month",value:"unit_month",label:"Month(s)"}],filterObjects:{},templateTasks:[{taskName:"",taskDescription:"",assignees:[],teams:[],taskEnd:null,order:1,taskEndUnit:"day",assignTaskToTicketAssignee:!1}],selectOptions:[],assignToOptions:[{name:"Teams",id:"teams"},{name:"Agents",id:"agents"}],category_id:null,project_id:null,task_category_api:"",id:"",tasksLabelStyle:{display:"none"}}},components:{"text-field":st,"dynamic-select":G,"date-time-field":gt,"v-select":Dt,"form-field":ft,"tool-tip":bt,draggable:It,StaticSelect:mt},computed:{disableRemoveButton(){return this.templateTasks.length===1?"disableMinus":""}},beforeMount(){this.fillFieldsIfEdit()},methods:{buttonText(t){return t?(t=t.toString(),` ${t}`):""},subString(t,e=15){return et(t,e)},addTaskRow(){this.templateTasks.push({taskName:"",taskDescription:"",assignees:[],teams:[],taskEnd:null,order:this.templateTasks.length+1,taskEndUnit:"day",assignTaskToTicketAssignee:!1})},removeTaskRow(t){this.templateTasks.length>1?this.templateTasks.splice(t,1):alert(this.lang("task-plugin-template-at-least-one-task"))},onChange(t,e){this[e]=t,e==="project_id"&&(t?this.task_category_api=`tasks/api/category/view?project_ids[0]=${t.id}`:(this.task_category_api="",this.category_id=null,this.randomKey++))},onChangeStringified(t,e){const a=JSON.parse(e);let l=this.templateTasks[a.iteration];l[a.name]=t},fillFieldsIfEdit(){if(this.edit){this.loading=!0;let t=K(window.location.pathname);C.get(`tasks/api/template/get-template-by-id/${t}`).then(({data:e})=>{this.id=e.id,this.name=e.name,this.description=e.description,this.category_id=e.category,this.project_id=e.project,this.addFilledTaskRows(e.template_tasks),this.loading=!1,this.edit=!1}).catch(e=>{S(e,"task-template-create-edit"),setTimeout(()=>{this.redirect("/tasks/template/settings")},1500)})}},addFilledTaskRows(t){t!==void 0&&(this.templateTasks=[],t.forEach((e,a)=>{this.templateTasks.push({taskName:e.name,taskDescription:e.taskDescription,teams:e.teams,assignees:e.assignees,taskEnd:e.end,order:e.order,taskEndUnit:e.end_unit,assignTaskToTicketAssignee:!!e.assign_task_to_ticket_agent})}))},submit(){let t,e;this.loading=!0;let a={name:this.name,description:this.description,category_id:this.category_id?this.category_id.id:null,project_id:this.project_id?this.project_id.id:null,task_templates:this.templateTasks};this.id?(t=`/tasks/api/template/update/${this.id}`,e="PUT"):(t="/tasks/api/template/store",e="POST"),C.request({method:e,url:t,data:a}).then(l=>{R(l,"task-template-create-edit"),this.$store.dispatch("unsetValidationError"),this.edit||setTimeout(()=>{this.$router.push({name:"TaskTemplate Settings"})},3e3)}).catch(l=>{S(l,"task-template-create-edit")}).finally(()=>{this.loading=!1})},updateOrder(){this.templateTasks.map((t,e)=>{t.order=e+1})}}},ii={class:"col-sm-12"},li={class:"row"},di={class:"row"},ri={class:"row"},ci={class:"col-sm-12 task-template-table"},mi={key:1,class:"table-responsive-sm"},ui={class:"table table-bordered"},hi={class:"thead-default"},pi={class:"temp-name"},_i=s("span",{class:"text-red"},"*",-1),ki={class:"temp-name"},gi={class:"temp-assigned-agents"},fi={class:"temp-assigned-teams"},bi={class:"temp-due"},yi=s("span",{class:"text-red"},"*",-1),vi={class:"temp-action"},wi=["onUpdate:modelValue","name","placehold"],Ti=["onUpdate:modelValue","name"],Ci={class:"task-assign-to"},ji={class:"task-assign"},Mi={class:"row no-gutter"},Si={class:"col-sm-4 col-xs-12"},Di=["onUpdate:modelValue"],Ii={class:"col-sm-8 col-xs-12"},Ai={class:"flex-div"},$i=s("i",{class:"glyphicon glyphicon-plus"},null,-1),Ei=[$i],Fi=["onClick"],Oi=s("i",{class:"fas fa-minus"},null,-1),Pi=[Oi],Li={class:"btn btn-sm btn-default drag-handle"},Vi=s("i",{class:"fas fa-bars"},null,-1),Ni=[Vi],Ui=s("i",{class:"fas fa-save"},null,-1);function qi(t,e,a,l,n,o){const h=r("custom-loader"),p=r("alert"),f=r("text-field"),k=r("dynamic-select"),m=r("loader"),T=r("tool-tip"),A=r("form-field"),z=r("v-select"),D=r("draggable"),B=r("faveo-box"),it=q("focus-first-input"),Q=q("tooltip");return i(),d("div",ii,[n.loading?(i(),y(h,{key:0,"animation-duration":"4000"})):_("",!0),u(p,{componentName:"task-template-create-edit"}),u(B,{title:n.edit?t.lang("task-plugin-task-template-edit"):t.lang("task-plugin-task-template-create")},{default:b(()=>[v((i(),d("div",li,[u(f,{label:t.lang("task-plugin-task-template-name"),onChange:o.onChange,placehold:t.lang("enter_a_value"),value:n.name,type:"text",name:"name",classname:"col-sm-4",required:!0,id:"task_name"},null,8,["label","onChange","placehold","value"]),u(k,{name:"project_id",classname:"col-sm-4",apiEndpoint:"tasks/api/project/view",multiple:!1,label:t.lang("project"),value:n.project_id,onChange:o.onChange,searchable:!0},null,8,["label","value","onChange"]),(i(),y(k,{name:"category_id",classname:"col-sm-4",key:n.randomKey,multiple:!1,apiEndpoint:n.task_category_api,label:t.lang("task-plugin-category"),hint:t.lang("task-plugin-category-tooltip"),value:n.category_id,onChange:o.onChange,searchable:!0,required:!1},null,8,["apiEndpoint","label","hint","value","onChange"]))])),[[it]]),s("div",di,[u(f,{label:t.lang("task-plugin-task-template-description"),onChange:o.onChange,placehold:t.lang("enter_a_value"),value:n.description,type:"textarea",name:"description",classname:"col-sm-12",required:!0,id:"task_description"},null,8,["label","onChange","placehold","value"])]),s("div",ri,[s("div",ci,[n.hasDataPopulated?(i(),d("div",mi,[s("table",ui,[s("thead",hi,[s("tr",null,[s("th",pi,[g(c(t.lang("task-plugin-task-template-task-name"))+" ",1),_i]),s("th",ki,c(t.lang("description")),1),s("th",gi,[g(c(t.lang("task-plugin-template-assigned-agents"))+" ",1),u(T,{message:t.lang("task-plugin-template-assigned-agents-tooltip"),size:"small"},null,8,["message"])]),s("th",fi,[g(c(t.lang("task-plugin-template-assigned-teams"))+" ",1),u(T,{message:t.lang("task-plugin-template-assigned-teams-tooltip"),size:"small"},null,8,["message"])]),s("th",bi,[g(c(t.lang("task-plugin-task-template-due-in"))+" ",1),yi]),s("th",vi,c(t.lang("task-plugin-template-action-label")),1)])]),u(D,{list:n.templateTasks,options:{animation:200,handle:".drag-handle"},tag:"tbody",onEnd:o.updateOrder},{item:b(({element:$,index:O})=>[(i(),d("tr",{key:O},[s("td",null,[u(A,{name:`task_templates.${O}.taskName`,label:"",labelStyle:n.tasksLabelStyle},{default:b(()=>[v(s("input",{type:"text","onUpdate:modelValue":E=>$.taskName=E,name:`task_templates.${O}.taskName`,placehold:t.lang("enter_a_value"),class:"form-control adjustableLineHeight"},null,8,wi),[[X,$.taskName]])]),_:2},1032,["name","labelStyle"])]),s("td",null,[u(A,{name:`task_templates.${O}.taskDescription`,label:"",labelStyle:n.tasksLabelStyle},{default:b(()=>[v(s("textarea",{"onUpdate:modelValue":E=>$.taskDescription=E,name:`task_templates.${O}.taskName`,class:"form-control adjustableLineHeight"},null,8,Ti),[[X,$.taskDescription]])]),_:2},1032,["name","labelStyle"])]),s("td",Ci,[u(k,{name:JSON.stringify({iteration:O,name:"assignees"}),multiple:!0,apiEndpoint:"api/dependency/agents?supplements[no_email]=1&page=1&paginate=1",label:"",labelStyle:n.tasksLabelStyle,value:$.assignees,onChange:o.onChangeStringified,searchable:!0,required:!1,disabled:n.assigneesDropdownDisabled},null,8,["name","labelStyle","value","onChange","disabled"])]),s("td",ji,[u(k,{name:JSON.stringify({iteration:O,name:"teams"}),multiple:!0,apiEndpoint:"api/dependency/teams?supplements[no_email]=1&page=1&paginate=1",label:"",labelStyle:n.tasksLabelStyle,value:$.teams,onChange:o.onChangeStringified,searchable:!0,required:!1,disabled:n.assigneesDropdownDisabled},null,8,["name","labelStyle","value","onChange","disabled"])]),s("td",null,[s("div",Mi,[s("div",Si,[u(A,{name:`task_templates.${O}.taskEnd`,label:"",labelStyle:n.tasksLabelStyle},{default:b(()=>[v(s("input",{type:"number","onUpdate:modelValue":E=>$.taskEnd=E,class:"form-control adjustableLineHeight"},null,8,Di),[[X,$.taskEnd,void 0,{number:!0}]])]),_:2},1032,["name","labelStyle"])]),s("div",Ii,[u(A,{name:`task_templates.${O}.taskEndUnit`,label:"",labelStyle:n.tasksLabelStyle},{default:b(()=>[u(z,{options:n.timeFilterOptions,class:"faveo-dynamic-select",modelValue:$.taskEndUnit,"onUpdate:modelValue":E=>$.taskEndUnit=E,multiple:!1,clearable:!1,reduce:E=>E.id},null,8,["options","modelValue","onUpdate:modelValue","reduce"])]),_:2},1032,["name","labelStyle"])])])]),s("td",null,[s("div",Ai,[v((i(),d("button",{class:"btn btn-sm btn-default",onClick:e[0]||(e[0]=(...E)=>o.addTaskRow&&o.addTaskRow(...E))},Ei)),[[Q,t.lang("add")]]),g("  "),v((i(),d("button",{class:I(["btn btn-sm btn-default",o.disableRemoveButton]),onClick:E=>o.removeTaskRow(O)},Pi,10,Fi)),[[Q,t.lang("remove")]]),g("  "),v((i(),d("button",Li,Ni)),[[Q,t.lang("move")]])])])]))]),_:1},8,["list","options","onEnd"])])])):(i(),y(m,{key:0,"animation-duration":"4000",size:"60"}))])]),s("div",null,[s("button",{onClick:e[1]||(e[1]=V((...$)=>o.submit&&o.submit(...$),["prevent"])),class:"btn btn-primary"},[Ui,g(" "+c(o.buttonText(t.lang("save"))),1)])])]),_:1},8,["title"])])}const ct=w(oi,[["render",qi]]),Ri={components:{TextField:st},data(){return{project_name:"",required:"required",projectId:"",loading:!1}},beforeMount(){this.setUp()},methods:{setUp(){this.projectId=K(window.location.pathname);let t="tasks/api/projects?projectIds[]="+this.projectId;C.get(t).then(e=>this.project_name=e.data.data.projects[0].name)},onChange(t,e){this[e]=t},setAlert(t){S({response:{status:400,data:{message:t}}},"projectEdit")},projectSubmit(){if(!this.project_name){this.setAlert(this.lang("project_name_empty"));return}let t={name:this.project_name};this.loading=!0,C.put("tasks/api/project/edit/"+this.projectId,t).then(e=>{this.loading=!1,R(e,"projectEdit"),setTimeout(()=>window.location=this.basePath()+"/tasks/settings")}).catch(e=>{this.loading=!1,S(e,"projectEdit")})}}},Bi={class:"card card-light"},xi={class:"card-header"},zi={class:"card-title"},Ki={class:"card-body"},Hi={class:"row"},Yi={class:"card-footer"};function Ji(t,e,a,l,n,o){const h=r("alert"),p=r("custom-loader"),f=r("TextField");return i(),d("div",null,[u(h,{componentName:"projectEdit"}),s("div",Bi,[n.loading?(i(),y(p,{key:0,"animation-duration":4e3,color:"#1d78ff",size:60})):_("",!0),s("div",xi,[s("h3",zi,c(t.lang("project_edit")),1)]),s("div",Ki,[s("div",Hi,[u(f,{label:t.lang("project_name"),id:"project_name",onChange:o.onChange,value:n.project_name,type:"text",name:"project_name",required:n.required,classname:"col-sm-12"},null,8,["label","onChange","value","required"])])]),s("div",Yi,[s("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=V((...k)=>o.projectSubmit&&o.projectSubmit(...k),["prevent"]))},c(t.lang("save")),1)])])])}const Wi=w(Ri,[["render",Ji]]),Gi={components:{TextField:st,DynamicSelect:G},data(){return{tasklist_name:"",required:"required",tasklistId:"",project:"",projectId:"",loading:!1}},beforeMount(){this.setUp()},methods:{setUp(){this.tasklistId=K(window.location.pathname);let t="tasks/tasklists?tasklistIds[]="+this.tasklistId;C.get(t).then(e=>{this.tasklist_name=e.data.data.tasklists[0].name,this.project=e.data.data.tasklists[0].project,this.projectId=this.project.id})},setAlert(t){S({response:{status:400,data:{message:t}}},"tasklistEdit")},onChange(t,e){typeof t=="object"&&(this.projectId=t.id.toString()),this[e]=t},tasklistSubmit(){if(!this.tasklist_name){this.setAlert(this.lang("tasklist_name_empty"));return}if(!this.projectId){this.setAlert(this.lang("project_name_for_tasklist"));return}let t={name:this.tasklist_name,project_id:this.projectId};this.loading=!0,C.put("/tasks/tasklist/edit/"+this.tasklistId,t).then(e=>{this.loading=!1,R(e,"tasklistEdit"),setTimeout(()=>window.location=this.basePath()+"/tasks/settings",1500)}).catch(e=>{this.loading=!1,S(e,"tasklistEdit")})}}},Qi={class:"card card-light"},Xi={class:"card-header"},Zi={class:"card-title"},tl={class:"card-body"},el={class:"row"},sl={class:"card-footer"};function al(t,e,a,l,n,o){const h=r("alert"),p=r("custom-loader"),f=r("TextField"),k=r("DynamicSelect");return i(),d("div",null,[u(h,{componentName:"tasklistEdit"}),s("div",Qi,[s("div",Xi,[s("h3",Zi,c(t.lang("tasklist_edit")),1)]),s("div",tl,[n.loading?(i(),y(p,{key:0,"animation-duration":4e3,color:"#1d78ff",size:60})):_("",!0),s("div",el,[u(f,{label:t.lang("tasklist_name"),id:"tasklist_name",onChange:o.onChange,placehold:t.lang("enter_a_value"),value:n.tasklist_name,type:"text",name:"tasklist_name",required:n.required,classname:"col-sm-6"},null,8,["label","onChange","placehold","value","required"]),u(k,{id:"project",name:"project",multiple:!1,label:t.lang("project"),onChange:o.onChange,strlength:"35",apiEndpoint:"tasks/api/project/view",required:n.required,value:n.project,classname:"col-sm-6"},null,8,["label","onChange","required","value"])])]),s("div",sl,[s("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=V((...m)=>o.tasklistSubmit&&o.tasklistSubmit(...m),["prevent"]))},c(t.lang("save")),1)])])])}const nl=w(Gi,[["render",al]]);ut("associated-task-list",ue,"ticket-timeline-mounted-tasks","timeline-display-box-tasks");ut("task-ticket-actions",ge,"timeline-action-div-mounted","timeline-action-div");Ft.addRoute({path:"/tasks",component:Ot,name:"Tasks",redirect:"/tasks/task",children:[{path:"task",component:ns,name:"Tasks Index",meta:{title:"tasks",crumb:{link:{name:"dashboard",to:"/"},active:"tasks"}}},{path:"task/create",component:W,name:"Task Create",props:{editPage:!1},meta:{title:"tasks",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"tasks",to:"/tasks/task"},active:"create"}}},{path:"task/:id/edit",component:W,name:"Task Edit",props:{editPage:!0},meta:{title:"tasks",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"tasks",to:"/tasks/task"},active:"edit"}}},{path:"task/:id",component:ot,name:"Task View",meta:{title:"tasks",crumb:{link:{name:"dashboard",to:"/"},root_link:{name:"tasks",to:"/tasks/task"},active:"view"}}}]});let ol={path:"/tasks",component:Kt,name:"Tasks Configuration",redirect:"/tasks/settings",children:[{path:"settings",component:Xo,name:"Task Settings",meta:{title:"project-and-category",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},active:"project-and-category"}}},{path:"template/settings",component:ni,name:"TaskTemplate Settings",meta:{title:"task-template-settings",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},active:"task-template"}}},{path:"template/create",component:ct,name:"TaskTemplate Create",meta:{title:"task-template-create",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},parent_link:{name:"task-template",to:"/tasks/template/settings"},active:"task-template-create"}}},{path:"template/:id/edit",component:ct,name:"TaskTemplate Edit",meta:{title:"task-template-edit",crumb:{link:{name:"admin_panel",to:"/"},root_link:{name:"plugins",to:"/plugins"},parent_link:{name:"task-template",to:"/tasks/template/settings"},active:"task-template-edit"}}}]};zt.addRoute(ol);app.component("task-create",W);app.component("task-individual-view",ot);app.component("task-view",ot);app.component("task-create-wrapper",W);app.component("project-edit",Wi);app.component("tasklist-edit",nl);
